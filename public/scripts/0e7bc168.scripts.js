!function(r){"use strict";function i(e,t){this.$body=r(document.body),this.$scrollElement=r(e).is(document.body)?r(window):r(e),this.options=r.extend({},i.DEFAULTS,t),this.selector=(this.options.target||"")+" .nav li > a.page-scroll",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",r.proxy(this.process,this)),this.refresh(),this.process()}function t(a){return this.each(function(){var e=r(this),t=e.data("bs.scrollspy"),n="object"==typeof a&&a;t||e.data("bs.scrollspy",t=new i(this,n)),"string"==typeof a&&t[a]()})}i.VERSION="3.3.4",i.DEFAULTS={offset:10},i.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},i.prototype.refresh=function(){var e=this,a="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),r.isWindow(this.$scrollElement[0])||(a="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=r(this),t=e.data("target")||e.attr("href"),n=/^#./.test(t)&&r(t);return n&&n.length&&n.is(":visible")&&[[n[a]().top+i,t]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},i.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),a=this.options.offset+n-this.$scrollElement.height(),i=this.offsets,r=this.targets,o=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),a<=t)return o!=(e=r[r.length-1])&&this.activate(e);if(o&&t<i[0])return this.activeTarget=null,this.clear();for(e=i.length;e--;)o!=r[e]&&t>=i[e]&&(void 0===i[e+1]||t<i[e+1])&&this.activate(r[e])},i.prototype.activate=function(e){this.activeTarget=e,this.clear();var t=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=r(t).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")},i.prototype.clear=function(){r(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var e=r.fn.scrollspy;r.fn.scrollspy=t,r.fn.scrollspy.Constructor=i,r.fn.scrollspy.noConflict=function(){return r.fn.scrollspy=e,this},r(window).on("load.bs.scrollspy.data-api",function(){r('[data-spy="scroll"]').each(function(){var e=r(this);t.call(e,e.data())})})}(jQuery),function(a){"use strict";a.fn.emulateTransitionEnd=function(e){var t=!1,n=this;a(this).one("bsTransitionEnd",function(){t=!0});return setTimeout(function(){t||a(n).trigger(a.support.transition.end)},e),this},a(function(){a.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(e){if(a(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(o){"use strict";var s=function(e,t){this.$element=o(e),this.options=o.extend({},s.DEFAULTS,t),this.$trigger=o('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function i(e){var t,n=e.attr("data-target")||(t=e.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return o(n)}function l(a){return this.each(function(){var e=o(this),t=e.data("bs.collapse"),n=o.extend({},s.DEFAULTS,e.data(),"object"==typeof a&&a);!t&&n.toggle&&/show|hide/.test(a)&&(n.toggle=!1),t||e.data("bs.collapse",t=new s(this,n)),"string"==typeof a&&t[a]()})}s.VERSION="3.3.4",s.TRANSITION_DURATION=350,s.DEFAULTS={toggle:!0},s.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},s.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,t=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(t&&t.length&&(e=t.data("bs.collapse"))&&e.transitioning)){var n=o.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){t&&t.length&&(l.call(t,"hide"),e||t.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var i=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!o.support.transition)return i.call(this);var r=o.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",o.proxy(i,this)).emulateTransitionEnd(s.TRANSITION_DURATION)[a](this.$element[0][r])}}}},s.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=o.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var t=this.dimension();this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!o.support.transition)return n.call(this);this.$element[t](0).one("bsTransitionEnd",o.proxy(n,this)).emulateTransitionEnd(s.TRANSITION_DURATION)}}},s.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},s.prototype.getParent=function(){return o(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(e,t){var n=o(t);this.addAriaAndCollapsedClass(i(n),n)},this)).end()},s.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var e=o.fn.collapse;o.fn.collapse=l,o.fn.collapse.Constructor=s,o.fn.collapse.noConflict=function(){return o.fn.collapse=e,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var t=o(this);t.attr("data-target")||e.preventDefault();var n=i(t),a=n.data("bs.collapse")?"toggle":t.data();l.call(n,a)})}(jQuery),shortcut={all_shortcuts:{},add:function(u,d,c){var e={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1,disable_in_editable:!1};if(c)for(var t in e)void 0===c[t]&&(c[t]=e[t]);else c=e;var n=c.target;"string"==typeof c.target&&(n=document.getElementById(c.target));u=u.toLowerCase();var a=function(e){if(e=e||window.event,c.disable_in_input){if(e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),"INPUT"==t.tagName||"TEXTAREA"==t.tagName)return;if("DIV"==t.tagName&&t.contentEditable)return}if(c.disable_in_editable){var t;if(e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),"DIV"==t.tagName&&t.contentEditable)return;if("TEXTAREA"==t.tagName)return}e.keyCode?code=e.keyCode:e.which&&(code=e.which);var n=String.fromCharCode(code).toLowerCase();188==code&&(n=","),190==code&&(n=".");var a=u.split("+"),i=0,r={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},o={esc:27,escape:27,tab:9,space:32,return:13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,break:19,insert:45,home:36,delete:46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},s={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};e.ctrlKey&&(s.ctrl.pressed=!0),e.shiftKey&&(s.shift.pressed=!0),e.altKey&&(s.alt.pressed=!0),e.metaKey&&(s.meta.pressed=!0);for(var l=0;k=a[l],l<a.length;l++)"ctrl"==k||"control"==k?(i++,s.ctrl.wanted=!0):"shift"==k?(i++,s.shift.wanted=!0):"alt"==k?(i++,s.alt.wanted=!0):"meta"==k?(i++,s.meta.wanted=!0):1<k.length?o[k]==code&&i++:c.keycode?c.keycode==code&&i++:n==k?i++:r[n]&&e.shiftKey&&(n=r[n])==k&&i++;if(i==a.length&&s.ctrl.pressed==s.ctrl.wanted&&s.shift.pressed==s.shift.wanted&&s.alt.pressed==s.alt.wanted&&s.meta.pressed==s.meta.wanted&&(d(e),!c.propagate))return e.cancelBubble=!0,e.returnValue=!1,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1};this.all_shortcuts[u]={callback:a,target:n,event:c.type},n.addEventListener?n.addEventListener(c.type,a,!1):n.attachEvent?n.attachEvent("on"+c.type,a):n["on"+c.type]=a},remove:function(e){e=e.toLowerCase();var t=this.all_shortcuts[e];if(delete this.all_shortcuts[e],t){var n=t.event,a=t.target,i=t.callback;a.detachEvent?a.detachEvent("on"+n,i):a.removeEventListener?a.removeEventListener(n,i,!1):a["on"+n]=!1}}},$.fn.scrollToThis=function(e,t,a){"function"==typeof t&&2==arguments.length&&(a=t,t=e);var i=$.extend({scrollTarget:e,offsetTop:50,duration:200,easing:"linear"},t);return this.each(function(){var e=$(this),t="number"==typeof i.scrollTarget?i.scrollTarget:$(i.scrollTarget),n="number"==typeof t?t:t.offset().top+e.scrollTop()-parseInt(i.offsetTop);e.animate({scrollTop:n},parseInt(i.duration),i.easing,function(){"function"==typeof a&&a.call(this)})})};var translation_en={global:{name:"Name",email:"Email",at:"at",edit:"Edit",empty:"Empty",back:"Back",pref_language:"Language Preference",welcome:"Welcome",to:"to",or:"or",and:"and",from:"from",preview_student:"Preview as Student",exit_preview_as_student:"Exit Student Preview",settings:"Settings",question:"Question",questions:"Questions",duration:"Duration",video:"Video",videos:"Videos",inclass_lecture:"In-class Video",distance_peer_lecture:"Distance-peer Video",customlink:"Link",customlinks:"Links",title:"Title",description:"Description",note:"Note",discussion:"Discussion",discussions:"Discussions",number_of_students:"Number of Students",copy:"Copy",please:"Please",please_wait:"Please Wait",lecture:"@:global.video",lectures:"@:global.videos",courses:"courses",module:"module",overview:"Module Summary",quiz:"Quiz",quizzes:"Quizzes",video_quizzes:"Video Quizzes",video_quiz:"Video Quiz",survey:"Survey",surveys:"Surveys",marker:"Marker",markers:"Markers",answer:"Answer",free_text_question:"Free Text Question",confused:"Confused",really_confused:"Really Confused",search:"Search",new_course:"New course",required:"Required",optional:"Optional",students:"Students",teacher:"teacher",student:"student",done:"Done",correct:"Correct",incorrect:"Incorrect",warning:"Warning",are_you_sure:"Are you sure you want to proceed?",visible:"Visible",leave:"Leave",stay:"Stay",votes:"Votes",no:"No",courses_list:"Courses List",new:"New",copy:"Copy"},mailer:{send_email:"Send An Email",to:"To",send:"Send",subject:"Subject",email_body:"Body"},error_message:{connected:"Connected",cant_connect_to_server:"Cannot connect to server",invalid_email:"Invalid Email",got_some_errors:"Please correct the errors above",required:"@:global.required",invalid_input:"Invalid Input",due_date_changed:"Due Date has been changed.",you_are_not_authorized:"You are not authorized to see requested page",update_account_information:"Please update your account information to use the new version of ScalableLearning.",select_module_first:"Please Select A Module First",change_password_confirmation:"You have successfully changed your password.",confirm_change_email:"You have successfully changed your email.",export_course:"Your anonymized course data will be emailed to you shortly.",export_student:"Your student list will be emailed to you shortly.",export_school_administration:"Statistics will be exported to CSV and sent to your Email.",another_marker:"There is another marker at the same time",remove_your_self:"You were successfully removed from the course",slow:{server:"The server",is_slow:"is taking a long time to load this video",try_reload:"You can continue waiting, or try reloading the page"},welcome_message_updated:"Welcome message updated"},time:{hours:"hours",minutes:"minutes",seconds:"Seconds",weeks:"Weeks",today:"today",day:"day",days:"days",ago:"ago"},tooltip:{list_view:"List View",grid_view:"Grid View"},button:{yes:"Yes",no:"No",next:"Next",submit:"Submit",save:"Save",publish:"Publish",unpublish:"Unpublish",save_close:"Save and Close",close:"Close",delete:"Delete",send:"Send",cancel:"Cancel",show:"Show",save_changes:"Save Changes",remove:"Remove",replay:"Replay",retry:"Retry",reply:"Reply",hide:"Hide",refresh:"Refresh",vote:"Vote",continue:"Continue",no_thanks:"No thanks"},support:{ipad:"iPad support is currently in beta.",mobiles:"Mobile devices are not currently fully supported.",issue_and_recommendation:"Student video support is available for Android 4.4 and higher and iOS 10.3 and higher. We recommend that teachers use a desktop browser for best results.",ie_disclaimer:"Internet Explorer is not fully compatible with the interactive video features used on Scalable Learning. We strongly encourage you to use"},navigation:{logout:"Logout",login:"Login",account_information:"Account Information",courses:"My Courses",notifications:"Notifications",notification:"Notification",dashboard:"Dashboard",settings:"Settings",account:"Account",show_all_courses:"Show all courses",copied_from:"Copied From",description:{settings_description:"Modify your account information/settings"},progress:"Progress",in_class:"In-class",calendar:"Calendar",announcements:"Announcements",calendar_and_announcements:"Calendar and Announcements",content:"Content",information:"Information",course_information:"Course Information",enrolled_students:"Enrolled Students",teachers:"Teachers",lectures:"Lectures",help:"Help",add_students:"Add Students",administration:"Administration",add_teacher:"Add Teacher/TA",student_list:"Student List",join_course:"Join a new course (student)",new_course:"Create a new course (teacher)",review:"Review",welcome_message:"Welcome Message",register:{teacher:"Teacher Registration",student:"Student Registration"},teacher:"For Teachers",student:"For Students",int_video:"New to ScalableLearning? Please watch a short introductory video to help you get started."},content_navigator:{customlink:"@:global.customlink",lecture:"@:global.lecture",inclass_lecture:"@:global.inclass_lecture",quiz:"@:global.quiz",survey:"@:global.survey",empty:"Empty Course",select_module:"Select a Module"},discussion:{private_post:"Private Post",public_post:"Public Post",comment:"Comment",like:"Vote Up",unlike:"Vote Down",write_comment:"Leave a comment...",flag_post:"Flag this post",flag:"Flag",unflag:"Unflag",flagged_post:"Flagged post",flagged_comment:"Flagged comment",unflag_post:"Unflag this post",flags:"Flags",likes:"Likes",remove_flags:"Remove Flag",private_discussion:"Private Discussion (Viewed by teacher only)",public_discussion:"Public Discussion (Viewed by all)",cannot_be_empty:"Cannot be empty",cannot_ask_question_preview:"You cannot ask questions while previewing as a student",q:"Q.",edited:"edited",button:{ask:"Ask",cancel:"@:button.cancel",save:"@:button.save"}},context_menu:{copy:"@:global.copy",paste:"Paste",share:"Share",share_copy:"Share Material"},sharing:{nothing_selected:"Nothing is selected",please_enter_email:"Please enter an Email",teacher_email:"Teacher Email",with_you:"Shared with you",view:"View Shared",manage:"Manage Shared",shared_from:"Data shared from ",shared_by:"shared by,",to_course:"to course",to_module:"to module",copy:"@:global.copy",lecture:"@:global.lecture",items:"items",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",customlink:"@:global.customlink"},footer:{about:"About ",privacy:"Privacy",faq:"FAQ"},feedback:{like_to_comment:"What's your question, comment, or issue?",what_you_think:"What do you need help with?",instructions:"This helps us make sure you get the right answer as fast as possible.",provide_desciption:"Please provide more description",provide_email_name:"Please make sure that you provided your name and email address",thanks:"Thanks for your feedback! We’ll get back to you soon.",leave_feedback:"Share all the details. The more we know, the better we can help you.",course_content:"My Course Contents",system:"The ScalableLearning Website",none:"Please select one...",no_access:"I can't access my account",question_before_sign:"I have a question before I sign up",request_feature:"I want to request a feature",no_email:"I'm not receiving emails",confused:"I'm confused about how something works",bug:"I think something is broken",other:"Other"},enroll_email:{go_to:"(Note: If you have trouble with the above instructions, go to",help_enroll:"Help on Enrollment",instruction:"Students enroll by first registering on the scalable learning website and then entering the Course Enrollment Key. To help your students do this, please send them an email with the following instructions.",dear_student:"Dear Student",this_term_new_system_part_1:"This term in {{course_name}} we will be using ScalableLearning to help make your learning more interactive.  To get started go to ",this_term_new_system_part_2:" and login with your school email.",create_account_with_university:"and create an account with your university email address.",add_course_by_choosing_part_1:" login with your school email, then choose 'Join Course' from the 'Courses' menu and use the Enrollment Key ",add_course_by_choosing_part_2:" to join {{short_name}}. If you have any questions please use the 'Support' form in the 'Help' menu.)",add_course_by_url:" Follow this link ",sincerely:"Sincerely",to_get_started:"To\tget\tstudents\tstarted,\tsend\tthe\tfollowing\temail\tto\tyour\tclass:",if_problem:"if there are problems:",ask_student:"Ask\tthe\tstudent to",check_spam:"check\tSPAM\tfilters",conf_email:"for\tthe\tconfirmation\temail.",enroll_manual:"enroll\tmanually",by_go:"by\tgoing\t to",and_joining:"and\tjoining\t with\tthe enrollment key",contact:"Contact\tsupport",from_help:"from\tthe\tHelp\tmenu.",guest_stu:"Guest\tStudents:",you_may:"You\tmay\tinvite\tothers\tto\tjoin\tyour\t course\tas\tguests\tby\tgoing\t to",guest_may:"Guests\tmay\tsee\tall\tthe\tonline\tmaterial,\tbut\ttheir\tanswers\tand\tquestions\twill\tnot\t be\tvisible\tto\tthe\tteacher.\tGuests\tcan\tenroll\twith\tthe\tlink\tabove\tor\twith\tthe\tguest\tenrollment\tkey"},account:{password:{change_password:"Change my Password",new_password:"New password",forgot_password:"Reset password",send_reset:"Send me Reset Password Instructions",resetting:"Resetting Password",need_password:"We need your current password to confirm your changes",password_confirmation:"Password confirmation",password:"Password",current_password:"Current Password"},confirm_account:"Confirm Account",confirmation_token:"Confirmation Token",resend_confirmation:"Resend confirmation instructions",didnt_receive_confirmation:"Re-send confirmation email",cancel_account:"Delete my account",first_name:"First Name",last_name:"Last Name",screen_name:"Online Name",university:"School or University",saml_disable_edit:"Name, email, and school information provided by UNIVERSITY. If you need to change this information, please contact UNIVERSITY technical support.",first_day:"First day of the week for the calendar",link:"Website",security:"Security",online_name_comment:"Used when you make comments or ask questions. To be anonymous, use the default or a pseudonym.",avatar_comment:"You can change your account image on ",password_comment:"Enter a new password to change your password.",school_email:"School Email",sign_up:"Sign up",sign_in:"Sign in",can_not_use_domain:"You can not register using this domain. To create an account, login through your school provider.",login:"@:navigation.login",join:"Join",remember_me:"Keep me logged in",confirm_destroy:"Are you sure you want to delete your account?",confirm_destroy_note:"Please note that all your data will be deleted from the system and cannot be recovered.",required_marked:"Required fields are marked with *",use_school:"Use your School/University Account",school_not_listed:"If your school is not in this list, you can Login with a ScalableLearning account below",use_scalable:"Use a ScalableLearning Account",login_with:"Login with",other_login:"Other login options",sign_through:"Signing in through",im_student:"I'm a Student",im_teacher:"I'm a Teacher",back:"@:global.back",go_to_support:"If you need help, just go to Support in the Help menu",account_confirmed:"Your account {{email}} has been confirmed.",start_using:" to start using ",invalid_confirmation:"This confirmation link is no longer valid. (It has either expired or already been used.)",click_here:"click here",new_confirmation:"To get a new confirmation link please",already_confirmation:"If you have already confirmed your account,"},lti:{embed:"Embed",lti:"Linking to your School LMS",select:"Select",courses:"@:global.courses",modules:"modules",items:"@:sharing.items",no_account:"You do not have an account on Scalable Learning. To Create an account, click on",contact_teacher:"You are not an instructor in this course on Scalable Learning. Please contact the course owner to add you as a Professor/TA to the course"},events:{due:"Due",deadline_msg:"All deadlines are at midnight on the day specified",done:"@:global.done",done_late:"Done late",not_done:"Not done",not_done_late:"Not done and late",not_done_due:"Not done or due in less than 2 days",completed_on_time:"@:progress.chart.completed_on_time",completed:"Completed",late:"late",due_date_passed:"Due date has passed",drag_due_date_error_part_1:"You cannot move the ",drag_due_date_error_part_2:"'s due date before it's appearance date. To change the appearance date click on the ",drag_due_date_error_part_3:" and choose edit."},notification:{invited:"You have been invited to the course {{course}}, by {{user}}, as a {{role}}",shared:"{{user}} has shared course data with you",accept:"Accept",reject:"Reject",reviewed_inclass:"Would you like the teacher to review this question in class"},privacy:{policy:"Terms and Conditions",terms_intro:"You are deemed to accept and agree to abide by the following Terms and Conditions when you create a user account, log in, and/or use the ScalableLearning service.",privacy_text:"Privacy",information_collect:"What information we collect",information_collect_details:"We collect information on how users use the site, and how they interact with and create educational content. This includes responses to quizzes, lecture videos played, pauses, seeks, questions asked, questions answered, clicks on the confused button, responses to surveys, use of course construction tools, progress visualization, in-class display tools, course content and structure, and general site navigation. We also collect information on how teachers use the site, including use of the course construction tools, progress visualization, in-class display tools, course content and structure, and general site navigation. This information includes the time, type of action, the response, and the account associated with the action.",information_use:"How we use the information",information_use_details:"We use this information to improve ScalableLearning and learn how to improve teaching and learning. For example, student information is used to help teachers understand how their students are learning (quiz answers), where students are having difficulty in their courses (lecture statistics), and what kinds of questions they are having (surveys and questions). The source of anonymous information (anonymous surveys and quizzes) is not shown to teachers on the site to maintain student anonymity. Teacher information is used to help develop better interfaces and identify how we can better provide them with insights into where students need more help.",information_use_details2:"We also use this information both internally and with external partners for research to improve teaching techniques and the tools we provide. All information used for research is pseudonyminized by removing names and email addresses. We require that external partners uphold required privacy and security standards.",confidentiality_and_security:"Confidentiality and security",confidentiality_and_security_details:"We take your privacy and security seriously. We promise to never release your personally identifiable information to a third party without your consent. Your information will be stored and protected according to industry norms.",use_of_cookies:"Use of cookies",use_of_cookies_details:"Cookies are used on this website to remember your login information. While you are logged in, a cookie is used to track your login session. This cookie expires when you close your browser window or sign out. If you select “Remember me” when you login, the cookie will remain for two weeks.",identifiable_information:"Personally identifiable information",identifiable_information_details:"The personally identifiable information for your account consists of the name and email address you provide when you register an account on the site. This information is attached to your actions on the site. You may access, rectify, and delete your account information via the Account Information page on the website. We store the IP address of all accesses to the site in the server logs.",deleting_profile:"Data Retention and Deleting your profile",deleting_profile_details:"Your data is retained for 1 year after your last interaction to enable you to enroll in future classes. After 1 year you will receive an email asking if you wish to retain your data in the system, psuedonyminize it, or delete it. If you do nothing your data will be pseudonyminized such that we are unable to identify your name or email, but you can recover your account with your data using your original email address. You can delete your data at any time by simply deleting your account. Note that it may take a period of time for this information to be deleted from backup systems. Your pseudonyminized usage behavior may be retained for research.",gdpr_compliance:"GDPR Compliance",gdpr_compliance_details_1:"Legal Basis. The legal basis for ScalableLearning’s processing of data is the consent of the teacher and students to use the service. This consent is granted upon registering an account and agreeing to the privacy policy. Users can revoke their consent at any time by deleting their account. Teachers who use this service must have the authority to enroll their students in the service if the students themselves do not have this authority.",gdpr_compliance_details_2:"Data Protection Contact. The data protection officer for ScalableLearning can be reached at info@scalable-learning.com, or by writing to ScalableLearning Data Protection Officer, RISE SICS AB, Box 1263, SE-164 29 Kista, Sweden.",gdpr_compliance_details_3:"Data Processing. The data processing undertaken by ScalableLearning is specified in this privacy document under “How we use the information.”",gdpr_compliance_details_4:"Data Protection and Security. We use industry-standard methods for protecting the security of our data.",gdpr_compliance_details_5:"Right to Correction. To correct data, please file a support request using the help menu.",gdpr_compliance_details_6:"Right to Deletion. To delete your data, please delete your account.",gdpr_compliance_details_7:"Right to Limit Processing. To limit processing of your data, please delete your account.",gdpr_compliance_details_8:"Right to Data Portability. For a portable electronic version of your data, please file a support request using the help menu.",gdpr_compliance_details_9:"Destruction of Data. Data is retained in according “Data retention and Deleting your Profile” above. We maintain a hashed list of accounts to be able to identify completed processing activities.",gdpr_compliance_details_10:"Right to Object. To limit third-party processing of your data, please delete your account. Note that data provided to third parties may be anonymized such that it is not possible to remove particular users’ data from such collections.",gdpr_compliance_details_11:"Incident Reporting. In the event of a data leak, all potentially affected users will be notified within 72 hours of detection of the data leak.",gdpr_compliance_details_12:"Usage Limitations. Data collection and processing is limited to the purposes of helping students and teachers learn, and to develop new teaching techniques and improving the system.",gdpr_compliance_details_13:"Right to Access. Information on the purpose for data collections, types of data collected, what is given out, how long data is retained, and where data comes from are described above and in the Impact Assessment.",acceptable_use_policy:"Acceptable Use Policy",acceptable_use_policy_details_1:"The ScalableLearning Acceptable Use Policy sets out the terms under which you may access the ScalableLearning service (“conditions of use”). This policy applies to all users of the ScalableLearning service.",acceptable_use_policy_details_2:"You are deemed to accept and agree to abide by the Acceptable Use Policy when you create a user account, log in, and/or use the ScalableLearning service.",acceptable_use_policy_details_3:"You shall only use your ScalableLearning account to perform tasks consistent with the goals of the ScalableLearning service (teaching and learning) and in compliance with these conditions of use.",acceptable_use_policy_details_4:"You shall not use your ScalableLearning account for any unlawful purpose.",acceptable_use_policy_details_5:"You shall not attempt to breach or circumvent any administrative or security controls.",acceptable_use_policy_details_6:"You shall respect copyright and confidentiality agreements.",acceptable_use_policy_details_7:"You shall protect your account and any sensitive data and files to which it gives access.",acceptable_use_policy_details_8:"You shall immediately report any known or suspected security breach or misuse of your registration, or the information to which it gives access, to the ScalableLearning Data Protection Contact (see above) and/or the Service Provider (see below).",acceptable_use_policy_details_9:"Use of the ScalableLearning service is at your own risk. There is no guarantee that the service will be available at any time or that it will suit any purpose.",acceptable_use_policy_details_10:"The managers of the ScalableLearning service are entitled to regulate and terminate access to the service and you shall immediately comply with their instructions, subject to separate agreements.",acceptable_use_policy_details_11:"You are liable for the consequences of any violations by you of the Acceptable Use Policy.",other:"Other",legal_entity:"Legal Entity/Service Provider",legal_entity_details:"ScalableLearning is provided by RISE SICS AB, Box 1263, SE-16429 Kista, Sweden.",code_conduct:"GÉANT Data Protection Code of Conduct",code_conduct_details:"This privacy policy complies with the GÉANT Data Protection Code of conduct version 1.0, 14 June 2013.",policy_changes:"Privacy policy changes",policy_changes_details:"The current privacy policy will always be located on this page and we encourage you to visit this page to review changes. Any significant changes in the privacy policy will be sent by email to all active accounts. Changes to the privacy policy take effect when posted here.",policy_agree:"I agree to the ScalableLearning Privacy Policy and I consent to allow ScalableLearning to Process my data.",last_update:"Last update: May-2018",agree:"Agree",cancel:"Cancel"},faq:{faq:"Frequently Asked Questions",question1:"Who is the owner of the data?",answer1:"Course data is owned by the teacher who created the course. Student data is owned by the student. If a student deletes his or her account the activity data from that student becomes anonymous.",question2:"Where is the data stored, and under what legal jurisdiction?",answer2:"The data is stored in a datacenter in Ireland and ScalableLearning operates under the legal jurisdiction of Sweden, with the RISE SICS as the legal entity.",question3:"Is it possible to retrieve or export the data?",answer3:"Teachers can export complete course data.",question4:"Are backups made of the system?",answer4:"Daily backups are made for recovery.",question5:"How are data storage and transportation secured?",answer5:"Transportation and storage are secured using industry-standard encryption, authentication, and physical access protection.",question6:"Is traffic logged?",answer6:"Traffic is logged for 4-10 days and is available to the development team.",question7:"How is the system secured?",answer7:"See"},intro:{title:"Intro Video",teacher_introduction:"This 10-minute video will give you a rapid overview of how to create lectures, add quizzes, and review your students' online performance. You may",teacher_skip_intro:"the introduction if you really want to, and can always find more detailed help in the Help menu.",student_introduction:"This 3-minute video describes how to use",student_introduction_cont:"and how to study effectively in a flipped class. You may",student_skip_intro:"the introduction if you really want to, and can always find more detailed help in the Help menu.",by_using_service:"By using this service you agree to our",redirect_courselist:"Redirecting to your course list in ",skip:"skip",go_to:"Note: If you have trouble with the above instructions, go to"},dashboard:{large_calendar:"Large Calendar",small_calendar:"Small Calendar",export_calendar:"Export Calendar",whats_new:"What's New",as_ical_file:"As File",as_url:"As Link",student_completion:"Student Completion",completion:"Completion",unanswered_questions:"Unanswered",start_inclass:"@:inclass.start_inclass",review_select_inclass_material:"Review & Select In-Class Material",review_quiz:"Review Quiz",my_questions:"My Questions",try_again:"Try again",ontime:"On-time",incomplete:"Incomplete",complete:"Complete",more_than:"More than",less_than:"Less than",not_started:"Not Started",between:"Between",never_tried:"Never tried",solved:"Solved",not_checked:"Not checked",final_try:"final try",first_try:"first try",voted_for_review:"Voted for review",click_for_information:"Click for information",inclass_question:"In-class Question",distance_peer_question:"Distance-peer Question",complete_video:"Please, complete this video",complete_quiz:"Please, complete this quiz",your:"Your",group:"group",individual:"individual",shown_top:" is shown on top.",shown_below:" is shown below.",is_not_checked:" is not checked.",was:" was ",you:"You",tried_once:", you tried once.",tried_more_once:", you tried more than once.",not_first_try:" not on the first try.",on_first_try:" on the first try .",you_solved_group_survey:"You solved group survey.",you_not_answered_quiz:"You did not answer this quiz.",answered_survey:" answered this survey",answered:" answered",answered_but_not_checked:"You have tried this quiz, but your answer has not been checked by the teacher.",answered_but_not_checked_question:"You have tried this question, but your answer has not been checked by the teacher.",answered_but_group:"You have tried this quiz, but your  ",not_checked_group:" has not been checked by the teacher.",tried_not_correct_first:"You have tried this quiz once, but have ",self_not_correct_question:"You have tried this question, but have ",tried_not_correct_first_answer:"not gotten the answer correct",tried_not_correct_last:"You have tried this quiz more than once, but have ",answered_correct_but:"You've got the answer correct, but ",you_answered:"You've got the answer ",click_retry_quiz:"Click to re-try this quiz.",less_one_hour:"due in less than an hour.",correct:"correct",incorrect:"incorrect",answer:"answer",survey:"survey",continue_watching:"Continue watching",watch_again:"Watch again",start_watching:"Start watching"},inclass:{more:"more",pause:"Pause",resume:"Resume",discussion:"@:global.discussion",discussions:"@:global.discussions",quizzes:"@:global.quizzes",surveys:"@:global.surveys",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",primary_marker:"@:global.marker",free_text_question:"@:global.free_text_question",confused:"@:global.confused",really_confused:"@:global.really_confused",video_quizzes:"@:global.video_quizzes",video_quiz:"@:global.video_quiz",hide:"@:button.hide",show:"@:button.show",video_only:"Video Only",zoom_graph:"Zoom Graph",zoom_video:"Zoom Video",show_graph:"Show Graph",exit:"Exit",blackscreen_close:"Click or Press 'b' to return",blackscreen_done:"Review finished. Press ESC to end",start_inclass:"Start In-class Review",review:"In-class Review",time_estimate:"In-class Time Estimate",total_inclass_time:"Total In-Class Time",peer_problem_time:"Peer Problem Time",review_time:"Review Time",time_per_quiz:"Review Time per quiz",time_per_question:"Review Time per question",display_content:"Display In-class Content",choose_module:"Choose a module to display selected materials In-class",change_defaults:"change defaults",intro_stage:"Intro",self_stage:"Self",group_stage:"Group",discussion_stage:"@:global.discussion",session_not_started:"The in-class session has not started",please_try_or_refresh:"Please try again later or click on the 'Refresh' button below",question_not_started:"The in-class question has not started",click_next_question:"Click on 'Next' when the question shows up",multiple_choice:"multiple choice",click_forward_result:"Press forward to view in-class voting results."},distance_peer:{invited:"Invite a student to Join a distance peer session",invited_instruction:"Choose a student ",distance_peer_instruction:"Please call up your partner while you do these questions so you can discuss them in real-time. Remember that for the Individual quizzes you are both supposed to answer on your own, but when you get to the Group part of the quiz you are encouraged to discuss the answers together.",invited_by:"You are invited by",invited_by_instruction:"Click on button of student you want to join ",wait_for_acceptance:"Wait For Acceptance",wait_for_acceptance_instruction:"Wait For acceptance from student or cancel the invitation",waiting_response_of_back_end:"Check if you're invited to join a distance peer session",invite_another_button:"Invite another student to join",video_stage:"Please watch the video.",intro_stage:"Quiz:Intro",self_stage:"Quiz:Self",multiple_choice:"@:inclass.multiple_choice",group_stage:"Quiz:Group",end_video_stage:"Quiz:End",end_peer_instruction:"End Distance Peer Instruction",in_distance_peer:"You are participating in a distance peer instruction lesson with {{name}}.",the_another_student_finished_status:"{{name}} finished {{status}}, you can resume",waiting_the_another_student_to_finish:"Waiting {{name}} to finish {{status}}",click_on_button_below_to_end_session:"Click on button below to end distance peer session",the_another_student_finished_message_video:"Please watch the video to get to the peer instruction questions.",the_another_student_finished_message_quiz_intro:"Press play to watch the introduction to the question.",the_another_student_finished_message_quiz_self:"Please choose your individual answer. (Do not discuss your answer with your partner.)",the_another_student_finished_message_quiz_group:"Please discuss your answer with your partner and choose your final answer. (You do not have to choose the same answers.)",the_another_student_finished_message_quiz_end:"Please watch the teacher's explanation of the answer.",waiting_message_quiz_intro_after_video:"Waiting for your partner to finish watching the video.",waiting_message_quiz_self_after_intro:"Waiting for your partner to finish watching the introduction.",waiting_message_quiz_group_after_self:"Waiting for your partner to choose his or her individual answer. (Do not discuss your answer with your partner.)",waiting_message_quiz_end_after_group:"Waiting for your partner to choose his or her answer after the discussion.",waiting_message_video_after_quiz_end:"Waiting for your partner to finish watching the teacher's explanation.",prevent_seek_forward:"Please do not skip ahead of your partner.",can_not_leave_this_status:"{{name}} did not finish this status, you can not go to the next status",other_student_ended_session:"{{name}} ended the distance peer session ",student_cancelled:"{{name}} cancelled the invitation"},editor:{explanation:"Explanation",quiz_question:"Quiz Question",quiz_time:"Quiz Time",marker_time:"Marker Time",note_time:"Note Time",note_duration:"Note Duration",note_as_slide:"Fullscreen Note",note_as_slide_description:" (This note will pause the video until the student clicks Continue.)",note_as_slide_empty_description:"Put in your text below in the Annotations box.",start_time:"Start Time",end_time:"End Time",intro_timer:"Intro Timer",self_timer:"Self Timer",group_timer:"Group Timer",discussion_timer:"Discussion Timer",preview_inclass:"Preview in-class",incorrect_format_time:"Incorrect Format for Time",cannot_delete_alteast_one_answer:"Cannot delete, there must be alteast one answer",time_outside_range:"Time Outside Video Range",start_time_bigger_than_end_time:"End time must be after start time",header:"Header",answer:"@:global.answer",inclass_student_note:"Why did you choose that answer? (For your own notes.)",type:"Type",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",note:"@:global.note",course_editor:"Course Editor",link_editor:"Link Editor",video_editor:"Video Editor",correct:"@:global.correct",incorrect:"@:global.incorrect",quiz_editor:"Quiz Editor",survey_editor:"Survey Editor",module_editor:"Module Editor",title:"@:global.title",annotation:"Annotation",tooltip:{invisible:"Not currently visible to students.",visible_quiz:"Published: visible to students.",invisible_quiz:"Unpublished: not visible to students.",invisible_cont:"Will be visible",students_must_complete_inorder:"Students must complete this item before going on to the next item in the module",students_must_complete_required:"All required items must be completed on-time for the student to receive credit for the module",students_can_not_skep_ahead:"@:editor.details.skip_ahead_description",click_to_delete:"Click here to delete, click outside to close",create_link_time:"Create a link to this time in the video",video_info:"Only YouTube URLs and MP4 H.264 encoded videos are allowed",click_add_question:"Click or type 'i' to add a question",click_add_marker:"Click or type 'm' to add a marker",click_add_note:"Click or type 'n' to add a note. Press 'shift-n' to add a note and continue playing.",quiz_publish_status:"Module not visible to students. Please make sure module is visible before publishing"},drag:{start:"Start",end:"End",instruction:"Enter the name for draggable item and position its Start and End locations on the screen.",correct:"This item is correct here because",incorrect:"Item {{num}} would be incorrect here because"},messages:{random_answers:"The answers below will be presented to the student in random order",provide_answer:"Please provide the answer text for each choice",quiz_no_answer:"Quiz doesn't have a correct answer",enter_url:"Enter the video Title and URL",enter_url_continue:"in the Details on the right.",for_help:"For help uploading videos",for_help_continue:"See 'Getting Started' in the Help menu",double_click_new_answer:"Double-click on the video to add a new answer.",drag_to_reorder:"Drag to reorder"},home:{choose_module:"Choose a module to the left view and edit its contents.",drag_module:"Drag modules around to re-order them.",create_module:"Create modules to organize your course contents.",choose_add:" Add videos, quizzes, surveys, and links.",preview_see:"Preview as Student to see how your content will appear to students",right_click:"Right-click on an item to Copy, Paste, or Share it with other teachers."},regex:{enter_string:"Enter the string to match or a regular expression",correct_if:"will only be correct if the student enters",correct_for:"will be correct for",any_integer:"any integer number between 0 and 9",numbers:"the numbers 10, 14 and 29"},details:{duration:"@:global.duration",details:"Details",video:"@:global.video",video_type:"Video Type",add_video:"Add link to video",add_description:"Add description",title:"@:global.title",description:"@:global.description",instructions:"Instructions",set_date:"Set Date",use_module:"Use Module’s Visibility",use_module_due:"Use Module’s Due Date",use_module_in_order:"Use Module’s Order",use_module_required:"Use Module’s Required",use_module_skip_ahead:"Use Module’s Skip Ahead",vidoe_not_exist:"Video may not exist or may still be uploading",incompatible_video_link:"Invalid movie type. Please provide a valid YouTube, .mp4 or a MediaSite URL.",student_link_lecture:"Student link to lecture",appearance_date:"Appearance Date",due_date:"Due Date",quizzes:"@:global.quizzes",markers:"Markers",note:"Notes",student_link_module:"Student link to module",has_due_date:"has due date",required:"@:global.required",skip_ahead:"Skip Ahead",in_order:"In Order",retries:"Retries",display_text:"Display question over video",display_text_explain:"(Use if the question text is not in the video.)",student_link_quiz:"Student link to quiz",skip_ahead_description:"Allow students to skip ahead in video",graded:"Graded",quiz_pass_fail:"This quiz is pass/fail",show_explanation:"Show explanation after each try",correct_to_pass:" correct required to pass",pass:"Pass",fail:"Fail"},popover:{shown_in_graph:"Shown on results graph",shown_to_student:"Shown to students"},button:{add_video_quiz:"Add Video Quiz Here",add_marker:"Add Marker",show_all_quizzes:"Show All Quizzes",add_content:"Add Content",add_answer:"Add Answer",add_question:"Add Question",add_header:"Add Header",add_module:"Add Module",preview_student:"@:global.preview_student",add_note:"Add Note"}},lectures:{messages:{thank_you_answer:"Thank you for your answer",press_to_continue:"Press play to continue.",did_not_get_credit:"You did not get credit for this video. To get credit for a required video you need to watch the whole thing (no skipping) and answer each question (you don't have to get them right, though).",please_choose_one_answer:"Please choose at least one answer",please_choose_an_answer:"Please choose your answer(s).",finish_before_proceeding:"Please finish previous required lectures before proceeding",really_confused_use_question:"You could ask a question so the teacher can help you.",navigate_away:"Are you sure you want to navigate away from this page?",change_lost:"Your changes will be lost!"},timeline:{timeline:"Timeline",slides:"Slides",description:"@:global.description",question:"@:global.question",confused:"@:global.confused",really_confused:"@:global.really_confused",note:"@:global.note",quiz:"@:global.quiz",marker:"@:global.marker",watched:"Watched",quizzes:"quizzes",required_quizzes:"required quizzes",export_chart:"Export Data"},button:{ask_question:"Ask a Question",new_note:"New Note",im_confused:"I'm Confused",exit_fullscreen:"Exit Fullscreen",fullscreen:"Fullscreen",check_answer:"Check Answer",start_distance_peer:"Start Distance Peer Instruction",submit:"@:button.submit",submit_my_vote:"Submit my vote"},tooltip:{unsolved_quiz:"You have to complete the quiz as part of the video before you can jump to it",click_or_type_note:"Click or type N to add a note",click_or_type_question:"Click or type Q to ask a question",click_or_type_confused:"Click or type C to say confused",click_or_type_fullscreen:"Click or type F to enter fullscreen",click_or_type_smallscreen:"Click or type F to enter smallscreen",video_shortcut:"press J to rewind 10s or K for play/pause or L for fast forward 10s"},correct:"@:global.correct",incorrect:"@:global.incorrect",confused:"@:global.confused",really_confused:"@:global.really_confused",hover_for_explanation:"Hover for explanation",tap_for_explanation:"Tap for explanation",multiple_correct:"There may be multiple correct answers",other_correct_answers:"There may be other correct answers as well",must_place_items:"You must place all items",answer_question:"Please answer the question",choose_correct_answer:"Please choose the correct answer(s)",answer:"@:global.answer",choices:"Choices",optional:"@:global.optional"},progress:{title:"@:global.title",discussion:"@:global.discussion",free_text_question:"@:global.free_text_question",related:"Related",of_student_review:"voted for review",questions:"@:global.questions",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",out_of:"Out Of",number_of_students:"@:global.number_of_students",confused:"@:global.confused",really_confused:"@:global.really_confused",back:"@:global.back",pauses:"Pauses",finished_on_time:"Finished on Time",finished_not_on_time:"Finished Not on Time",not_finished:"Not Finished",not_started:"Not started",grade:"Grade",course_graph_desc:"Lecture and quiz completion percentages for all students",based_on_invideo:"Based on in-video questions answered",button:{hide:"@:button.hide",make_visible:"Make Survey Visible to Students",see_all:"See All",export_chart:"Export Chart",show_in_class:"Show in class",reply:"@:button.reply",send_reply:"Post reply and send message to student"},tooltip:{see_related:"See related answers to student",quizzes_solved:"quizzes required solved",quizzes_optional_solved:"optional quizzes solved",watched_video:"Watched",correct:"@:global.correct",question_not_checked:"@:dashboard.not_checked",completed:"@:events.completed",confused:'Shows the number of students who clicked the "confused" button at that time in the video. If a student clicked the button more than once in the same place, it is shown in red',back:"Shows the number of students who went back in the video from that time in the video",pauses:"Shows the number of students who paused at that time in the video",questions:"Shows the number of students who asked questions at that time in the video"},popover:{change_status:"Change Status",original:"Original",on_time:"On Time",not_done:"Not Done"},shortcuts:{go_next_item:"Go to next item",go_previous_item:"Go to previous item",go_inside_item:"Go inside an item",go_outside_item:"Go outside an item",seek_to_location:"Seek to location",resize_video:"Resize video",mark:"Mark",reply:"@:button.reply"},chart:{not_started_watching:"Not Started Watching",watched:"Watched",completed_on_time:"Completed on Time",completed_late:"Completed Late",module_progress_charts_quizzes:"Module Progress Charts - Based on invideo quizzes",module_progress:"Module Progress",answered:"Answered"},home:{module_completion:"Module Completion",review_module:"Review Module",module_review:"Module Review",module_timeline:"Module Timeline",review_course:"Review Course",course_completion:"Course Completion",course_graph:"Course Graph",view_respond_students:"View and respond to students’ quizzes and questions, and choose material for in-class.",view_interaction:"View student interactions across a module.",view_module_completed:"View which students have completed each video in a module on-time or late.",view_course_completed:"View which students have completed each module on-time or late.",view_course_graph:"View a percentage graph of overall lectures and quizzes completion."}},quizzes:{used_up_all:"Used up all",attempts:" attempts",attempt_number:"Attempt number",must_choose_answer:"Must choose at least one answer",optional:"@:global.optional",already_submitted:"You've submitted the",no_more_attempts:"and have no more attempts left",graded_quiz:"Graded quiz",correct_required_to_pass:"correct answers required to pass.",grade:{under_review:"Under Review",partial:"Partial",correct:"@:global.correct",incorrect:"@:global.incorrect"}},enrollment:{enter_enrollment:"Please Enter Enrollment Key",get_enrollment_key:"Please contact your instructor if you didn't receive it.",enrollement_key_format:"You should receive an enrollement key of the form",enroll:"Enroll"},enrolled_students:{name:"@:global.name",email:"@:global.email",remove_student:"Remove students",enrolled_students:"@:navigation.enrolled_students",help_enroll_student:"Help on enrolling students",select_all:"Select All",deselect_all:"Deselect All",done:"@:global.done",export_as:"Export Student List"},groups:{module:"Module",groups:"Groups",statistics:{videos:"@:global.videos",customlinks:"@:global.customlinks",quizzes:"@:global.quizzes",surveys:"@:global.surveys",video_quizzes:"@:global.video_quizzes",questions:"@:global.questions"},delete_popup:{warning:"@:global.warning",delete_module:"Deleting the module",will_delete:"will delete all items inside it.",are_you_sure:"@:global.are_you_sure"}},courses:{information:{adding_teacher:"A teacher or TA must have a teacher account on",create_account:"To create a teacher account visit",go_to_course:"Go to Course",edit_course:"Edit Course",description:"@:global.description",done:"@:global.done",professor:"Professor",prof:"@:courses.information.professor",ta:"TA",discussion_forum_link:"Discussion Forum Link",enrollment_key:"Enrollment Key",enrollment_url:"Enrollment URL",course_link:"Course Link",taught_by:"Taught by",taught_by_small_cap:"taught by",receive_student_ask_email:"Receive email when a student asks a question",receive_due_dates_email_question:"Would you like to receive email reminders about your course deadlines?",receive_due_date_email:"Receive email reminders of upcoming due dates.",receive_student_ask_email_question:"Would you like to receive an email whenever a student asks a question with a link to reply?",change_email_question:"(You can change this at any time on the Course Information page.)",button:{add_teacher:"Add Teacher",remove_teacher:"Remove Teacher",export_as:"Export anonymized course data",invite:"Invite to Join",send_email_reminder:"Send email reminders"},tooltip:{click_to_copy:"Click to Copy"}},list:{finished:"Finished",all_finished:"@:courses.list.finished",all:"All",current:"Current",duration:"@:global.duration",lectures:"@:global.lectures",quizzes:"@:global.quizzes",surveys:"@:global.surveys",number_of_students:"@:global.number_of_students",importing_data:"Importing Data",button:{new_course:"@:global.new_course",back:"@:global.back",sort_by:"Sort By"},messages:{no_courses:"Currently, you don't have any courses you can access. You can start by adding one.",enroll_instruction:"To enroll in a course choose 'Join a new course' from the Courses menu and enter the Enrollment Key from your instructor.",create_enroll_instruction:"To create or enroll in a course choose 'New course' or 'Join a new course' from the My Courses menu and enter the Enrollment Key from your instructor.",enroll_instruction:"To enroll in a new course, choose 'Join a new course' from the My Courses menu and enter the Enrollment Key from your instructor.",create_instruction:"To create a new course, choose 'Create a new course' from the My Courses menu."},tooltip:{unenroll:"Unenroll"},delete_popup:{warning:"@:global.warning",delete_course:"Deleting the course",will_delete:"will delete",all_modules:"All modules",all_items:"All items inside each modules",all_progress:"All students progress",are_you_sure:"Are you sure you want to proceed?",cannot_undo:"This cannot be undone!"}},new:{button:{create_course:"Create Course",unselect:"Unselect"},copy_from_existing:"Copy Data from Existing Course",copy_from_existing_title:"Copy Data",ask_copy_from_existing:"Would you like to create a new empty course or copy material from an existing course?",ask_choose_from_existing:"Please choose one of your existing courses to copy content from",course_item_shift:"Course items will be shifted according to the course start date."},start_date:"Start Date",end_date:"End Date",disable_registration:"Disable Registration After",limit_registration_domain:"Registrable Schools",limit_registration_domain_description:"Allow only students from specific school domains to register",limit_registration_all_students:"Allow any student to register",duration:"Course Duration (weeks)",prerequisites:"Prerequisites",course_image_url:"Course Image URL",short_name:"Short Name",time_zone:"Course Timezone",course_code:"Course Code",course_name:"Course Name",university_note:"University Note"},statistics:{statistics:"Statistics",administration:"Administration",statistics_dashboard:"Statistics Dashboard",registration:"Registration",report_period:"Report Period",generate_report:"Generate Report",login:"@:navigation.login",lecture_views:"Lecture Views",questions_asked:"Questions Asked",confused:"@:global.confused",courses_created:"Courses Created",lectures_created:"Lectures Created",video_quizzes_created:"Video Quizzes Created",normal_quizzes_created:"Normal Quizzes Created",surveys_created:"Surveys Created",video_quizzes_solved:"Video Quizzes Solved",normal_quizzes_solved:"Normal Quizzes Solved",surveys_solved:"Surveys Solved",total_courses:"Total Courses",total_students:"Total Students",total_teachers:"Total Teachers",total_lectures:"Total Lectures",total_quizzes:"Total Quizzes",total_surveys:"Total Surveys",total_questions_asked:"Total Questions Asked",total_confused:"Total Confused",rate_from:"rate from",to:"to",drag_to_zoom:"Click and drag in the plot area to zoom in",pinch_to_zoom:"Pinch the chart to zoom in",write_welcome_message:"Write welcome message"},player:{click_video_quality:"Click to change video quality",quality:"Quality",speed:"Speed"},announcements:{create_announcement:"New Announcement",empty:"No announcements yet.",post:"Post announcements to the class here"},help:{getting_started:{getting_started:"Getting Started",student:"for Students",teacher:"for Teachers"},support:"Support",teacher_forum:"Teacher Forum",instruction_manual:"Instruction Manual",tips:"Tips",how_to_flip:"How to Flip your Class",privacy_faq:"Privacy & FAQ"},course_settings:{show_notes:"Show Notes",show_quizzes:"Show Quizzes",show_surveys:"Show Surveys",show_confused:"Show Confused",show_markers:"Show Markers",show_charts:"Show Charts",show_discussion:"Show Discussion",show_lecture_quizzes:"Show Lecture Quizzes",print:"Print",download_notes:"Download Notes"},content:{add_new_content:"Add New Content",types:{customlink:"@:global.customlink",video:"@:global.video",inclass_video:"@:global.inclass_lecture",distance_peer_video:"@:global.distance_peer_lecture",video_desc:"You can add quiz questions on top of the video.",quiz:"@:global.quiz",survey:"@:global.survey",link_desc:"Web link to other sites or pages.",quiz_or_survey:"Quiz or Survey",quiz_or_survey_desc:"Text-based, not part of a video. Can be graded or optional."},questions:{insert_video_question:"Insert a Video Question",categories:{on_video:{title:"On-video Quiz",desc:"Place quiz choices on top of the video. Use this if the answers are visible in the video."},text_quiz:{title:"Text Quiz",desc:"Text quiz on a white background. Use this if the quiz answers are not visible in the video."},on_video_survey:{title:"On-video Survey",desc:"Surveys have no correct answer. Use this if the survey choices are visible in the video."},text_survey:{title:"Text Survey",desc:"Text Surveys have no correct answer on a white background. Use this if the survey choices are not visible in the video."}},types:{ocq:"One answer",mcq:"Multiple answers",drag:"Drag and drop",text:"Free text answer"},quiz_types:{mcq:"Multiple Choice (multiple correct answers)",ocq:"Multiple Choice (one correct answer)",drag:"Drag-and-Drop (ordering)",text:"Free Answer (text answer)",free_text:"Free Text",match_text:"Match Text"},survey_types:{mcq:"Multiple Choice (multiple selections)",ocq:"Multiple Choice (one selection)"}}},languages:{languages:"Languages",en:"English",sv:"Svenska"},welcome_messages:{description:"Enter the text to display to users from the {{domain}} domain when they log in. This text will be displayed at the top of the 'Create Course' page."}},full_calendar_en={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{today:"Today",month:"Month",week:"Week",day:"Day"}},translation_sv={global:{name:"Namn",email:"E-post-adress",at:"vid",edit:"Redigera",empty:"Fältet är tomt",back:"Tillbaka",pref_language:"Språkinställning",welcome:"Välkommen",to:"till",or:"eller",and:"och",from:"från",preview_student:"Förhandsvisa som student",exit_preview_as_student:"Gå ur förhandsvisning som student",settings:"Inställningar",question:"Fråga",questions:"frågor",duration:"Längd",video:"Video",videos:"Videos",inclass_lecture:"I klassrummet video",distance_peer_lecture:"Distance-peer video",customlink:"Länk",customlinks:"Länkar",title:"Titel",description:"Beskrivning",note:"Anteckning",discussion:"Diskussion",discussions:"Diskussioner",number_of_students:"Antal studenter",copy:"Kopia",please:"Var god",please_wait:"Var god vänta",lecture:"@:global.video",lectures:"@:global.videos",courses:"kurser",module:"modul",overview:"Modul Sammanfattning",quiz:"Quiz",quizzes:"Quiz-frågor",video_quizzes:"Video-quiz-frågor",video_quiz:"Video-quiz",survey:"Enkät",surveys:"Enkäter",marker:"Markering",markers:"Markeringar",answer:"Svar",free_text_question:"Fritext-fråga",confused:"Förvirrad",really_confused:"Verkligen förvirrad",search:"Sök",new_course:"Skapa ny kurs",required:"Nödvändig",optional:"Valfri",students:"Studenter",teacher:"lärare",student:"student",done:"Klart",correct:"Korrekt",incorrect:"Felaktig",warning:"Varning",are_you_sure:"Är du säker på att du vill fortsätta?",visible:"Synlig",leave:"Lämna",stay:"Stanna",votes:"Röster",no:"Nej",courses_list:"kurser List"},mailer:{send_email:"Skicka ett mail",to:"Till",send:"Skicka",subject:"Ämne",email_body:"Textyta"},error_message:{connected:"Ansluten",cant_connect_to_server:"Kan inte ansluta till servern",invalid_email:"Ogiltig e-post-adress",got_some_errors:"Rätta till felen ovan",required:"@:global.required",invalid_input:"Ogiltiga indata",due_date_changed:"Färdigdatum har ändrats.",you_are_not_authorized:"Du har inte behörighet att visa den begärda sidan",update_account_information:"Vänligen uppdatera din kontoinformation för att använda den nya versionen av Scalable Learning.",select_module_first:"Välj först en modul i menyn.",change_password_confirmation:"Du har nu ändrat ditt lösenord.",confirm_change_email:"Du har nu ändrat ditt E-post-adress.",export_course:"Dina anonymiserade kursdata kommer strax att skickas dig via email",export_student:"Listan över dina studenter kommer strax att skickas dig via email",export_school_administration:"Statistiken kommer strax att skickas dig via email",another_marker:"Det finns en annan markör vid samma tid",remove_your_self:"Du har framgångsrikt tagits bort från kursen",slow:{server:"Videoservern",is_slow:" tar lång tid på sig för att visa den här videon",try_reload:"Du kan fortsätta vänta eller prova att uppdatera sidan"},welcome_message_updated:"Välkommen Meddelande uppdaterad"},time:{hours:"timmar",minutes:"minuter",seconds:"Sekunder",weeks:"Veckor",today:"Idag",day:"dag",days:"dagar",ago:"sedan"},tooltip:{list_view:"Listvy",grid_view:"Rutnätsvy"},button:{yes:"Ja",no:"Nej",next:"Nästa",submit:"Skicka in",save:"Spara",publish:"Publicera",unpublish:"Opublicera",save_close:"Spara och stäng",close:"Stäng",delete:"Radera",send:"Skicka",cancel:"Avbryt",show:"Visa",save_changes:"Spara ändringar",remove:"Ta bort",replay:"Spela igen",retry:"Försök igen",reply:"Svara",hide:"Göm",refresh:"Uppdatera skärmen",vote:"Rösta",continue:"Fortsätt",no_thanks:"Nej tack"},support:{ipad:"Stöd för iPad är för närvarande i beta.",mobiles:"Mobila enheter har för närvarande inte fullständigt stöd.",issue_and_recommendation:"Studentvideostöd är tillgängligt för Android 4.4 och senare och iOS 10.3 och senare. Vi rekommenderar att lärare använder en skrivbords-webbläsare för bästa resultat.",ie_disclaimer:"Internet Explorer stöder inte alla interaktiva videofunktioner som används av Scalable Learning. Vi rekommenderar att du använder"},navigation:{logout:"Logga ut",login:"Inloggning",account_information:"Kontoinformation",courses:"Mina kurser",notifications:"Meddelanden",notification:"Meddelande",dashboard:"Instrumentpanel",settings:"Inställningar",account:"Konto",show_all_courses:"Visa mina kurser",copied_from:"Kopierad från",description:{settings_description:"Ändra dina kontoinställningar"},progress:"Framsteg",in_class:"I klassrummet",calendar:"Kalender",announcements:"Meddelanden",calendar_and_announcements:"Kalender och meddelanden",content:"Kursinnehåll",information:"Information",course_information:"Kursinformation",enrolled_students:"Inskrivna studenter",teachers:"Lärare",lectures:"Videos",help:"Hjälp",add_students:"Lägg till studenter",administration:"Administrera",add_teacher:"Lägg till lärare/assistent",student_list:"Lista av studenter",join_course:"Delta i en ny kurs (elev)",new_course:"Skapa en ny kurs (lärare)",review:"Bedöm",welcome_message:"Välkommen Meddelande",register:{teacher:"Lärare, registrering",student:"Student, registrering"},teacher:"För lärare",student:"För elever",int_video:"Ny på ScalableLearning? Prova att se en kort introduktions-video för att komma igång fortare."},content_navigator:{customlink:"@:global.customlink",lecture:"@:global.lecture",inclass_lecture:"@:global.inclass_lecture",quiz:"@:global.quiz",survey:"@:global.survey",empty:"Kursen saknar innehåll",select_module:"Välj en modul"},discussion:{private_post:"Privat inlägg",public_post:"Öppet inlägg",comment:"Kommentera",like:"Rösta för",unlike:"Rösta emot",write_comment:"Lämna en kommentar...",flag_post:"Flagga detta inlägg",flag:"Flagga",unflag:"Av-flagga",flagged_post:"Flaggade inlägget",flagged_comment:"Flaggade kommentaren",unflag_post:"Av-flagga detta inlägg",flags:"Flaggor",likes:"Gillar",remove_flags:"Ta bort flaggor",private_discussion:"Privat diskussion (ses endast av läraren)",public_discussion:"Öppen diskussion (ses av alla)",cannot_be_empty:"kan inte vara tomt",cannot_ask_question_preview:"Du kan inte ställa frågor medan du förhandsgranskar som student",q:"F.",edited:"redigerad",button:{ask:"Fråga",cancel:"@:button.cancel",save:"@:button.save"}},context_menu:{copy:"@:global.copy",paste:"Klistra in",share:"Dela",share_copy:"Dela markerat objekt"},sharing:{nothing_selected:"Inget är valt",please_enter_email:"Ange en e-post-adress",teacher_email:"Lärarens e-post-adress",with_you:"Delat med dig",view:"Visa delat",manage:"Hantera delat",shared_from:"Data delas av ",shared_by:"delas med,",to_course:"till kurs",to_module:"till modul",copy:"@:global.copy",lecture:"@:global.lecture",items:"objekt",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",customlink:"@:global.customlink"},footer:{about:"Om ",privacy:"Sekretesspolicy",faq:"Vanliga frågor"},feedback:{like_to_comment:"Vad är din fråga, kommentar, eller problem?",what_you_think:"Vad behöver du hjälp med?",instructions:"Detta för att hjälpa oss att ge ett så korrekt svar så fort som möjligt.",provide_desciption:"Hjälp oss med en beskrivning av ditt problem!",provide_email_name:"Lämna ditt namn och e-post så att vi kan återkomma till dig!",thanks:"Tack för din kommentar! Vi återkommer till dig snart.",leave_feedback:"Ge oss alla detaljer. Ju mer vi vet, dess då lättare och bättre kan vi hjälpa dig.",course_content:"Mitt kursinnehåll",system:"Scalable Learnings webbplats",none:"Var god välj en...",no_access:"Jag får inte access till mitt konto",question_before_sign:"Innan jag registrerar mig har jag en fråga",request_feature:"Jag skulle vilja föreslå ny funktionalitet",no_email:"Jag får ingen email",confused:"Jag är förvirrad och förstår inte hur det hänger ihop",bug:"Jag tror att något inte fungerar som det ska",other:"Annat"},enroll_email:{go_to:"(Om du inte förstår instruktionerna ovan, gå till",help_enroll:"Hjälp med registrering",instruction:"Studenter anmäler sig genom att först registrera sig på Scalable Learnings webbplats och sedan mata in kursnyckeln. För att hjälpa eleverna med detta, skicka ett e-postmeddelande med följande instruktioner.",dear_student:"Hej!",this_term_new_system_part_1:"I denna termins upplaga av  {{course_name}} kommer vi att använda oss utav ScalableLearning för att kunna erbjuda en mer interaktiv inlärning.  För att komma igång gå till ",this_term_new_system_part_2:" och logga in med ditt skolmail.",create_account_with_university_:"och skapa ett konto med din e-postadress från din skola/universitet.",add_course_by_choosing_part_1:" logga in med ditt skol-email, och välj sedan 'Delta i en ny kurs' under menyn 'Mina kurser' och ange kursnyckel",add_course_by_choosing_part_2:" för att delta i {{short_name}}. Om du har några frågor, var god använd 'Support' formuläret under menyn 'Hjälp'.",add_course_by_url:" Följ denna länk",sincerely:"Vänliga hälsningar",to_get_started:"För\tatt\tfå\tigång\tera\televerna,\tskicka\tföljande\temail\ttill\ter\tklass:",if_problem:"om det uppstår problem:",ask_student:"Be\televen\tatt",check_spam:"kontrollera\tSPAM\tfiltren",conf_email:"för\tkonfirmations-mail.",enroll_manual:"registrera\tmanuellt",by_go:"genom\tatt\t gå\t till",and_joining:"och\tgå\t med\t genom\t att\t använda\tregistrerings-nyckeln",contact:"Kontakta\tsupport",from_help:"från\tHjälp-menyn.",guest_stu:"Gäststudent:",you_may:"Du \tkan\tinvitera\tandra\tatt\tgå\tmed\tdin\t kurs\tsom\tgäster\tgenom\tatt\t gå\ttill",guest_may:"Gäster\tkan\tse\tallt\tonline\tmaterial,\tmen\tderas\tsvar\toch\tfrågot\tkommer\tinte\t att\tsynas\tför\tläraren.\tGäster\tkan\tregistrera\tsig\tvia\tlänken\tovan\teller\tmed\ten\tregistrerings-nyckel\tför\tgäster"},account:{password:{change_password:"Ändra mitt lösenord",new_password:"Nytt lösenord",forgot_password:"Återställ lösenord",send_reset:"Skicka mig instruktioner för att återställa lösenordet",resetting:"Återställer lösenord",need_password:"Vi behöver ditt nuvarande lösenord för att bekräfta dina ändringar.",password_confirmation:"Bekräfta lösenord",password:"Lösenord",current_password:"Nuvarande lösenord"},confirm_account:"Bekräfta Konto",confirmation_token:"Bekräftelsekod",resend_confirmation:"Skicka bekräftelse och instruktioner igen",didnt_receive_confirmation:"Skicka e-postbekräftelsen igen",cancel_account:"Ta bort mitt konto",first_name:"Förnamn",last_name:"Efternamn",screen_name:"Ditt online-namn",university:"Skola eller universitet",saml_disable_edit:"Namn, email och information tillhandahållen av högskolan/universitet. Om du behöver ändra något i denna info var vänlig ta kontakt med högskolans/universitetets tekniska support.",first_day:"Första dagen i veckan för kalendern",link:"Hemsida",security:"Säkerhet",avatar_comment:"Du kan byta din avatar på ",online_name_comment:"(Ditt online-namn visas för andra elever och lärare när du skriver kommentarer eller ställer frågor. Du kan ändra det till vad du vill.)",password_comment:"Skriv in ett nytt lösenord som ersätter ditt gamla.",school_email:"E-post-adress",sign_up:"Registrera dig",sign_in:"Logga in",can_not_use_domain:"Du kan inte registrera sig med den här domänen. För att skapa ett konto, logga in via din skola.",login:"@:navigation.login",join:"Registrera",remember_me:"Förbli inloggad",confirm_destroy:"Är det riktigt att du vill ta bort ditt konto?",confirm_destroy_note:"Observera att alla data kommer att tas bort från systemet och kan inte återställas.",required_marked:"Obligatoriska fält är markerade med *",use_school:"Använd kontot på din skola/universitet",school_not_listed:"Om din skola inte finns med på listan, så kan du logga in med ett konto på ScalableLearning nedan",use_scalable:"Använd ett konto på ScalableLearning",login_with:"Logga in med",other_login:"Andra inloggnings-alternativ",sign_through:"Logga in via",im_student:"Jag är student",im_teacher:"Jag är lärare",back:"@:global.back",go_to_support:"Om du behöver hjälp, gå till Support under Hjälp-menyn",account_confirmed:"Ditt konto {{email}} har konfirmerats.",start_using:"att börja använda",invalid_confirmation:"Bekräftelselänken är inte längre giltigt. (Det har antingen gått ut eller har redan använts.)",click_here:"Klicka här",new_confirmation:"För att få en ny bekräftelse länk vänligen",already_confirmation:"Om du redan har bekräftat ditt konto,"},lti:{embed:"Bädda in",lti:"Länkas till din skolas LMS",select:"Välj",courses:"@:global.courses",modules:"moduler",items:"@:sharing.items",no_account:"Du har inget konto på Scalable Learning. För att skapa ett konto, klicka på",contact_teacher:"Du är inte lärare/assistent på denna kurs hos Scalable Learning. Vänligen kontakta kursens ägare för att lägga till dig som lärare/assistent på kursen"},events:{due:"Förfaller",deadline_msg:"Alla deadlines är vid midnatt den angivna dagen.",done:"@:global.done",done_late:"Klart sent",not_done:"Inte klart",not_done_late:"Inte klart och sen",not_done_due:"Inte klart eller skall vara färdigt inom 2 dagar",completed_on_time:"@:progress.chart.completed_on_time",complete:"Klart",late:"sen",due_date_passed:"Färdigdatum har passerats",drag_due_date_error_part_1:"Du kan inte flytta ",drag_due_date_error_part_2:"färdigdatum före dess publiceringsdatum. För att ändra publiceringsdatum, klicka på ",drag_due_date_error_part_3:" och välj redigera."},notification:{invited:"Du har blivit inbjuden till kursen {{course}} av {{user}} som {{role}}",shared:"{{user}} har delat sina kursuppgifter med dig",accept:"Acceptera",reject:"Avböj",reviewed_inclass:"Vill du att läraren skall gå igenom denna fråga i klassrummet"},privacy:{policy:"användningsvillkor",terms_intro:"Genom att skapa ett användarkonto, logga in och/eller använda ScalableLearning-tjänsten accepterar du dessa villkor.",privacy_text:"Integritet",information_collect:"Vilken information vi samlar in",information_collect_details:"Vi samlar in information om hur användarna använder webbplatsen och hur de interagerar med eller skapar kursmaterial. Detta inkluderar svar på quizzar, spelade videos, pauser, förflyttningar, ställda frågor, besvarade frågor, klick på Förvirrad-knappen, svar på enkäter och allmän sidnavigering. Vi samlar också in information om hur lärare använder webbplatsen, inklusive skapandet av kurser, visualisering av framsteg, presentation i klassrummet, kursinnehåll och struktur samt allmän sidnavigering, använda självklart byggverktyg, visualisering av framsteg, visningsverktyg i klassen, kursinnehåll och struktur samt allmän sidnavigering. Denna information inkluderar tiden, typen av åtgärd, svaret och kontot som är kopplat till åtgärden.",information_use:"Hur vi använder informationen",information_use_details:"Vi använder denna information både för att förbättra ScalableLearning-tjänsten och för lära oss hur vi kan förbättra undervisning och lärande. Studentinformationen används bland annat för att hjälpa lärare att följa hur studenter lär sig, var studenter har svårigheter med sina kurser och vilka frågor de har. Upphovspersoner till anonym information (anonyma enkäter och quizzar) visas inte för lärare på webbplatsen för att upprätthålla studentanonymiteten. Lärarinformation används för att utveckla bättre gränssnitt och för att identifiera hur vi bättre kan stödja lärare att se var studenter behöver mer hjälp.",information_use_details2:"Vi använder också denna information både internt och med externa partners för forsknings för att förbättra undervisningstekniker och de verktyg vi tillhandahåller. All information som används för forskning är pseudonyminiserad genom att ta bort namn och e-postadresser. Vi kräver att externa partners upprätthåller nödvändiga sekretessoch säkerhetsstandarder.",confidentiality_and_security:"Konfidentialitet och säkerhet",confidentiality_and_security_details:"Vi tar din integritet och säkerhet på allvar. Vi lovar att aldrig släppa din personligt identifierbara information till en tredje part utan ditt samtycke. Din information kommer att lagras och skyddas enligt branschstandarder.",use_of_cookies:"Användning av webbkakor",use_of_cookies_details:"Webbkakor ('cookies') används på denna webbplats för att komma ihåg din inloggningsinformation. Medan du är inloggad används en kaka för att spåra din inloggningssession. Den här kakan upphör att gälla när du stänger ditt webbläsarfönster eller loggar ut. Om du väljer 'Kom ihåg mig' när du loggar in kommer kakan att förbli i två veckor.",identifiable_information:"Personligt identifierbar information",identifiable_information_details:"Den personligt identifierbara informationen för ditt konto består av namnet och e-postadressen du anger när du registrerar ett konto på webbplatsen. Denna information är kopplad till dina handlingar på webbplatsen. Du kan komma åt, rätta till och ta bort din kontoinformation via sidan Kontoinformation på webbplatsen. Vi lagrar IP-adressen för alla åtkomster till webbplatsen i serverns loggar.",deleting_profile:"Lagring av uppgifter och radering av din profil",deleting_profile_details:"Dina uppgifter behålls i 1 år efter din senaste interaktion för att du ska kunna anmäla dig till framtida kurser. Efter 1 år får du ett mail som frågar om du vill behålla dina uppgifter i systemet, psuedonyminisera dem eller radera dem. Om du inte gör något blir dina uppgifter pseudonyminiserade så att vi inte kan identifiera ditt namn eller e-post, men du kan återställa ditt konto och dina data med din ursprungliga e-postadress. Du kan när som helst radera dina data genom att helt enkelt radera ditt konto. Observera att det kan ta en tid för att denna information ska raderas från backup-system. Dina pseudonyminiserade användningsuppgifter kan behållas för forskning.",gdpr_compliance:"Överensstämmelse med Allmänna dataskyddsförordningen (GDPR)",gdpr_compliance_details_1:"Rättslig grund. Den rättsliga grunden för ScalableLearnings behandling av data är samtycke från lärare och studenter att använda tjänsten. Detta samtycke ges när du registrerar ett konto och godkänner användningsvillkoren. Användare kan när som helst återkalla sitt samtycke genom att radera sitt konto. Lärare som använder denna tjänst måste ha behörighet att anmäla sina studenter till tjänsten om studenterna själva inte har denna auktoritet.",gdpr_compliance_details_2:"Dataskyddskontakt. Dataskyddsansvarig för ScalableLearning kan nås på info@scalable-learning.com eller genom att skriva till ScalableLearning dataskyddsansvarig, RISE SICS AB, Box 1263, 164 29 Kista.",gdpr_compliance_details_3:"Databehandling. Den databehandling som utförs av ScalableLearning anges i detta dokument under 'Hur vi använder informationen.' ",gdpr_compliance_details_4:"Dataskydd och säkerhet. Vi använder branschstandardmetoder för att skydda säkerheten för våra data.",gdpr_compliance_details_5:"Rätt till korrigering. För att korrigera data, vänligen fyll i en supportförfrågan med hjälp av hjälpmenyn.",gdpr_compliance_details_6:"Rätt till radering. Ta bort ditt konto för att radera dina data.",gdpr_compliance_details_7:"Rätt att begränsa behandlingen. Ta bort ditt konto för att begränsa behandlingen av dina data.",gdpr_compliance_details_8:"Rätt till dataportabilitet. För en portabel elektronisk version av dina data, vänligen fyll i en supportförfrågan med hjälp av hjälpmenyn.",gdpr_compliance_details_9:"Förstöring av data. Data behålls i enlighet med 'Lagring av uppgifter och radering av din profil' ovan. Vi upprätthåller en envägshashad lista över konton för att kunna identifiera avslutad behandling.",gdpr_compliance_details_10:"Rätt till objekt. Ta bort ditt konto för att begränsa behandling av data från tredje part. Observera att data som lämnats till tredje part kan ha anonymiserats på ett sådant sätt att det inte går att ta bort specifika användares data från sådana samlingar.",gdpr_compliance_details_11:"Incidentrapportering. I händelse av dataläckage kommer alla potentiellt drabbade användare att bli underrättade inom 72 timmar efter detektering.",gdpr_compliance_details_12:"Användningsbegränsningar. Datainsamling och behandling är begränsad till syftet att hjälpa studenter och lärare, och att utveckla nya undervisningstekniker och förbättra systemet.",gdpr_compliance_details_13:"Rätt till åtkomst. Information om syftet med datainsamling, typer av insamlade data, vad som anges, hur länge data behålls och varifrån data kommer ifrån beskrivs ovan och i konsekvensanalysen.",acceptable_use_policy:"Godtagbar användning",acceptable_use_policy_details_1:"",acceptable_use_policy_details_2:"",acceptable_use_policy_details_3:"Du ska endast använda ditt ScalableLearning-konto för att utföra uppgifter som är förenliga med målen för ScalableLearning-tjänsten (undervisning och lärande) och i enlighet med dessa användningsvillkor.",acceptable_use_policy_details_4:"Du får inte använda ditt ScalableLearning-konto för något olagligt syfte.",acceptable_use_policy_details_5:"Du får inte försöka bryta mot eller kringgå några administrativa kontroller eller säkerhetskontroller.",acceptable_use_policy_details_6:"Du ska respektera upphovsrätt och sekretessavtal.",acceptable_use_policy_details_7:"Du ska skydda ditt konto och alla känsliga data och filer som den ger tillgång till.",acceptable_use_policy_details_8:"Du ska omedelbart rapportera varje känt eller misstänkt säkerhetsintrång eller missbruk av din registrering, eller den information till vilken den ger tillgång till ScalableLearnings dataskyddskontakt (se ovan) och/eller till Tjänsteleverantören (se nedan).",acceptable_use_policy_details_9:"All användning av ScalableLearning-tjänsten sker på egen risk. Det finns ingen garanti för att tjänsten kommer att finnas tillgänglig när som helst eller att den passar för alla ändamål.",acceptable_use_policy_details_10:"Ledningen för ScalableLearning-tjänsten har rätt att begränsa och avsluta tillgången till tjänsten och du ska genast följa deras instruktioner, med förbehåll för separata avtal.",acceptable_use_policy_details_11:"Du är ansvarig för följderna av eventuella överträdelser.",other:"Andra",legal_entity:"Juridisk enhet / Tjänsteleverantör",legal_entity_details:"ScalableLearning tillhandahålls av RISE SICS AB, Box 1263, SE-164 29 Kista.",code_conduct:"GÉANT dataskyddskod",code_conduct_details:"Dessa användningsvillkor följer GÉANT Uppförandekod för dataskydd version 1.0, 14 juni 2013.",policy_changes:"Ändringar av användningsvillkor",policy_changes_details:"De nuvarande användningsvillkoren kommer alltid att finnas på den här sidan och vi uppmanar dig att besöka den här sidan för att granska ändringar. Eventuella väsentliga ändringar skickas via e-post till alla aktiva konton. Ändringar träder i kraft när de publiceras här.",policy_agree:"Jag godkänner Privacy Policy för ScalableLearning och jag godkänner att ScalableLearning kan behandla mina data",last_update:"Senast uppdaterad: Maj-2018",agree:"hålla med",cancel:"annullera"},faq:{faq:"Vanliga frågor",question1:"Vem äger den lagrade informationen?",answer1:"Kursinformationen ägs av den som skapat kursen. Studentinformationen ägs av studenten. Om en student tar bort sitt konto blir tidigare sparad informationen från deltagande i kurser kvar men helt anonymt.",question2:"Var lagras informationen och under vilket lands jurisdiktion?",answer2:"Informationen lagras på ett datacenter på Irland och ScalableLearning-tjänsten drivs under svensk jurisdiktion, med RISE SICS som ansvarig",question3:"Kan informationen kommas åt eller exporteras?",answer3:"Lärare kan exportera fullständig information från sina kurser.",question4:"Tas backuper av systemet?",answer4:"Det tas daglig backup.",question5:"Hur säkras lagring och överföring av information?",answer5:"Lagring och överföring säkras med kryptering, autenticering och skydd mot fysisk åtkomst enligt moderna industriella standarder.",question6:"Loggas trafiken?",answer6:"Trafiken loggas 4-10 dagar och är tillgänglig för utvecklingsgruppen för felsökning och andra utvecklingsändamål.",question7:"Hur säkras systemet?",answer7:"Se detaljerad information (på engelska) om vår applikationsplattform Heroku:"},intro:{title:"Introduktionsvideo",teacher_introduction:"Denna 10-minuters video ger dig en snabb introduktion till hur du lägger till videos och quizzar och följer dina studenters framsteg på nätet. Du kan",teacher_skip_intro:"introduktionen om du vill och kan alltid hitta hjälp under Hjälp-menyn.",student_introduction:"Denna 3-minuters video beskriver hur du använder",student_introduction_cont:"och hur man studerar effektivt i en flippad kurs. Du kan",student_skip_intro:"introduktionen om du vill och kan alltid hitta hjälp under Hjälp-menyn.",by_using_service:"Genom att använda den här tjänsten samtycker du till vår",redirect_courselist:"Går till din kurslista om ",skip:"hoppa över",go_to:"Om du inte förstår instruktionerna ovan, gå till"},dashboard:{large_calendar:"Stor kalender",small_calendar:"Liten kalender",export_calendar:"Exportera kalender",whats_new:"Nyheter",as_ical_file:"Som fil ",as_url:"Som länk ",student_completion:"Studenten slutför",student_completion:"Slutför",unanswered_questions:"Obesvarade",start_inclass:"@:inclass.start_inclass",review_select_inclass_material:"Gransla & välj in-class material",review_quiz:"Granska quiz",my_questions:"Mina frågor",try_again:"Försök igen",ontime:"I tid",incomplete:"Ofullständig",complete:"Komplett",more_than:"Mer än",less_than:"Mindre än",not_started:"Inte börjat",between:"Mellan",never_tried:"Aldrig provat",solved:"Lösta",not_checked:"Ej markerad",final_try:"slutliga försök",first_try:"första försöket",voted_for_review:"Röstade för granskning",click_for_information:"Klicka för mer information",inclass_question:"In-class fråga",distance_peer_question:"Distance-peer fråga",complete_video:"Var god se denna video klart",your:"Din",group:"grupp",individual:"enskild",shown_top:" visas på högst upp.",shown_below:" visas nedan.",is_not_checked:" är ej markerad.",was:" var",you:"Du",tried_once:", du försökte en gång.",tried_more_once:", du försökte dig mer än en gång.",not_first_try:" inte på första försöket.",on_first_try:" på första försöket.",you_solved_group_survey:"Du har fyllt i gruppenkäten.",you_not_answered_quiz:"Du har inte besvarat detta quiz",answered_survey:" besvarade denna enkät",answered:" svarade",answered_but_not_checked:"Du har provsvarat på detta test, men svaret har inte granskats av läraren än.",answered_but_not_checked_question:"Du har provsvarat på detta fråga, men svaret har inte granskats av läraren än.",answered_but_group:"Du har provat det här testet, men din ",not_checked_group:" har inte kontrollerats av läraren.",tried_not_correct_first:"Du har provat detta test en gång, men har ",self_not_correct_question:"Du har provat detta fråga , men har ",tried_not_correct_first_answer:"inte fått korrekt svar.",tried_not_correct_last:"Du har provat det här testet mer än en gång, men har",answered_correct_but:"Du har svaret korrekt, men ",you_answered:"Du har svaret ",click_retry_quiz:"Klicka för att försöka igen.",less_one_hour:"färdigdatum mindre än om en timme.",correct:"korrekt",incorrect:"felaktig",answer:"svar",survey:"enkät",continue_watching:"Fortsätt att titta",watch_again:"Titta igen",start_watching:"Börja titta"},inclass:{more:"mer",pause:"Paus",resume:"Återuppta",discussion:"@:global.discussion",discussions:"@:global.discussions",quizzes:"@:global.quizzes",surveys:"@:global.surveys",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",primary_marker:"@:global.marker",free_text_question:"@:global.free_text_question",confused:"@:global.confused",really_confused:"@:global.really_confused",video_quizzes:"@:global.video_quizzes",video_quiz:"@:global.video_quiz",hide:"@:button.hide",show:"@:button.show",video_only:"Endast Video",zoom_graph:"Zoom Graf",zoom_video:"Zooma Video",show_graph:"Visa Graf",exit:"Avsluta",blackscreen_close:"Klicka eller tryck på 'b' för att gå tillbaka",blackscreen_done:"Genomgången klar. Klicka på ESC för att avsluta",start_inclass:"Visa för genomgång i klassrummet",review:"Genomgång i klassrummet",time_estimate:"Tidsuppskattning för genomgång",total_inclass_time:"Sammanlagd lektions-tid",peer_problem_time:"Diskussion-tid",review_time:"Sammanlagd tid för genomgång",time_per_quiz:"Tid per quiz",time_per_question:"Tid per fråga",display_content:"Visa I-klassinnehåll",choose_module:"Välj en modul för att visa utvalt material i klassrummet",change_defaults:"byt standard-inställningar",intro_stage:"Introduktion",self_stage:"Individuell del",group_stage:"Grupp-del",discussion_stage:"Diskussions-del",session_not_started:"Lektionen har inte börjat",please_try_or_refresh:"Var god försök igen eller tryck på uppdatera-knappen (refresh) nedan",question_not_started:"Frågan har inte givits på lektionen än",click_next_question:"Klicka på 'Nästa' när frågan visas",multiple_choice:"multipla val",click_forward_result:"Tryck framåt för att se i klassrummet omröstningsresultat."},distance_peer:{invited:"Bjud in en elev för en Distance Peer session",invited_instruction:"Välj en elev",distance_peer_instruction:"Ring upp din partner medans du går igenom frågorna så att ni kan diskutera dem i realtid. Kom ihåg att för individuella quiz så ska ni svara var för sig, men för grupp-delen av ett quiz så uppmuntras ni att diskutera svaret sinsemellan.",invited_by:"Du är inbjuden",invited_by_instruction:"Tryck på knappen för den elev du vill samarbeta med ",wait_for_acceptance:"Vänta på acceptans",wait_for_acceptance_instruction:"Vänta på acceptans från elev eller inhibera inbjudan ",waiting_response_of_back_end:"Kontrollera om du är inbjuden att delta i en Distance Peer session ",invite_another_button:"Bjud in en annan elev",video_stage:"Var god se videon.",intro_stage:"Quiz:Intro",self_stage:"Quiz:Själv",multiple_choice:"@:inclass.multiple_choice",group_stage:"Quiz:Grupp",end_video_stage:"Quiz:Slut",end_peer_instruction:"Avsluta Distance Peer sessionen",in_distance_peer:"Du deltar i en Distance Peer session med namnet {{name}}.",the_another_student_finished_status:"{{name}} har slutfört {{status}}, du kan fortsätta",waiting_the_another_student_to_finish:"Väntar på att {{name}} ska slutföra {{status}}",click_on_button_below_to_end_session:"Klicka på knappen nedan för att avsluta Distance Peer sessionen",the_another_student_finished_message_video:"Snälla du titta på videon för att komma till peer-instruktionsfrågorna.",the_another_student_finished_message_quiz_intro:"Snälla du tryck på play för att titta på introduktionen av frågan.",the_another_student_finished_message_quiz_self:"Snälla du  välj ett svar frågan på egen hand. (Diskutera inte det med din partner.)",the_another_student_finished_message_quiz_group:"Snälla du diskutera ditt svar med din partner och välj ditt senaste svar. (Du behöver inte välja samma svar.)",the_another_student_finished_message_quiz_end:"Snälla du tryck på play för att titta på lärarens förklaring av svaret.",waiting_message_quiz_intro_after_video:"Väntar på att din partner slutföra titta på videon.",waiting_message_quiz_self_after_intro:"Väntar på att din partner slutföra titta på introduktionen.",waiting_message_quiz_group_after_self:"Väntar på din partner att välja sitt individuella svar. (Diskutera inte ditt svar med din partner.)",waiting_message_quiz_end_after_group:"Väntar på din partner att välja sitt svar efter diskussionen.",waiting_message_video_after_quiz_end:"Väntar på din partner att slutföra titta på lärarens förklaring.",prevent_seek_forward:"Var snäll och gå inte över din partner.",can_not_leave_this_part:"{{name}} har inte avslutat denna del än, så du kan inte fortsätta till nästa del",other_student_ended_session:"{{name}} avslutade Distance Peer sessionen",student_cancelled:"{{name}} avbrutit inbjudan."},editor:{explanation:"Förklaring",quiz_question:"Quiz-fråga",quiz_time:"Quiz-tidpunkt",marker_time:"Markörens tid",note_time:"Anteckning tid",note_duration:"Anteckning varaktighet",note_as_slide:"Fullskärm Anteckning",note_as_slide_description:" (Den här anteckningen pausar videon tills studenten klickar på Fortsätt.)",note_as_slide_empty_description:"Sätt i texten nedan i rutan annotering.",start_time:"Start-tid",end_time:"Slut-tid",intro_timer:"Timer Intro del",self_timer:"Timer individuell del",group_timer:"Timer grupp del",discussion_timer:"Timer diskussions del",preview_inclass:"Förhandsvisa lektion",incorrect_format_time:"Felaktigt format på tiden",cannot_delete_alteast_one_answer:"Kan inte ta bort; det måste finnas minst ett svar",time_outside_range:"Tid utanför videons speltid",start_time_bigger_than_end_time:"Slut-tid måste vara efter start-tid",header:"Rubrik",answer:"@:global.answer",inclass_student_note:"Varför valde du det svaret? (För dina egna anteckningar.)",type:"Typ",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",note:"@:global.note",course_editor:"Redigera kurs",link_editor:"Redigera länk",video_editor:"Redigera video",correct:"@:global.correct",incorrect:"@:global.incorrect",quiz_editor:"Redigera Quiz",survey_editor:"Redigera Enkät",module_editor:"Redigera Modul",title:"@:global.title",annotation:"Annotering",tooltip:{invisible:"Inte synlig för eleverna.",invisible_quiz:"Opublicera: Inte synlig för eleverna.",invisible_con:"Kommer att synas på detta datum.",students_must_complete_inorder:"Studenter måste avsluta detta moment innan de går vidare",students_must_complete_required:"Alla nödvändiga objekt måste fyllas i, i tid, för att studenten ska få tillgodoräkna sig modulen",students_can_not_skep_ahead:"@:editor.details.skip_ahead_description",click_to_delete:"Klicka här för att ta bort, klicka utanför för att stänga",create_link_time:"Skapa en länk till den här tidpunkten i videon",video_info:"Endast YouTube-webbadresser och MP4-H.264-kodade videofilmer tillåts",click_add_question:"Klicka eller skriv 'i' för att lägga till en fråga.",click_add_marker:"Klicka eller skriv 'm' för att lägga till en markering",click_add_note:"Klicka eller skriv 'n' för att lägga till en notering. Tryck 'shift-n' för att lägga till en notering och fortsätta uppspelningen",quiz_publish_status:"Modul inte synlig för eleverna. Se till att modulen är synlig före publicering"},drag:{start:"Start",end:"Slut",instruction:"Ange namn för dragbara objekt och placera Start och Slut på skärmen.",correct:"Denna post är korrekt här eftersom",incorrect:"Punkt {{num}} skulle vara felaktig här eftersom"},messages:{random_answers:"Svaren nedan kommer att presenteras för studenten i slumpmässig ordning",provide_answer:"Ange svarstext för varje alternativ",quiz_no_answer:"Quizzen saknar korrekt svar",enter_url:"Ange videons titel och dess länk",enter_url_continue:"i Detaljer till höger.",for_help:"För hjälp att ladda upp videoklipp",for_help_continue:"Se 'Komma igång' i Hjälp-menyn",double_click_new_answer:"Dubbelklicka på videon för att lägga till ett nytt svar",drag_to_reorder:"Dra för att ordna"},home:{choose_module:"Välj en modul till vänster för att visa och redigera dess innehåll.",drag_module:"Dra moduler upp och ner för att ändra ordningen.",create_module:"Skapa moduler för att organisera dina kursinnehåll.",choose_add:"Lägg till videor, quizzar, undersökningar och länkar.",preview_see:"Förhandsvisa hur ditt innehåll kommer att visas för studenter",right_click:"Högerklicka på ett objekt för att kopiera, klistra, eller dela det med andra lärare."},regex:{enter_string:"Ange strängen för att matcha eller ett reguljärt uttryck",correct_if:"kommer endast vara korrekt för",correct_for:"kommer att vara korrekt för",any_integer:"varje heltal mellan 0 och 9",numbers:"siffrorna 10, 14 och 29"},details:{duration:"@:global.duration",details:"Detaljer",video:"@:global.video",video_type:"Video-typ",add_video:"Lägg till länk till videon",add_description:"Lägg till beskrivning",title:"@:global.title",description:"@:global.description",instructions:"Instruktioner",set_date:"Välj datum",use_module:"Använd modulens synlighet",use_module_due:"Använd modulens färdigdatum",use_module_in_order:"Använd moduls ordning",use_module_required:"Använd moduls nödvändighet",use_module_skip_ahead:"Använd moduls hoppa över",vidoe_not_exist:"Videon saknas eller laddas fortfarande upp",incompatible_video_link:"Ej valid filmtyp. Var god välj en YouTube, .mp4 eller MediaSite URL.",student_link_lecture:"Student-länk till video",appearance_date:"Publiceringsdatum",due_date:"Färdigdatum",quizzes:"@:global.quizzes",markers:"Markeringar",note:"Anteckningar",student_link_module:"Student-länk till modulen",has_due_date:"Har färdigdatum",required:"@:global.required",skip_ahead:"Hoppa över",in_order:"I ordning",retries:"försök",display_text:"Visa fråga över videon",display_text_explain:"(Använd om frågan texten är inte i videon.)",student_link_quiz:"Student-länk till quiz",skip_ahead_description:"Tillåta eleverna hoppa framåt i video",graded:"Graderade",quiz_pass_fail:"denna quiz är godkänd / misslyckad",show_explanation:"Visa förklaring efter varje försök",correct_to_pass:" korrekt krävs för att passera",pass:"Klara",fail:"Misslyckas"},popover:{shown_in_graph:"Visas i resultatdiagram",shown_to_student:"Visas för studenterna"},button:{add_video_quiz:"Lägg till video-quiz här",add_marker:"Lägg till markering",show_all_quizzes:"Visa alla quizzar",add_content:"Lägg till Innehåll",add_answer:"Lägg till svar",add_question:"Lägg till fråga",add_header:"Lägg till rubrik",add_module:"Lägg till modul",preview_student:"@:global.preview_student",add_note:"Lägg till en notering"}},lectures:{messages:{thank_you_answer:"Tack för ditt svar",press_to_continue:"Tryck spela till fortsätta.",did_not_get_credit:"Videon ej markerad som sedd. För att markeras som sedd måste hela videon ses och frågorna besvaras (men inte nödvändigtvis rätt!).",please_choose_one_answer:"Välj minst ett svar",please_choose_an_answer:"Var god välj ditt (dina) svar",finish_before_proceeding:"Se klart tidigare videos innan du fortsätter",really_confused_use_question:"Du kan ställa en fråga så att läraren kan hjälpa dig.",navigate_away:"Är du säker på att du vill navigera bort från denna sida?",change_lost:"Alla dina ändringar kommer att gå förlorade!"},timeline:{timeline:"Tidslinje",slides:"Bilder",description:"@:global.description",question:"@:global.question",confused:"@:global.confused",really_confused:"@:global.really_confused",note:"@:global.note",quiz:"@:global.quiz",marker:"@:global.marker",watched:"Sedda",quizzes:"quizzar",required_quizzes:"erfoderliga quiz",export_chart:"Exportera data"},button:{ask_question:"Ställ en fråga",new_note:"Ny anteckning",im_confused:"Jag är förvirrad",exit_fullscreen:"Gå ur helskärmsläge",fullscreen:"Helskärm",check_answer:"Kontrollera svaret",start_distance_peer:"Starta Distance Peer sessionen",submit:"@:button.submit",submit_my_vote:"Skicka min rösta"},tooltip:{unsolved_quiz:"Du måste ha svarat på quizen innan du kan hoppa till den",click_or_type_note:"Klicka eller skriv N för att lägga till en anteckning",click_or_type_question:"Klicka eller skriv Q för att ställa en fråga",click_or_type_confused:"Klicka eller skriv C för att säga att du är förvirrad",click_or_type_fullscreen:"Klicka eller skriv F för att gå till helskärmsläge",click_or_type_smallscreen:"Klicka eller skriv F för att gå ur helskärmsläge",video_shortcut:"tryck J för att backa 10s eller K för att spela/pausa eller L för att snabbspola framåt 10s"},correct:"@:global.correct",incorrect:"@:global.incorrect",confused:"@:global.confused",really_confused:"@:global.really_confused",hover_for_explanation:"Hovra med pekaren för förklaring",tap_for_explanation:"Knacka (tap) för förklaring",multiple_correct:"Det kan finnas flera rätta svar",other_correct_answers:"Det kan finnas fler rätta svar",must_place_items:"Du måste placera alla objekt",answer_question:"Vänligen svara på frågan",choose_correct_answer:"Välj det rätta svaret",answer:"@:global.answer",choices:"Svarsalternativen",optional:"@:global.optional"},progress:{title:"@:global.title",discussion:"@:global.discussion",free_text_question:"@:global.free_text_question",related:"Relaterat",of_student_review:"röstade för genomgång",questions:"@:global.questions",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",out_of:"Av",number_of_students:"@:number_of_students",confused:"@:global.confused",really_confused:"@:global.really_confused",back:"@:global.back",pauses:"Pauser",finished_on_time:"Klar i tid",finished_not_on_time:"Klar sent",not_finished:"Inte klart",grade:"Betyg",course_graph_desc:"Videos och quizzar klara, procentsatser för alla studenter",based_on_invideo:"Baserat på antal in-video-frågor besvarade",button:{hide:"@:button.hide",make_visible:"Gör enkäten synlig för studenterna",see_all:"Se alla",export_chart:"Exportera tabell",show_in_class:"Visa i klassen",reply:"@:button.reply",send_reply:"Posta svar och skicka meddelande till elev"},tooltip:{see_related:"Se relaterade svar för elev",quizzes_solved:"quizzar lösta",quizzes_optional_solved:"extra quiz lösta",watched_video:"Sedd",correct:"@:global.correct",question_not_checked:"@:dashboard.not_checked",completed:"@:events.completed",confused:'Visar antalet studenter som klickade på "förvirrad" knappen vid den tiden i videon. Om en student klickade på knappen mer än en gång på samma plats visas den i rött',back:"Visar antalet studenter som gick tillbaka i videon från den tiden i videon",pauses:"Visar antalet studenter som pausade vid den tiden i videon",questions:"Visar antalet studenter som ställde frågor på den tiden i videon"},popover:{change_status:"Ändra status",original:"Original",on_time:"I tid",not_done:"Ej utfört"},shortcuts:{go_next_item:"Gå till nästa objekt",go_previous_item:"Gå till föregående objekt",go_inside_item:"Gå in i ett objekt",go_outside_item:"Gå ut ur ett objekt",seek_to_location:"Sök till plats",resize_video:"Växla videostorlek",mark:"Markera för genomgång",reply:"@:button.reply"},chart:{not_started_watching:"Inte börjat titta",watched:"Sedd",completed_on_time:"Klar i tid",completed_late:"Klar sent",module_progress_charts_quizzes:"Framsteg i modulen, baserat på video-quizzar",module_progress:"Modul-framsteg",answered:"Besvarade"},home:{review_module:"Bedöm en modul",module_review:"Bedöm arbete med modul",module_timeline:"Bedöm interaktion med videos",module_completion:"Bedöm slutförande av modul",review_course:"Bedöm hela kursen",course_completion:"Bedöm slutförande av moduler",course_graph:"Bedöm slutförande av videos och quizzar",view_respond_students:"Visa quizresultat och frågor, svara på frågor och välj material till klassrummet.",view_interaction:"Visa hur studenter interagerat med videor.",view_module_completed:"Visa om studenter tittat på videor inom en modul i tid.",view_course_completed:"Visa slutförandestatus för varje modul i kursen.",view_course_graph:"Visa slutförandestatus för alla videos och quizzar i kursen."}},quizzes:{used_up_all:"Förbrukat alla",attempts:" försök",attempt_number:"Försök nummer",must_choose_answer:"Måste välja minst ett svar",optional:"@:global.optional",already_submitted:"Du har lämnat in",no_more_attempts:"och har inga fler försök kvar",graded_quiz:"graderade frågesport",correct_required_to_pass:"korrekta svar som krävs för att passera.",grade:{under_review:"föremål för översyn",partial:"Partiell",correct:"@:global.correct",incorrect:"@:global.incorrect"}},enrollment:{enter_enrollment:"Ange kursnyckel",get_enrollment_key:"Kontakta din lärare om du inte fått en kursnyckel.",enrollement_key_format:"Du skall ange en kursnyckel på formen",enroll:"Registrera"},enrolled_students:{name:"@:global.name",email:"@:global.email",remove_student:"Avlägsna studenter",enrolled_students:"@:navigation.enrolled_students",help_enroll_student:"Hjälp med registrering av studenter",select_all:"Markera alla",deselect_all:"Avmarkera alla",done:"@:global.done",export_as:"Exportera listan över studenter "},groups:{module:"Modul",groups:"Grupper",statistics:{videos:"@:global.videos",customlinks:"@:global.customlinks",quizzes:"@:global.quizzes",surveys:"@:global.surveys",video_quizzes:"@:global.video_quizzes",questions:"@:global.questions"},delete_popup:{warning:"@:global.warning",delete_module:"Att ta bort modulen",will_delete:"kommer att ta bort allt den innehåller.",are_you_sure:"@:global.are_you_sure"}},courses:{information:{adding_teacher:"En lärare eller assisterande lärare måste ha ett lärarkonto på",create_account:"För att skapa ett lärarkonto gå till",go_to_course:"Gå till kurs",edit_course:"Redigera kurs",description:"@:global.description",done:"@:global.done",professor:"Lärare",prof:"@:courses.information.professor",ta:"Lärarassistent",discussion_forum_link:"Länk till diskussionsforum",enrollment_key:"Kursnyckel",enrollment_url:"URL för registrering",course_link:"Kurslänk",taught_by:"Ges av",taught_by_small_cap:"ges av",receive_student_ask_email:"Få notifiering via email när student ställer fråga",receive_due_dates_email_question:"Vill du ta emot e-påminnelser om dina kurs deadlines?",receive_due_date_email:"Få påminnelse om kommande senaste färdigdatum.",receive_student_ask_email_question:"Vill du få notifiering via email när student ställer fråga med en länk för att svara?",change_email_question:"(Du kan ändra detta när som helst på kursinformation sida.)",button:{add_teacher:"Lägg till lärare",remove_teacher:"Ta bort lärare",export_as:"Exportera anonymiserade kursdata",invite:"Bjud in",send_email_reminder:"Skicka ett mail påminnelser"},tooltip:{click_to_copy:"Klicka för att kopiera"}},list:{finished:"Avslutad",all_finished:"Avslutade",all:"Alla",current:"Pågående",duration:"@:global.duration",lectures:"@:global.lectures",quizzes:"@:global.quizzes",surveys:"@:global.surveys",number_of_students:"@:global.number_of_students",importing_data:"Importera data",button:{new_course:"@:global.new_course",back:"@:global.back",sort_by:"Sortera efter"},messages:{no_courses:"Just nu har du inte några kurser som du kan komma åt. Du kan börja genom att skapa en ny.",enroll_instruction:"För att anmäla dig till en kurs, välj 'Delta i en ny kurs' under menyn 'Mina kurser' och ange kursnyckeln du fått från din lärare. ",create_enroll_instruction:"För att skapa eller följa en kurs välj 'Skapa ny kurs' eller 'Delta i en ny kurs' under menyn 'Mina kurser' och fyll i kursnyckeln som du fått av din lärare. ",create_instruction:"För att skapa ny kurs, välj 'Skapa ny kurs'  under menyn 'Mina kurser' och.",enroll_instruction:"För följa en kurs välj 'Delta i en ny kurs' under menyn 'Mina kurser' och fyll i kursnyckeln som du fått av din lärare."},tooltip:{unenroll:"Avregistrera"},delete_popup:{warning:"@:global.warning",delete_course:"Tar bort kursen",will_delete:"kommer att ta bort",all_modules:"Alla moduler",all_items:"Allt innehåll i moduler",all_progress:"All information om studenters arbete",are_you_sure:"Är du säker att du vill fortsätta?",cannot_undo:"Detta kan inte återställas!"}},new:{button:{create_course:"Skapa kurs",unselect:"Avmarkera"},copy_from_existing:"Kopiera data från befintlig kurs",course_item_shift:"Kurs objekt kommer att skiftad i enlighet med startdatum."},start_date:"Startdatum",end_date:"Slutdatum",disable_registration:"Stäng registrering efter",limit_registration_domain:"Registrering Skolor",limit_registration_domain_description:"Tillåt endast studenter från specifika skol domäner för att registrera",limit_registration_all_students:"Låt någon student att registrera",duration:"Kurslängd i veckor",prerequisites:"Förkunskaper",course_image_url:"Länk till bild",short_name:"Kortnamn",time_zone:"Tidszon",course_code:"Kurskod",course_name:"Kursens namn",university_note:"Universitet Anteckning"},statistics:{statistics:"Statistik",administration:"Administration",statistics_dashboard:"Statistikpanelen",registration:"Registrering",report_period:"Rapport-period",generate_report:"Generera rapport",login:"@:navigation.login",lecture_views:"Videos visade",questions_asked:"Frågor ställda",confused:"Förvirrad",courses_created:"Kurser skapade",lectures_created:"Videos skapade",video_quizzes_created:"Video-quiz-frågor skapade",normal_quizzes_created:"Normala quiz-frågor skapade",surveys_created:"Enkäter skapade",video_quizzes_solved:"Video-quiz-frågor besvarade",normal_quizzes_solved:"Normala quiz-frågor besvarade",surveys_solved:"Enkäter besvarade",total_courses:"Totalt antal kurser",total_students:"Totalt antal studenter",total_teachers:"Totalt antal lärare",total_lectures:"Totalt antal videos",total_quizzes:"Totalt antal quiz-frågor",total_surveys:"Totalt antal enkäter",total_questions_asked:"Totalt antal frågor ställda",total_confused:"Totalt antal förvirrad-klick",rate_from:"värdera från",to:"till",drag_to_zoom:"Klicka och dra i hela området för att zooma in",pinch_to_zoom:'"Nyp" diagrammet för att zooma in',write_welcome_message:"Skriv välkomstmeddelande"},player:{click_video_quality:"Klicka för att ändra videokvalitet",quality:"Kvalitet",speed:"Hastighet"},announcements:{create_announcement:"Skapa nytt meddelande",empty:"Inga meddelanden ännu",post:"Inlägg meddelanden till klass här"},help:{getting_started:{getting_started:"Komma igång",student:"för studenter",teacher:"för lärare"},support:"Support",teacher_forum:"Lärarforum",instruction_manual:"Bruksanvisning",tips:"Tips",how_to_flip:"Hur du flippar",privacy_faq:"Sekretesspolicy och vanliga frågor"},course_settings:{show_notes:"Visa anteckningar",show_quizzes:"Visa quizzar",show_surveys:"Visa enkäter",show_confused:"Visa förvirrade",show_markers:"Visa markeringar",show_charts:"Visa diagram",show_discussion:"Visa diskussion",show_lecture_quizzes:"Visa video-quizzar",print:"Skriv ut",download_notes:"Ladda ner anteckningar"},content:{add_new_content:"Lägg till nytt innehåll",types:{customlink:"@:global.customlink",video:"@:global.video",inclass_video:"@global.inclass_lecture",distance_peer_video:"@:global.distance_peer_lecture",video_desc:"Du kan lägga till quizfrågor ovanpå videon.",quiz:"@:global.quiz",survey:"@:global.survey",link_desc:"Länk till andra webbplatser eller sidor.",quiz_or_survey:"Quiz eller enkät",quiz_or_survey_desc:"Text-baserad, kan vara obligatorisk eller frivillig."},questions:{insert_video_question:"Lägg till en video-quiz",categories:{on_video:{title:"Video-quiz",desc:"Placera quizzen på videon. Använd detta om svaren är synliga i videon."},text_quiz:{title:"Text-quiz",desc:"Text-quiz på en vit bakgrund. Använd detta om frågesport-svaren inte syns i videon"},on_video_survey:{title:"Video-enkät",desc:"Enkäter har inget rätt svar. Använd detta om undersöknings-val syns i videon."},text_survey:{title:"Text enkät ",desc:"Text enkäter visar inte korrekt svar mot vit bakgrund. Använd om alternativen i enkäten inte är synliga i videon. "}},types:{ocq:"Ett svar",mcq:"Flera svar",drag:"Dra-och-släpp",text:"Fritext"},quiz_types:{mcq:"Flervals (flera korrekta svar)",ocq:"Flervals (ett korrekta svar)",drag:"Dra-och-släpp (ordnad lista)",text:"Text (fritext eller matcha text)",free_text:"Fritext",match_text:"Matcha text"},survey_types:{mcq:"Flervals (flera korrekta svar)",ocq:"Flervals (ett korrekt svar)"}}},languages:{languages:"Languages",en:"English",sv:"Svenska"},welcome_messages:{description:"Ange texten som ska visas för användare från domänen {{domain}} när de loggar in. Denna text kommer att visas längst upp på sidan 'Skapa Kurs'."}},full_calendar_sv={monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthNamesShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],dayNames:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],dayNamesShort:["sön","mån","tis","ons","tor","fre","lör"],buttonText:{today:"Idag",month:"Månad",week:"Vecka",day:"Dag"}};angular.module("scalearAngularApp",["ngCookies","ngResource","ngSanitize","ui.router","ngTouch","ui.bootstrap.datepicker","ui.bootstrap.timepicker","ui.sortable","ui.calendar","ngDragDrop","infinite-scroll","xeditable","googlechart","pascalprecht.translate","angularMoment","textAngular","highcharts-ng","config","chieffancypants.loadingBar","anguFixedHeaderTable","mm.foundation","dcbImgFallback","ngclipboard","ngTextTruncate","ngDialog","mgo-angular-wizard","angular-medium-editor","smart-table"]),angular.module("scalearAngularApp").constant("headers",{withCredentials:!1,"X-Requested-With":"XMLHttpRequest"}),angular.module("scalearAngularApp").run(["$http","$rootScope","editableOptions","editableThemes","UserSession","$state","ErrorHandler","$timeout","$window","$log","$translate","$cookies","$tour","Course","URLInformation","CourseModel","Token","$location",function(e,t,n,a,r,o,s,i,l,u,d,c,_,m,p,g,h,f){try{MathJax&&MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"]]},showProcessingMessages:!1,showMathMenu:!1})}catch(e){}e.defaults.headers.common["X-CSRF-Token"]=c["XSRF-TOKEN"],n.theme="default",a.default.submitTpl='<button class="button tiny with-tiny-padding with-medium-padding-right with-medium-padding-left no-margin-bottom size-1 success check" type="submit"><i class="fi-check"></i></button>',a.default.cancelTpl='<button class="button tiny with-tiny-padding with-medium-padding-right with-medium-padding-left no-margin-bottom size-1 alert cancel" type="button" ng-click="$form.$cancel()"><i class="fi-x"></i></button>',a.default.errorTpl='<small class="error with-tiny-padding position-relative" ng-show="$error" ng-bind="$error" style="z-index:90"></small>',t.textAngularOpts={toolbar:[["h1","h2","h3","p","pre","quote"],["bold","italics","underline","ul","ol","redo","undo","clear"],["insertLink","unlink","insertImage"]],classes:{toolbarGroup:"button-group tiny custom_button_group",toolbarButton:"button tiny secondary",textEditor:"form-control",htmlEditor:"form-control"}},u.debug("lang is "+t.current_lang);var v=["login","teacher_signup","student_signup","thanks_for_registering","forgot_password","change_password","show_confirmation","new_confirmation","home","privacy","faq","about","ie","student_getting_started","teacher_getting_started","landing","signup","lti_course_list"],b=["course.student_calendar","course.course_information","course.module.courseware","lti_course_list"],y=["new_course","course.course_editor","course.calendar","course.enrolled_students","send_email","send_emails","course.announcements","course.edit_course_information","course.teachers","course.progress","course.progress.main","course.progress.module","statistics","course.module.course_editor","lti_course_list"],w=["login","student_signup","teacher_signup","thanks_for_registering","new_confirmation","forgot_password","change_password"],k=function(e){s.showMessage("Error : "+d.instant("error_message.you_are_not_authorized"),"errorMessage",4e3,"error"),p.setRedirectLink(e)};l.onbeforeunload=function(){t.unload=!0},t.$on("$stateChangeStart",function(e,t,n,a,i){_.isActive()&&_.end(),p.addToHistory(o.href(a,i)),"ltiSignInTokenCtrl"!=t.controller&&"ltiCourseListCtrl"!=t.controller||!n["access-token"]?r.getCurrentUser().then(function(e){/MSIE (\d+\.\d+);/.test(l.navigator.userAgent)&&"home"!==t.name&&o.go("ie"),e.info_complete?(n.course_id&&g.getCourseRole(n.course_id).then(function(e){(function(e){for(var t in y){var n=y[t];if(e.substring(0,n.length)===n)return!0}return!1}(t.name)&&g.isStudent()||function(e){for(var t in b){var n=b[t];if(e.substring(0,n.length)===n)return!0}return!1}(t.name)&&g.isTeacher())&&(o.go("course_list"),k(o.href(t,n)))}),"home"===t.name&&o.go("course_list"),"confirmed"===t.name&&e.intro_watched?k(o.href(t,n)):"confirmed"===t.name||e.intro_watched||"edit_account"===t.name?"login"===t.name||"teacher_signup"===t.name||"student_signup"===t.name?o.go("course_list"):function(e){for(var t in w){var n=w[t];if(e.substring(0,n.length)===n)return!0}return!1}(t.name)&&(o.go("home"),k(o.href(t,n))):o.go("confirmed")):(o.go("edit_account",{},{notify:!1}),s.showMessage(d.instant("error_message.update_account_information"),"errorMessage",4e3,"error"))}).catch(function(){if("home"===t.name&&o.go("landing"),!function(e){for(var t in v){var n=v[t];if(e.substring(0,n.length)===n)return!0}return!1}(t.name)){o.go("login");var e=o.href(t,n);/courses\/enroll\?id=/.test(e)&&p.setEnrollLink(e),k(e)}}):h.setTokenWithPromise(n).then(function(){"true"==n.redirect_boolean&&(e.preventDefault(),f.url(n.redirect_local_url))}).catch(function(e){u.debug("Token error: "+e)})})}]),angular.module("scalearAngularApp").config(["$stateProvider","$urlRouterProvider","$httpProvider","$translateProvider","$logProvider","cfpLoadingBarProvider","scalear_api","$sceProvider",function(e,t,n,a,i,r,o,s){r.includeSpinner=!0,i.debugEnabled(o.debug),s.enabled(!1),a.translations("en",translation_en).translations("sv",translation_sv).preferredLanguage("en").useCookieStorage().useSanitizeValueStrategy("escape"),n.defaults.withCredentials=!1,n.interceptors.push("ServerInterceptor"),n.interceptors.push("TokenServerInterceptor"),t.otherwise("/"),e.state("home",{url:"/",templateUrl:"/views/empty_view.html",controller:"HomeCtrl"}).state("landing",{url:"/home",views:{landing:{templateUrl:"/views/main.html",controller:"MainCtrl"}}}).state("about",{url:"/about",templateUrl:"/views/about.html",controller:"AboutCtrl"}).state("ie",{url:"/ie",templateUrl:"/views/ie.html"}).state("login",{url:"/users/login?access-token&client&expiry&token-type&uid",templateUrl:"/views/login.html",controller:"LoginCtrl",params:{email:null}}).state("teacher_signup",{url:"/users/teacher",templateUrl:"/views/users/signup.html",controller:"UsersTeacherCtrl"}).state("student_signup",{url:"/users/student",templateUrl:"/views/users/signup.html",controller:"UsersStudentCtrl"}).state("signup",{url:"/users/signup",templateUrl:"/views/users/unified_signup.html",controller:"UsersSignUpCtrl",params:{input1:null,input2:null}}).state("thanks_for_registering",{url:"/users/thanks",templateUrl:"/views/users/thanks.html",controller:"ThanksForRegisteringCtrl",params:{email:null}}).state("confirmed",{url:"/users/confirmed",templateUrl:"/views/users/confirmed.html",controller:"UsersConfirmedCtrl"}).state("edit_account",{url:"/users/edit",templateUrl:"/views/users/edit.html",controller:"UsersEditCtrl"}).state("forgot_password",{url:"/users/password/new",templateUrl:"/views/users/password/new.html",controller:"UsersPasswordNewCtrl"}).state("forgot_password_confirmation",{url:"/users/forgot_password_confirmation",templateUrl:"/views/users/password/forgot_password_confirmation.html",controller:"ForgotPasswordConfirmationCtrl",params:{email:null}}).state("change_password",{url:"/users/password/edit?token&client_id&uid",templateUrl:"/views/users/password/edit.html",controller:"UsersPasswordEditCtrl"}).state("new_confirmation",{url:"/users/confirmation/new",templateUrl:"/views/users/confirmation/new.html",controller:"UsersConfirmationNewCtrl"}).state("show_confirmation",{url:"/users/confirmation?access-token&account_confirmation_success&client&client_id&uid",templateUrl:"/views/users/confirmation/show.html",controller:"UsersConfirmationShowCtrl"}).state("privacy",{url:"/privacy",templateUrl:"/views/privacy.html",controller:"PrivacyCtrl"}).state("faq",{url:"/faq",templateUrl:"/views/faq.html",controller:"FaqCtrl"}).state("course_list",{url:"/courses",templateUrl:"/views/course_list.html",controller:"courseListCtrl"}).state("student_enroll_course",{url:"/courses/enroll?id",templateUrl:"/views/empty_view.html",controller:"CoursesEnrollCtrl"}).state("new_course",{url:"/courses/new",templateUrl:"/views/teacher/course_list/new_course.html",controller:"newCourseCtrl"}).state("course",{url:"/courses/:course_id",template:"<ui-view/>",controller:"courseCtrl",resolve:{CourseData:["CourseModel","ModuleModel","ItemsModel","$stateParams",function(e,t,n,a){return e.getData(a.course_id)}]}}).state("course.content_selector",{url:"/content",templateUrl:"/views/empty_view.html",controller:"contentSelectorCtrl"}).state("course.module",{url:"/modules/:module_id",templateUrl:"/views/empty_view.html",controller:"moduleCtrl",abstract:!0}).state("course.module.course_editor",{url:"/course_editor",templateUrl:"/views/teacher/course_editor/course_editor.html",controller:"courseEditorCtrl",abstract:!0}).state("course.module.course_editor.overview",{url:"",views:{details:{templateUrl:"/views/teacher/course_editor/module.details.html",controller:"moduleDetailsCtrl"},module:{templateUrl:"/views/teacher/course_editor/module.middle.html",controller:"moduleMiddleCtrl"}}}).state("course.module.course_editor.lecture",{url:"/lectures/:lecture_id",views:{details:{templateUrl:"/views/teacher/course_editor/lecture.details.html",controller:"lectureDetailsCtrl"},middle:{templateUrl:"/views/teacher/course_editor/lecture.middle.html",controller:"lectureMiddleCtrl"}},params:{time:null}}).state("course.module.course_editor.quiz",{url:"/quizzes/:quiz_id",views:{details:{templateUrl:"/views/teacher/course_editor/quiz.details.html",controller:"quizDetailsCtrl"},middle:{templateUrl:"/views/teacher/course_editor/quiz.middle.html",controller:"quizMiddleCtrl"}}}).state("course.module.course_editor.customlink",{url:"/link/:customlink_id",views:{details:{templateUrl:"/views/teacher/course_editor/customlink.details.html",controller:"customLinkDetailsCtrl"},middle:{templateUrl:"/views/teacher/course_editor/customlink.middle.html",controller:"customLinkMiddleCtrl"}}}).state("course.course_editor",{url:"/course_editor?new_course",templateUrl:"/views/teacher/course_editor/course_editor.html",controller:"courseEditorCtrl"}).state("course.progress",{url:"/progress",templateUrl:"/views/teacher/progress/progress.html",controller:"progressCtrl"}).state("course.progress_graph",{url:"/progress/graph",templateUrl:"/views/teacher/progress/progress_graph.html",controller:"progressGraphCtrl"}).state("course.progress_overview",{url:"/progress_overview",templateUrl:"/views/teacher/progress/progress_overview.html",controller:"progressOverviewCtrl"}).state("course.module.progress_overview",{url:"/progress_overview",templateUrl:"/views/teacher/progress/progress_overview.html",controller:"progressOverviewCtrl"}).state("course.module.progress",{url:"/progress?item_id",templateUrl:"/views/teacher/progress/progress_lecture.html",controller:"progressLectureCtrl"}).state("course.module.progress_statistics",{url:"/progress/statistics",templateUrl:"/views/teacher/progress/student_statistics_tab.html",controller:"studentStatisticsCtrl"}).state("course.module.progress_students",{url:"/progress/students",templateUrl:"/views/teacher/progress/lecture_progress_tab.html",controller:"lectureProgressCtrl"}).state("course.module.courseware",{url:"/courseware",templateUrl:"/views/student/lectures/courseware.html",controller:"coursewareCtrl"}).state("course.module.courseware.overview",{url:"/overview",templateUrl:"/views/student/course/module_overview.html",controller:"studentModuleOverviewCtrl"}).state("course.module.courseware.lecture",{url:"/lectures/:lecture_id?time",reloadOnSearch:!1,templateUrl:"/views/student/lectures/lecture.middle.html",controller:"studentLectureMiddleCtrl"}).state("course.module.student_inclass",{url:"/student_inclass",templateUrl:"/views/student/inclass/inclass.html",controller:"studentInclassCtrl"}).state("course.module.courseware.quiz",{url:"/quizzes/:quiz_id",templateUrl:"/views/student/lectures/quiz.middle.html",controller:"studentQuizMiddleCtrl"}).state("course.enrolled_students",{url:"/enrolled_students",templateUrl:"/views/teacher/course/enrolled_students.html",controller:"enrolledStudentsCtrl"}).state("course.send_emails",{url:"/send_emails",templateUrl:"/views/teacher/course/send_emails.html",controller:"sendEmailsCtrl"}).state("course.announcements",{url:"/announcements",templateUrl:"/views/teacher/announcements/announcements.html",controller:"announcementsCtrl",params:{show:null}}).state("course.course_information",{url:"/course_information?new_enroll",templateUrl:"/views/student/course/course_information.html",controller:"studentCourseInformationCtrl"}).state("course.edit_course_information",{url:"/information?new_course",templateUrl:"/views/teacher/course/course_information.html",controller:"teacherCourseInformationCtrl"}).state("course.inclass",{url:"/inclass",templateUrl:"/views/teacher/in_class/inclass.html",controller:"inclassCtrl"}).state("course.module.inclass",{url:"/inclass",templateUrl:"/views/teacher/in_class/inclass_module.html",controller:"inclassModuleCtrl"}).state("course.module.inclass.display_quizzes",{url:"/display_quizzes",templateUrl:"/views/teacher/in_class/display_quizzes.html",controller:"displayQuizzesCtrl"}).state("dashboard",{url:"/dashboard",templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).state("statistics",{url:"/statistics",templateUrl:"/views/statistics/statistics.html",controller:"statisticsCtrl"}).state("lti_course_list",{url:"/lti_course_list?return_url&email&full_name&first_name&last_name&consumer_key&resource_context_id&access-token&client&expiry&token-type&uid&redirect_local_url&redirect_boolean",templateUrl:"/views/teacher/course_list/lti_course_list.html",controller:"ltiCourseListCtrl"}).state("lti_sign_in_token",{url:"/lti_sign_in_token?redirect_local_url&status&redirect_boolean&access-token&client&expiry&token-type&uid",templateUrl:"/views/teacher/course_list/lti_sign_in_token.html",controller:"ltiSignInTokenCtrl"}).state("school_statistics",{url:"/school_statistics",templateUrl:"/views/statistics/school_statistics.html",controller:"schoolStatisticsCtrl"}).state("welcome_message",{url:"/welcome_message",templateUrl:"/views/welcome_message.html",controller:"welcomeMessageCtrl"}).state("show_shared",{url:"/show_shared",templateUrl:"/views/teacher/sharing/shared.html",controller:"sharedCtrl"}).state("student_getting_started",{url:"/help/student/getting_started",templateUrl:"/views/student/help/student_getting_started.html",controller:"StudentGettingStartedCtrl"}).state("lti_help",{url:"/help/lti_help",templateUrl:"/views/teacher/help/lti_help.html",controller:"LtiKeyGenerateCtrl"}).state("teacher_getting_started",{url:"/help/teacher/getting_started",templateUrl:"/views/teacher/help/teacher_getting_started.html",controller:"TeacherGettingStartedCtrl"}).state("preview",{url:"/preview",params:{course_id:null,module_id:null,lecture_id:null,quiz_id:null,time:null,prevState:null},controller:["Preview","$state",function(e,t){e.start()}]})}]),angular.module("config",[]).constant("scalear_api",{beta:!0,debug:!0,ga_token:"",host:"",version:"4.4.3 (Wed, 07 Nov 2018 19:59:44 GMT)",instruction_manual:"external_documents/Manual - Using Scalable Learning v.3.22.pdf",flipped_manual:"external_documents/Manual - Flipped Teaching v.1.0.pdf",teacher_welcome_video:"https://www.youtube.com/watch?v=tqE7wRQCgmU",teacher_new_course_video:"https://www.youtube.com/watch?v=rDWIUYybFPs",teacher_review_course_video:"https://www.youtube.com/watch?v=DhJgqWBm0XY",student_welcom_video:"https://www.youtube.com/watch?v=bLiZfyBuFkc",teacher_forum_link:"https://groups.google.com/forum/#!forum/scalablelearning-teachers-forum"}),angular.module("scalearAngularApp").filter("format",function(){return function(e,t){var n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),i=Math.floor(e-3600*n-60*a),r=parseInt(1e3*parseFloat(e-Math.floor(e).toFixed(3)));if(n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),r<10?r="00"+r:r<100?r="0"+r:0==r&&(r="000"),t){var o=t.replace("hh",n);return o=(o=(o=(o=(o=(o=o.replace("h",1*n+"")).replace("mm",a)).replace("m",1*a+"")).replace("ss",i)).replace("s",1*i+"")).replace("MMM",r+"")}return n+":"+a+":"+i}}).filter("formattime",function(){return function(e,t){if(0<e){var n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),i=Math.floor(e-3600*n-60*a);if(e<60&&(a=1,i=0),0==n?t=t.replace("hh:","").replace("h:",""):n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),t){var r=t.replace("hh",n);return r=(r=(r=(r=(r=r.replace("h",1*n+"")).replace("mm",a)).replace("m",1*a+"")).replace("ss",i)).replace("s",1*i+"")}return n+":"+a+":"+i}return"0:00"}}).filter("roundedformattime",function(){return function(e,t){if(0<e){var n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),i=Math.floor(e-3600*n-60*a);if(0<i&&(a+=1,i=0),n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),t){var r=t.replace("hh",n);return r=(r=(r=(r=(r=r.replace("h",1*n+"")).replace("mm",a)).replace("m",1*a+"")).replace("ss",i)).replace("s",1*i+"")}return n+":"+a+":"+i}return"0:00"}}).filter("fromNow",function(){return function(e){return moment(e).fromNow()}}).filter("inclass",function(){return function(e,t){if(!t)return e;var n={};return angular.forEach(e,function(e,t){e.show&&(n[t]=e)}),n}}).filter("survey",function(){return function(e,t){if(!t)return e;var n=[];return angular.forEach(e,function(e,t){e.student_hide||n.push(e)}),n}}).filter("currentCourse",function(){var t=new Date;return function(e){if(start_date.setDate(start_date.getDate()+7*duration)<t)return e}}).filter("formatURL",function(){return function(e){return e.match(/^[a-zA-Z]+:\/\//)||e.toString().startsWith("<iframe")||(e="http://"+e),e}}).filter("saveStateFormatter",function(){return function(e){return e==EditorState.DIRTY?"You have unsaved changes":e==EditorState.SAVE?"Saving in Google Drive...":e==EditorState.LOAD?"Loading...":e==EditorState.READONLY?"Read only":"Video and notes saved in Google Drive"}}).filter("bytes",function(){return function(e){if(e=parseInt(e),isNaN(e))return"...";var t=0<e?Math.floor(Math.log(e)/Math.LN2/10):0;return Math.round(e/Math.pow(2,10*t))+[" bytes"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"][t]}}).filter("capitalize",function(){return function(e){if(e&&0<e.length)return e[0].toUpperCase()+e.slice(1)}}).filter("anonymous",function(){return function(e,t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()+"-"+md5(e).substring(0,4).toUpperCase()}}).filter("courseActive",["$state",function(t){return function(e){return t.includes("**.course.**")&&t.params.course_id==e}}]).filter("reverse",function(){return function(e){if(e)return e.slice().reverse()}}).filter("href",["$state",function(t){return function(e){if(e)return t.href(e,{},{absolute:!0})}}]).filter("visible",function(){return function(e){if(e)return new Date(e)<=new Date}}).filter("inclassMenuFilter",function(){return function(e){return e.filter(function(e){return!!e.data&&("discussion"==e.type||e.data.show)})}}).filter("parseUrlFilter",function(){var n=/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/gi;return function(e,t){return console.log("text in parseUrlFilter:",e),-1===e.indexOf("<img")?e.replace(n,'<a target="'+t+'" href="$&">$&</a>'):e}}),angular.module("scalearAngularApp").directive("autoFillSync",["$timeout",function(r){return{require:"ngModel",link:function(e,t,n,a){var i=t.val();r(function(){var e=t.val();a.$pristine&&i!==e&&a.$setViewValue(e)},500)}}}]).directive("format",["$filter",function(i){return{require:"?ngModel",link:function(e,t,n,a){a&&a.$formatters.unshift(function(e){return i("formattime")(a.$modelValue,n.format)})}}}]).directive("profileImage",["$window",function(e){return{replace:!0,restrict:"E",scope:{email:"=",imagesize:"@",background:"@"},templateUrl:"/views/profile_image.html",link:function(e,t){e.$watch("email",function(){e.email?e.source_image="https://www.gravatar.com/avatar/"+md5(e.email)+"?s="+e.imagesize+"&r=pg&default=https%3A%2F%2Fs.gravatar.com%2Favatar%2F7b2c0c5390921bbccd4818d0cf4bcb71%3Fs%3D"+e.imagesize+"%26r%3Dpg":e.source_image="https://www.gravatar.com/avatar/000000000?s="+e.imagesize+"&r=pg&default=https%3A%2F%2Fs.gravatar.com%2Favatar%2F7b2c0c5390921bbccd4818d0cf4bcb71%3Fs%3D"+e.imagesize+"%26r%3Dpg"})}}}]).directive("contextMenu",["$window","$log",function(o,s){return{restrict:"A",link:function(n,a,e){var i=angular.element(a.find("."+e.target));i.css("position","fixed"),i.css("cursor","pointer");var r=function(){n.opened=!1,angular.element(".open").removeClass("open").css("display","none"),angular.element(o).add(a).off("click")};a.bind("contextmenu",function(t){n.$apply(function(){var e;t.preventDefault(),t.stopPropagation(),e=t,r(),n.opened=!0,i.css("width","10%"),i.css("top",e.clientY+5+"px"),i.css("left",e.clientX-10+"px"),i.css("zIndex",1e4),i.addClass("open"),i.css("display","block"),angular.element(o).add(a).on("click",function(e){s.debug(e),n.opened&&n.$apply(function(){e.preventDefault(),e.stopPropagation(),r()})})})})}}}]).directive("teacherCourseItem",["ErrorHandler",function(e){return{restrict:"E",scope:{course:"=",teachers:"=",deletecourse:"=",filterteacher:"=",currentuser:"="},templateUrl:"/views/teacher/course_list/teacher_course_item.html",link:function(e){}}}]).directive("courseItem",["ErrorHandler",function(e){return{replace:!0,restrict:"E",scope:{course:"=",teachers:"=",unenroll:"="},templateUrl:"/views/student/course_list/student_course_item.html",link:function(e){}}}]).directive("userItem",["ErrorHandler",function(e){return{replace:!0,restrict:"E",scope:{user:"=",select:"=",emailsingle:"=",removestudent:"=",deletemode:"="},templateUrl:"/views/user_item.html",link:function(e){e.toggleSelect=function(){e.select(e.user)}}}}]).directive("announcementItem",["ErrorHandler",function(e){return{restrict:"E",scope:{announcement:"=",saveannouncement:"=",showannouncement:"=",hideannouncement:"=",deleteannouncement:"=",saving:"=",index:"="},templateUrl:"/views/announcementItem.html",link:function(e){}}}]).directive("screenfull",function(){return{restrict:"A",scope:{active:"="},link:function(e,t,n){e.$watch("active",function(){screenfull.enabled&&(e.active?screenfull.request(angular.element(t)[0]):screenfull.exit())})}}}).directive("enrollmentModal",["$modal",function(n){return{restrict:"A",replace:!0,link:function(e,t){e.open=function(){angular.element(".button").blur(),n.open({templateUrl:"/views/student/course_list/enroll_modal.html",controller:"StudentEnrollModalCtrl"})}}}}]).directive("calendarModal",["$modal",function(n){return{restrict:"A",replace:!0,link:function(e,t){e.openCalendar=function(){angular.element(".button").blur(),n.open({templateUrl:"/views/student/calendar/calendar.html",controller:"CalendarModalCtrl"})}}}}]).directive("enrollHelpModal",["$modal","UserSession","$location",function(n,a,i){return{restrict:"A",replace:!0,link:function(t,e){t.openHelpModal=function(e){a.getCurrentUser().then(function(e){t.current_user=e}),t.course=e,t.enrollment_url=i.absUrl().split("courses")[0]+"courses/enroll?id="+t.course.unique_identifier,t.enrollment_url_guest=i.absUrl().split("courses")[0]+"courses/enroll?id="+t.course.guest_unique_identifier,t.copySuccess=function(e){$("#enrollment_message, #enrollment_message li").children().animate({color:"#428bca"},"fast").delay(300).animate({color:"black"},"fast",function(){e.clearSelection()})},t.copyError=function(e){},n.open({templateUrl:"/views/teacher/course/help_enroll.html",controller:["$scope","$modalInstance",function(e,t){e.close=function(){t.dismiss()}}],scope:t})}}}}]).directive("embedSrc",function(){return{restrict:"A",link:function(e,t,n){var a=t;e.$watch(function(){return n.embedSrc},function(){var e=t.clone().attr("src",n.embedSrc);a.replaceWith(e),a=e})}}}).directive("ngAutoExpand",function(){return{restrict:"A",link:function(e,n,t){n.bind("keyup",function(e){var t=e.target;$(t).height(0);var n=$(t)[0].scrollHeight;n<20&&(n=28),$(t).height(n-8)}),setTimeout(function(){var e=n;$(e).height(0);var t=$(e)[0].scrollHeight;t<20&&(t=28),$(e).height(t-8)},0)}}}).directive("ngEnter",function(){return function(t,e,n){e.bind("keydown keypress",function(e){13===e.which&&0==e.shiftKey&&(t.$apply(function(){t.$eval(n.ngEnter)}),e.preventDefault())})}}),angular.module("scalearAngularApp").directive("richTextarea",["$timeout",function(p){return{replace:!0,restrict:"EA",template:"<textarea medium-editor bind-options='medium_editor_options' class='medium-editor-textarea' ></textarea>",controller:["$scope","$attrs","$element","$interpolate","ScalearUtils",function(e,t,n,a,i){var r,o=new(MediumEditor.extensions.button.extend({name:"colorPicker",action:"applyForeColor",aria:"color picker",contentDefault:"<span class='editor-color-picker'>Color<span>",init:function(){var e;this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML="<i class='fi-paint-bucket size-18'></i>",e=this.button,$(e).spectrum({allowEmpty:!0,color:"#f00",showInput:!0,showAlpha:!0,showPalette:!0,showInitial:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex3",change:function(e){s(e)},hide:function(e){s(e)},palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]}),this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(e){r=this.base.exportSelection();var t=$(this.base.getSelectedParentElement()).css("color");$(this.button).spectrum("set",t),e.preventDefault(),e.stopPropagation();var n=this.getAction();n&&this.execAction(n)}}));function s(e){var t=e?e.toRgbString():"rgba(0,0,0,0)";o.base.importSelection(r),o.document.execCommand("styleWithCSS",!1,!0),o.document.execCommand("foreColor",!1,t)}var l=MediumEditor.extensions.button.extend({name:"increaseFontSize",action:"fontSize",aria:"increase font size",contentDefault:"+",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML='<b title="increase text size">+</b>',this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.document.queryCommandValue("fontSize")+"";t<8&&this.execAction("fontSize",{value:parseInt(t)+1})}}),u=MediumEditor.extensions.button.extend({name:"decreaseFontSize",action:"fontSize",aria:"decrease font size",contentDefault:"-",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML='<b title="decrease text size">-</b>',this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.document.queryCommandValue("fontSize")+"";1<t&&this.execAction("fontSize",{value:parseInt(t)-1})}}),d=MediumEditor.extensions.button.extend({name:"mathjax",aria:"Math Latex support",contentDefault:"Math",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.classList.add("mathjax-btn"),this.button.title="Use this button to turn on/off equation formatting. Write equations using LaTeX formatting surrounded by $$ (new line) or $ (in-line). For example: $$E=mc^2$$",this.button.innerHTML='<b title="Math Latex">&#8721;</b>',this.on(this.button,"click",this.handleClick.bind(this));var e=this,t=this.base.elements[0];p(function(){$(t).find("span[class*=MathJax]").remove(),MathJax.Hub.Queue(["Rerender",MathJax.Hub,t,function(){c(t),e.setActive()}])})},handleClick:function(e){var t=this,n=this.base.elements[0];this.isActive()?(!function(e){for(var t=MathJax.HTML,n=MathJax.Hub.getAllJax(),a=0,i=n.length;a<i;a++){var r=n[a].SourceElement(),o=-1==r.type.indexOf("mode=display")?"$":"$$",s=o+n[a].originalText+o;n[a].Remove();var l=r.previousSibling,u=r.parentNode,d=t.Element("span",{className:"mathjax_original"},[s]);u.insertBefore(d,l),l&&"MathJax_Preview"===l.className&&u.removeChild(l),u.removeChild(r),$(d).replaceWith(function(){return $(this).text()})}}(),t.setInactive()):MathJax.Hub.Queue(["Typeset",MathJax.Hub,n,function(){c(n),t.setActive(),$(".mathjax-btn").tooltip(t.isActive()?"destroy":"show")}]),e.preventDefault(),e.stopPropagation(),this.base.trigger("editableInput",{},n)},isActive:function(){var e=this.base.options.activeButtonClass;return this.button.classList.contains(e)},setInactive:function(){if(0==MathJax.Hub.getAllJax(this.base.elements[0]).length){var e=this.base.options.activeButtonClass;this.button.classList.remove(e)}},setActive:function(){if(0<MathJax.Hub.getAllJax(this.base.elements[0]).length){var e=this.base.options.activeButtonClass;this.button.classList.add(e)}}});function c(e){for(var t=MathJax.Hub.getAllJax(e),n=0;n<t.length;n++){var a=$("<span contenteditable='false'></span>").css({width:"100%",height:"100%",background:"rgba(0, 0, 0, 0)",position:"absolute"});$("#"+t[n].inputID+"-Frame").css("outline","none").prepend(a)}}var _=MediumEditor.extensions.button.extend({name:this.name,init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML=this.buttonInnerHTML,this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(e){var t=this.base.options.contentWindow.getSelection().baseNode.children[0],n=angular.element(t);n.addClass(this.imageSize),1==this.base.elements[0].childElementCount&&(n[0].outerHTML=" "),this.execAction("insertHTML",{value:n[0].outerHTML})},isActive:function(){var e=this.base.options.activeButtonClass;return this.button.classList.contains(e)},setInactive:function(){var e=this.base.options.activeButtonClass;this.button.classList.remove(e)},setActive:function(){var e=this.base.options.activeButtonClass;this.button.classList.add(e)}}),m=MediumEditor.extensions.button.extend({name:"customImage",tagNames:["img"],action:"image",aria:"image support",contentDefault:"Image",init:function(){var n=this.base;this.base.elements[0];this.base.subscribe("editableClick",function(e,t){console.log(e),"IMG"===e.target.tagName&&n.selectElement(e.target.parentNode)}),this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML="<i class='fi-photo'><i>",this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(e){var t=this.base;this.base.elements[0];if(this.isActive()){this.setInactive();var n=t.options.contentWindow.getSelection().baseNode.children[0].getAttribute("src");this.execAction("insertHTML",{value:n})}else{this.setActive();var a=this.setImageHtmlElement();this.execAction("insertHTML",{value:a});var i=this.base.options.contentWindow.getSelection().baseNode,r=new MediumEditor(i,{toolbar:{buttons:["small","medium","large","veryLarge","original"]},extensions:{small:new _({name:"small",imageSize:"small_img",buttonInnerHTML:'<b title="Size 1">Small</b>'}),medium:new _({name:"medium",imageSize:"medium_img",buttonInnerHTML:'<b title="Size 2">Medium</b>'}),large:new _({name:"large",imageSize:"large_img",buttonInnerHTML:'<b title="Size 3">Large</b>'}),veryLarge:new _({name:"veryLarge",imageSize:"veryLarge_img",buttonInnerHTML:'<b title="Size 4">Very Large</b>'}),original:new _({name:"original",imageSize:"original",buttonInnerHTML:'<b title="Original">original</b>'})}});r.selectElement(i),r.subscribe("hideToolbar",function(){r.destroy()});var o=r.getExtensionByName("toolbar").getToolbarElement();o.style.width="auto",o.classList.remove("medium-toolbar-arrow-under"),o.classList.add("medium-size-toolbar-arrow-under")}e.preventDefault(),e.stopPropagation()},setImageHtmlElement:function(){var e=this.base,t=this.base.elements[0],n=e.options.contentWindow.getSelection().toString().trim(),a=e.options.contentWindow.getSelection(),i="<img class='medium-editor-element' src="+n+"></img>";if(1==t.childElementCount)if(0!=a.getRangeAt(e).startOffset||a.baseNode.previousSibling){var r=t.innerText;this.rewriteMediumEditorContent(r,n)}else i="<div><p class='medium-editor-element'>"+i+"</p></div>";else(0!=a.getRangeAt(this.base.getSelectedParentElement()).startOffset||a.baseNode.previousSibling)&&this.rewriteSelectedElementParentContent(n);return i},rewriteSelectedElementParentContent:function(e){var t=this.base.getSelectedParentElement().innerText.split(e);t.splice(1,0,e);var n="";for(var a in t)t[a]&&(n+="<p class='medium-editor-p'>"+t[a]+"</p>");this.base.getSelectedParentElement().innerHTML=n,this.base.selectElement(this.base.getSelectedParentElement().children[1])},rewriteMediumEditorContent:function(e,t){this.base.saveSelection();var n=e.split(t);n.splice(1,0,t);var a="";for(var i in n)n[i]&&(a+="<p class='medium-editor-p'>"+n[i]+"</p>");this.base.setContent(a),this.base.restoreSelection()},isAlreadyApplied:function(e){return e.firstChild?"IMG"===e.firstChild.nodeName:"IMG"===e.nodeName},isActive:function(){var e=this.base.options.activeButtonClass;return this.button.classList.contains(e)},setInactive:function(){var e=this.base.options.activeButtonClass;this.button.classList.remove(e)},setActive:function(){var e=this.base.options.activeButtonClass;this.button.classList.add(e)}});e.medium_editor_options={toolbar:{buttons:["bold","italic","underline","strikethrough","subscript","superscript","increaseFontSize","decreaseFontSize","colorPicker",{name:"anchor",contentDefault:"<i class='fi-link size-18'></i>"},"anchor","quote","pre",{name:"orderedlist",contentDefault:"<i class='fi-list-number size-22' style='line-height:0'></i>"},{name:"unorderedlist",contentDefault:"<i class='fi-list-bullet size-22' style='line-height:0'></i>"},"justifyLeft","justifyCenter","justifyRight","mathjax","removeFormat","customImage"]},placeholder:!!t.placeholder&&{text:a(t.placeholder)()},paste:{cleanPastedHTML:!0,forcePlainText:!1},extensions:{colorPicker:o,increaseFontSize:new l,decreaseFontSize:new u,mathjax:new d,customImage:new m},disableReturn:!1}}]}}]),angular.module("scalearAngularApp").directive("teacherModuleSummary",["ScalearUtils","$filter","$translate","$state","CourseEditor",function(r,o,s,l,u){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/teacher/progress/teacher_module_summary.html",link:function(i,e){var t=i.$watch("moduledata.duration",function(e){if(e){i.moduledata.hour_min=r.toHourMin(i.moduledata.duration),i.moduledata.time_left_string=r.toHourMin(i.moduledata.due_date).split(":")[0],i.moduledata.due_date_enabled=!u.isDueDateDisabled(i.moduledata.due_date_string),i.subtitle=i.moduledata.hour_min+" "+s.instant("time.hours")+", "+i.moduledata.quiz_count+" "+s.instant("global.quizzes")+", "+i.moduledata.survey_count+" "+s.instant("global.surveys")+". ",i.moduledata.due_date_enabled?i.subtitle+=s.instant("events.due")+" "+o("date")(new Date(i.moduledata.due_date_string),"dd-MMMM-yyyy")+" "+s.instant("global.at")+" "+o("date")(new Date(i.moduledata.due_date_string),"HH:mm")+".":i.subtitle+=s.instant("global.no")+" "+s.instant("editor.details.due_date");var n={on_time:{text:s.instant("dashboard.ontime"),color:"#16A53F"},late:{text:s.instant("events.late"),color:"#E66726"},incomplete:{text:s.instant("dashboard.incomplete"),color:"#a4a9ad"},completed:{text:s.instant("dashboard.complete"),color:"#16A53F"},more_than_50:{text:s.instant("dashboard.more_than")+" 50%",color:"#1bca4d"},less_than_50:{text:s.instant("dashboard.less_than")+" 50%",color:"#F5C09E"},not_watched:{text:s.instant("dashboard.not_started"),color:"#a4a9ad"},completed_late:{text:s.instant("events.late"),color:"#1bca4d"},more_than_80:{text:s.instant("dashboard.more_than")+" 80%",color:"#E66726"},between_50_80:{text:s.instant("dashboard.between")+" 50% & 80%",color:"#800000"}},a=[];Object.keys(i.moduledata.students_completion).forEach(function(e){var t={name:n[e].text,data:[i.moduledata.students_completion[e]],color:n[e].color};a.push(t)}),i.student_completion_chart_config={options:{chart:{type:"bar",margin:[0,0,10,0],spacing:[0,0,0,0]},plotOptions:{series:{stacking:"normal"}},legend:{enabled:!1},tooltip:{formatter:function(){return'<b style="color:'+this.series.color+'">'+this.series.name+"</b> ("+this.y+" of "+i.moduledata.students_count+")"},positioner:function(e,t,n){var a=n.plotX-n.h,i=n.plotX,r=a+(i-a)/2-e/2;return r<0?r=0:i<r+e&&(r=i-e-5),{x:r,y:n.plotY+10}}}},size:{height:50},title:{text:null},xAxis:{categories:null,gridLineWidth:0,labels:{enabled:!1},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,labels:{enabled:!1},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,min:0,max:i.moduledata.students_count},series:a},t()}});i.goTo=function(e,t,n,a){l.go(e,{course_id:t,module_id:n,item_id:a})}}}}]).directive("teacherOnlineQuizSummary",["$state","$compile","$timeout","$rootScope","$translate",function(d,c,_,m,p){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/teacher/progress/teacher_online_quiz_summary.html",link:function(s,e){s.width_online_quiz=100,s.tooltip_template_click_hover="hover";var i={never_tried:{name:p.instant("dashboard.never_tried"),data:[],color:"#a4a9ad"},survey_solved:{name:p.instant("dashboard.solved"),data:[],color:"#355BB7"},not_checked:{name:p.instant("dashboard.not_checked"),data:[],color:"#551a8b"},not_correct_many_tries:{name:p.instant("editor.incorrect")+" ("+p.instant("dashboard.final_try")+")",data:[],color:"#E66726"},not_correct_first_try:{name:p.instant("editor.incorrect")+" ("+p.instant("dashboard.first_try")+")",data:[],color:"#ED9467"},not_correct_quiz:{name:p.instant("editor.incorrect"),data:[],color:"#E66726"},tried_correct_finally:{name:p.instant("editor.correct")+" ("+p.instant("dashboard.final_try")+")",data:[],color:"#1bca4d"},correct_first_try:{name:p.instant("editor.correct")+" ("+p.instant("dashboard.first_try")+")",data:[],color:"#16A53F"},correct_quiz:{name:p.instant("editor.correct"),data:[],color:"#16A53F"},review_vote:{name:p.instant("dashboard.voted_for_review"),data:[],color:"#f5c343"}},r=[],o=s.$watch("moduledata.online_quiz",function(e){if(e){s.moduledata.online_quiz.length<20&&(s.width_online_quiz=5*s.moduledata.online_quiz.length),s.moduledata.online_quiz.forEach(function(n){Object.keys(n).forEach(function(t){r.push("<b>"+n[t].lecture_name+": </b>"+n[t].quiz_name),Object.keys(n[t].data).forEach(function(e){"null"==n[t].data[e]?i[e].data.push(null):"review_vote"==e?(s.review_vote_exist=s.review_vote_exist||0<n[t].data[e],i[e].data.push(-1*n[t].data[e])):n[t].inclass?i[e].data.push({y:n[t].data[e],borderColor:"black",borderWidth:1}):i[e].data.push({y:n[t].data[e]})}),"quiz"==n[t].type?i.survey_solved.data.push(null):(i.not_correct_many_tries.data.push(null),i.not_correct_first_try.data.push(null),i.not_correct_quiz.data.push(null),i.tried_correct_finally.data.push(null),i.correct_first_try.data.push(null),i.correct_quiz.data.push(null),i.not_checked.data.push(null))})});var t={borderColor:"#000000",shared:!0,useHTML:!0,enabled:!0,animation:!0,padding:8,snap:10,backgroundColor:"white",borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"},positioner:function(e,t,n){var a=n.plotX-e/2;return a<0&&(a=0),$("#teacher_completion").width()<n.plotX+e&&(a=$("#teacher_completion").width()-1.025*e),{x:a,y:100}}},n=angular.copy(t);n.formatter=u;var a=angular.copy(t);a.formatter=l,s.quiz_completion_chart_config={options:{chart:{type:"column",events:{load:function(){this.quiz_tooltip=new Highcharts.Tooltip(this,n),this.hover_tooltip=new Highcharts.Tooltip(this,a)}},margin:s.review_vote_exist?[0,0,0,0]:[0,0,30,0]},plotOptions:{series:{stacking:"normal",point:{events:{mouseOver:function(e){this.index!=s.previous_tooltoip&&(s.quiz_completion_chart_config.getHighcharts().quiz_tooltip.hide(0),s.previous_tooltoip=this.index,s.quiz_completion_chart_config.getHighcharts().hover_tooltip.refresh([e.target],e))},mouseOut:function(){s.quiz_completion_chart_config.getHighcharts().hover_tooltip.hide(0),s.quiz_completion_chart_config.getHighcharts().quiz_tooltip.isHidden&&(s.previous_tooltoip=null)}}}},column:{pointWidth:20,borderWidth:0,events:{click:function(e){e.stopPropagation(),this.chart.quiz_tooltip.refresh([e.point],e);var t=this;$(document).click(function(){t.chart.quiz_tooltip.hide(0),s.quiz_completion_chart_config.getHighcharts().hover_tooltip.hide(0),$(document).off("click")})}}}},tooltip:{enabled:!1},legend:{enabled:!1}},size:{height:125},title:{text:null},xAxis:{categories:r,gridLineWidth:0,labels:{enabled:!1},lineColor:"transparent",lineWidth:0,minorGridLineWidth:0,minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,plotLines:[{color:"black",width:1,value:0}],labels:{enabled:!1},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,max:s.moduledata.students_count},series:i},o()}});function l(){return"<div >"+p.instant("dashboard.click_for_information")+"</div>"}function u(){var e=s.moduledata.online_quiz[this.points[0].point.index],t=Object.keys(e)[0],n=e[t],a=n.type,i=[];if(s.quiz_completion_chart_config.getHighcharts().hover_tooltip.hide(0),s.title=this.x,n.inclass&&(s.title="<b>"+p.instant("dashboard.inclass_question")+": </b>"+this.x),n.distance_peer&&(s.title="<b>"+p.instant("dashboard.distance_peer_question")+": </b>"+this.x),s.left="","quiz"==a){s.quiz_only_one_bar_config={options:{chart:{type:"column",spacing:[0,0,0,0],margin:[0,0,1,0]},plotOptions:{series:{stacking:"normal",animation:!1}},legend:{reversed:!0}},size:{width:70,height:0<n.data.review_vote?150:130},title:{text:null},xAxis:{categories:null,gridLineWidth:0,labels:{useHTML:!0,enabled:!1},lineColor:"transparent",lineWidth:0,minorGridLineWidth:0,minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,plotLines:[{color:"black",width:1,value:0}],labels:{enabled:!1}},series:[{showInLegend:!1,name:p.instant("dashboard.never_tried"),data:[n.data.never_tried],color:"#a4a9ad"},{showInLegend:!1,name:p.instant("dashboard.not_checked"),data:[n.data.not_checked],color:"#551a8b"},{showInLegend:!1,name:p.instant("editor.incorrect")+" ("+p.instant("dashboard.final_try")+")",data:[n.data.not_correct_many_tries],color:"#E66726"},{showInLegend:!1,name:p.instant("editor.incorrect")+" ("+p.instant("dashboard.first_try")+")",data:[n.data.not_correct_first_try],color:"#ED9467"},{showInLegend:!1,name:p.instant("editor.incorrect"),data:[n.data.not_correct_quiz],color:"#E66726"},{showInLegend:!1,name:p.instant("editor.correct")+" ("+p.instant("dashboard.final_try")+")",data:[n.data.tried_correct_finally],color:"#1bca4d"},{showInLegend:!1,name:p.instant("editor.correct")+" ("+p.instant("dashboard.first_try")+")",data:[n.data.correct_first_try],color:"#16A53F"},{showInLegend:!1,name:p.instant("editor.correct"),data:[n.data.correct_quiz],color:"#16A53F"},{showInLegend:!1,name:p.instant("dashboard.voted_for_review"),data:[-1*n.data.review_vote],color:"#f5c343"}]},s.left+="<div style='margin-bottom: 26px;'> ",s.quiz_only_one_bar_config.series.forEach(function(e){var t=Math.abs(e.data[0]);"null"==e.data[0]||isNaN(e.data[0])||("Voted for review"==e.name?s.left+="</div><div><b>"+t+"  ("+Math.round(t/s.moduledata.students_count*100)+'%)     <span style="color:'+e.color+'">'+e.name+"</span></b></div>":s.left+="<div><b>"+t+"  ("+Math.round(t/s.moduledata.students_count*100)+'%)     <span style="color:'+e.color+'">'+e.name+"</span></b></div>")});var r="<div class='dashboard' style='width:460px; height:100%'><div ng-bind-html='title' class='row collapse'></div><div class='row collapse' style='width:420px; height:100%'><div class='small-2 columns no-padding'><highchart class='chart' config='quiz_only_one_bar_config'  style='width: 100%;'></highchart></div><div style='padding-top: 40px;' class='small-10 columns'><div ng-bind-html='left' style='font-size:12px'></div></div></div><div ng-show='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButtonReview' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px; color:white;' translate>dashboard.review_quiz</a></div><div ng-hide='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButton' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px;' translate>dashboard.review_quiz</a></div></div>"}else{var o=[];i=[];s.left+="<br/><b>"+this.points[0].y+"  ("+Math.round(this.points[0].percentage)+"%)     <span >"+this.points[0].series.name+"</span></b>",Object.keys(n.answer).forEach(function(e){o.push(n.answer[e]),i.push(e),s.left+="<br/><b>"+n.answer[e]+"  ("+Math.round(n.answer[e]/s.moduledata.students_count*100)+"%)     <span >"+e+"</span></b>"}),s.quiz_only_one_bar_config={options:{chart:{type:"column",spacing:[0,0,0,0],margin:[0,0,1,0]},plotOptions:{series:{stacking:"normal",animation:!1},column:{borderWidth:0}},legend:{reversed:!0}},size:{width:150,height:130},title:{text:null},credits:{enabled:!1},xAxis:{categories:i,gridLineWidth:0,labels:{useHTML:!0,enabled:!1},lineColor:"transparent",lineWidth:0,minorGridLineWidth:0,minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,plotLines:[{color:"black",width:1,value:0}],labels:{enabled:!1}},series:[{showInLegend:!1,data:o,color:"#355BB7"}]};r="<div class='dashboard' style='width:520px; height:100%; min-height:164px'><div ng-bind-html='title' class='row collapse'></div><div class='row collapse' style='width:400px; height:100%'><div class='small-5 columns no-padding'><div id='custom_chart' ></div><highchart class='chart' config='quiz_only_one_bar_config'  style='width: 100%;'>></highchart></div><div style='padding-top: 40px;' class='small-7 columns'><div ng-bind-html='left' style='font-size:12px'></div></div></div><div ng-show='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButtonReview' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px; color:white' translate>dashboard.review_quiz</a></div><div ng-hide='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButton' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px;' translate>dashboard.review_quiz</a></div></div>"}return $("#quiz_bar").html(r),c($("#quiz_bar"))(s),s.$digest(),_(function(){$(".gotToQuizButton").click(function(){s.goTo("course.module.progress",s.moduledata.course_id,s.moduledata.id,"vq_"+t)})}),_(function(){$(".gotToQuizButtonReview").click(function(){m.$broadcast("scroll_to_item_summary","vq_"+t)})}),$("#quiz_bar").html()}s.goTo=function(e,t,n,a){d.go(e,{course_id:t,module_id:n,item_id:a})}}}}]).directive("teacherDiscussionSummary",["$state",function(i){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/teacher/progress/teacher_discussion_summary.html",link:function(e,t){e.goTo=function(e,t,n,a){i.go(e,{course_id:t,module_id:n,item_id:a})}}}}]).directive("studentModuleSummary",["ScalearUtils","$filter","$translate","$state","CourseEditor","ModuleModel",function(a,i,r,o,s,e){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/student/progress/student_module_summary.html",link:function(t){var n=t.$watch("moduledata.due_date_string",function(e){e&&(t.moduledata.hour_min=a.toHourMin(t.moduledata.duration),t.moduledata.time_left_string=a.toHourMin(t.moduledata.due_date).split(":")[0],t.subtitle=t.moduledata.hour_min+" "+r.instant("time.hours")+", "+t.moduledata.quiz_count+" "+r.instant("global.quizzes")+", "+t.moduledata.survey_count+" "+r.instant("global.surveys")+". ",t.next_lecture={},t.next_lecture.type="lecture",-1==t.moduledata.first_lecture?t.continue_button=null:0<t.moduledata.module_done_perc&&t.moduledata.module_done_perc<100&&-1<t.moduledata.last_viewed?(t.continue_button=r.instant("dashboard.continue_watching"),t.next_lecture.id=t.moduledata.last_viewed):100==t.moduledata.module_done_perc&&-1!=t.moduledata.first_lecture?(t.continue_button=r.instant("dashboard.watch_again"),t.next_lecture.id=t.moduledata.first_lecture):0==t.moduledata.module_done_perc&&(t.continue_button=r.instant("dashboard.start_watching"),t.next_lecture.id=t.moduledata.first_lecture),t.moduledata.due_date_enabled=!s.isDueDateDisabled(t.moduledata.due_date_string),t.moduledata.due_date_enabled?t.subtitle+=r.instant("events.due")+" "+i("date")(new Date(t.moduledata.due_date_string),"dd-MMMM-yyyy")+" "+r.instant("global.at")+" "+i("date")(new Date(t.moduledata.due_date_string),"HH:mm")+".":t.subtitle+=r.instant("global.no")+" "+r.instant("editor.details.due_date"),n())});t.goTo=function(e,t,n,a){o.go("course.module.courseware.lecture",{course_id:e,module_id:t,lecture_id:n,time:a},{time:a})},t.goToLectureQuiz=function(e,t,n,a){"lecture"==a?o.go("course.module.courseware.lecture",{course_id:e,module_id:t,lecture_id:n}):o.go("course.module.courseware.quiz",{course_id:e,module_id:t,quiz_id:n})}}}}]).directive("studentOnlineQuizSummary",["ScalearUtils","$translate","$state",function(r,o,s){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/student/progress/student_online_quiz_summary.html",link:function(n){n.online_quiz_color={},n.online_quiz_group_color={};var a="("+o.instant("dashboard.complete_video")+")",i="("+o.instant("dashboard.complete_quiz")+")";n.quiz_completion_data_series={group_never_tried:{name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.group")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.shown_top"),color:"#a4a9ad"},group_survey_solved:{name:o.instant("dashboard.you_solved_group_survey"),color:"#355BB7"},group_not_checked:{name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.group")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.is_not_checked"),color:"#551a8b"},group_tried_not_correct_first:{name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.group")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#ED9467'>"+o.instant("dashboard.incorrect")+"</span>"+o.instant("dashboard.tried_once"),color:"#ED9467"},group_tried_not_correct_finally:{name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.group")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#E66726'>"+o.instant("dashboard.incorrect")+"</span>"+o.instant("dashboard.tried_more_once"),color:"#E66726"},group_tried_correct_finally:{name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.group")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#1bca4d'>"+o.instant("dashboard.correct")+"</span>"+o.instant("dashboard.not_first_try"),color:"#1bca4d"},group_correct_first_try:{name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.group")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#16A53F'>"+o.instant("dashboard.correct")+"</span>"+o.instant("dashboard.on_first_try"),color:"#16A53F"},self_never_tried:{name:o.instant("dashboard.you_not_answered_quiz"),group_name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.individual")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.shown_below"),color:"#a4a9ad"},self_survey_solved:{name:o.instant("dashboard.you")+" <span style='color:#355BB7'>"+o.instant("dashboard.answered_survey")+"</span>.",group_name:o.instant("dashboard.you")+o.instant("dashboard.answered")+" <b>"+o.instant("dashboard.individual")+"<b/> "+o.instant("dashboard.survey")+" ",color:"#355BB7"},self_not_checked:{name:o.instant("dashboard.answered_but_not_checked"),group_name:o.instant("dashboard.answered_but_group")+"<b>"+o.instant("dashboard.invdividual")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.not_checked_group"),color:"#551a8b"},self_not_checked_question:{name:o.instant("dashboard.answered_but_not_checked_question"),color:"#551a8b"},self_tried_not_correct_first:{name:o.instant("dashboard.tried_not_correct_first")+"<span style='color:#ED9467'>"+o.instant("dashboard.tried_not_correct_first_answer")+"</span>.",group_name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.individual")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#ED9467'>"+o.instant("dashboard.incorrect")+"</span>"+o.instant("dashboard.tried_once"),color:"#ED9467"},self_not_correct_question:{name:o.instant("dashboard.self_not_correct_question")+"<span style='color:#ED9467'>"+o.instant("dashboard.tried_not_correct_first_answer")+"</span>.",color:"#E66726"},self_tried_not_correct_finally:{name:o.instant("dashboard.tried_not_correct_last")+"<span style='color:#E66726'>"+o.instant("dashboard.tried_not_correct_first_answer")+"</span>.",group_name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.individual")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#E66726'>"+o.instant("dashboard.incorrect")+"</span>"+o.instant("dashboard.tried_more_once"),color:"#E66726"},self_tried_correct_finally:{name:o.instant("dashboard.answered_correct_but")+"<span style='color:#1bca4d'>"+o.instant("dashboard.not_first_try")+"</span>",group_name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.individual")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#1bca4d'>"+o.instant("dashboard.correct")+"</span>"+o.instant("dashboard.not_first_try"),color:"#1bca4d"},self_correct_first_try:{name:o.instant("dashboard.you_answered")+"<span style='color:#16A53F'>"+o.instant("dashboard.correct")+"</span>"+o.instant("dashboard.on_first_try"),group_name:o.instant("dashboard.your")+" <b>"+o.instant("dashboard.individual")+"</b> "+o.instant("dashboard.answer")+o.instant("dashboard.was")+"<span style='color:#16A53F'>"+o.instant("editor.correct")+"</span>"+o.instant("dashboard.on_first_try"),color:"#16A53F"},self_correct_question:{name:o.instant("dashboard.you_answered")+"<span style='color:#16A53F'>"+o.instant("dashboard.correct")+"</span>.",color:"#16A53F"}};var t=n.$watch("moduledata.remaining_duration",function(e){if(null!=e){n.remaining="Remaining: "+r.toHourMin(n.moduledata.remaining_duration)+" "+o.instant("time.hours")+", "+n.moduledata.remaining_quiz+" "+o.instant("global.quizzes")+", "+n.moduledata.remaining_survey+" "+o.instant("global.surveys")+". ",n.group_width=1/n.moduledata.online_quiz_count*100,n.quiz_completion_bar={width:5*n.moduledata.online_quiz_count},100<n.quiz_completion_bar.width&&(n.quiz_completion_bar.width=100),n.quiz_completion_bar.width+="%",n.online_popover={},n.online_quiz_name={},n.content={},n.lecture_quiz_boolean={};n.moduledata.module_completion.forEach(function(t){t.completion_style={position:"relative",width:t.duration+"%",background:"linear-gradient(to right, #16A53F "+t.percent_finished+"%, #a4a9ad 0%)"},t.item_style={},t.quiz_bar_style={},t.online_quizzes&&(t.item_style.width=n.group_width*t.online_quizzes.length+"%",t.quiz_bar_style.width=100/t.online_quizzes.length+"%",t.online_quizzes.forEach(function(e){n.online_quiz_name[e.id]="<b>"+t.item_name+"</b>: "+e.quiz_name,e.inclass&&(n.online_quiz_name[e.id]="<b>In-Class Question: </b>"+n.online_quiz_name[e.id]),e.distance_peer&&(n.online_quiz_name[e.id]="<b>Distance-Peer Question: </b>"+n.online_quiz_name[e.id]),"lecture"==t.type&&e.required&&("self_never_tried"==e.data[0]&&!e.data[1]||"self_never_tried"==e.data[0]&&"group_never_tried"==e.data[1])&&(n.online_quiz_name[e.id]=a),"quiz"==t.type&&e.required&&"self_never_tried"==e.data[0]&&!e.data[1]&&(n.online_quiz_name[e.id]=i),n.online_quiz_color[e.id]={backgroundColor:n.quiz_completion_data_series[e.data[0]].color},n.content[e.id]=n.quiz_completion_data_series[e.data[0]].name,n.lecture_quiz_boolean[e.id]="lecture"==t.type,n.online_popover[e.id]={title:"<span style='font-size:12px;' ng-bind-html='online_quiz_name[online_quiz.id]' ></span> ",content:"<div ng-bind-html='content[online_quiz.id]' style='margin-bottom: 10px;font-size:12px;'></div><div ng-if='lecture_quiz_boolean[online_quiz.id]'><div ng-if=\"quiz_completion_data_series[online_quiz['data'][0]].color != '#a4a9ad' \" style='font-size:12px;' translate>dashboard.click_retry_quiz</div></div>",html:!0,trigger:"hover",placement:"bottom",container:"#student_popover"},2==e.data.length&&(n.online_quiz_color[e.id]={backgroundColor:n.quiz_completion_data_series[e.data[0]].color},n.online_quiz_group_color[e.id]={backgroundColor:n.quiz_completion_data_series[e.data[1]].color},n.content[e.id]={},n.content[e.id][0]=n.quiz_completion_data_series[e.data[0]].group_name,n.content[e.id][1]=n.quiz_completion_data_series[e.data[1]].name,n.online_popover[e.id].content="<div class='row collapse' style='height: 135px;width: 100%;'><div style='height: 45px;width: 100%;' ><div style='width: 10%;margin-right: 10px;float: left;' ng-style='online_quiz_group_color[online_quiz.id]'  class='quiz-inner-bar'></div><div  ng-bind-html='content[online_quiz.id][1]' style='font-size:12px;'></div></div><div style='height: 45px;width: 100%;margin-top: 2px'><div style='width: 10%;margin-right: 10px;float: left;' ng-style='online_quiz_color[online_quiz.id]'  class='quiz-inner-bar'></div><div  ng-bind-html='content[online_quiz.id][0]' style='font-size:12px;'></div><div ng-if=\"quiz_completion_data_series[online_quiz['data'][0]].color != '#a4a9ad' || quiz_completion_data_series[online_quiz['data'][1]].color != '#a4a9ad'\" style='font-size:12px;' translate>dashboard.click_retry_quiz</div> "),1}))}),t()}});n.lectureTooltip=function(e){e.item_style.border="2px solid #000000",e.completion_style.border="2px solid #000000",e.show_tooltip=!0},n.lectureTooltipLeave=function(e){e.completion_style.border="1px solid #EFE7E7",e.item_style.border="none",e.show_tooltip=!1},n.goTo=function(e,t,n,a,i,r){var o;"lecture"==e?(o="course.module.courseware.lecture",r.required&&"self_never_tried"==r.data[0]||s.go(o,{course_id:t,module_id:n,lecture_id:a,time:i},{time:i})):(o="course.module.courseware.quiz",r.required&&"self_never_tried"==r.data[0]||s.go(o,{course_id:t,module_id:n,quiz_id:a,time:i},{time:i}))},n.goToLectureQuiz=function(e,t,n,a){"lecture"==a?s.go("course.module.courseware.lecture",{course_id:e,module_id:t,lecture_id:n}):s.go("course.module.courseware.quiz",{course_id:e,module_id:t,quiz_id:n})}}}}]).directive("studentDiscussionSummary",["$state",function(i){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/student/progress/student_discussion_summary.html",link:function(e){e.goTo=function(e,t,n,a){i.go("course.module.courseware.lecture",{course_id:e,module_id:t,lecture_id:n,time:a},{time:a})}}}}]),angular.module("scalearAngularApp").directive("appMessages",["ErrorHandler",function(t){return{scope:{server_error:"=serverError"},replace:!0,templateUrl:"/views/app_messages.html",link:function(n,e){t.addToElementList($(e).find(".alert-message")),n.$on("ErrorMessage:show",function(e,t){n.status=t}),n.$on("ErrorMessage:hide",function(){n.status=null})}}}]).directive("errorMessage",["$log",function(e){return{restrict:"E",scope:{column:"@",data:"="},replace:!0,template:"<div ng-if='error' class='errormessage valign-super'>{{error}}</div>",link:function(t){e.debug("in error directive"),t.$watch(function(){if(t.data){var e=t.data[t.column];t.error=e.join()}})}}}]),angular.module("scalearAngularApp").directive("videoContainer",function(){return{transclude:!0,replace:!0,restrict:"E",template:'<div class="videoborder panel widescreen " style="padding:0; border:none; margin:0" ng-transclude></div>'}}).directive("youtube",["$rootScope","$log","$timeout","$window","$cookieStore","$interval","VideoInformation","ScalearUtils",function(h,f,v,e,t,b,y,w){return{transclude:!0,restrict:"E",replace:!0,scope:{url:"=",ready:"&",id:"@",player:"=",autoplay:"@",controls:"@",start:"=",end:"="},template:"<div><div ng-transclude></div></div>",link:function(a,e){a.vq="hd720",a.$on("$destroy",function(){a.kill_popcorn(),a.player={},a.id="",a.ready="",a.url=""});var n,t=[],i={},r={},o=function(e){t.unshift(e)},s=function(e,t,n,a,i,r){var o,s,l=d(e);if(l)o="https://www.youtube.com/watch",s="&v="+l[1];else{var u=e.split("?");o=u[0],s="&"+u[1]}return n&&(s+="&start="+n),a&&(s+="&end="+a),t&&(s+="&vq="+t),o+"?modestbranding=0&showinfo=0&rel=0&autohide=0&playsinline=1&autoplay="+i+"&controls="+r+"&theme=light"+s};a.kill_popcorn=function(){n&&(Popcorn.destroy(n),n.media.destroy&&n.media.destroy()),e.find("iframe").remove(),e.find("video").remove(),a.slow_off&&a.slow_off(),a.timeout_promise&&v.cancel(a.timeout_promise)},i.play=function(){n.play()},i.pause=function(){n.pause()},i.mute=function(){n.mute(),y.volume=0},i.volume=function(e){n.volume(e),y.volume=e},i.unmute=function(){n.unmute(),y.volume=.8},i.paused=function(){return n.paused()},i.getTime=function(){return n.currentTime()-a.start},i.getAbsoluteDuration=function(){var e=n.duration();return a.player.controls.youtube?e-1:e},i.getDuration=function(){return a.end-a.start},i.readyState=function(){return n.readyState()},i.seek=function(e){f.debug("entering sekking",e),(e=parseFloat(e))<0&&(e=0),e>i.getDuration()&&(e=i.getDuration()),i.getDuration()-e<1&&(e=i.getDuration()-1),e+=a.start||0,0==i.readyState()?n.on("loadeddata",function(){v(function(){n.currentTime(e)})}):(f.debug("seeking now",e),n.currentTime(e)),parent.focus()},i.absoluteSeek=function(e){n.currentTime(e)},i.seek_and_pause=function(e){m(a.url)?0==e?i.seek(0):(i.seek(e),n.video.pauseAfterSeek()):(i.seek(e),n.pause())},i.setStartTime=function(e){a.video_start=Math.round(e)},i.setEndTime=function(e){a.video_end=Math.round(e)},i.getStartTime=function(){return a.video_start},i.getEndTime=function(){return a.video_end},i.setVideoStartTime=function(e){a.start=Math.round(e)},i.setVideoEndTime=function(e){a.end=Math.round(e)},i.getVideoStartTime=function(){return a.start},i.getVideoEndTime=function(){return a.end},i.refreshVideo=function(){f.debug("refreshVideo!"),a.kill_popcorn(),function(){if(a.kill_popcorn(),i.youtube=!1,a.controls&&null!=a.controls||(a.controls=0),a.autoplay&&null!=a.autoplay||(a.autoplay=0),h.is_mobile&&(a.autoplay=1),u(a.url)){i.youtube=!0;var e=Popcorn.HTMLYouTubeVideoElement("#"+a.id);f.debug("youtube"),n=Popcorn(e),e.src=s(a.url,a.vq,a.video_start||a.start,a.video_end||a.end,a.autoplay,a.controls),f.debug(e.src)}else c(a.url)?(f.debug("vimeo"),(n=Popcorn.smart("#"+a.id,a.url+"?autoplay=true&controls=0&portrait=0&byline=0&title=0&fs=0",{width:"100%",height:"100%",controls:0})).controls(a.controls),n.autoplay(a.autoplay)):_(a.url)?(f.debug("mp4"),e=Popcorn.HTMLVideoElement("#"+a.id),n=Popcorn(e,{}),e.src=a.url,n.video.className="fit-inside",(h.is_mobile||"default"==a.controls)&&n.controls(!0),n.autoplay(!1)):p(a.url)?(f.debug("mediasite"),e=Popcorn.HTMLMediaSiteVideoElement("#"+a.id),n=Popcorn(e),e.src=a.url,f.debug(e.src)):m(a.url)&&(e=Popcorn.HTMLKalturaVideoElement("#"+a.id),n=Popcorn(e),e.src=a.url,i.kaltura=!0,i.setKcontrolBar());a.player&&(a.player.element=n),l(),parent.focus(),a.timeout_promise=b(function(){0!=i.readyState()||h.is_mobile||a.$emit("slow",u(a.url))},15e3,1)}()},i.hideControls=function(){n.controls(!1)},i.cue=function(e,t){return n.cue(e,t),i.getLastCueEvent()},i.getLastCueEvent=function(){return n.getTrackEvent(n.getLastTrackEventId())},i.removeTrackEvent=function(e){n.removeTrackEvent(e)},i.getTrackEvents=function(){return n.getTrackEvents()},i.removeAllTrackEvents=function(){n.getTrackEvents().forEach(function(e){n.removeTrackEvent(e.id)})},i.replay=function(){i.pause(),i.seek(0),i.play()},i.getSpeeds=function(){return n.media.getSpeeds()},i.changeSpeed=function(e){a.player.controls.youtube||a.player.controls.kaltura?-1!=i.getSpeeds().indexOf(e)&&n.media.setSpeed(e):n.video.playbackRate=e,y.speed=e},i.getAvailableQuality=function(){return n.media.getAvailableQuality()},i.getQuality=function(){return n.media.getQuality()},i.changeQuality=function(e){if(-1!=i.getAvailableQuality().indexOf(e)&&i.getQuality()!=e){var t=i.paused();n.media.setQuality(e),t&&i.pause()}y.quality=e},i.setKcontrolBar=function(){a.controls?o(n.video.showControlBar):o(n.video.hideControlBar)};var l=function(){n.on("loadeddata",function(){f.debug("Video data loaded and ready"),h.is_mobile&&n.controls(!1),r.onReady&&(r.onReady(),w.safeApply());var e=i.youtube?i.getDuration():i.getAbsoluteDuration();y.setDuration(e),function(){for(var e=t.length;e--;)t[e]()}()}),n.on("playing",function(){f.debug("youtube playing"),parent.focus(),r.onPlay&&(r.onPlay(),w.safeApply())}),n.on("pause",function(){parent.focus(),r.onPause&&(r.onPause(),a.$apply())}),n.on("timeupdate",function(){r.timeUpdate&&(r.timeUpdate(),a.$apply())}),n.on("loadedmetadata",function(){parent.focus(),r.onMeta&&(r.onMeta(),w.safeApply())}),n.on("canplay",function(){parent.focus(),r.canPlay&&(r.canPlay(),a.$apply())}),n.on("seeking",function(){parent.focus(),r.seeking&&(r.seeking(),a.$apply())}),n.on("seeked",function(){parent.focus(),r.seeked&&(r.seeked(),a.$apply())}),n.on("waiting",function(){parent.focus(),r.waiting&&(r.waiting(),a.$apply())}),n.on("ended",function(){parent.focus(),r.onEnd&&(r.onEnd(),a.$apply())}),a.slow_off=a.$on("slow",function(e,t){parent.focus(),r.onSlow&&r.onSlow(t)})};h.$on("refreshVideo",function(){i.refreshVideo()});var u=function(e){var t=e||a.url||"",n=t.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)([^\s&]{11})/);return n||t.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)?([^\s&]{11})/)},d=function(e){return(e||a.url||"").match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)?\.be\/([^\s&]{11})/)},c=function(e){return(e||a.url||"").match(/vimeo/)},_=function(e){return(e||a.url||"").match(/(.*mp4$)/)},m=function(e){var t;if(e)return e.match('src=(.*)[a-z]"')&&(t=e.match('src=(.*)[a-z]"')[0]),(t||a.url.split(" ")[1]||"").match(/https?:\/\/.*\/[a-zA-Z]+\/[0-9]+\/[a-zA-Z]+\/[0-9]+00\/[a-zA-Z]+\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+).*&entry_id=(.+)[a-z]*\&flashvars(&.*)?/)},p=function(e){return(e||a.url||"").match(/^(http|https):\/\/.*(\/Play\/)/)};i.isYoutube=u,i.isMP4=_,i.isKaltura=m,a.$watch("url",function(){a.url&&(u(a.url)&&a.url.match(/^(http|https):\/\/www\.youtube\.com\/watch\?v=[^\s]{11}[\W\w]*$/)||c(a.url)||_(a.url)||m(a.url)||p(a.url))&&i.refreshVideo()});var g=a.$watch("player",function(){a.player&&(a.player.controls=i,a.player.events&&(r=a.player.events),a.player.element=n,a.$emit("player ready"),g())})}}}]).directive("resizableVideo",["$window","$rootScope","$timeout","$log",function(_,m,e,p){return{restrict:"A",scope:{container:"=",quiz_layer:"=quizLayer",video_layer:"=videoLayer",aspect_ratio:"=aspectRatio",fullscreen:"=active",resize:"=",max_width:"=maxWidth"},link:function(c,e){c.resize.small=function(){c.fullscreen=!1,angular.element("body").css("overflow",""),angular.element("body").css("position","");var e={top:"",left:"",position:"",width:"",height:"","z-index":0},t=angular.copy(e);c.container&&angular.extend(c.container,e),c.video_layer&&angular.extend(c.video_layer,t),c.quiz_layer&&angular.extend(c.quiz_layer,{position:"absolute","margin-left":"0px","margin-top":"0px","z-index":1,width:"100%",height:"100%",top:"0px",left:"0px"}),c.unregister_back_event&&c.unregister_back_event(),c.unregister_state_event&&c.unregister_state_event()},c.resize.big=function(){p.debug("resizing big");var e="smallscreen"==c.aspect_ratio?4/3:16/9,t=angular.element(_);if(c.fullscreen=!0,angular.element("body").css("overflow","hidden"),angular.element("body").css("position","fixed"),m.is_mobile)var n=70,a=t.height(),i=t.width();else n=80,a=screen.height,i=screen.width;t.scrollTop("0px");var r={top:0,left:0,position:"fixed",width:i-c.max_width,height:a,"z-index":1031},o=angular.copy(r);o.height-=n,o.width="auto",o.position="";var s=o.height,l=s*e,u={};if(l>i-c.max_width){p.debug("width cutt offff");var d=(a-n-(s=1*(i-c.max_width)/e))/2;u={position:"fixed",top:0,left:0,width:i-c.max_width,height:s,"margin-top":d+"px","margin-left":"0px"}}else{p.debug("height cutt offff"),p.debug(i),p.debug(l),p.debug((i-c.max_width-l)/2),u={position:"fixed",top:0,left:0,width:l,height:s,"margin-left":(i-c.max_width-l)/2+"px","margin-top":"0px"}}c.container&&angular.extend(c.container,r),c.video_layer&&angular.extend(c.video_layer,o),c.quiz_layer&&angular.extend(c.quiz_layer,u)}}}}]).directive("progressBar",["$rootScope","$log","$window","$cookieStore","$timeout","VideoQuizModel","$filter","VideoInformation","ScalearUtils",function(m,p,e,g,h,f,v,b,y){return{transclude:!0,restrict:"E",replace:!1,scope:{player:"=",seek:"&",timeline:"=",role:"&",editing:"="},templateUrl:"/views/progress_bar.html",link:function(o,e,t){o.user_role=o.role();var n=o.player.element,a=angular.element(".progressBar"),i=(e.find(".playhead"),e.find(".elapsed"),!1);o.progress_bar=$(".progressBar"),o.progress_width=o.progress_bar.width(),o.current_time=0,o.volume_class="mute",o.quality=!1,o.chosen_quality="hd720",o.chosen_speed=1,o.is_mobile=m.is_mobile,h(function(){o.duration=o.player.controls.getDuration(),o.video={start_time:o.player.controls.getVideoStartTime(),end_time:o.player.controls.getVideoEndTime()},o.$watch("editing",function(){"video"==o.editing?(o.video.start_time=o.player.controls.getVideoStartTime(),o.video.end_time=o.player.controls.getVideoEndTime(),o.duration=o.player.controls.getAbsoluteDuration()):o.duration=o.player.controls.getDuration()}),o.is_mobile&&h(function(){document.getElementsByClassName("progressBar")[0].addEventListener("touchstart",o.playHeadMouseDown,!0)})});var r=function(){if("video"==o.editing)$(".squarebrackets_left").css("left",o.video.start_time/o.duration*100+"%"),$(".squarebrackets_right").css("left",o.video.end_time/o.duration*100+"%"),$(".repeating_green_pattern").css("left",o.video.start_time/o.duration*100+"%");else if("quiz"==o.editing){var e=f.getSelectedVideoQuiz();e&&($(".squarebrackets_left").css("left",e.start_time/o.duration*100+"%"),$(".squarebrackets_right").css("left",e.end_time/o.duration*100+"%"),$(".quiz_circle").css("left",e.time/o.duration*100-.51+"%"),$(".repeating_grey_pattern").css("left",e.start_time/o.duration*100+"%"),$(".repeating_orange_pattern").css("left",e.time/o.duration*100+"%"))}};$(window).resize(r),m.$on("details_navigator_change",r),o.play_class=o.is_mobile?"pause":"play",o.quality_names={auto:"Auto",tiny:"144p",small:"240p",medium:"360p",large:"480p",hd720:"720p (HD)",hd1080:"1080p (HD)",highres:"High"},o.setSpeed=function(e){p.debug("setting youtube speed to "+e),o.player.controls.changeSpeed(e),o.chosen_speed=e,g.put(o.player.controls.youtube?"youtube_speed":"mp4_speed",o.chosen_speed)},o.showPlayhead=function(e){o.playhead_timeout&&h.cancel(o.playhead_timeout),o.playhead_class="playhead_big"},o.hidePlayhead=function(e){i||(o.playhead_timeout=h(function(){o.playhead_class="",o.playhead_timeout=null,o.$apply()},1e3))},o.playHeadMouseDown=function(e){i=!0,o.is_mobile?(o.showPlayhead(),window.addEventListener("touchmove",o.moveplayhead,!0),window.addEventListener("touchend",o.playHeadMouseUp,!0)):(window.addEventListener("mousemove",o.moveplayhead,!0),window.addEventListener("mouseup",o.playHeadMouseUp,!0))},o.playHeadMouseUp=function(e){1==i&&(i=!1,o.is_mobile?(o.hidePlayhead(),window.removeEventListener("touchmove",o.moveplayhead,!0),window.removeEventListener("touchend",o.playHeadMouseUp,!0)):(window.removeEventListener("mousemove",o.moveplayhead,!0),window.removeEventListener("mouseup",o.playHeadMouseUp,!0)),o.progressSeek(e)),o.$apply()},o.moveplayhead=function(e){var t=(e.pageX-a.offset().left)/a.outerWidth(),n=100*t-.51;0<=n&&n<=100&&(o.elapsed_head=99.4<n?99.4:n,o.elapsed_width=n+.45,o.current_time=o.duration*t),n<0&&(o.elapsed_head=0,o.elapsed_width=0,o.current_time=0),100<n&&(o.elapsed_head=99.4,o.elapsed_width=100,o.current_time=o.duration),o.seek()(o.current_time),o.$apply()},o.play=function(){o.player.controls.paused()?(o.player.controls.play(),o.play_class="pause"):(o.player.controls.pause(),o.play_class="play")},o.rewind=function(){var e=o.player.controls.getTime();o.seek()(e-10)},o.fastForward=function(){var e=o.player.controls.getTime();o.seek()(e+10)},o.muteToggle=function(){"mute"==o.volume_class?o.mute():o.unmute()},o.loadCaptionTracks=function(){o.captionTracks||(o.captionTracks=n.video.getCaptionTracks())},o.setCaptionTrack=function(e){o.selectedCaptionTrack=e,n.video.setCaptionTrack(e),g.put("captionTrack",o.selectedCaptionTrack)};var s=o.$watch("volume",function(){o.volume&&(g.put("volume",o.volume),0!=o.volume?("unmute"==o.volume_class&&o.player.controls.unmute(),o.volume_class="mute"):o.volume_class="unmute",o.player.controls.volume(o.volume))});o.mute=function(){o.player.controls.mute(),o.volume_class="unmute",o.volume=0,g.put("volume",o.volume)},o.unmute=function(){o.player.controls.unmute(),o.volume_class="mute",o.volume=.8,g.put("volume",o.volume)},o.progressSeek=function(e){if(!o.skip_progress_seek||"quiz"!=o.editing){var t=angular.element(".progressBar"),n=(e.pageX-t.offset().left)/t.outerWidth();o.seek()(o.duration*n),_(),o.timeline&&2==o.user_role&&d(o.duration*n)}o.skip_progress_seek=!1},o.showQuality=function(){o.quality=!o.quality},o.setQuality=function(e){o.player.controls.changeQuality(e),o.chosen_quality=e},o.scrollEvent=function(e,t){l(e,t),u(e,t)};var l=function(e,t){$(".student_timeline").scrollToThis("#"+e+"_"+t,{offsetTop:100,duration:350})},u=function(e,t){$("#"+e+"_"+t).animate({backgroundColor:"#ffff99"},"fast"),$("#"+e+"_"+t).animate({backgroundColor:"#ffffff"},2e3)},d=function(e){var t=o.timeline.getNearestEvent(e);t.data&&Math.abs(t.time-e)<=30&&l(t.type,t.data.id)},c=function(e,t,n){var a=o.progress_bar.width(),i=n.time/o.duration*a;t.position.left<i&&angular.element(e.target).toggleClass("squarebrackets_left_hover"),t.position.left>i?angular.element(e.target).toggleClass("squarebrackets_right_hover"):angular.element(e.target).find(".dot_circle").toggleClass("dot_circle_hover"),n.has_start=n.start_time!=n.time,n.has_end=n.end_time!=n.time};o.calculateQuizBoundaries=function(e,t,n){t.position.top=-4;var a=o.progress_bar.width();o.quiz_circle_width=$(".quiz_circle").width(),n.data.start_location=n.data.start_time/o.duration*a,n.data.end_location=n.data.end_time/o.duration*a,n.data.quiz_location=n.data.time/o.duration*a,n.data.has_start=n.data.start_time!=n.data.time,n.data.has_end=n.data.end_time!=n.data.time;var i=o.timeline.getNextByType(n),r=o.timeline.getPrevByType(n);n.data.next_quiz_start=i?i.data.start_time/o.duration*a:a,n.data.prev_quiz_end=r?r.data.end_time/o.duration*a:0,c(e,t,n.data)},o.calculateQuizTime=function(e,t,n){t.position.top=-4;var a=o.quiz_circle_width;t.position.left>n.data.end_location-a&&(n.data.has_end?t.position.left=n.data.end_location-a:t.position.left=n.data.quiz_location-6),t.position.left<n.data.start_location+1&&(n.data.has_start?t.position.left=n.data.start_location+1:t.position.left=n.data.quiz_location-6),n.time=(t.position.left+6)/o.progress_bar.width()*o.duration,n.data.time=(t.position.left+6)/o.progress_bar.width()*o.duration,n.data.hide_quiz_answers=!1,m.$broadcast("show_quiz_background",n.data),n.data.formatedTime=v("format")(n.data.time),o.seek()(n.data.time)},o.calculateStartQuizTime=function(e,t,n){t.position.top=-4;var a=o.quiz_circle_width/2+1;t.position.left>n.quiz_location-a&&(t.position.left=n.quiz_location-a),t.position.left<n.prev_quiz_end+5&&(t.position.left=n.prev_quiz_end+5),n.start_time=t.position.left/o.progress_bar.width()*o.duration,n.hide_quiz_answers=!0,m.$broadcast("hide_quiz_background"),o.seek()(n.start_time)},o.calculateEndQuizTime=function(e,t,n){t.position.top=-4;var a=o.quiz_circle_width/2+1;t.position.left>n.next_quiz_start-5&&(t.position.left=n.next_quiz_start-5),t.position.left<n.quiz_location+a&&(t.position.left=n.quiz_location+a),n.end_time=t.position.left/o.progress_bar.width()*o.duration,n.hide_quiz_answers=!0,m.$broadcast("hide_quiz_background"),o.seek()(n.end_time)},o.cleanUpDrag=function(e,t,n){c(e,t,n.data)},o.calculateVideoBoundaries=function(e,t){t.position.top=-4;var n=o.progress_bar.width();o.video.start_location=o.video.start_time/o.duration*n,o.video.end_location=o.video.end_time/o.duration*n,o.video.progress_width=n},o.calculateVideoStartTime=function(e,t){t.position.top=-4;t.position.left<0&&(t.position.left=0),t.position.left>o.video.end_location-25&&(t.position.left=o.video.end_location-25),o.video.start_time=t.position.left/o.video.progress_width*o.duration,o.player.controls.setVideoStartTime(o.video.start_time),o.player.controls.absoluteSeek(o.video.start_time)},o.calculateVideoEndTime=function(e,t){t.position.top=-4;t.position.left<o.video.start_location+25&&(t.position.left=o.video.start_location+25),t.position.left>o.video.progress_width&&(t.position.left=o.video.progress_width),o.video.end_time=t.position.left/o.video.progress_width*o.duration,o.player.controls.setVideoEndTime(o.video.end_time),o.player.controls.absoluteSeek(o.video.end_time)},o.seekToQuiz=function(e){e.hide_quiz_answers=!1,o.skip_progress_seek=!0,o.seek()(e.time),o.player.controls.pause(),m.$broadcast("show_quiz_background",e)},o.showQuiz=function(e){o.seekToQuiz(e),m.$broadcast("show_online_quiz",e)};var _=function(){o.timeline.items.forEach(function(e){e.data&&e.data.selected&&(e.data.hide_quiz_answers=!0)}),m.$broadcast("hide_quiz_background")};s=o.$watch("volume",function(){o.volume&&(o.player.controls.volume(o.volume),0!=o.volume?o.volume_class="mute":o.volume_class="unmute")});n.on("timeupdate",function(){0==i&&"video"!=o.editing&&(o.current_time=o.player.controls.getTime(),b.current_time=o.current_time,o.elapsed_width=o.current_time/o.duration*100,o.elapsed_head=.5<o.elapsed_width?o.elapsed_width-.45:0,o.elapsed_head=99.4<o.elapsed_head?99.4:o.elapsed_head),o.$apply()}),n.on("pause",function(){o.play_class="play",y.safeApply()}),n.on("playing",function(){o.player.controls.youtube&&(o.chosen_quality=o.player.controls.getQuality()),o.play_class="pause",y.safeApply()}),o.player.controls.youtube||o.player.controls.kaltura?(g.get("captionTrack")&&o.setCaptionTrack(g.get("captionTrack")),o.speeds=o.player.controls.getSpeeds(),o.chosen_speed=g.get("youtube_speed")||1,null!=g.get("volume")?(o.volume=g.get("volume"),o.volume||o.mute()):o.volume=.8,o.qualities=["auto","small","medium","large"],h(function(){o.qualities=o.player.controls.getAvailableQuality().reverse()},2e3),o.setQuality(o.chosen_quality)):(o.speeds=[.8,1,1.2,1.5,1.8],o.chosen_speed=g.get("mp4_speed")||1,o.volume=g.get("volume")||.8,o.qualities=["auto"],o.chosen_quality=o.qualities[0]),o.setSpeed(o.chosen_speed),shortcut.add("Space",function(){o.play()},{disable_in_input:!0}),shortcut.add("j",function(){o.rewind(),o.$apply()},{disable_in_input:!0}),shortcut.add("k",function(){o.play(),o.$apply()},{disable_in_input:!0}),shortcut.add("l",function(){o.fastForward(),o.$apply()},{disable_in_input:!0}),shortcut.add("b",function(){var e=o.player.controls.getTime();o.player.controls.pause(),o.player.controls.seek(e-10),o.player.controls.play()},{disable_in_input:!0}),o.$on("$destroy",function(){shortcut.remove("b"),shortcut.remove("Space"),shortcut.remove("j"),shortcut.remove("k"),shortcut.remove("l"),s(),$(window).off("resize",r)})}}}]),angular.module("scalearAngularApp").directive("popOver",["$parse","$compile","$q","$window","$log","$timeout",function(t,l,e,u,d,c){return{restrict:"A",link:function(i,r,o,e){var s=t(o.popOver);i.$watch(o.popOver,function(e){var t=s(i);if(t){r.popover("destroy"),r.popover(t);var n=r.data("popover");if(t.content){o.unique&&r.on("show",function(){$(".popover.in").each(function(){var e=$(this),t=e.data("popover");t&&!t.$element.is(r)&&e.popover("hide")})}),o.highlight&&r.on("show",function(){r.find(".video_link").select()}),n.getPosition=function(){var e=$.fn.popover.Constructor.prototype.getPosition.apply(this,arguments);return l(this.$tip)(i),i.$digest(),this.$tip.data("popover",this),t.displayontop&&angular.element(".popover").css("z-index","999999"),t.topcut&&a(e),t.adjustRight&&(e=t.adjustRight(e,r,angular.element(".popover"))),e};var a=function(e){d.debug("topcut");angular.element(u);var t,n=angular.element(".arrow"),a=r.offset().top;d.debug(a),a<225&&(d.debug(angular.element(".popover").parent().position()),t=angular.element(".popover").parent().position().top+e.height,n.css("top",t+"px"),e.top=angular.element(".popover").height()-angular.element(".popover").height()/4+e.height)};t.instant_show&&c(function(){r.trigger(t.instant_show),t.instant_show=!1}),$(document).on("click",function(e){var t=$(e.target),n=0<t.closest(".popover").length,a=t.is(r);n||a||r.popover("hide")})}}})}}}]),angular.module("scalearAngularApp").directive("mainNavigation",["$state","$tour","scalear_api","$timeout","$cookieStore","$rootScope","Impersonate","ContentNavigator","User","Preview","$log","UserSession",function(n,e,a,i,t,r,o,s,l,u,d,c){return{replace:!0,restrict:"E",transclude:"true",scope:{user:"=",teacher_courses:"=teacherCourses",student_courses:"=studentCourses"},templateUrl:"/views/main_navigation.html",link:function(e,t){e.scalear_api=a,e.lti_embed=-1!=location.hash.indexOf("lti_course_list"),r.$watch("preview_as_student",function(){e.preview_as_student=r.preview_as_student}),e.logout=function(){r.busy_loading=!0,i(function(){c.logout().then(function(){n.go("login"),r.busy_loading=!1})},200)},e.areShared=function(){return e.user&&e.user.accepted_shared},e.getEndDate=function(e,t){return e.setDate(e.getDate()+7*t)},e.goToCourse=function(e,t){e.id!=n.params.course_id&&n.go("course",{course_id:e.id})},e.startTour=function(){d.debug(n.current.name),e.$emit("start_tour",{state:n.current.name})},e.closeMenu=function(e){i(function(){angular.element(".toggle-topbar").click()})},e.disablePreview=function(){u.stop()}}}}]).directive("teacherNavigation",["$rootScope","$state","ContentNavigator","DetailsNavigator","Impersonate","$cookieStore",function(t,a,i,r,e,n){return{replace:!0,restrict:"E",scope:{},templateUrl:"/views/teacher/teacher_sub_navigation.html",link:function(n){n.ContentNavigator=i,n.DetailsNavigator=r,n.$state=a,n.$on("Course:ready",function(e,t){n.course=t}),n.initFilters=function(){n.progress_item_filter={lecture_quizzes:!0,confused:!0,charts:!0,discussion:!0,free_question:!0},n.progress_filter={quiz:!0,survey:!0}},n.toggleNavigator=function(){i.setStatus(!i.getStatus())},n.toggleDetails=function(){r.setStatus(!r.getStatus())};var e;n.goToEditor=function(){a.includes("**.module.**")?a.go("course.module.course_editor.overview"):a.go("course.course_editor")},n.goToProgress=function(){a.includes("**.module.**")?a.go("course.module.progress_overview"):a.go("course.progress_overview")},n.goToClass=function(){a.includes("**.module.**")?a.go("course.module.inclass"):a.go("course.inclass")},n.pasteItem=function(){t.$broadcast("paste_item")},n.print=function(){t.$broadcast("print")},n.updateProgressItemFilter=function(e){"lecture_quizzes"==e&&(n.progress_item_filter.charts=!n.progress_item_filter.lecture_quizzes,n.progress_item_filter.free_question=!n.progress_item_filter.lecture_quizzes),n.progress_item_filter[e]=!n.progress_item_filter[e],t.$broadcast("progress_item_filter_update",n.progress_item_filter)},n.updateProgressFilter=function(e){n.progress_filter[e]=!n.progress_filter[e],t.$broadcast("progress_filter_update",n.progress_filter)},e=!0,r.setStatus(e)}}}]).directive("studentNavigation",["ContentNavigator","TimelineNavigator","$state",function(e,t,a){return{replace:!0,restrict:"E",transclude:!0,scope:{},templateUrl:"/views/student/student_sub_navigation.html",link:function(n){n.ContentNavigator=e,n.TimelineNavigator=t,n.$on("Course:ready",function(e,t){n.course=t}),n.toggleNavigator=function(){a.includes("course.content_selector")||e.setStatus(!e.getStatus())},n.toggleTimeline=function(){t.setStatus(!t.getStatus())}}}}]).directive("contentNavigator",["Module","$stateParams","$state","$timeout","Lecture","Course","ContentNavigator","$rootScope","Preview","$log","MobileDetector","UserSession","VideoInformation","ScalearUtils",function(n,e,r,o,s,t,l,u,a,d,c,_,m,p){return{restrict:"E",replace:!0,transclude:!0,scope:{mode:"@",open_navigator:"=open"},templateUrl:"/views/content_navigator.html",link:function(i,e,t){function a(e){i.show_module_overlay=e}i.$state=r,_.getCurrentUser().then(function(e){i.current_user=e}),i.$on("Module:ready",function(e,t){i.modules=t}),i.$watch("$state.params",function(){r.params.module_id?(i.currentmodule={id:r.params.module_id},i.currentitem={id:r.params.lecture_id||r.params.quiz_id||r.params.customlink_id},o(function(){i.scrollIntoView(i.currentmodule)})):(i.currentmodule=null,i.currentitem=null)}),u.$watch("clipboard",function(){i.clipboard=u.clipboard}),i.$on("item_done",function(e,t){var n=0;l.getStatus()||(n=700),o(function(){t.done||(t.done=!0,t.blink=!0,o(function(){t.blink=!1},1e3))},n)}),i.$on("content_navigator_overlay",function(e,t){a(t.status)}),i.moduleSortableOptions={axis:"y",dropOnEmpty:!1,handle:".handle",cursor:"crosshair",items:".module",opacity:.4,scroll:!0,update:function(e,t){n.saveSort({course_id:r.params.course_id},{group:i.modules})}},i.itemSortableOptions={axis:"y",dropOnEmpty:!1,handle:".handle",cursor:"crosshair",items:".item",opacity:.4,scroll:!0,update:function(e,t){var n=t.item.scope().item.group_id,a=t.item.scope().$parent.module.items;s.saveSort({course_id:r.params.course_id,group:n},{items:a})}},i.showModuleCourseware=function(e,t){i.currentmodule=e,r.go("course.module.courseware.overview",{module_id:e.id}),t.stopPropagation()},i.showItem=function(e,t){if(r.includes("**.progress.**")||r.includes("**.progress_overview"))r.includes("course.module.progress")&&u.$broadcast("scroll_to_item",e);else{var n={module_id:e.group_id};d.debug(e);var a=e.class_name.toLowerCase();n[a+"_id"]=e.id,c.isPhone()&&o(function(){l.close()}),r.go("course.module."+t+"."+a,n),"courseware"==t&&"customlink"==a||(i.currentitem={id:r.params.lecture_id||r.params.quiz_id||r.params.customlink_id})}},i.showModule=function(e,t){i.currentmodule&&t.stopPropagation(),r.includes("course.progress_overview")||r.includes("course.progress_main")||r.includes("course.progress_graph")||r.includes("course.progress")?r.go("course.module.progress_overview",{module_id:e.id}):r.includes("course.module.progress_overview")||r.includes("course.module.progress")||r.includes("course.module.progress_statistics")||r.includes("course.module.progress_students")?r.go(".",{module_id:e.id}):r.includes("course.module.inclass")||r.includes("course.inclass")?r.go("course.module.inclass",{module_id:e.id}):(r.go("course.module.course_editor.overview",{module_id:e.id}),i.currentmodule={id:r.params.module_id}),o(function(){i.scrollIntoView(i.currentmodule)})},i.removeModuleHover=function(e,t,n){n.module.hovered=!1,p.safeApply()},i.showModuleHover=function(e,t,n){n.module.hovered=!0,p.safeApply()},i.preview=function(){0!=m.current_time&&(r.params.time=Math.floor(m.current_time));var e=r.params;e.prevState=r.current.name,r.go("preview",e,{reload:!0})},i.addModule=function(){u.$broadcast("add_module")},i.paste=function(e,t){"module"==i.clipboard.type?u.$broadcast("paste_item"):u.$broadcast("paste_item",t)},i.copyDraggedItem=function(e,t,n){u.$broadcast("copy_item",n.draggedItem)},i.pasteDraggedItem=function(e,t,n){i.currentmodule.id==n.module.id?u.$broadcast("clear_item"):(u.$broadcast("paste_item",n.module.id,{cut:!0}),a(!0)),i.currentmodule.id=n.module.id,n.module.hovered=!1},i.scrollIntoView=function(e){$("#module_"+e.id).length&&$(".modules_container").scrollToThis("#module_"+e.id,{offsetTop:$(".modules_container").offset().top,duration:400})},i.goToCourseInfoStudent=function(){i.currentmodule=null,r.go("course.course_information")}}}}]).directive("timelineFilters",["$rootScope","$log","TimelineFilter",function(e,t,n){return{restrict:"E",scope:{},template:'<i class="timeline-settings" id="timeline_settings_btn" pop-over="popover_options"></i>',link:function(t){t.initFilters=function(){t.timeline_filter=n},t.exportNotes=function(){e.$broadcast("export_notes")},t.updateLectureFilter=function(e){t.timeline_filter.toggle(e)};t.popover_options={content:'<ul ng-init="initFilters()" class="no-margin"><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'note\')"><input id="showNotesCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'note\')" /><span style="font-size:12px" translate>course_settings.show_notes</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'discussion\')"><input id="showQuestionsCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'discussion\')" /><span style="font-size:12px" translate>course_settings.show_discussion</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'quiz\')"><input id="showQuizzesCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'quiz\')" /><span style="font-size:12px" translate>course_settings.show_quizzes</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'confused\')"><input id="showConfusedCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'confused\')" /><span style="font-size:12px" translate>course_settings.show_confused</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'marker\')"><input id="showMarkersCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'marker\')" /><span style="font-size:12px" translate>course_settings.show_markers</span></div></li><li><a class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="exportNotes()"><span style="font-size:12px" translate>course_settings.download_notes</span></a></li></ul>',html:!0,placement:"left"}}}}]).directive("userNavigation",[function(){return{replace:!0,restrict:"E",scope:{message:"="},templateUrl:"/views/user_sub_navigation.html",link:function(e){}}}]),angular.module("scalearAngularApp").directive("version",["scalear_api",function(e){return{restrict:"E",template:'<div style="font-size:10px;color:lightgray;font-weight: 200">v'+e.version+"</div>"}}]).directive("scalearFooter",["scalear_api",function(t){return{restrict:"E",template:'<div class="row size-12" style="text-align: center; line-height: 12px;">&copy; '+(new Date).getFullYear()+' <span tooltip-html-unsafe="{{tooltip_text}}">ScalableLearning</span> | <a ui-sref="about" class="color-green" translate="footer.about"></a> | <a ui-sref="privacy" class="color-green" translate="footer.privacy"></a></div>',link:function(e){e.tooltip_text='<div style="font-size:10px;color:lightgray;font-weight: 200">build: v'+t.version+"</div>"}}}]).directive("reportTechnical",["Home","$location","$log","$stateParams","$interval","$translate","$rootScope","$modal",function(e,t,n,a,i,r,o,s){return{restrict:"A",link:function(e,t){e.toggleTechnicalDisplay=function(){angular.element(".btn").blur(),s.open({templateUrl:"/views/report_technical.html",controller:"ReportTechnicalCtrl"})}}}}]),angular.module("scalearAngularApp").directive("notificationItem",["$rootScope","Home","SharedItem","$state","UserSession",function(n,a,e,i,r){return{restrict:"E",scope:{id:"=",notification:"=",type:"="},templateUrl:"/views/teacher/invitation/invitation_item.html",link:function(t,e){r.getCurrentUser().then(function(e){t.current_user=e}),t.accept=function(){a.acceptCourse({},{invitation:t.id},function(e){t.current_user.invitations=e.invitations,delete t.current_user.invitation_items[t.id],i.go("course.edit_course_information",{course_id:t.notification.course_id,new_course:!0}),n.$broadcast("Course:get_current_courses")})},t.reject=function(){a.rejectCourse({},{invitation:t.id},function(e){t.current_user.invitations=e.invitations,delete t.current_user.invitation_items[t.id]})}}}}]).directive("sharedItemNotification",["$rootScope","Home","SharedItem","$state","UserSession",function(e,t,n,a,i){return{restrict:"E",scope:{id:"=",notification:"=",type:"="},templateUrl:"/views/teacher/sharing/shared_item_notification.html",link:function(t,e){i.getCurrentUser().then(function(e){t.current_user=e}),t.accept=function(){n.accpetShared({shared_item_id:t.notification.id},{},function(e){t.current_user.shared=e.shared_items,delete t.current_user.shared_items[t.id],a.go("show_shared",{},{reload:!0})})},t.reject=function(){n.rejectShared({shared_item_id:t.notification.id},{},function(e){t.current_user.shared=e.shared_items,delete t.current_user.shared_items[t.id]})}}}}]),angular.module("scalearAngularApp").directive("sharedItem",["$rootScope","Module","Lecture","Quiz","SharedItem","CustomLink","$state","$log",function(e,t,r,o,s,l,n,u){return{restrict:"E",scope:{data:"=",courses:"="},templateUrl:"/views/teacher/sharing/shared_item.html",link:function(i,e){i.addModule=function(n,a,e){t.moduleCopy({course_id:e},{module_id:i.data[n].modules[a].id},function(e){u.debug(e),i.data[n].modules.splice(a,1);var t=angular.copy(i.data[n]);delete t.id,delete t.teacher,u.debug(t),0==t.modules.length&&0==t.lectures.length&&0==t.quizzes.length&&0==t.customlinks.length?s.destroy({shared_item_id:i.data[n].id},function(){i.data.splice(n,1)}):s.updateSharedData({shared_item_id:i.data[n].id},{data:t})})},i.addLecture=function(n,a,e,t){r.lectureCopy({course_id:e},{lecture_id:i.data[n].lectures[a].id,module_id:t},function(e){u.debug(e),i.data[n].lectures.splice(a,1);var t=angular.copy(i.data[n]);delete t.created_at,delete t.id,delete t.teacher,0==t.modules.length&&0==t.lectures.length&&0==t.quizzes.length&&0==t.customlinks.length?s.destroy({shared_item_id:i.data[n].id},function(){i.data.splice(n,1)}):s.updateSharedData({shared_item_id:i.data[n].id},{data:t})},function(){})},i.addQuiz=function(n,a,e,t){o.quizCopy({course_id:e},{quiz_id:i.data[n].quizzes[a].id,module_id:t},function(e){u.debug(e),i.data[n].quizzes.splice(a,1);var t=angular.copy(i.data[n]);delete t.created_at,delete t.id,delete t.teacher,0==t.modules.length&&0==t.lectures.length&&0==t.quizzes.length&&0==t.customlinks.length?s.destroy({shared_item_id:i.data[n].id},function(){i.data.splice(n,1)}):s.updateSharedData({shared_item_id:i.data[n].id},{data:t})},function(){})},i.addLink=function(n,a,e,t){l.linkCopy({course_id:e},{link_id:i.data[n].customlinks[a].id,module_id:t},function(e){u.debug(e),i.data[n].customlinks.splice(a,1);var t=angular.copy(i.data[n]);delete t.created_at,delete t.id,delete t.teacher,0==t.modules.length&&0==t.lectures.length&&0==t.quizzes.length&&0==t.customlinks.length?s.destroy({shared_item_id:i.data[n].id},function(){i.data.splice(n,1)}):s.updateSharedData({shared_item_id:i.data[n].id},{data:t})},function(){})}}}}]),angular.module("scalearAngularApp").directive("moduleEdit",["$rootScope","$timeout","$state","$log","ngDialog",function(t,e,n,i,r){return{restrict:"E",replace:!0,scope:{module:"=data"},templateUrl:"/views/teacher/course_editor/module_edit.html",link:function(n,e){var a=function(){var t=0;n.module.items.forEach(function(e){e.duration&&(t+=parseInt(e.duration))}),n.module.total_time=t};a(),n.$on("update_module_time",function(e,t){n.module.id==t&&a()}),t.$watch("clipboard",function(){n.clipboard=t.clipboard}),n.remove=function(e){e.preventDefault(),e.stopPropagation(),0<n.module.items.length?r.open({template:'                            <div class="ngdialog-message">                                <h2><b><span translate>groups.delete_popup.warning</span>!</b></h2>                                <span>                                    <span translate>groups.delete_popup.delete_module</span>                                    <b>"'+n.module.name+'"</b>                                    <span translate>groups.delete_popup.will_delete</span>                                    <span translate>groups.delete_popup.are_you_sure</span>                                </span>                            </div>                            <div class="ngdialog-buttons">                                <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>button.cancel</button>                                <button type="button" class="ngdialog-button ngdialog-button-alert delete_confirm" ng-click="delete()" translate>button.delete</button>                            </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1,controller:["$scope",function(e){e.delete=function(){t.$broadcast("delete_module",n.module),e.closeThisDialog()}}]}):t.$broadcast("delete_module",n.module)},n.copy=function(e){i.debug("copy"),e.preventDefault(),t.$broadcast("copy_item",n.module)},n.paste=function(e){i.debug("Paste"),e.preventDefault(),t.$broadcast("paste_item",n.module.id)},n.share=function(e){i.debug("Share"),e.preventDefault(),t.$broadcast("share_copy",{module_id:n.module.id})}}}}]).directive("itemEdit",["$rootScope","$timeout","$anchorScroll","$location","$state","$log",function(n,e,t,a,i,r){return{scope:{item:"=data",copyDraggedItem:"="},restrict:"E",templateUrl:"/views/teacher/course_editor/item_edit.html",link:function(t,e){n.$watch("clipboard",function(){t.clipboard=n.clipboard}),t.remove=function(e){e.stopPropagation(),e.preventDefault(),n.$broadcast("delete_item",t.item)},t.copy=function(e){r.debug("copy"),e.preventDefault(),n.$broadcast("copy_item",t.item)},t.paste=function(e){r.debug("Paste"),e.preventDefault(),n.$broadcast("paste_item",t.item.group_id)},t.share=function(e){r.debug("Share"),e.preventDefault(),n.$broadcast("share_copy",{module_id:t.item.group_id,item:t.item})}}}}]).directive("module",function(){return{replace:!0,restrict:"E",scope:{data:"&data"},templateUrl:"/views/teacher/course_editor/module.html",link:function(e,t){e.module=e.data();var n;n=0,e.module.items.forEach(function(e){e.duration&&(n+=parseInt(e.duration))}),e.module.total_time=n}}}).directive("item",function(){return{scope:{data:"&data"},restrict:"E",templateUrl:"/views/teacher/course_editor/item.html",link:function(e,t){e.item=e.data()}}}).directive("buttonLink",function(){return{scope:{title:"@",action:"&"},restrict:"E",replace:!0,template:'<div ng-click="action({$event:$event})" class="btn" >{{title}}</div>'}}).directive("editableText",["$timeout",function(a){return{scope:{value:"=",save:"&",validation:"&",action:"&",elem:"="},restrict:"E",template:'<a onshow="selectField()" ng-mouseover="show_pencil = true;" blur="submit" ng-mouseleave="show_pencil = false;"  editable-text="value" e-form="textBtnForm" onbeforesave="validation()($data, elem)" onaftersave="saveData()" ng-click="action()" style="cursor:pointer;padding-right: 20px;" e-class="editable-input-large">{{ value || ("global.empty"|translate) }}<i ng-class="overclass" ></i> <span ng-show="show_pencil" class="fi-pencil size-21" style="position: absolute;" ng-click="textBtnForm.$show()"></span></a>',link:function(e,t,n){e.selectField=function(){a(function(){var e=t.find(".editable-input");t.find("form.editable-wrap").css("width","100%"),e.select()})},e.saveData=function(){a(function(){e.save()})},e.show=function(){e.textBtnForm.$show()},n.open&&e.show()}}}]).directive("overlay",["$timeout",function(e){return{transclude:!0,restrict:"E",replace:!0,template:'<div class="overlay" ng-transclude></div>',link:function(e,t){var n=t.parent();e.getHeight=function(){return n.height()}}}}]).directive("loading",function(){return{scope:{size:"@",show:"="},restrict:"E",replace:!0,templateUrl:"/views/teacher/course_editor/loading.html"}}).directive("deleteButton",["$translate",function(e){return{scope:{size:"@",action:"&",vertical:"&",text:"&",overlaymode:"&",mode:"@",moduleitem:"@",tooltiptext:"@",padded:"@"},restrict:"E",templateUrl:"/views/teacher/course_editor/delete_button.html",link:function(n){n.tooltiptext_translated=e.instant(n.tooltiptext),n.overlay=n.overlaymode()||!1,n.display_vertical=n.vertical(),n.text_mode=n.text(),n.showDeletePopup=function(e,t){n.displayDeletePopup=e,t.stopPropagation(),t.preventDefault()}}}}]).directive("moduleContentModal",["$modal",function(n){return{scope:{openModal:"="},restrict:"A",replace:!0,controller:["$scope",function(e){e.openModal=function(){n.open({templateUrl:"/views/teacher/course_editor/online_content_modal.html",controller:t})};var t=["$scope","$modalInstance","$rootScope",function(e,t,n){e.addItem=function(e){n.$broadcast("add_item",e),t.close()},e.cancel=t.dismiss}]}]}}]).directive("lectureQuestionsModal",["$modal",function(n){return{scope:{openModal:"=",data:"="},restrict:"A",replace:!0,controller:["$scope",function(e){e.openModal=function(){n.open({templateUrl:"/views/teacher/course_editor/question_types_modal.html",controller:t,windowClass:"large",scope:e})};var t=["$scope","$modalInstance","$rootScope",function(n,a,i){n.lecture=n.data,n.submitting=!1,n.addQuiz=function(e,t){n.submitting||(i.$broadcast("add_online_quiz",e,t),n.submitting=!0),a.close()},n.cancel=a.dismiss}]}]}}]),angular.module("scalearAngularApp").directive("quizList",function(){return{restrict:"E",templateUrl:"/views/teacher/course_editor/lecture.middle.quiz_list.html"}}).directive("markerList",function(){return{restrict:"E",templateUrl:"/views/teacher/course_editor/lecture.middle.marker_list.html"}}).directive("quiz",function(){return{transclude:!0,replace:!0,restrict:"E",template:'<div class="ontop" id="ontop" style="position: absolute;width:100%; height: 100%; top:0px; left: 0px;" ng-class="lecture.aspect_ratio" ng-transclude></div>'}}).directive("videoOverlay",function(){return{transclude:!0,replace:!0,restrict:"E",template:'<div style="position: absolute;width:100%; height: 100%; top:0px; left: 0px;" ng-class="lecture.aspect_ratio" ng-transclude></div>'}}).directive("quizEditPanel",["$timeout","$q","OnlineQuiz","$translate","ScalearUtils","VideoInformation",function(a,e,t,n,i,r){return{restrict:"E",templateUrl:"/views/teacher/course_editor/quiz_edit_panel.html",link:function(n,e,t){n.selected_quiz.has_start=n.selected_quiz.start_time!=n.selected_quiz.time,n.selected_quiz.has_end=n.selected_quiz.end_time!=n.selected_quiz.time,n.invideo_quiz_type="invideo"==n.selected_quiz.quiz_type,n.updateQuizStartTime=function(){if(n.selected_quiz.start_time=n.selected_quiz.time,n.selected_quiz.has_start){var e=5*r.duration/100;n.selected_quiz.start_time=n.selected_quiz.start_time-e<0?0:n.selected_quiz.start_time-e}},n.updateQuizEndTime=function(){if(n.selected_quiz.end_time=n.selected_quiz.time,n.selected_quiz.has_end){var e=n.lecture_player.controls.getDuration(),t=5*e/100;n.selected_quiz.end_time=n.selected_quiz.end_time+t>e?e:n.selected_quiz.end_time+t}},a(function(){e.find(".quiz_name").focus(),document.execCommand("selectAll",!1,null)})}}}]).directive("markerEditPanel",["$timeout","$q","$translate","OnlineMarker",function(a,e,t,n){return{restrict:"E",template:'<div><h6 class="row no-margin color-wheat wheat"><div style="margin-top:10px;text-align:left;margin-left:0;"><div class="small-12 columns" style="margin-bottom: 5px;"><span translate>editor.title</span>:</div><div class="small-12 left columns" style="margin-bottom: 15px;"><div><rich-textarea class="marker_name" ng-model="selected_marker.title" ></div><small class="error" ng-show="marker_errors.name_error" ng-bind="marker_errors.name_error"></small></div></div><div style="margin-top:10px;text-align:left;margin-left:0;"><div class="small-12 columns" style="margin-bottom: 5px;"><span translate>editor.annotation</span>:</div><div class="small-12 left columns" style="margin-bottom: 15px;"><rich-textarea class="marker_annotation" ng-model="selected_marker.annotation" style="height: 70px;margin-bottom:0;"></div></div><div class="row" style="text-align:left;margin-left:0;"><div class="small-3 columns"><span translate>editor.note_time</span>:</div><div class="small-4 left columns no-padding" style="margin-bottom: 5px;"><input class="marker_time" type="text" ng-model="selected_marker.formatedTime" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="marker_errors.time_error" ng-bind="marker_errors.time_error"></small></div></div><div class="row" style="text-align:left;margin-left:0;"><div class="small-3 columns"><span translate>editor.note_as_slide</span>:</div><div class="small-9 left columns no-padding" style="margin-bottom: 5px;"><input class="marker_as_slide" type="checkbox" ng-model="selected_marker.as_slide" style="margin-bottom:0;"/><span translate>editor.note_as_slide_description</span><small class="error position-absolute z-one" ng-show="marker_errors.as_slide_error" ng-bind="marker_errors.as_slide_error"></small></div></div><div class="row" style="text-align:left;margin-left:0;" ng-hide="selected_marker.as_slide"><div class="small-3 columns"><span translate>editor.note_duration</span>:</div><div class="small-4 left columns no-padding" style="margin-bottom: 5px;"><input class="marker_duration" type="text" ng-model="selected_marker.duration" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="marker_errors.duration_error" ng-bind="marker_errors.duration_error"></small></div></div><delete_button id="delete_marker_button" size="big" action="deleteMarkerButton(selected_marker)" vertical="false" text="true" style="margin:10px;margin-left:0;float:right;margin-top:0;"></delete_button><button id="save_marker_button" ng-disabled="disable_save_button" class="button tiny" style="float:right" ng-click="saveMarkerBtn(selected_marker)" translate>events.done</button></h6></div>',link:function(e,t,n){a(function(){t.find(".marker_name").focus(),document.execCommand("selectAll",!1,null)});shortcut.add("Tab",function(){var e;e="tab",$("div.marker_name").is(":focus")?$("div.marker_annotation").focus():$("div.marker_annotation").is(":focus")?$("input.marker_time").focus():$("input.marker_time").is(":focus")?$("#input.marker_duration").focus():$("input.marker_duration").is(":focus")?$("#save_marker_button").focus():$("#save_marker_button").is(":focus")?"enter"==e?$("#save_marker_button").click():$("#delete_marker_button").find("a").focus():$("#delete_marker_button").find("a").is(":focus")&&$("div.marker_name").focus()},{disable_in_input:!1}),e.$on("$destroy",function(){shortcut.remove("Enter"),shortcut.remove("Tab")})}}}]).directive("videoEditPanel",["$rootScope","$filter","ScalearUtils","VideoInformation",function(i,r,o,e){return{restrict:"E",template:'<div><h6 class="row no-margin color-wheat wheat"><div style="margin:10px">Use the handlers above to trim video</div><div><div class="small-12 columns" style="margin-bottom:10px;"><div class="small-3 columns">Start Time</div><div class="small-5 columns left size-14 text-center no-padding" style="border-radius: 3px; border: 1px darkgrey solid;"><input type="text" ng-model="selected_lecture.start_time_formated_time" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="lecture_errors.start_time" ng-bind="lecture_errors.start_time"></small></div></div><div class="small-12 columns"><div class="small-3 columns">End Time</div><div class="small-5 columns left size-14 text-center no-padding" style="border-radius: 3px; border: 1px darkgrey solid;"><input type="text" ng-model="selected_lecture.end_time_formated_time" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="lecture_errors.end_time" ng-bind="lecture_errors.end_time"></small></div></div><button id="save_marker_button" ng-disabled="disable_save_button" class="button tiny" style="margin:10px;margin-left:0;float:right;margin-top:0;" ng-click="closeTrimVideo()" translate>events.done</button></h6></div>',link:function(n,e,t){n.selected_lecture={},n.lecture_errors={};var a=n.lecture.end_time;n.selected_lecture.start_time_formated_time=r("format")(n.lecture.start_time),n.selected_lecture.end_time_formated_time=r("format")(n.lecture.end_time),n.$watch("lecture.start_time",function(e,t){n.selected_lecture.start_time_formated_time=r("format")(n.lecture.start_time)}),n.$watch("lecture.end_time",function(e,t){n.selected_lecture.end_time_formated_time=r("format")(n.lecture.end_time)}),n.closeTrimVideo=function(){n.lecture_errors.start_time=o.validateTimeWithDurationForTrim(n.selected_lecture.start_time_formated_time,a),n.lecture_errors.end_time=o.validateTimeWithDurationForTrim(n.selected_lecture.end_time_formated_time,a,n.selected_lecture.start_time_formated_time),n.lecture_errors.start_time||n.lecture_errors.end_time||(n.lecture.start_time=o.arrayToSeconds(n.selected_lecture.start_time_formated_time.split(":")),n.lecture.end_time=o.arrayToSeconds(n.selected_lecture.end_time_formated_time.split(":")),i.$broadcast("close_trim_video"))}}}}]).directive("answervideo",function(){return{scope:{quiz:"=",data:"=",list:"=",save:"&",remove:"&"},replace:!0,restrict:"E",template:"<div ng-switch on='quiz.question_type.toUpperCase()'><answer ng-switch-when='MCQ' /><answer ng-switch-when='OCQ' /><drag ng-switch-when='DRAG' /><free_text ng-switch-when='FREE TEXT QUESTION' /></div>"}}).directive("answer",["$rootScope","$log","$timeout",function(r,o,s){return{replace:!0,restrict:"E",templateUrl:"/views/teacher/course_editor/answer.html",link:function(t,n,e){t.setAnswerColor=function(){"OCQ"==t.quiz.question_type?t.imgName=t.data.correct?t.ocq_correct:t.ocq_incorrect:t.imgName=t.data.correct?t.mcq_correct:t.mcq_incorrect},t.calculatePosition=function(){var e=angular.element(".ontop");t.data.xcoor=parseFloat(n.position().left)/e.width(),t.data.ycoor=parseFloat(n.position().top)/e.height(),t.calculateSize()},t.calculateSize=function(){var e=angular.element(".ontop");t.data.width=n.width()/e.width(),t.data.height=n.height()/e.height()},t.radioChange=function(e){"OCQ"==t.quiz.question_type&&(o.debug("radioChange"),t.quiz.answers.forEach(function(e){e.correct=!1}),e.correct=!0,r.$emit("radioChange"))},t.selectField=function(){s(function(){$(".popover .answer_text").focus(),document.execCommand("selectAll",!1,null)})},t.updateValues=function(){for(var e in t.values=0,t.quiz.answers)t.quiz.answers[e].correct&&(t.values+=1)};var a=function(){$(".popover").remove()};t.$on("$destroy",function(){a()}),t.close=function(){t.save(),a()},t.delete=function(){t.remove(),a()},t.answerDragStart=function(){a()},r.$on("radioChange",function(){t.setAnswerColor()}),t.answerClass="component dropped answer_img";var i="";i="survey"==t.quiz.quiz_type?"<form name='aform'><label class='show-inline'><span translate>editor.answer</span><h6 class='no-margin-bottom'><small translate>editor.popover.shown_in_graph</small></h6></label><span class='right' tooltip-append-to-body='true' tooltip={{'editor.tooltip.click_to_delete'|translate}}><delete_button class='right' size='big' hide-confirm='false' color='dark' action='remove()'></delete_button></span><div><rich-textarea rows=3 class='must_save answer_text' ng-class='{error: aform.answer.$error.required}' type='text' ng-model='data.answer' ng-init='selectField()'  name='answer' required /></div><small class='error' ng-show='aform.answer.$error.required' style='padding-top: 5px;'><span translate>error_message.required</span>!</small><button type='button' ng-click='close()' class='button tiny success with-small-margin-top small-6 columns'><span translate>button.close</span></button>"+'<delete_button size="big" action="delete()" vertical="false" text="true" style="margin:8px 0;" class="small-6 columns no-padding"></delete_button></form>':"<form name='aform' ><label class='show-inline'><span translate>editor.correct</span> <span translate>editor.answer</span><input id='correct_checkbox' class='must_save_check' ng-change='radioChange(data);setAnswerColor();updateValues();' ng-model='data.correct' style='margin-left:10px;margin-bottom:2px' type='checkbox' ng-checked='data.correct' name='mcq'/></label><label class='with-small-margin-top'><span translate>editor.answer</span><h6 class='subheader no-margin'><small style='text-transform: initial;' translate>editor.popover.shown_in_graph</small></h6><div><rich-textarea rows=3 class='must_save answer_text' ng-model='data.answer' ng-class='{error: aform.answer.$error.required}' required ng-init='selectField($event)'/></div><small class='error' ng-show='aform.answer.$error.required' style='padding-top: 5px;'><span translate>error_message.required</span>!</small></label><label style='margin-top:10px'><span translate>editor.explanation</span><h6 class='subheader no-margin'><small style='text-transform: initial;' translate>editor.popover.shown_to_student</small></h6><rich-textarea rows=3 class='must_save' ng-model='data.explanation' /></label><button type='button' ng-click='close()' class='button tiny success with-small-margin-top small-6 columns'><span translate>button.close</span></button>"+'<delete_button size="big" action="delete()" vertical="false" text="true" style="margin:8px 0;" class="small-6 columns no-padding"></delete_button></form>',t.popover_options={content:i,html:!0,placement:function(){var e=.5<t.data.xcoor?"left":"right";return t.data.ycoor<.3?"bottom":e},container:"body"},t.data.id||(t.popover_options.instant_show="click"),t.$watch("quiz.answers",function(){t.updateValues()},!0),t.setAnswerColor()}}}]).directive("drag",["$log","$timeout",function(o,s){return{replace:!0,restrict:"E",template:"<div><div pop-over='popover_options' unique='true' class='component dropped_drag'  ng-style=\"{width: (data.width*100)+'%', height: (data.height*100)+'%', left: (data.xcoor*100)+'%', top: (data.ycoor*100)+'%'}\" data-drag='true' data-jqyoui-options=\"{containment:'.ontop'}\" jqyoui-draggable=\"{animate:true, onStop:'calculatePosition'}\" ><div ><span class='position-header error light-grey dark-text no-margin'>{{data.pos+1}} <span translate>editor.drag.end</span></span></div></div><div class='dragged handle' data-drag='true' style='max-width:350px;max-height:95px; overflow: scroll; border-radius: 10px; padding: 10px;' ng-style=\"{left: (data.sub_xcoor*100)+'%', top: (data.sub_ycoor*100)+'%'}\" data-jqyoui-options=\"{containment:'.ontop'}\" jqyoui-draggable=\"{animate:true, onStop:'calculatePosition'}\" ><span class='position-header error light-grey dark-text no-margin' style='top: 6px;left: -48px;padding: 6px;'>{{data.pos+1}} <span translate>editor.drag.start</span></span><span class='no-margin' ng-bind-html='data.answer'></span></div></div>",link:function(a,i,e){if(a.calculatePosition=function(){var e=angular.element(".ontop"),t=angular.element(i.children()[0]),n=angular.element(i.children()[1]);a.data.xcoor=parseFloat(t.position().left)/e.width(),a.data.ycoor=parseFloat(t.position().top)/e.height(),a.data.sub_xcoor=parseFloat(n.position().left)/e.width(),a.data.sub_ycoor=parseFloat(n.position().top)/e.height(),o.debug(a.data),a.calculateSize()},a.calculateSize=function(){var e=angular.element(".ontop"),t=angular.element(i.children()[0]);a.data.width=t.width()/e.width(),a.data.height=t.height()/e.height()},a.selectField=function(){s(function(){$(".popover .answer_text").focus(),document.execCommand("selectAll",!1,null)})},null==a.data.pos){o.debug("pos undefined");var t=Math.max.apply(Math,a.list);a.data.pos=t==-1/0?-1:t+1,a.list.push(a.data.pos)}if(a.pos=parseInt(a.data.pos),!(a.data.explanation instanceof Array))for(var n in a.data.explanation=[],a.list)a.data.explanation[n]="";a.quiz.answers.forEach(function(e){e.explanation[a.data.pos]||(e.explanation[a.data.pos]="")});var r=function(){$(".popover").remove()};a.$on("$destroy",function(){r()}),a.close=function(){a.save(),r()};a.popover_options={content:'<ul class="no-margin"><label><span translate>editor.drag.instruction</span><rich-textarea ng-change="save()"  rows=3 style="resize:vertical;" class="answer_text must_save" ng-model="data.answer" ng-init="selectField()"/></label><label><span translate>editor.drag.correct</span>:<rich-textarea ng-change= "save()" rows=3 style="resize:vertical;" class="must_save" ng-model="data.explanation[pos]" /></label><label ng-repeat=\'num in list|filter:"!"+data.pos\' ><span translate translate-values="{num:num+1}">editor.drag.incorrect</span>:<rich-textarea ng-change="save()" rows=3 class="must_save" style="resize:vertical;" ng-model="data.explanation[num]" /></label><button type=\'button\' ng-click=\'close()\' class=\'button tiny success with-small-margin-top small-5 columns\'><span translate>button.close</span></button><delete_button size="big" action="remove()" vertical="false" text="true" style="margin:8px 0;" class="small-7 columns no-padding"></delete_button></ul>',html:!0,placement:function(){var e=.5<a.data.xcoor?"left":"right";return a.data.ycoor<.3?"bottom":e},container:"body"},a.data.id||(a.popover_options.instant_show="click"),angular.element(i.children()[0]).resizable({containment:".videoborder",minHeight:40,minWidth:40,stop:a.calculateSize})}}}]).directive("freeText",["$log","$timeout",function(e,t){return{replace:!0,restrict:"E",save:"&",remove:"&",template:"<div><div class='component dropped answer_drag' style='cursor:move;border: 1px solid #ddd;background-color:white;padding:0px;position:absolute; min-height:40px; min-width: 40px;' ng-style=\"{width: (data.width*100)+'%', height: (data.height*100)+'%', left: (data.xcoor*100)+'%', top: (data.ycoor*100)+'%'}\" data-drag='true' data-jqyoui-options=\"{containment:'.ontop'}\" jqyoui-draggable=\"{animate:true, onStop:'calculatePosition'}\"  pop-over='popover_options'><h6 class='no-margin' style='text-align:left;resize:none;padding:10px;font-size: 0.1rem' ng-bind-html='quiz.question'></h6></div></div>",link:function(n,a,e){n.calculatePosition=function(){var e=angular.element(".ontop"),t=angular.element(a.children()[0]);n.data.xcoor=parseFloat(t.position().left)/e.width(),n.data.ycoor=parseFloat(t.position().top)/e.height(),n.calculateSize()},n.calculateSize=function(){var e=angular.element(".ontop"),t=angular.element(a.children()[0]);n.data.width=t.width()/e.width(),n.data.height=t.height()/e.height()};var t=function(){$(".popover").remove()};n.$on("$destroy",function(){t()}),n.close=function(){n.save(),t()},n.delete=function(){n.remove()};n.popover_options={content:"<form name='aform' ><label style='margin-top:10px'><span translate>editor.explanation</span><h6 class='subheader no-margin'><small style='text-transform: initial;' translate>editor.popover.shown_to_student</small></h6><rich-textarea ng-change='save()' rows=3 class='must_save' type='text' ng-model='data.explanation'></textarea></label><button type='button' ng-click='close()' class='button tiny success with-small-margin-top small-6 columns'><span translate>button.close</span></button></form>",html:!0,placement:function(){var e=.5<n.data.xcoor?"left":"right";return n.data.ycoor<.3?"bottom":e},container:"body"},n.data.id||(n.popover_options.instant_show="click"),angular.element(a.children()[0]).resizable({containment:".videoborder",minHeight:40,minWidth:40,stop:n.calculateSize})}}}]).directive("answerform",["$log","$translate",function(a,i){return{scope:{quiz:"=",add:"&",remove:"&",removeq:"&",column:"@",columna:"@",index:"=",submitted:"=",subtype:"=",sortable:"@",save:"&"},restrict:"E",templateUrl:"/views/teacher/course_editor/answer_forum.html",link:function(n,t,e){n.isSurvey=function(){return n.subtype&&("survey"==n.subtype.toLowerCase()||"html_survey"==n.subtype.toLowerCase())},n.isFreeText=function(){return"Free Text Question"==n.quiz.question_type},n.isNormalQuiz=function(){return"content"in n.quiz},n.removeAnswerFreeText=function(){n.isFreeText()&&n.quiz.answers.forEach(function(e,t){0==t?"Free Text"==n.quiz.match_type&&(e.content=""):n.quiz.answers.splice(t,1)})},n.clearAnswer=function(){n.quiz.answers.forEach(function(e,t){e.explanation="",n.isFreeText()||(e.content="")})},n.quiz_types=[{value:"MCQ",text:i.instant("content.questions.quiz_types.mcq")},{value:"OCQ",text:i.instant("content.questions.quiz_types.ocq")},{value:"Free Text Question",text:i.instant("content.questions.quiz_types.text")}],n.match_types=[{value:"Free Text",text:i.instant("content.questions.quiz_types.free_text")},{value:"Match Text",text:i.instant("content.questions.quiz_types.match_text")}],a.debug(n.quiz),n.quiz.match_type||n.isSurvey()||("Free Text Question"==n.quiz.question_type&&n.quiz.answers&&""!=n.quiz.answers[0].content?n.quiz.match_type=n.match_types[1].value:n.quiz.match_type=n.match_types[0].value),n.isSurvey()||n.quiz_types.push({value:"drag",text:i.instant("content.questions.quiz_types.drag")}),n.addAnswer=n.add(),n.removeQuestion=n.removeq(),n.$on("$destroy",function(){shortcut.remove("Enter")}),shortcut.add("Enter",function(){if(!n.isFreeText()){var e=t.find("input");a.debug(e.length),e.each(function(e,t){a.debug(t),document.activeElement==t&&n.addAnswer("",n.quiz)}),n.$apply(),t.find("input")[e.length]&&t.find("input")[e.length].focus()}},{disable_in_input:!1,propagate:!0})}}}]).directive("htmlanswer",["$log",function(e){return{restrict:"E",template:"<div ng-switch on='quiz.question_type.toUpperCase()'><div ng-switch-when='FREE TEXT QUESTION' ><div ng-switch on='quiz.match_type.toUpperCase()'><div ng-switch-when='MATCH TEXT' ><html_freetextmatch ng-repeat='answer in quiz.answers' /></div><div ng-switch-when='FREE TEXT' ><html_freetext ng-repeat='answer in quiz.answers' /></div></div></div><div ng-switch-when='MCQ' ><html_mcq  ng-repeat='answer in quiz.answers' /></div><div ng-switch-when='OCQ' ><html_ocq  ng-repeat='answer in quiz.answers' /></div><ul  ng-switch-when='DRAG' class='no-padding-top'><h5 class='no-margin-top'><small translate>editor.messages.random_answers</small></h5><span ui-sortable='answers_sortable_options' ng-model='quiz.answers'><html_drag ng-repeat='answer in quiz.answers' /></span></ul></div>",link:function(t){t.removeAnswer=t.remove(),t.updateValues=function(){for(var e in t.values=0,t.quiz.answers)t.quiz.answers[e].correct&&(t.values+=1)},t.radioChange=function(e){t.quiz.answers.forEach(function(e){e.correct=!1}),e.correct=!0,t.updateValues()},t.show=function(){return"time"in t.quiz},t.$watch("quiz.answers",function(){t.updateValues()},!0),t.answers_sortable_options={axis:"y",dropOnEmpty:!1,handle:".drag-item",cursor:"crosshair",items:".drag-answer",opacity:.4,scroll:!0}}}}]).directive("htmlFreetext",function(){return{restrict:"E",template:"<ng-form name='aform'><div class ='row collapse' ng-if='!isSurvey()' ><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding' ><rich-textarea  ng-change='save()' class='no-margin explain' type='text' name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation'/></span></div></div></ng-form>"}}).directive("htmlFreetextmatch",function(){return{restrict:"E",template:"<ng-form name='aform'><div ng-if=quiz.match_type == 'Match Text'><div class='row'><div class='small-10 columns'><div><input required name='answer' type='text' placeholder='String to match' ng-model='answer[columna]' style='margin-bottom: 0;' /></div><small class='error' ng-show='submitted && aform.answer.$error.required' style='padding-top: 5px;'><span translate>error_message.required</span>!</small></div></div><div class='text-left size-12'><div><br/><span translate>editor.regex.enter_string</span><br /><br /><span translate>Examples</span>:</div><ul class='size-12'><li>Waterloo -> <span translate>editor.regex.correct_if</span> 'Waterloo'</li><li>/(Waterloo|waterloo)/ -> <span translate>editor.regex.correct_for</span> 'Waterloo' , 'waterloo'</li><li>/[0-9]/ -> <span translate>editor.regex.correct_for</span> <span translate>editor.regex.any_integer</span></li><li>/(10|14|29)/ -> <span translate>editor.regex.correct_for</span> <span translate>editor.regex.numbers</span></li></ul></div></div></div><div class ='row collapse' ><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding'><rich-textarea ng-change='save()' class='no-margin explain' type='text' name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation' /></span></div></ng-form>"}}).directive("htmlMcq",function(){return{restrict:"E",template:"<div class='small-12 no-padding columns'><delete_button class='right with-small-margin-top' size='small' mode='content_navigator' color='dark' action='removeAnswer($index, quiz)' /><ng-form name='aform'><div class='row collapse'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.answer</label></div><div class='small-7 columns left no-padding'><div><rich-textarea ng-change='save()'  class='no-margin' required name='answer' placeholder={{'editor.answer'|translate}} ng-model='answer[columna]' /></div><small class='error with-tiny-margin-bottom' ng-show='submitted && aform.answer.$error.required' ><span translate>error_message.required</span>!</small></div><div class='small-2 columns' ng-if='!isSurvey()'><label><span translate>editor.correct</span></label><input class='valign-middle' ng-change='updateValues(); save();' type='checkbox' name='mcq' ng-model='answer.correct' ng-checked='answer.correct' /></div></div><div class ='row collapse' ng-if='!isSurvey()'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding'><rich-textarea ng-change='save()' class='no-margin' class='explain'  name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation'/></span></div></div></ng-form></div><hr style='margin: 0;'/>"}}).directive("htmlOcq",function(){return{restrict:"E",template:"<div class='small-12 no-padding columns'><ng-form name='aform'><delete_button class='right with-small-margin-top' mode='content_navigator' size='small' color='dark' action='removeAnswer($index, quiz)' /><div class='row collapse'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.answer</label></div><div class='small-7 columns left no-padding'><div><rich-textarea ng-change='save()' class='no-margin' required name='answer' placeholder={{'editor.answer'|translate}} ng-model='answer[columna]'/></div><small class='error with-tiny-margin-bottom' ng-show='submitted && aform.answer.$error.required' ><span translate>error_message.required</span>!</small></div><div class='small-2 columns' ng-if='!isSurvey()'><label><span translate>editor.correct</span></label><input class='valign-middle' id='radio_correct' ng-change='save()' type='radio' ng-model='answer.correct' ng-value=true ng-click='radioChange(answer)'/></div></div><div class ='row collapse' ng-if='!isSurvey()'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding'><rich-textarea ng-change='save()' class='no-margin' class='explain' name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation' /></span></div></div></ng-form></div><hr style='margin: 10px 0;'/>",link:function(e){e.answer.correct&&e.radioChange(e.answer)}}}).directive("htmlDrag",function(){return{restrict:"E",replace:!0,templateUrl:"/views/teacher/course_editor/html_drag.html"}}).directive("atleastone",["$log",function(i){return{require:"ngModel",link:function(t,e,n,a){t.validate=function(e){t.values<1?(i.debug("errorrr"),a.$setValidity("atleastone",!1)):a.$setValidity("atleastone",!0)},t.$watch("values",function(){t.validate()})}}}]).directive("controlsTeacher",["$window","$timeout",function(e,n){return{restrict:"E",scope:{link:"&"},template:'<div class="linkDiv" tooltip="{{\'editor.tooltip.create_link_time\'|translate}}" pop-over="link_content" unique="false" highlight="true"></div>',link:function(e,t){e.selectLink=function(e){n(function(){t.find(".video_link").select()})},e.link_content={content:"<b>Student link to time {{link().time| formattime:'hh:mm:ss'}} in this video</b><hr style='margin: 5px;'/><div style='word-break: break-all;'>{{link().url}}</div>",html:!0,placement:"left"}}}}]).directive("dynamicAnnotation",["$filter","$rootScope","CourseModel","$timeout",function(e,t,o,n){return{restrict:"E",scope:{data:"=",close:"&",action:"&",textToShow:"="},templateUrl:"/views/student/lectures/dynamic_annotation.html",link:function(n,e,t){n.closeBtn=n.close(),n.actionBtn=n.action();var a=angular.element(".ontop"),i=angular.element(e.children().first()),r=angular.element(i.children().first());n.calculatePosition=function(){n.data.xcoor=parseFloat(i.position().left)/a.width(),n.data.ycoor=parseFloat(i.position().top)/a.height(),n.calculateSize()},n.calculateSize=function(e,t){t&&r[0].offsetWidth+20<r[0].scrollWidth+20?(t.size.width=r[0].scrollWidth+20,n.data.width=t.size.width/a.width()):n.data.width=i[0].offsetWidth/a.width(),t&&r[0].offsetHeight+20<r[0].scrollHeight+20?(t.size.height=r[0].scrollHeight+20,n.data.height=n.data.height/a.height()):n.data.height=i[0].offsetHeight/a.height()},o.isStudent()||angular.element(e.children()[0]).resizable({containment:".videoborder",stop:n.calculateSize,resize:n.calculateSize})}}}]),angular.module("scalearAngularApp").directive("detailsText",["$timeout",function(i){return{template:'<a ng-click="show()" onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'"  editable-text="value" e-form="textBtnForm" blur="submit" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ value || empty_message ||("global.empty"|translate) }} <i ng-class="overclass"></i></a>',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",open:"=",empty_message:"@emptyMessage"},link:function(t,e,n){if(t.selectField=function(){i(function(){e.find(".editable-input").select()})},t.saveData=function(){i(function(){t.save()})},t.show=function(){t.textBtnForm.$show()},n.open)var a=t.$watch("open",function(e){!0===e&&(t.show(),a())})}}}]).directive("detailsUrl",["$timeout","$translate","$filter",function(i,r,o){return{template:'<a ng-click="show()" onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'"  editable-textarea="value" e-rows="5" e-cols="100" e-form="textBtnForm" blur="submit" onbeforesave="validate()(column,$data)" onaftersave="saveData()" ng-class={"text-italic":value=="none"}>{{ text || "http://" }} <i ng-class="overclass"></i></a>',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",open:"="},link:function(t,e,n){var a=t.$watch("value",function(){t.text="none"==t.value?"("+r.instant("editor.details.add_video")+"...)":t.value,a()});if(t.selectField=function(){i(function(){e.find(".editable-input").select(),"none"==t.value&&e.find(".editable-input").val("")})},t.saveData=function(){t.value.toString().startsWith("<iframe")||(t.value=o("formatURL")(t.value)),i(function(){t.text=t.value,t.save()})},t.show=function(){t.textBtnForm.$show()},n.open)a=t.$watch("open",function(e){!0===e&&(t.show(),a())})}}}]).directive("detailsLink",["$timeout",function(i){return{template:'<a href="#" onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'"  editable-text="value" blur="submit" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ short_url || "http://" }} <i ng-class="overclass"></i></a>',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",shorten:"="},link:function(e,t){e.selectField=function(){i(function(){t.find(".editable-input").select()})},e.$watch("value",function(){e.value&&(e.short_url=e.shorten?n(e.value,e.shorten):e.value)});var n=function(e,t){var n=(t=void 0!==t?t:50)/2;return e.length<=t?e:a(e,n,!1)+".."+a(e,n,!0)},a=function(e,t,n){for(var a=[" ","/","&"],i=.8*t,r=(e=(n=void 0!==n&&n)?e.split("").reverse().join(""):e,""),o=0;o<t-1&&(r+=e[o],!(i<=o&&0<=a.indexOf(e[o])));o++);return n?r.split("").reverse().join(""):r};e.saveData=function(){i(function(){e.save()})}}}}]).directive("detailsCheck",["$timeout",function(t){return{template:'<a href="#" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" editable-checkbox="checked" blur="submit" e-title="{{title}}" class="editable-checkbox" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ checked && yes || no }}<i ng-class="overclass"></i></a>',restrict:"E",scope:{checked:"=",save:"&",title:"@",yes:"@",no:"@",validate:"&",column:"@"},link:function(e){e.saveData=function(){t(function(){e.save()})}}}}]).directive("detailsDate",["$timeout",function(n){return{template:'<a onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" href="#" editable-bsdate="date" blur="submit" e-ng-change="pastTime()" e-datepicker-popup="dd-MMMM-yyyy" onbeforesave="validate()(column,$data)" onaftersave="saveData($data)">{{ (date | amDateFormat:"dddd, DD MMMM YYYY" ) || ("global.empty"|translate) }}<i ng-class="overclass"></i></a>',restrict:"E",scope:{date:"=",save:"&",validate:"&",column:"@"},link:function(t,e){t.selectField=function(){n(function(){e.find(".editable-input").select(),shortcut.add("enter",function(){e.find(".editable-input").submit(),shortcut.remove("enter")},{disable_in_input:!1})})},t.saveData=function(e){t.previousTime&&(t.date.setHours(t.previousTime.getHours()),t.date.setMinutes(t.previousTime.getMinutes()),n(function(){t.save({data:e,type:t.column})}))},t.pastTime=function(){t.previousTime=new Date(t.date)}}}}]).directive("detailsArea",["$timeout",function(n){return{template:'<a e-rich-textarea onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-textarea="value" onbeforesave="validate()(column,$data)" onaftersave="saveData()"><span ng-bind-html="value || empty_message"></span><i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",empty_message:"@emptyMessage"},link:function(e,t){e.selectField=function(){n(function(){t.find(".editable-input").select()})},e.saveData=function(){n(function(){e.save()})}}}}]).directive("bigArea",["$timeout",function(a){return{template:'<a e-rich-textarea onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-textarea="value" e-rows="5" e-cols="100" onbeforesave="validate()(column,$data)" onaftersave="saveData()"><span ng-bind-html="value || empty_message || (\'global.empty\'|translate)"></span><i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",empty_message:"@emptyMessage"},link:function(t,n){t.selectField=function(){var e=n.find(".editable-input");a(function(){e.select(),"none"==t.value&&e.val("")})},t.saveData=function(){a(function(){t.save()})}}}}]).directive("detailsNumber",["$timeout",function(n){return{template:'<a onshow="selectField();" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-number="value" e-min="min" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ value }}<i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",save:"&",min:"@",validate:"&",column:"@"},link:function(e,t){e.selectField=function(){n(function(){t.find(".editable-input").select()})},e.saveData=function(){n(function(){e.save()})}}}}]).directive("detailsSelect",["$timeout","$filter",function(e,n){return{template:'<a href="#" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" blur="submit" editable-select="value" buttons="no" e-ng-options="s.value as (s.text|translate) for s in options" onbeforesave="validate()(column,$data)" onaftersave="saveData()" e-style="width:120px !important;height:34px">{{ showStatus() }}<i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",options:"=",save:"&",validate:"&",column:"@"},link:function(t){t.showStatus=function(){var e=n("filter")(t.options,{value:t.value});return e.length?n("translate")(e[0].text):"Not set"},t.saveData=function(){e(function(){t.save()})}}}}]).directive("detailsTimeZone",["$timeout","$filter",function(e,n){return{template:'<a href="#" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" blur="submit" editable-select="value" buttons="no" e-ng-options="s.value for s in options" onbeforesave="validate()(column,$data)" onaftersave="saveData()" >{{ showStatus()}}<i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",options:"=",save:"&",validate:"&",column:"@"},link:function(t){t.showStatus=function(){var e=n("filter")(t.options,t.value);return e.length?e[0].value:"Not set"},t.saveData=function(){e(function(){t.save()})}}}}]).directive("detailsTime",["$timeout",function(n){return{template:'<a onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-bstime="time" e-show-meridian="false" e-minute-step="15" onbeforesave="validate()(column,$data)" onaftersave="saveData($data)">{{ (time | date:"HH:mm") || ("global.empty"|translate) }}<i ng-class="overclass"></i></a><timepicker ng-hide="true" />',restrict:"E",scope:{time:"=",save:"&",validate:"&",column:"@"},link:function(t,e){t.selectField=function(){n(function(){e.find(".editable-input td.control-group:nth(0) input").select()})},t.saveData=function(e){n(function(){t.save({data:e,type:t.column})})}}}}]),angular.module("scalearAngularApp").directive("progressMatrix",function(){return{restrict:"E",scope:{columnNames:"=",students:"=",status:"=",solvedCount:"=",totalLecQuiz:"=",action:"&",show_popover:"=showPopover",remaining:"&",scrolldisabled:"=",modstatus:"=",module:"=",export:"&"},templateUrl:"/views/teacher/progress/progress_matrix.html",link:function(e,t){if(e.exportProgress=null,e.export()&&(e.exportProgress=e.export()),e.show_popover){e.popover_options={content:"<div style='font-size:14px; color: black;'><input type='radio' name='stat' ng-model='student.status[module[0]]' ng-change='action({student_id:student.id, module_id:module[0], status:student.status[module[0]] , lecture_quiz:module[7]})' style='margin:0 4px 4px 4px'><span translate>progress.popover.original</span> <input type='radio' name='stat' ng-model='student.status[module[0]]' ng-change='action({student_id:student.id, module_id:module[0], status:student.status[module[0]] , lecture_quiz:module[7]})' style='margin:0 4px 4px 4px' value='Finished on Time' translate><span translate>progress.popover.on_time</span> <input type='radio' name='stat' ng-model='student.status[module[0]]' ng-change='action({student_id:student.id, module_id:module[0], status:student.status[module[0]] , lecture_quiz:module[7]})' style='margin:0 4px 4px 4px' value='Not Finished' translate><span translate>progress.popover.not_done</span></div>",title:"<span style='color: black;' translate>progress.popover.change_status</span>",html:!0,placement:"top",container:"body"}}e.getImg=function(e,t){return e=parseInt(e),t=parseInt(t),-1!=e||0!=t&&!isNaN(t)?-1==e&&0<t?"not_finished":0==e?"finished_on_time":0<e?"finished_not_on_time":void 0:"not_started"}}}}).directive("innerTitle",function(){return{restrict:"E",scope:{time:"=",type:"=",itemtitle:"=",color:"="},template:'<span class="inner_title" ><span style="cursor:pointer"><span ng-show="::(time!=null)">{{::"["+(time|format:"mm:ss")+"]"}}</span> <span >{{::type}}</span>: <span ng-style=\'::{"color":color, "fontWeight":"normal"}\' ng-bind-html="::(itemtitle)"></span></span></span>'}}).directive("showBox",function(){return{restrict:"E",scope:{value:"=",action:"&",text:"@"},template:'<div style="margin-left:4px"><div class="left no-padding" style="margin-right:3px;margin-left:2px"><input class="show_inclass no-margin" type="checkbox" ng-model="value" ng-change="change()" /></div><div class="left size-12 no-padding" style="color:black;font-weight:normal;margin-top: 3px;" > {{::label | translate}} </div></div>',link:function(e,t){e.label=e.text||"progress.button.show_in_class",e.change=function(){e.action(),angular.element("input.show_inclass").blur()}}}}).directive("freeTextTable",function(){return{restrict:"E",scope:{question:"=",survey_id:"=surveyId",lecture_id:"=lectureId",related_answers:"=relatedAnswers",display_only:"=displayOnly",graded:"@"},templateUrl:"/views/teacher/progress/free_text_table.html",controller:"freeTextTableCtrl"}}).directive("inclassEstimate",["$log",function(a){return{restrict:"E",scope:{time_quiz:"=timeQuiz",time_question:"=timeQuestion",video_quiz_count:"=videoQuizCount",quiz_count:"=quizCount",question_count:"=questionCount",survey_count:"=surveyCount",inclass_quiz_time:"=inclassQuizTime",inclass_quiz_count:"=inclassQuizCount"},templateUrl:"/views/teacher/in_class/inclass_time_estimate.html",link:function(n){n.numbers=[];for(var e=0;e<=6;e++)n.numbers.push(e);n.popover_options={content:"<div style='min-width: 235px;'><label class='small-12 columns no-padding'><span translate>inclass.time_per_quiz</span><select style='height: 20px;font-size: 12px;padding: 0 18px;margin: 0;margin-left: 10px;width: 25%;float: right;' ng-model='time_quiz' ng-options='i for i in numbers'></select></label><label class='small-12 columns no-padding with-small-margin-bottom'><span translate>inclass.time_per_question</span><select style='height: 20px;font-size: 12px;padding: 0 18px;margin: 0;margin-left: 10px;width: 25%;float: right;' ng-model='time_question' ng-options='i for i in numbers'></select></label></div>",html:!0,placement:"bottom"};n.$watchCollection("[time_quiz, time_question, video_quiz_count, quiz_count, question_count, survey_count, inclass_quiz_time]",function(e){var t;n.review_estimate=n.video_quiz_count*n.time_quiz+n.question_count*n.time_question+n.survey_count*n.time_question+n.quiz_count*n.time_quiz,n.inclass_estimate=Math.round(n.inclass_quiz_time)||0,n.total_inclass_estimate=n.review_estimate+n.inclass_estimate,n.review_estimate_color=(t=n.review_estimate,a.debug(t),12<t?"red":8<t?"orange":"black")})}}}]),angular.module("scalearAngularApp").directive("moduleProgressCheck",function(){return{restrict:"E",scope:{module:"&"},templateUrl:"/views/student/lectures/module_progress_check.html",link:function(t,e){var n=t.module().items.filter(function(e){return e.graded}).length,a=0==n;a&&(n=t.module().items.filter(function(e){return"customlink"!=e.class_name}).length);var i=t.$watch("module().items",function(){t.module_done=r()==n},!0),r=function(){if(a)var e=function(e){return e.done&&"customlink"!=e.class_name};else e=function(e){return e.done&&e.graded};return t.module().items.filter(e).length};t.$on("$destroy",function(){i()})}}}),angular.module("scalearAngularApp").directive("studentQuiz",["Lecture","$stateParams","$log","$rootScope",function(e,t,n,i){return{scope:{quiz:"=",studentAnswers:"=",submitted:"=",correct:"=",explanation:"=",saveSelection:"=",updateTime:"=",selectionSubmitted:"="},restrict:"E",templateUrl:"/views/student/lectures/student_quiz.html",link:function(a){a.index=0,a.drag_explanation={},a.getIndex=function(){return++a.index},a.sortableOptions={stop:function(e,t){a.saveSelection("save")}},a.updateValues=function(e){if("quiz"==a.quiz.quiz_type){if(""==a.studentAnswers[e]&&null==a.studentAnswers[e])a.values=0;else if("number"==typeof a.studentAnswers[e]||"string"==typeof a.studentAnswers[e]&&0<a.studentAnswers[e].length)a.values=1;else for(var t in a.studentAnswers[e])1==a.studentAnswers[e][t]&&(a.values=1);return a.saveSelection("save"),a.values}},a.valid=function(e){return 0!=a.updateValues(e)},a.getExplanationPop=function(e,t){return{content:'<div ng-bind-html="explanation['+e+"]"+(null!=t?"["+t+"]":"")+'"></div>',html:!0,trigger:i.is_mobile?"click":"hover",placement:"left"}},a.$watch("explanation",function(e){e&&Object.keys(a.explanation).length&&a.quiz.questions.forEach(function(n){"DRAG"!==n.question_type.toUpperCase()?n.answers.forEach(function(e){e.options=a.explanation[e.id]?a.getExplanationPop(e.id):""}):a.studentAnswers[n.id].forEach(function(e,t){a.drag_explanation[t]=a.explanation[n.answers[0].id]?a.getExplanationPop(n.answers[0].id,t):""})})})}}}]),angular.module("scalearAngularApp").directive("notification",["$translate","$log",function(a,e){return{restrict:"E",scope:{message:"=",submessage:"=",middleMessage:"="},templateUrl:"/views/student/lectures/notification.html",link:function(e,t,n){e.correct_notify=a.instant("lectures.correct"),e.incorrect_notify=a.instant("lectures.incorrect")}}}]).directive("reviewInclass",["$translate","$log",function(e,t){return{restrict:"E",scope:{vote:"&",close:"&",retry:"&"},templateUrl:"/views/student/lectures/review_inclass.html",link:function(e,t,n){}}}]).directive("checkAnswer",["$log",function(e){return{restrict:"E",replace:!0,scope:{action:"&"},template:'<button type="button" class="tiny success button with-small-padding no-margin" ng-click="action(); ">{{"lectures.button.check_answer" | translate}}</button>'}}]).directive("studentAnswerForm",["Lecture","$stateParams","$log",function(e,t,n){return{scope:{quiz:"=",studentAnswers:"=",submitted:"=",explanation:"="},restrict:"E",template:"<ng-form name='qform'><div style='text-align:left;margin:10px;'><label style='font-size: 15px;padding-bottom: 10px;' ng-bind-html='quiz.question'>:</label><div class='answer_div'><div class='answer_div_before'>{{quiz.question_type.toUpperCase() == 'FREE TEXT QUESTION'? 'lectures.answer' : 'lectures.choices' | translate}}</div><student-html-answer /></div></div></ng-form>",link:function(e,t,n,a){e.studentAnswers=e.studentAnswers||{}}}}]).directive("studentHtmlAnswer",["$log",function(e){return{restrict:"E",template:"<div ng-switch on='quiz.question_type.toUpperCase()' ><div ng-switch-when='MCQ' ><student-html-mcq  ng-repeat='answer in quiz.online_answers' /></div><div ng-switch-when='OCQ' ><student-html-ocq  ng-repeat='answer in quiz.online_answers' /></div><div ng-switch-when='FREE TEXT QUESTION'><student-html-free /></div><ul  ng-switch-when='DRAG' class='drag-sort sortable' ui-sortable ng-model='studentAnswers[quiz.id]'><student-html-drag ng-repeat='answer in studentAnswers[quiz.id]' /></ul></div>",link:function(t){t.updateValues=function(){if(t.values=0,"html"!=t.quiz.quiz_type&&"html_survey"!=t.quiz.quiz_type||"OCQ"!=t.quiz.question_type)for(var e in t.studentAnswers[t.quiz.id])1==t.studentAnswers[t.quiz.id][e]&&(t.values+=1);else"string"==typeof t.studentAnswers[t.quiz.id]&&(t.values+=1)},t.$watch("quiz.question",function(){t.updateValues()})}}}]).directive("studentHtmlMcq",["$translate","$log",function(e,t){return{restrict:"E",template:"<ng-form name='aform' ><input atleastone ng-model='studentAnswers[quiz.id][answer.id]' name='mcq_{{quiz.id}}' type='checkbox' ng-change='updateValues({{quiz.id}})' pop-over='mypop' /><p style='display:inline;margin-left:10px' ng-bind-html='answer.answer'></p><br/><span class='errormessage' ng-show='submitted && aform.$error.atleastone' translate='lectures.messages.please_choose_one_answer'></span><br/></ng-form>",link:function(t){t.$watch("explanation[answer.id]",function(e){t.explanation&&t.explanation[t.answer.id]&&(t.mypop={title:'<b ng-class="{\'green_notification\':explanation[answer.id][0]==true, \'red_notification\':explanation[answer.id][0]==false}">{{explanation[answer.id][0]==true?("lectures.correct"|translate) : ("lectures.incorrect"| translate)}}</b>',content:'<div ng-bind-html="explanation[answer.id][1]"></div>',html:!0,trigger:"hover",instant_show:"mouseover"})}),t.$on("$destroy",function(){t.explanation[t.answer.id]=null})}}}]).directive("studentHtmlOcq",["$translate","$log",function(e,n){return{restrict:"E",template:"<ng-form name='aform'><input atleastone ng-model='studentAnswers[quiz.id]' value='{{answer.id}}'  name='ocq_{{quiz.id}}' type='radio' ng-change='updateValues({{quiz.id}})' pop-over='mypop'/><p style='display:inline;margin-left:10px' ng-bind-html='answer.answer'></p><br/><span class='errormessage' ng-show='submitted && aform.$error.atleastone' translate='lectures.messages.please_choose_one_answer'></span><br/></ng-form>",link:function(t){t.$watch("explanation[answer.id]",function(e){t.explanation&&t.explanation[t.answer.id]&&(n.debug("exp changed!!!"),t.mypop={title:'<b ng-class="{\'green_notification\':explanation[answer.id][0]==true, \'red_notification\':explanation[answer.id][0]==false}">{{explanation[answer.id][0]==true?("lectures.correct"|translate) : ("lectures.incorrect"| translate)}}</b>',content:'<div ng-bind-html="explanation[answer.id][1]"></div>',html:!0,trigger:"hover",instant_show:"mouseover"})}),t.$on("$destroy",function(){t.explanation&&t.explanation[t.answer.id]&&(t.explanation[t.answer.id]=null)})}}}]).directive("studentHtmlDrag",function(){return{restrict:"E",replace:!0,templateUrl:"/views/student/lectures/html_drag.html",link:function(t){t.$watch("explanation[quiz.id]",function(e){t.explanation&&t.explanation[t.quiz.id]&&(t.mypop={content:'<div ng-bind-html="explanation[quiz.id][answer]"></div>',html:!0,trigger:"hover",container:"body"})}),t.$on("$destroy",function(){t.explanation[t.quiz.id]=null})}}}).directive("studentHtmlFree",["$translate","$log","$timeout","MobileDetector",function(e,t,n,a){var i="14px";return a.isMobile()&&(i="10px"),{restrict:"E",template:"<ng-form name='aform'><textarea ng-click='studentHtmlFreeInputClick($event)' ng-model='studentAnswers[quiz.id]' style='width:600px;height:110px;caret-color:blue;font-size:"+i+";' required></textarea><span class='errormessage' ng-show='submitted && aform.$error.required' translate='error_message.required'></span><br/></ng-form><div ng-bind-html='explanation[quiz.id]'></div>",link:function(e,t){e.$on("$destroy",function(){e.explanation[e.quiz.id]=null}),e.studentHtmlFreeInputClick=function(e){n(function(){angular.element(t).find("textarea").focus(),e.stopPropagation()})}}}}]).directive("studentAnswerVideo",["$log",function(e){return{restrict:"E",scope:{quiz:"=",data:"=",explanation:"=",studentAnswers:"=",correctSelections:"="},template:"<div ng-switch on='quiz.question_type.toUpperCase()'><div ng-switch-when='MCQ'><student-answer /></div><div ng-switch-when='OCQ'><student-answer correct_selections='correct_selections'/></div><div ng-switch-when='DRAG'><student-drag /></div><div ng-switch-when='FREE TEXT QUESTION'><student-free-text /></div></div>"}}]).directive("studentAnswer",["$rootScope","$translate","$log","$timeout",function(i,e,r,o){return{replace:!0,restrict:"E",templateUrl:"/views/student/lectures/answer.html",link:function(t,n,e,a){t.radioChange=function(e){t.correctSelections||(t.checkAnswerClicked=!1),"OCQ"==t.quiz.question_type&&(r.debug("radioChange"),t.quiz.online_answers.forEach(function(e){e.selected=!1}),e.selected=!0)},t.$watch("explanation[data.id]",function(e){t.explanation&&t.explanation[t.data.id]&&(t.checkAnswerClicked=!0,t.explanation[t.data.id][0]?(t.title_class="green_notification",t.exp_title="lectures.correct",t.show_sub_title="MCQ"==t.quiz.question_type):(t.title_class="red_notification",t.exp_title="lectures.incorrect"),t.explanation_pop={title:"<b ng-class='title_class'>{{(exp_title|translate)}}</b><h6 class='subheader no-margin' style='font-size:12px' ng-show='show_sub_title' translate>lectures.other_correct_answers</h6>",content:"<div ng-bind-html='explanation[data.id][1]'></div>",html:!0,trigger:i.is_mobile?"click":"hover",placement:.5<t.data.xcoor?"left":"right"},o(function(){t.explanation[t.data.id][0]&&n.siblings().css("z-index",1e4)},300))}),t.$on("$destroy",function(){t.explanation&&(t.explanation[t.data.id]=null)}),function(){t.explanation_pop={};var e="MCQ"==t.quiz.question_type?"checkbox":"radio";n[0].children.student_answer.setAttribute("type",e)}()}}}]).directive("studentDrag",["$rootScope","$translate","$log","ScalearUtils",function(i,e,t,c){return{restrict:"E",templateUrl:"/views/student/lectures/answer_drag.html",link:function(s,a){s.formatDrag=function(e,t){var n=angular.element(t.helper[0]);u(n)},s.convertPositionToPercent=function(e,t){var n=angular.element(t.helper[0]),a=angular.element(".ontop"),i=n.position().left,r=n.position().top;n.css({left:i/a.width()*100+"%",top:r/a.height()*100+"%"})},s.adjustDrag=function(e,t){var n=angular.element(t.helper[0]),a=angular.element(".ontop"),i=e.pageX-a.offset().left,r=e.pageY-a.offset().top;e.pageX-n.width()<a.offset().left?t.position.left=0:i>a.width()?t.position.left=a.width()-n.width():t.position.left=i-n.width()/2,e.pageY-n.height()<a.offset().top?t.position.top=0:r>a.height()?t.position.top=a.height()-n.height():t.position.top=r-n.height()},s.formatDropped=function(e,t){s.studentAnswers[s.quiz.id][s.data.id]?t.draggable.css("background-color","orange"):t.draggable.css("background-color","lightblue")},s.setDropped=function(e,t){if(s.studentAnswers[s.quiz.id][s.data.id]){var n=angular.element("#"+s.data.id);u(n),d(n),l(n),s.setDropped(e,t)}else{t.draggable.css("background-color","lightblue"),t.draggable.css("width",100*s.data.width+"%"),t.draggable.css("height",100*s.data.height+"%"),t.draggable.css("word-wrap","break-word"),t.draggable.css("overflow","hidden");var a=angular.element("#ontop").width(),i=angular.element("#ontop").height(),r=s.data.width*a,o=s.data.height*i*r/t.draggable.text().length;o=Math.min(Math.sqrt(o),15),t.draggable.css("font-size",o+"px"),t.draggable.css("left",100*s.data.xcoor+"%"),t.draggable.css("top",100*s.data.ycoor+"%"),t.draggable.addClass("dropped"),s.studentAnswers[s.quiz.id][s.data.id]=t.draggable.html(),t.draggable.attr("id",s.data.id),c.safeApply()}},s.clearDropped=function(e,t){n(t.draggable),l(t.draggable),t.draggable.css("font-size","15px"),t.draggable.css("overflow","scroll")};var e,l=function(e){e.attr("id")==s.data.id&&(s.studentAnswers[s.quiz.id][s.data.id]="",c.safeApply()),e.css("background-color",""),e.attr("id","")},u=function(e){e.removeClass("dropped"),e.width(""),e.height("")},d=function(e){e.css("left",100*s.data.sub_xcoor+"%"),e.css("top",100*s.data.sub_ycoor+"%")},n=function(e){s.explanation_pop&&e.popover("destroy")};s.$watch("explanation[data.id]",function(e){if(s.explanation&&s.explanation[s.data.id]){s.selected_id=angular.element(a.children()[1]).attr("id");var t=angular.element(".ontop");s.explanation_pop={title:"<b ng-class='{green_notification: explanation[selected_id][0], red_notification: !explanation[selected_id][0]}'>{{explanation[selected_id][0]?('lectures.correct'|translate):('lectures.incorrect'|translate)}}</b>",content:"<div ng-bind-html='explanation[selected_id][1]'></div>",html:!0,trigger:i.is_mobile?"click":"hover",placement:angular.element(a.children()[1]).position().left>t.width()/2?"left":"right"};var n=s.explanation[s.data.id][0]?"darkseagreen":"orangered";angular.element("#"+s.data.id).css("background-color",n)}}),s.$on("$destroy",function(){s.explanation[s.data.id]=null}),e=angular.element("#"+s.data.id),n(e),s.explanation_pop={},s.explanation[s.data.id]=null}}}]).directive("studentFreeText",["$rootScope","$translate","$log","$timeout",function(a,e,t,i){return{restrict:"E",template:'<textarea ng-click="freeTextInputClick($event)" placeholder="Write your answer here..." pop-over="explanation_pop" ng-model="studentAnswers[quiz.id]" ng-style="{left: (data.xcoor*100)+\'%\', top: (data.ycoor*100)+\'%\', width:(data.width*100)+\'%\', height:(data.height*100)+\'%\'}"  style="resize:none;position:absolute;font-size: 12px;"></textarea>',link:function(t,n){t.$watch("explanation[quiz.id]",function(e){t.explanation&&t.explanation[t.quiz.id]&&(t.explanation_pop={title:"<b ng-class='title_class'>{{(exp_title|translate)}}</b><h6 class='subheader no-margin' style='font-size:12px' ng-show='show_sub_title' translate>lectures.other_correct_answers</h6>",content:"<div ng-bind-html='explanation[quiz.id]'></div>",html:!0,trigger:a.is_mobile?"click":"hover",placement:.5<t.data.xcoor?"left":"right",container:"body"})}),t.freeTextInputClick=function(e){i(function(){angular.element(n).find("textarea").focus(),e.stopPropagation()})},t.$on("$destroy",function(){t.explanation[t.quiz.id]=null}),t.explanation_pop={},t.explanation[t.data.id]=null}}}]).directive("studentTimeline",["$timeout","ContentNavigator","TimelineFilter",function(a,i,r){return{replace:!0,restrict:"E",scope:{timeline:"=",items:"=",lecture:"=current",seek:"&",open_timeline:"=open",totalduration:"="},templateUrl:"/views/student/lectures/student_timeline.html",link:function(t,e,n){t.ContentNavigator=i,t.$watch("open_timeline",function(e){e?a(function(){t.delayed_timeline_open=!0},300):t.delayed_timeline_open=e}),t.checkEmpty=function(e){return""!=e.type},t.filterType=function(e){return r.get(e.type)}}}}]).directive("confusedTimeline",["Lecture","$filter",function(a,i){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/confused_timeline.html",link:function(n,e,t){n.item=n.data(),n.formattedTime=i("format","hh:mm:ss")(n.item.time),n.deleteConfused=function(t){a.deleteConfused({course_id:t.data.course_id,lecture_id:t.data.lecture_id,confused_id:t.data.id},function(e){n.$emit("remove_from_timeline",t)})}}}}]).directive("quizTimeline",["OnlineQuiz","$filter","$rootScope","$translate","$log",function(a,i,r,o,s){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/quiz_timeline.html",link:function(t,e,n){t.item=t.data(),t.preview_as_student=r.preview_as_student,t.formattedTime=i("format","hh:mm:ss")(t.item.time),t.unsolved_msg=o.instant("lectures.tooltip.unsolved_quiz"),t.voteForReview=function(){s.debug("vote review"),a.voteForReview({online_quizzes_id:t.item.data.id},{},function(e){e.done&&(t.item.data.reviewed||(t.item.data.reviewed=!0,t.item.data.votes_count++))})},t.unvoteForReview=function(){s.debug("unvote review"),a.unvoteForReview({online_quizzes_id:t.item.data.id},{},function(e){e.done&&t.item.data.reviewed&&(t.item.data.reviewed=!1,t.item.data.votes_count--)})}}}}]).directive("notesTimeline",["$log","Lecture","$state","$filter",function(a,i,r,o){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/notes_timeline.html",link:function(t,e,n){t.item=t.data(),t.formattedTime=o("format","hh:mm:ss")(t.item.time),t.deleteNote=function(){t.item.data&&t.item.data.id?i.deleteNote({course_id:r.params.course_id,lecture_id:t.item.data.lecture_id||r.params.lecture_id,note_id:t.item.data.id},function(){t.$emit("remove_from_timeline",t.item)}):t.$emit("remove_from_timeline",t.item)},t.saveNote=function(e){a.debug(t.item),i.saveNote({course_id:r.params.course_id,lecture_id:t.item.data.lecture_id||r.params.lecture_id,note_id:t.item.data.id||null},{data:e,time:t.item.time},function(e){t.item.data=e.note})}}}}]).directive("notesArea",["$timeout",function(n){return{template:'<div   e-rich-textarea onshow="moveCursorToEnd()" e-rows="3" e-cols="100" blur="submit" editable-textarea="value" e-form="myform" buttons="no" onaftersave="saveData()" e-placeholder="Note..." ng-click="show()" e-style="width:95% !important; font-size: 13px;color: teal; height:80px" style="padding:0 9px"><div class="note" style="word-break: break-word; margin: 0px;cursor: text;float:left"><span ng-bind-html="value" style="white-space: pre-wrap;"></span></div><div style="font-size: 10px; float: right; display: inline-block;"><delete_button size="small" action="delete()" vertical="false" text="false" ></delete_button></div></div>',restrict:"E",scope:{value:"=",save:"&",delete:"&"},link:function(e,t){e.$on("$destroy",function(){shortcut.remove("enter"),shortcut.remove("esc")}),e.moveCursorToEnd=function(){shortcut.add("enter",function(){$("form.editable-textarea").submit()},{disable_in_input:!1}),shortcut.add("esc",function(){$("form.editable-textarea").submit()},{disable_in_input:!1})},e.show=function(){e.myform.$show(),$(".medium-editor-textarea").focus()},e.value||e.show(),e.saveData=function(){e.$emit("note_updated"),e.value?n(function(){e.save()(e.value)}):e.delete()}}}}]).directive("markersTimeline",["$filter",function(a){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/markers_timeline.html",link:function(e,t,n){e.item=e.data(),e.formattedTime=a("format","hh:mm:ss")(e.item.time)}}}]).directive("annotation",["$filter",function(e){return{restrict:"E",scope:{annotation:"=text",close:"&",action:"&"},templateUrl:"/views/student/lectures/annotation.html",link:function(e,t,n){e.closeBtn=e.close(),e.actionBtn=e.action()}}}]).directive("dynamicAnnotationStudent",["$filter","$rootScope","CourseModel","$timeout",function(e,t,n,a){return{restrict:"E",scope:{data:"=",close:"&",action:"&",textToShow:"="},templateUrl:"/views/student/lectures/dynamic_annotation_student.html",link:function(e,t,n){e.closeBtn=e.close(),e.actionBtn=e.action()}}}]).directive("slideNote",["$filter","$rootScope","CourseModel","$timeout",function(e,t,n,a){return{restrict:"E",scope:{data:"=",close:"&",action:"&"},templateUrl:"/views/student/lectures/slide_note.html",link:function(e,t,n){e.closeBtn=e.close(),e.actionBtn=e.action()}}}]).directive("correctionMark",[function(){return{restrict:"E",scope:{data:"=",correctSelections:"="},templateUrl:"/views/student/lectures/mark.html",link:function(n,a,e){n.setStyle=function(){var e=n.data,t=a[0].firstElementChild;e.xcoor<.5?t.style.left=100*e.xcoor+1.5+"%":t.style.left=100*e.xcoor-2+"%",t.style.top=100*e.ycoor-.5+"%",t.style.position="absolute",t.style.zIndex="20",t.style.height="20px",t.className="mark"}}}}]),angular.module("scalearAngularApp").directive("eventItem",["$filter",function(e){return{replace:!0,restrict:"E",scope:{event:"=",role:"="},templateUrl:"/views/student/news_feed/event_item.html"}}]),angular.module("scalearAngularApp").directive("questionBlock",["$log","$translate","Forum","$state","$rootScope","User","$filter","ScalearUtils","VideoInformation","UserSession","$timeout","MobileDetector",function(a,i,r,o,s,l,u,d,c,_,m,p){return{restrict:"E",templateUrl:"/views/forum/question_block.html",scope:{item:"=",pref:"="},link:function(n,e,t){_.getCurrentUser().then(function(e){n.current_user=e,function(){n.preview_as_student=s.preview_as_student,n.ask_button_clicked=!1,n.choices=[{text:i.instant("discussion.private_discussion"),value:0},{text:i.instant("discussion.public_discussion"),value:1}],n.privacy=n.choices[n.current_user.discussion_pref],"number"==typeof n.item.time&&(n.item.time=u("format","hh:mm:ss")(n.item.time));p.isPhone()||m(function(){$(".text_block").focus()});n.item.data&&n.item.data.isEdit&&(n.privacy=0==n.item.data.privacy?n.choices[0]:n.choices[1],n.current_question=n.item.data.content)}()});n.postQuestion=function(t){n.current_question&&n.current_question.length&&""!=n.current_question.trim()?(n.current_user.discussion_pref!=n.privacy.value&&(n.current_user.discussion_pref=n.privacy.value,l.alterPref({},{privacy:n.privacy.value})),n.time_error=d.validateTimeWithDuration(t.time,c.duration),n.time_error||(n.ask_button_clicked=!0,t.time=d.arrayToSeconds(t.time.split(":")),r.createPost({post:{content:n.current_question,time:t.time,lecture_id:o.params.lecture_id,privacy:n.privacy.value}},function(e){a.debug("success"),t.data=e.post,n.error_message=null,n.current_question=""},function(){a.debug("failure")}),n.$emit("discussion_updated"))):n.$emit("remove_from_timeline",t)},n.updateQuestion=function(e){n.current_question&&n.current_question.length&&""!=n.current_question.trim()?(n.time_error=d.validateTimeWithDuration(e.time,c.duration),n.time_error||(n.ask_button_clicked=!0,e.time=d.arrayToSeconds(e.time.split(":")),r.updatePost({post_id:e.data.id},{content:n.current_question,time:e.time},function(){e.data.content=n.current_question,e.data.updated_at=new Date,e.data.edited=!0,e.data.isEdit=!1,n.error_message=null,n.current_question=""}))):e.data.isEdit=!1},n.cancelQuestion=function(e){n.$emit("discussion_updated"),n.$emit("remove_from_timeline",e)},n.$on("post_question",function(e,t){t.data&&t.data.isEdit?n.updateQuestion(t.data):n.postQuestion(t)}),shortcut.add("enter",function(){n.item.data&&n.item.data.isEdit?n.updateQuestion(n.item):n.postQuestion(n.item),n.$apply()},{disable_in_input:!1}),n.$on("$destroy",function(){shortcut.remove("enter")})}}}]).directive("discussionTimeline",["Forum","Timeline","$translate","$rootScope","$filter","$log","$window","MobileDetector","UserSession",function(i,e,r,n,o,s,t,l,u){return{restrict:"A",scope:{seek:"&",data:"&"},templateUrl:"/views/forum/discussion_timeline.html",link:function(a,e,t){u.getCurrentUser().then(function(e){a.current_user=e}),a.turncatingcount=30,l.isiPad()&&(a.turncatingcount=15),a.item=a.data(),a.preview_as_student=n.preview_as_student,a.formattedTime=o("format","hh:mm:ss")(a.item.time),a.private_text=r.instant("discussion.private_post"),a.public_text=r.instant("discussion.public_post"),a.deleteDiscussion=function(t){i.deletePost({post_id:t.data.id},function(e){a.error_message=null,a.$emit("remove_from_timeline",t)},function(){})},a.flagPost=function(){i.flagPost({post_id:a.item.data.id},function(e){a.item.data.user_flag=1,a.item.data.flags_count++})},a.unflagPost=function(){i.flagPost({post_id:a.item.data.id},function(e){a.item.data.user_flag=0,a.item.data.flags_count--})},a.upvotePost=function(){i.votePost({vote:parseInt(a.item.data.user_vote)+1,post_id:a.item.data.id},function(e){a.item.data.user_vote=1,a.item.data.votes_count++})},a.downvotePost=function(){i.votePost({vote:parseInt(a.item.data.user_vote)-1,post_id:a.item.data.id},function(e){a.item.data.user_vote=0,a.item.data.votes_count--})},a.deleteComment=function(n){i.deleteComment({comment_id:n.id,post_id:a.item.data.id},function(e){var t=a.item.data.comments.indexOf(n);a.item.data.comments.splice(t,1),a.error_message=null})},a.reply=function(t,n){n&&n.length&&""!=n.trim()?(a.error_message=null,s.debug("discussion",t),i.createComment({comment:{content:n,post_id:t.data.id,lecture_id:t.data.lecture_id}},function(e){t.data.comments?t.data.comments.push(e.comment):t.data.comments=[e.comment],n=""},function(){})):a.error_message=r.instant("discussion.cannot_be_empty"),angular.element(".btn").blur()}}}}]).directive("discussionComment",["Forum","Timeline","$translate","$rootScope","$log","UserSession",function(a,e,t,i,n,r){return{restrict:"E",scope:{comment:"=",delete:"&"},templateUrl:"/views/forum/discussion_comment.html",link:function(t,e,n){r.getCurrentUser().then(function(e){t.current_user=e}),t.preview_as_student=i.preview_as_student,t.flagComment=function(){a.flagComment({comment_flag:{comment_id:t.comment.id}},function(e){t.comment.user_flag=1,t.comment.flags_count++})},t.unflagComment=function(){a.flagComment({comment_flag:{comment_id:t.comment.id}},function(e){t.comment.user_flag=0,t.comment.flags_count--})},t.upvoteComment=function(){a.voteComment({comment_vote:{vote:parseInt(t.comment.user_vote)+1,comment_id:t.comment.id}},function(e){t.comment.user_vote=1,t.comment.votes_count++})},t.downvoteComment=function(){a.voteComment({comment_vote:{vote:parseInt(t.comment.user_vote)-1,comment_id:t.comment.id}},function(e){t.comment.user_vote=0,t.comment.votes_count--})}}}}]).directive("votingButton",["$translate","$log",function(n,e){return{restrict:"E",scope:{votes_count:"=votesCount",voted:"=",up:"&",down:"&",direction:"@"},templateUrl:"/views/forum/like_button.html",link:function(e,t){e.like_text=n.instant("discussion.like"),e.unlike_text=n.instant("discussion.unlike"),angular.element(t.find(".looks-like-a-link")).css("display","horizontal"==e.direction?"inline-block":"block")}}}]).directive("flagButton",["$translate","$log",function(n,e){return{restrict:"E",scope:{flagged:"=",flag:"&",unflag:"&"},templateUrl:"/views/forum/flag_button.html",link:function(e,t){e.flag_text=n.instant("discussion.flag_post"),e.unflag_text=n.instant("discussion.unflag_post")}}}]).directive("commentBox",["$log",function(n){return{restrict:"E",scope:{discussion:"&",submit:"&"},templateUrl:"/views/forum/comment_box.html",link:function(e,t){e.showfield=!1,e.submitComment=function(){e.submit()(e.discussion(),e.comment),e.comment=null,e.hideField(),n.debug(e.showfield)},e.toggleField=function(){e.showfield=!e.showfield},e.hideField=function(){!e.comment&&e.showfield&&e.toggleField()}}}}]),angular.module("scalearAngularApp").factory("Course",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/courses/:course_id/:action",{course_id:n.course_id,lang:o.use()},{create:{method:"POST",headers:i,params:{course_id:null}},index:{method:"GET",ignoreLoadingBar:!0,headers:i,params:{course_id:null}},update:{method:"PUT",headers:i},validateCourse:{method:"PUT",params:{action:"validate_course_angular"},headers:i},send_batch_email_through:{method:"POST",params:{action:"send_batch_email_through"},headers:i},removeStudent:{method:"POST",params:{action:"remove_student"},headers:i},unenroll:{method:"POST",params:{action:"unenroll"},headers:i},destroy:{method:"DELETE",headers:i},show:{method:"GET",headers:i},saveTeacher:{method:"POST",params:{action:"save_teachers"},headers:i},updateTeacher:{method:"POST",params:{action:"update_teacher"},headers:i},updateStudentDueDateEmail:{method:"POST",params:{action:"update_student_duedate_email"},headers:i},updateTeacherDiscussionEmail:{method:"POST",params:{action:"update_teacher_discussion_email"},headers:i},getStudentDueDateEmail:{method:"GET",params:{action:"get_student_duedate_email"},headers:i},deleteTeacher:{method:"DELETE",params:{action:"delete_teacher"},headers:i},getCalendarEvents:{method:"GET",params:{action:"events"},headers:i},getAnnouncements:{method:"GET",isArray:!0,params:{action:"announcements"},headers:i},newCourse:{method:"GET",headers:i,params:{action:"new",course_id:null}},getCourseEditor:{method:"GET",params:{action:"course_editor_angular"},headers:i},getTeachers:{method:"GET",params:{action:"teachers"},headers:i},getSelectedSubdomains:{method:"GET",params:{action:"get_selected_subdomains"},headers:i},setSelectedSubdomains:{method:"POST",params:{action:"set_selected_subdomains"},headers:i},enroll:{method:"POST",params:{action:"enroll_to_course",course_id:null},headers:i},getModuleProgress:{method:"GET",ignoreLoadingBar:!0,params:{action:"module_progress_angular"},headers:i},getTotalChart:{method:"GET",params:{action:"get_total_chart_angular"},headers:i},getCourseware:{method:"GET",params:{action:"courseware_angular"},headers:i},getEnrolledStudents:{method:"GET",params:{action:"enrolled_students"},headers:i,isArray:!0},exportCsv:{method:"GET",params:{action:"export_csv"},headers:i},exportStudentCsv:{method:"GET",params:{action:"export_student_csv"},headers:i},currentCourses:{method:"GET",isArray:!1,headers:i,params:{action:"current_courses"}},exportModuleProgress:{method:"GET",headers:i,params:{action:"export_modules_progress"}},systemWideEmail:{method:"POST",params:{action:"send_system_announcement"},headers:i},getRole:{method:"GET",headers:i,params:{action:"get_role"}}})}]).factory("CourseModel",["Course","$rootScope","$q","UserSession","$cookieStore","ScalearUtils",function(o,s,t,e,i,n){var a,r,l=null;function u(e){return l||(l=t.defer(),o.getRole({course_id:e}).$promise.then(function(e){var t;t=e.role,a=t,l.resolve(e.role)}).catch(function(){d()})),l.promise}function d(){a=l=null}function c(){return 2==a||7==a}function _(){return 1==a}function m(e){return e.instanceType&&"Course"==e.instanceType()}function p(t){if(m(t))return t;return angular.extend(t,{instanceType:function(){return"Course"},update:function(){var e=angular.copy(t);return e.time_zone=t.time_zone.name,delete e.id,delete e.created_at,delete e.updated_at,delete e.unique_identifier,delete e.duration,delete e.guest_unique_identifier,o.update({course_id:t.id},{course:e}).$promise},validate:function(){return o.validateCourse({course_id:t.id},t).$promise.catch(function(e){return 422==e.status?e.data.errors.join():"Server Error"})},exportCourse:function(){return o.exportCsv({course_id:t.id}).$promise},getAnnouncements:function(){return o.getAnnouncements({course_id:t.id}).$promise},getStudentDueDateEmail:function(){return o.getStudentDueDateEmail({course_id:t.id}).$promise},updateStudentDueDateEmail:function(e){o.updateStudentDueDateEmail({course_id:t.id},{email_due_date:e})},updateTeacherDiscussionEmail:function(e){o.updateTeacherDiscussionEmail({course_id:t.id},{email_discussion:e})}})}return{getCourseRole:u,removeCourseRole:d,removeSelectedCourse:function(){r=null},getData:function(a){return e.getCurrentUser().then(function(e){if(e&&e.roles)return d(),u(a)}).then(function(e){return _()?(n=a,i.remove("preview_as_student"),i.remove("old_user_id"),i.remove("new_user_id"),i.remove("course_id"),o.getCourseEditor({course_id:n}).$promise.then(function(e){return s.$broadcast("Course:set_modules",e.groups),e.course})):c()?(t=a,o.getCourseware({course_id:t}).$promise.then(function(e){return e.course.next_item=e.next_item,s.$broadcast("Course:set_modules",e.groups),e.course})):void 0;var t,n}).then(function(e){var t=p(e);return r=t,s.$broadcast("Course:ready",t),t})},getSelectedCourse:function(){return r},isStudent:c,isTeacher:_,createInstance:p,isInstance:m,currentCourses:function(){return o.currentCourses({}).$promise},getUserOtherCourses:function(){return o.newCourse().$promise},create:function(e,t){var n=e.selected_subdomain,a=e.email_discussion;delete e.selected_subdomain,delete e.email_discussion;var i=angular.copy(e),r=new Date;return i.start_date.setMinutes(i.start_date.getMinutes()-r.getTimezoneOffset()),i.time_zone=e.time_zone.name,o.create({course:i,import:t,subdomains:n,email_discussion:a}).$promise.then(function(e){return s.$broadcast("Course:get_current_courses"),e})}}}]),angular.module("scalearAngularApp").factory("TeacherModel",["Course","CourseModel",function(t,n){return{getTeachers:function(){return t.getTeachers({course_id:n.getSelectedCourse().id}).$promise},getSelectedSubdomains:function(){return t.getSelectedSubdomains({course_id:n.getSelectedCourse().id}).$promise},setSelectedSubdomains:function(e){return t.setSelectedSubdomains({course_id:n.getSelectedCourse().id},{selected_subdomains:e}).$promise},updateTeacher:function(e){return t.updateTeacher({course_id:n.getSelectedCourse().id},e).$promise},deleteTeacher:function(e){return t.deleteTeacher({course_id:n.getSelectedCourse().id,email:e.email}).$promise},saveNewTeacher:function(e){return t.saveTeacher({course_id:n.getSelectedCourse().id},{new_teacher:e}).$promise}}}]),angular.module("scalearAngularApp").factory("Module",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/courses/:course_id/groups/:module_id/:action",{course_id:n.course_id,lang:o.use()},{update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},newModule:{method:"POST",params:{action:"new_module_angular"},headers:i},newCustomLink:{method:"POST",params:{action:"new_link_angular"},headers:i},saveSort:{method:"POST",params:{action:"sort"},headers:i},getModuleStatistics:{method:"GET",params:{action:"get_group_statistics"},headers:i},validateModule:{method:"PUT",params:{action:"validate_group_angular"},headers:i},getAllItemsProgress:{method:"GET",ignoreLoadingBar:!0,params:{action:"get_all_items_progress_angular"},headers:i},getStudentStatistics:{method:"GET",params:{action:"get_student_statistics_angular"},headers:i},changeModuleStatus:{method:"POST",ignoreLoadingBar:!0,params:{action:"change_status_angular"},headers:i},hideQuiz:{method:"POST",params:{action:"hide_invideo_quiz"},headers:i},getStudentModule:{method:"GET",params:{action:"get_module_data_angular"},headers:i},moduleCopy:{method:"POST",params:{action:"module_copy"},headers:i},getModuleProgress:{method:"GET",params:{action:"get_module_progress"},headers:i},getModuleInclass:{method:"GET",params:{action:"get_module_inclass"},headers:i},getQuizCharts:{method:"GET",params:{action:"get_quiz_charts"},headers:i},getQuizChartsInclass:{method:"GET",params:{action:"get_quiz_charts_inclass"},headers:i},getSurveyCharts:{method:"GET",params:{action:"get_survey_charts"},headers:i},getSurveyChart:{method:"GET",params:{action:"get_survey_chart_angular"},headers:i},getInclassStudentStatus:{method:"GET",ignoreLoadingBar:!0,headers:i,params:{action:"get_inclass_student_status"}},getModuleSummary:{method:"GET",ignoreLoadingBar:!0,headers:i,params:{action:"get_module_summary"}},getOnlineQuizSummary:{method:"GET",ignoreLoadingBar:!0,headers:i,params:{action:"get_online_quiz_summary"}},getDiscussionSummary:{method:"GET",ignoreLoadingBar:!0,headers:i,params:{action:"get_discussion_summary"}},updateAllInclassSessions:{method:"POST",ignoreLoadingBar:!0,headers:i,params:{action:"update_all_inclass_sessions"}},exportModuleTimelineCsv:{method:"GET",headers:i,params:{action:"export_module_timeline_csv"}}})}]).factory("ModuleModel",["Module","$rootScope",function(n,a){var t=null,i=[],r={},o=null;function s(e){i.push(e),r[e.id]=e,a.$broadcast("Module:set_items",e.items)}function l(t){if((e=t).instanceType&&"Module"==e.instanceType())return t;var e;return angular.extend(t,{instanceType:function(){return"Module"},remove:function(){return n.destroy({course_id:t.course_id,module_id:t.id},{}).$promise.then(function(){var e;e=t,i.splice(i.indexOf(e),1),delete r[e.id]})},validate:function(){return n.validateModule({course_id:t.course_id,module_id:t.id},t).$promise.catch(function(e){return 422==e.status?e.data.errors[0]:"Server Error"})},update:function(){var e=angular.copy(t);return delete e.id,delete e.items,delete e.created_at,delete e.updated_at,delete e.total_time,n.update({course_id:t.course_id,module_id:t.id},{group:e}).$promise.then(function(){a.$broadcast("Module:"+t.id+":updated",t)})},getStatistics:function(){return n.getModuleStatistics({course_id:t.course_id,module_id:t.id}).$promise},isVisible:function(){return new Date(t.appearance_time)<=new Date}})}return a.$on("Course:ready",function(e,t){o=t}),a.$on("Course:set_modules",function(e,t){i=[],r={},t.forEach(function(e){s(l(e))}),a.$broadcast("Module:ready",i)}),a.$on("Item:added",function(e,t){var n;r[(n=t).group_id].items.push(n)}),a.$on("Item:removed",function(e,t){var n,a;(a=r[(n=t).group_id].items).splice(a.indexOf(n),1)}),{setSelectedModule:function(e){t=e},getSelectedModule:function(){return t},clearSelectedModule:function(){t=null},getById:function(e){return r[e]},create:function(){return n.newModule({course_id:o.id},{}).$promise.then(function(e){var t=l(e.group);return t.items=[],s(t),a.$broadcast("Module:added",t),t})},createInstance:l,paste:function(e){return n.moduleCopy({course_id:o.id},{module_id:e.id}).$promise.then(function(e){s(l(e.group))})}}}]),angular.module("scalearAngularApp").factory("ItemsModel",["LectureModel","QuizModel","LinkModel","$rootScope","$state","ErrorHandler",function(n,a,i,r,o,s){var l={lecture:{},quiz:{},customlink:{}};function u(e){var t=null;t="lecture"==e.class_name?n.createInstance(e):"quiz"==e.class_name?a.createInstance(e):i.createInstance(e),l[e.class_name][e.id]=t,r.$broadcast("update_module_time",e.group_id)}function t(e,t){if(l[t][e])return l[t][e];o.go("course_list"),s.showMessage("Error: "+t+" not found.","errorMessage",4e3,"error")}function d(){n.clearSelectedLecture(),a.clearSelectedQuiz(),i.getSelectedLink()}return r.$on("Module:set_items",function(e,t){var n;(n=t).forEach(function(e){u(e)}),r.$broadcast("Item:ready",n)}),r.$on("Item:added",function(e,t){u(t)}),r.$on("Item:removed",function(e,t){var n;delete l[(n=t).class_name][n.id],r.$broadcast("update_module_statistics"),"lecture"==n.class_name&&r.$broadcast("update_module_time",n.group_id)}),{getLecture:function(e){return t(e,"lecture")},getQuiz:function(e){return t(e,"quiz")},getLink:function(e){return t(e,"customlink")},getSelectedItem:function(){return n.getSelectedLecture()||a.getSelectedQuiz()||i.getSelectedLink()},setSelectedItem:function(e){d(),"lecture"==e.class_name?n.setSelectedLecture(e):"quiz"==e.class_name?a.setSelectedQuiz(e):i.setSelectedLink(e)},clearAllSelected:d,getById:t}}]),angular.module("scalearAngularApp").factory("Lecture",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/courses/:course_id/lectures/:lecture_id/:action",{course_id:n.course_id,lecture_id:"@id",lang:o.use()},{update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},newLecture:{method:"GET",params:{action:"new_lecture_angular"},headers:i},getQuizData:{method:"GET",params:{action:"get_old_data_angular"},headers:i},getHtmlData:{method:"GET",params:{action:"get_html_data_angular"},headers:i},newQuiz:{method:"GET",params:{action:"new_quiz_angular"},headers:i},newMarker:{method:"POST",params:{action:"new_marker"},headers:i},updateAnswers:{method:"POST",params:{action:"save_answers_angular"},headers:i},saveSort:{method:"POST",ignoreLoadingBar:!0,params:{action:"sort"},headers:i},validateLecture:{method:"PUT",params:{action:"validate_lecture_angular"},headers:i},getLectureStudent:{method:"GET",params:{action:"get_lecture_data_angular"},headers:i},confused:{method:"POST",params:{action:"confused"},headers:i},saveOnline:{method:"POST",params:{action:"save_online"},headers:i},saveHtml:{method:"POST",params:{action:"save_html"},headers:i},deleteConfused:{method:"DELETE",params:{action:"delete_confused"},headers:i},saveNote:{method:"POST",params:{action:"save_note"},headers:i},deleteNote:{method:"DELETE",params:{action:"delete_note"},headers:i},lectureCopy:{method:"POST",params:{action:"lecture_copy"},headers:i},exportNotes:{method:"GET",params:{action:"export_notes"},headers:i},changeLectureStatus:{method:"POST",ignoreLoadingBar:!0,params:{action:"change_status_angular"},headers:i},updatePercentView:{method:"POST",ignoreLoadingBar:!0,params:{action:"update_percent_view"},headers:i},confusedShowInclass:{method:"POST",ignoreLoadingBar:!0,params:{action:"confused_show_inclass"},headers:i},logVideoEvent:{method:"POST",ignoreLoadingBar:!0,params:{action:"log_video_event"},headers:i},checkIfInvited:{method:"GET",ignoreLoadingBar:!1,params:{action:"check_if_invited_distance_peer"},headers:i},invitedStudent:{method:"GET",ignoreLoadingBar:!0,params:{action:"invite_student_distance_peer"},headers:i},checkInvitedStudentAccepted:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_invited_student_accepted_distance_peer"},headers:i},acceptInvation:{method:"GET",ignoreLoadingBar:!0,params:{action:"accept_invation_distance_peer"},headers:i},caneclDistancePeerSession:{method:"GET",ignoreLoadingBar:!0,params:{action:"cancel_session_distance_peer"},headers:i},checkIfInDistancePeerSession:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_if_in_distance_peer_session"},headers:i},changeStatusDistancePeer:{method:"GET",ignoreLoadingBar:!0,params:{action:"change_status_distance_peer"},headers:i},checkIfDistancePeerStatusIsSync:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_if_distance_peer_status_is_sync"},headers:i},checkIfDistancePeerIsAlive:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_if_distance_peer_is_alive"},headers:i}})}]).factory("LectureModel",["Lecture","$rootScope","VideoInformation","$translate","Timeline","ScalearUtils","$q","ModuleModel",function(s,l,u,d,t,c,_,m){var n=null;function p(e){return n=e,a()}function a(){return n}function g(e){return e.instanceType&&"Lecture"==e.instanceType()}function i(a){if(g(a))return a;function i(){var e=angular.copy(a);return delete e.id,delete e.created_at,delete e.updated_at,delete e.class_name,delete e.className,delete e.timeline,delete e.selected,s.update({course_id:a.course_id,lecture_id:a.id},{lecture:e}).$promise.then(function(e){angular.extend(a,e.lecture)})}function e(){return s.validateLecture({course_id:a.course_id,lecture_id:a.id},a).$promise.catch(function(e){return 422==e.status?e.data.errors.join():"Server Error"})}function r(e,t,n){a.timeline.add(e,t,n)}function o(e,t){a.timeline.items.splice(a.timeline.getIndexById(e.id,t),1)}return a.timeline=new t,l.$on("Module:"+a.group_id+":updated",function(e,t){a.appearance_time_module&&(a.appearance_time=t.appearance_time),a.due_date_module&&(a.due_date=t.due_date),a.required_module&&(a.required=t.required),a.graded_module&&(a.graded=t.graded),a.skip_ahead_module&&(a.skip_ahead=t.skip_ahead)}),l.$on("Lecture:"+a.id+":add_to_timeline",function(e,t,n,a){r(t,n,a)}),l.$on("Lecture:"+a.id+":remove_from_timeline",function(e,t,n){o(t,n)}),angular.extend(a,{update:i,validateUrl:function(){var n=_.defer();return u.invalidUrl(a.url)?n.reject(d.instant("editor.details.incompatible_video_link")):e().then(function(){var e=u.isYoutube(a.url);if(e){var t=e[1];u.emptyCachedInfo(),u.requestInfoFromYoutube(t).then(function(e){0<e.items.length&&"processed"===e.items[0].status.uploadStatus?n.resolve():n.reject(d.instant("editor.details.vidoe_not_exist"))}).catch(function(){return n.reject(d.instant("editor.details.vidoe_not_exist")),n.promise})}else n.resolve()}).catch(function(e){n.reject(e)}),n.promise},validate:e,updateUrl:function(){u.resetValues();var n=_.defer();if(a.aspect_ratio="widescreen",a.url=a.url.trim(),a.url&&"none"!=a.url&&"http://"!=a.url){var e=u.isYoutube(a.url);if(e){var t=e[1];u.isFinalUrl(a.url)||(a.url=u.getFinalUrl(t)),u.requestInfoFromYoutube(t).then(function(e){var t=c.parseDuration(e.items[0].contentDetails.duration);a.duration=3600*t.hour+60*t.minute+t.second,a.start_time=0,a.end_time=a.duration,i().then(function(){n.resolve(!0)}),l.$broadcast("update_module_time",a.group_id)})}else u.isMP4(a.url)?$("video").bind("loadeddata",function(e){a.start_time=0,a.end_time=e.target.duration||0,i().then(function(){n.resolve(!1)}),l.$broadcast("update_module_time",a.group_id)}):(u.isMediaSite(a.url)||u.isKaltura(a.url))&&u.waitForDurationSetup().then(function(e){a.duration=e,a.start_time=0,a.end_time=a.duration,i().then(function(){n.resolve(!1)}),l.$broadcast("update_module_time",a.group_id)})}else a.url="none",n.reject();return n.promise},addToTimeline:r,removeFromTimeline:o,instanceType:function(){return"Lecture"},remove:function(){return s.destroy({course_id:a.course_id,lecture_id:a.id},{}).$promise.then(function(){l.$broadcast("Item:removed",a)})},updateViewPercentage:function(e){return s.updatePercentView({course_id:a.course_id,lecture_id:a.id},{percent:e}).$promise},module:function(){return m.getById(a.group_id)},setAsSelected:function(){return p(a)},markDone:function(){l.$broadcast("item_done",a)},destroy:function(){a.timeline=new t}})}return{createInstance:i,isInstance:g,clearSelectedLecture:function(){n&&n.destroy(),n=null},getSelectedLecture:a,setSelectedLecture:p,create:function(e){var t=!1,n=!1;1==e&&(t=!0),2==e&&(n=!0);var a=m.getSelectedModule();return s.newLecture({course_id:a.course_id,group:a.id,inclass:t,distance_peer:n}).$promise.then(function(e){e.lecture.class_name="lecture";var t=i(e.lecture);return l.$broadcast("Item:added",t),t})},paste:function(e,t){var n=m.getById(t);return s.lectureCopy({course_id:n.course_id},{lecture_id:e.id,module_id:n.id}).$promise.then(function(e){e.lecture.class_name="lecture";var t=i(e.lecture);return l.$broadcast("Item:added",t),l.$broadcast("update_module_statistics"),t})}}}]),angular.module("scalearAngularApp").factory("OnlineQuiz",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/online_quizzes/:online_quizzes_id/:action",{lang:o.use()},{update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},getQuizList:{method:"GET",params:{action:"get_quiz_list_angular"},headers:i},validateName:{method:"PUT",params:{action:"validate_name"},headers:i},voteForReview:{method:"POST",params:{action:"vote_for_review"},headers:i},unvoteForReview:{method:"POST",params:{action:"unvote_for_review"},headers:i},hideResponses:{method:"POST",params:{action:"hide_responses"},headers:i},updateInclassSession:{method:"POST",ignoreLoadingBar:!0,params:{action:"update_inclass_session"},headers:i},getChartData:{method:"GET",ignoreLoadingBar:!0,params:{action:"get_chart_data"},headers:i},getInclassSessionVotes:{method:"GET",ignoreLoadingBar:!0,params:{action:"get_inclass_session_votes"},headers:i},updateGrade:{method:"POST",params:{action:"update_grade"},headers:i}})}]).factory("VideoQuizModel",["OnlineQuiz","$rootScope","ItemsModel","$q","VideoInformation","Lecture","CourseEditor","ErrorHandler","$filter","ScalearUtils","$translate",function(_,m,p,g,h,f,v,b,t,y,w){var n=null;function k(e){return e.formatedTime=t("format")(e.time,"hh:mm:ss.MMM"),e.start_formatedTime=t("format")(e.start_time,"hh:mm:ss.MMM"),e.end_formatedTime=t("format")(e.end_time,"hh:mm:ss.MMM"),e.inclass&&e.inclass_session||(e.inclass_session={intro:120,self:120,in_group:120,discussion:120}),e.intro_formatedTime=t("format")(e.intro,"hh:mm:ss.MMM"),e.self_formatedTime=t("format")(e.self,"hh:mm:ss.MMM"),e.group_formatedTime=t("format")(e.in_group,"hh:mm:ss.MMM"),e.discussion_formatedTime=t("format")(e.discussion,"hh:mm:ss.MMM"),n=e,a()}function a(){return n}function u(s){if((e=s).instanceType&&"VideoQuiz"==e.instanceType())return s;var e;function o(e,t,n,a,i){var r=v.newAnswer(e,t,n,a,i,"lecture",s.id);if(s.answers.push(r),"drag"==s.question_type.toLowerCase()){var o=Math.max.apply(Math,s.allPos);r.pos=o==-1/0?0:o+1,s.allPos=l(s.answers)}}function t(){var e=angular.element("#ontop"),t=e.height()/3,n=e.width()/4,a=t/e.height(),i=n/e.width(),r=250/e.width();o("",100/e.height(),r,i,a)}function n(e){var t=v.newAnswer(e,"","","","","lecture",s.id);s.answers.push(t)}function l(e){var n=[];return e.forEach(function(e,t){e.pos=t,n.push(parseInt(e.pos))}),n}function a(){return f.getQuizData({course_id:s.course_id,lecture_id:s.lecture_id,quiz:s.id}).$promise.then(function(e){s.answers=e.answers,"drag"==s.question_type.toLowerCase()&&(s.allPos=l(e.answers)),"free text question"==s.question_type.toLowerCase()&&0==s.answers.length&&t()})}function i(){return f.getHtmlData({course_id:s.course_id,lecture_id:s.lecture_id,quiz:s.id}).$promise.then(function(e){"drag"==s.question_type.toLowerCase()?(s.answers=[],e.answers.length?s.answers=v.expandDragAnswers(e.answers[0].id,e.answers[0].answer,"lecture",s.id,e.answers[0].explanation):n()):(s.answers=e.answers,s.answers.length||n())})}function r(){return"html"==s.quiz_type}function u(){return"drag"==s.question_type.toLowerCase()}function d(){return"html_survey"==s.quiz_type}function c(){return u()&&r()}return angular.extend(s,{getInVideoQuizAnswers:a,getTextQuizAnswers:i,getQuizAnswers:function(e){return"invideo"==s.quiz_type?a():i()},addFreeTextAnswer:t,addAnswer:o,removeAnswer:function(e){s.answers.splice(e,1),"drag"==s.question_type.toLowerCase()&&(s.allPos=l(s.answers))},addHtmlAnswer:n,removeHtmlAnswer:function(e){s.answers.length<=1?b.showMessage("Error : "+w.instant("editor.cannot_delete_alteast_one_answer"),"errorMessage",4e3,"error"):s.answers.splice(e,1)},updateAnswers:function(){var e=s.answers;if(c()){var t=v.mergeDragAnswers(s.answers,"lecture",s.id);s.answers.forEach(function(e){e.id&&null==t.id&&(t.id=e.id)}),e=[t]}return f.updateAnswers({course_id:s.course_id,lecture_id:s.lecture_id,online_quiz_id:s.id},{answer:e,quiz_title:s.question,match_type:s.match_type}).$promise},instanceType:function(){return"VideoQuiz"},setAsSelected:function(){return k(s)},isTextVideoQuiz:r,isFreeTextVideoQuiz:function(){return"free text question"==s.question_type.toLowerCase()},isDragQuiz:u,isTextQuiz:function(){return r()||d()},isSurvey:function(){return"survey"==s.quiz_type},isTextSurvey:d,deleteQuiz:function(){return _.destroy({online_quizzes_id:s.id},{}).$promise.then(function(e){m.$broadcast("Lecture:"+s.lecture_id+":remove_from_timeline",s,"quiz")})},isDragTextQuiz:c,validate:function(){return(e={},e.question=s.question,_.validateName({online_quizzes_id:s.id},e).$promise.catch(function(e){var t={};return 422==e.status?t.name_error=e.data.errors.join():t.name_error="Server Error",t})).then(function(e){return e.name_error?{errors:e}:(t=p.getSelectedItem(),n=g.defer(),a={},a.time_error=y.validateTimeWithDuration(s.formatedTime,h.duration),(t.inclass||t.distance_peer)&&(a.intro_timer_error=y.validateTimeWithoutDuration(s.intro_formatedTime,h.duration),a.self_timer_error=y.validateTimeWithoutDuration(s.self_formatedTime,h.duration),a.group_timer_error=y.validateTimeWithoutDuration(s.group_formatedTime,h.duration),a.discussion_timer_error=y.validateTimeWithoutDuration(s.discussion_formatedTime,h.duration)),a.time_error||a.intro_timer_error||a.self_timer_error||a.group_timer_error||a.discussion_timer_error?n.reject(a):n.resolve(),n.promise).catch(function(e){return{errors:e}});var t,n,a});var e},update:function(){var e=p.getSelectedItem();(e.inclass||e.distance_peer)&&(s.intro=y.arrayToSeconds(s.intro_formatedTime.split(":")),s.self=y.arrayToSeconds(s.self_formatedTime.split(":")),s.in_group=y.arrayToSeconds(s.group_formatedTime.split(":")),s.discussion=y.arrayToSeconds(s.discussion_formatedTime.split(":")));var t=s.time%1,n=y.arrayToSeconds(s.formatedTime.split(":"));return s.time!=n+t&&(s.time=n,e.inclass||e.distance_peer||(s.start_time=s.end_time=n)),_.update({online_quizzes_id:s.id},{online_quiz:{time:s.time,start_time:s.start_time,end_time:s.end_time,question:s.question,inclass:s.inclass,graded:s.graded,intro:s.intro,self:s.self,in_group:s.in_group,discussion:s.discussion,display_text:s.display_text,xcoor:s.xcoor,ycoor:s.ycoor,height:s.height,width:s.width}}).$promise}})}return{getQuizzes:function(){var a=p.getSelectedItem();return _.getQuizList({lecture_id:a.id}).$promise.then(function(e){var n=[];return e.quizList.forEach(function(e){var t=u(e);n.push(t),m.$broadcast("Lecture:"+a.id+":add_to_timeline",t.time,"quiz",t)}),n})},addVideoQuiz:function(e,t,n){var a,i=p.getSelectedItem(),r=h.duration;e<1&&(e=1),a=e,i.timeline.items.forEach(function(e){if("quiz"==e.type){var t=e.data.time;0<t-a&&t-a<.5?a=t-.5:0<a-t&&a-t<.5?a=t+.5:a-t==0&&(a=t+.5)}}),r<=(e=a)&&(e=r-2);var o=e,s=e;if(i.inclass||i.distance_peer){var l=5*r/100;o=o-l<0?0:o-l,s=r-1<s+l?r-1:s+l}return f.newQuiz({course_id:i.course_id,lecture_id:i.id,time:e,start_time:o,end_time:s,quiz_type:t,ques_type:n,inclass:i.inclass}).$promise.then(function(e){var t=u(e.quiz);return m.$broadcast("Lecture:"+i.id+":add_to_timeline",t.time,"quiz",t),t})},createInstance:u,setSelectedVideoQuiz:k,getSelectedVideoQuiz:a,clearSelectedVideoQuiz:function(){n=null}}}]),angular.module("scalearAngularApp").factory("OnlineMarker",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/online_markers/:online_markers_id/:action",{lang:o.use()},{update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},getMarkerList:{method:"GET",params:{action:"get_marker_list"},headers:i},validateName:{method:"PUT",params:{action:"validate_name"},headers:i},updateHide:{method:"POST",params:{action:"update_hide"},headers:i}})}]).factory("MarkerModel",["OnlineMarker","$rootScope","ItemsModel","$q","$filter","VideoInformation","Lecture","ScalearUtils",function(i,d,c,_,t,m,p,a){var n=null;function r(e){return e.formatedTime=t("format")(e.time),n=e,o()}function o(){return n}function g(n){if((e=n).instanceType&&"Marker"==e.instanceType())return n;var e;return angular.extend(n,{setAsSelected:function(){return r(n)},instanceType:function(){return"Marker"},update:function(){var e=n.time%1,t=a.arrayToSeconds(n.formatedTime.split(":"));return n.time!=t+e&&(n.time=t),i.update({online_markers_id:n.id},{online_marker:{time:n.time,title:n.title,annotation:n.annotation,duration:n.duration,xcoor:n.xcoor,ycoor:n.ycoor,width:n.width,height:n.height,as_slide:n.as_slide}}).$promise},deleteMarker:function(){return i.destroy({online_markers_id:n.id},{}).$promise.then(function(){d.$broadcast("Lecture:"+n.lecture_id+":remove_from_timeline",n,"marker")})},validate:function(){return(e={},e.title=n.title,i.validateName({online_markers_id:n.id},{online_marker:e}).$promise.catch(function(e){var t={};return 422==e.status?t.name_error=e.data.errors.join():t.name_error="Server Error",t})).then(function(){return e=_.defer(),(t={}).time_error=a.validateTimeWithDuration(n.formatedTime,m.duration),t.time_error?e.reject(t):e.resolve(),e.promise;var e,t});var e}})}return{getMarkers:function(){var a=c.getSelectedItem();return i.getMarkerList({lecture_id:a.id}).$promise.then(function(e){var n=[];return e.markerList.forEach(function(e){var t=g(e);n.push(t),d.$broadcast("Lecture:"+a.id+":add_to_timeline",t.time,"marker",t)}),n})},addMarker:function(e,t,n,a,i){var r=_.defer(),o=c.getSelectedItem(),s=m.duration;e<1&&(e=1),s<=e&&(e=s-2);var l=o.timeline.getItemsBetweenTimeByType(e,e,"marker");if(0<l.length)r.resolve(l[0].data);else{var u={height:t||0,width:n||0,xcoor:a||0,ycoor:i||0,time:e};p.newMarker({course_id:o.course_id,lecture_id:o.id},{marker:u}).$promise.then(function(e){var t=g(e.marker);d.$broadcast("Lecture:"+o.id+":add_to_timeline",t.time,"marker",t),r.resolve(t)})}return r.promise},createInstance:g,setSelectedMarker:r,getSelectedMarker:o,clearSelectedMarker:function(){n=null}}}]),angular.module("scalearAngularApp").factory("Quiz",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/courses/:course_id/quizzes/:quiz_id/:action",{course_id:n.course_id,lang:o.use()},{newQuiz:{method:"POST",params:{action:"new_or_edit"},headers:i},update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},getQuestions:{method:"GET",params:{action:"get_questions_angular"},headers:i},updateQuestions:{method:"PUT",params:{action:"update_questions_angular"},headers:i},validateQuiz:{method:"PUT",params:{action:"validate_quiz_angular"},headers:i},makeVisible:{method:"POST",params:{action:"make_visible"},headers:i},hideResponses:{method:"POST",params:{action:"hide_responses"},headers:i},hideResponseStudent:{method:"POST",params:{action:"hide_response_student"},headers:i},sendFeedback:{method:"POST",params:{action:"create_or_update_survey_responses"},headers:i},deleteFeedback:{method:"POST",params:{action:"delete_response"},headers:i},showInclass:{method:"POST",params:{action:"show_question_inclass"},headers:i},showStudent:{method:"POST",params:{action:"show_question_student"},headers:i},saveStudentQuiz:{method:"POST",params:{action:"save_student_quiz_angular"},headers:i},quizCopy:{method:"POST",params:{action:"quiz_copy"},headers:i},changeQuizStatus:{method:"POST",ignoreLoadingBar:!0,params:{action:"change_status_angular"},headers:i},updateGrade:{method:"POST",params:{action:"update_grade"},headers:i}})}]).factory("QuizModel",["Quiz","ModuleModel","$rootScope",function(a,i,r){var t=null;function e(e){return t=e,n()}function n(){return t}function o(e){return e.instanceType&&"Quiz"==e.instanceType()}function s(n){if(o(n))return n;return r.$on("Module:"+n.group_id+":updated",function(e,t){n.required_module&&(n.required=t.required),n.graded_module&&(n.graded=t.graded),n.due_date_module&&(n.due_date=t.due_date)}),angular.extend(n,{instanceType:function(){return"Quiz"},module:function(){return i.getById(n.group_id)},validate:function(){return a.validateQuiz({course_id:n.course_id,quiz_id:n.id},n).$promise.catch(function(e){return 422==e.status&&e.data.errors?e.data.errors.join():"Server Error"})},update:function(){var e=angular.copy(n);return delete e.created_at,delete e.updated_at,delete e.class_name,delete e.id,a.update({course_id:n.course_id,quiz_id:n.id},{quiz:e}).$promise.then(function(e){return angular.extend(n,e.quiz),n})},remove:function(){return a.destroy({course_id:n.course_id,quiz_id:n.id},{}).$promise.then(function(){r.$broadcast("Item:removed",n)})},setAsSelected:function(){return e(n)},markDone:function(){r.$broadcast("item_done",n)},studentSolve:function(e,t){return a.saveStudentQuiz({quiz_id:n.id,course_id:n.course_id},{student_quiz:e,commit:t}).$promise},isVisible:function(){return new Date(n.appearance_time)<=new Date}})}return{setSelectedQuiz:e,getSelectedQuiz:n,clearSelectedQuiz:function(){t=null},isInstance:o,createInstance:s,paste:function(e,t){var n=i.getById(t);return a.quizCopy({course_id:n.course_id},{quiz_id:e.id,module_id:n.id}).$promise.then(function(e){e.quiz.class_name="quiz";var t=s(e.quiz);return r.$broadcast("Item:added",t),r.$broadcast("update_module_statistics"),t})},create:function(e){var t=i.getSelectedModule();return a.newQuiz({course_id:t.course_id,group:t.id,type:e},{}).$promise.then(function(e){e.quiz.class_name="quiz";var t=s(e.quiz);return r.$broadcast("Item:added",t),t})}}}]),angular.module("scalearAngularApp").factory("QuestionModel",["Quiz","CourseEditor","ErrorHandler","ItemsModel","$translate","$rootScope",function(r,o,n,s,a,l){var u=[];function e(){var e=s.getSelectedItem();return r.getQuestions({course_id:e.course_id,quiz_id:e.id}).$promise}function i(e,t){var n=o.newAnswer(e,"","","","","quiz",t.id);t.answers.push(n)}function t(e){u.splice(e,1)}return{getQuestions:e,getEditableQuestions:function(){return e().then(function(n){return(u=n.questions).forEach(function(e,t){"DRAG"==e.question_type.toUpperCase()?(e.answers=[],n.answers[t].length?e.answers=o.expandDragAnswers(n.answers[t][0].id,n.answers[t][0].content,"quiz",e.id,n.answers[t][0].explanation):i("",e)):(e.answers=n.answers[t],n.answers[t].length||"Free Text Question"==e.question_type||i("",e))}),u})},getSolvableQuestions:function(){return e().then(function(e){return u=e.questions,e})},addQuestion:function(){var e={quiz_id:s.getSelectedItem().id,content:"",question_type:"MCQ",answers:[]};u.push(e),i("",e)},removeQuestion:t,updateQuestions:function(){var e=s.getSelectedItem(),t=[];for(var n in u)if("DRAG"==u[n].question_type.toUpperCase()){var a=o.mergeDragAnswers(u[n].answers,"quiz",u[n].id);u[n].answers.forEach(function(e){e.id&&null==a.id&&(a.id=e.id)});var i=angular.copy(u[n]);i.answers=[a],t[n]=i}else t[n]=u[n];return l.$broadcast("questions_count:updated",u.length),r.updateQuestions({course_id:e.course_id,quiz_id:e.id},{questions:t}).$promise},addAnswer:i,removeAnswer:function(e,t){1<t.answers.length?t.answers.splice(e,1):n.showMessage("Error : "+a.instant("editor.cannot_delete_alteast_one_answer"),"errorMessage",4e3,"error")},addHeader:function(){var e={quiz_id:s.getSelectedItem().id,content:"",question_type:"header"};u.push(e)},removeHeader:function(e){t(e)},questions:u}}]),angular.module("scalearAngularApp").factory("CustomLink",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/custom_links/:link_id/:action",{lang:o.use()},{update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},validate:{method:"PUT",headers:i,params:{action:"validate_custom_link"}},linkCopy:{method:"POST",params:{action:"link_copy"},headers:i}})}]).factory("LinkModel",["CustomLink","Module","ModuleModel","$filter","$rootScope",function(a,t,i,n,r){var o=null;function s(e){return o=e,l()}function l(){return o}function u(e){return e.instanceType&&"Link"==e.instanceType()}function d(e){if(u(e))return e;return angular.extend(e,{instanceType:function(){return"Link"},module:function(){return i.getById(e.group_id)},remove:function(){return a.destroy({course_id:e.course_id,link_id:e.id},{}).$promise.then(function(){r.$broadcast("Item:removed",e)})},validate:function(){return a.validate({link_id:e.id},{link:e,course_id:e.course_id}).$promise.catch(function(e){return 422==e.status?e.data.errors[0]:"Server Error"})},update:function(){return e.url=n("formatURL")(e.url),a.update({link_id:e.id},{link:{url:e.url,name:e.name}}).$promise},setAsSelected:function(){return s(e)}})}return{isInstance:u,createInstance:d,setSelectedLink:s,getSelectedLink:l,clearSelectedLink:function(){o=null},create:function(){var e=i.getSelectedModule();return t.newCustomLink({course_id:e.course_id,module_id:e.id},{}).$promise.then(function(e){e.link.url="http://",e.link.class_name="customlink";var t=d(e.link);return r.$broadcast("Item:added",t),r.$broadcast("update_module_statistics"),t})},paste:function(e,t){var n=i.getById(t);return a.linkCopy({link_id:e.id,course_id:n.course_id,module_id:n.id},{}).$promise.then(function(e){e.link.class_name="customlink";var t=d(e.link);return r.$broadcast("Item:added",t),t})}}}]),angular.module("scalearAngularApp").factory("CourseEditor",["$window",function(e){var l={capitalize:function(e){return e[0].toUpperCase()+e.slice(1)},expandDragAnswers:function(e,t,n,a,i){var r=[];for(var o in t instanceof Array||(t=[t]),t){var s=l.newAnswer(t[o],"","","","",n,a,i[o]);0==o&&(s.id=e),r.push(s)}return r},mergeDragAnswers:function(e,t,n){var a=[],i=[];return e.forEach(function(e){"quiz"==t?a.push(e.content):a.push(e.answer),i.push(e.explanation||"")}),l.newAnswer(a,"","","","",t,n,i)},mergeDragPos:function(e){var t=[];return e.forEach(function(e){t.push(parseInt(e.pos))}),t},newAnswer:function(e,t,n,a,i,r,o,s){if("quiz"!=r)var l={answer:e||"",correct:!1,explanation:s||"",online_quiz_id:o,height:t||0,width:n||0,xcoor:a||0,ycoor:i||0,sub_xcoor:a||0,sub_ycoor:i-.09||0};else l={content:e||"",correct:!1,question_id:o,explanation:s||""};return l},isDueDateDisabled:function(e){var t=new Date(e),n=new Date;return t.getFullYear()>n.getFullYear()+100}};return l}]),angular.module("scalearAngularApp").factory("Announcement",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/courses/:course_id/announcements/:announcement_id/:action",{course_id:n.course_id,lang:o.use()},{index:{method:"GET",isArray:!0,headers:i},create:{method:"POST",headers:i},update:{method:"PUT",headers:i},destroy:{method:"DELETE",headers:i},show:{method:"GET",headers:i}})}]),angular.module("scalearAngularApp").factory("Kpi",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/kpis/:document_id/:action",{lang:o.use()},{readData:{method:"GET",headers:i,params:{action:"read_data"}},readTotals:{method:"GET",headers:i,params:{action:"read_totals"}},readSeries:{method:"GET",headers:i,params:{action:"read_series"}},readTotalsForDuration:{method:"GET",headers:i,params:{action:"read_totals_for_duration"}},getReportDataCourseDuration:{method:"POST",headers:i,params:{action:"get_report_data_course_duration"}},exportSchoolStatistics:{method:"GET",headers:i,params:{action:"export_school_statistics"}}})}]),angular.module("scalearAngularApp").factory("SharedItem",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/shared_items/:shared_item_id/:action",{lang:o.use()},{create:{method:"POST",headers:i},destroy:{method:"DELETE",headers:i},showShared:{method:"GET",headers:i,params:{action:"show_shared"}},accpetShared:{method:"POST",headers:i,params:{action:"accept_shared"}},rejectShared:{method:"POST",headers:i,params:{action:"reject_shared"}},updateSharedData:{method:"POST",headers:i,params:{action:"update_shared_data"}}})}]),angular.module("scalearAngularApp").factory("NewsFeed",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/news_feed/:action",{lang:o.use()},{index:{method:"GET",isArray:!1,headers:i}})}]),angular.module("scalearAngularApp").factory("ServerInterceptor",["$rootScope","$q","$timeout","$interval","ErrorHandler","$injector","scalear_api","headers","$log","$translate","$cookieStore","$location","URLInformation","Token",function(i,r,o,s,l,u,d,c,_,m,p,e,t,n){return{request:function(e){var t=new RegExp(d.host+"(/en/|/sv/)");return e.url=e.url.replace(t,d.host+"/"+m.use()+"/"),e||r.when(e)},requestError:function(e){return canRecover(e)?responseOrNewPromise:r.reject(e)},response:function(e){var t=new RegExp("^"+d.host);return 1==i.server_error&&-1!=e.config.url.search(t)&&(angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage(m.instant("error_message.connected"),"errorMessage",4e3,"success")),e||r.when(e)},responseError:function(e){if(_.debug(e),(e.headers()["x-flash-error"]||e.headers()["x-flash-warning"]&&-1!=e.config.url.search(n))&&(angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage(e.headers()["x-flash-error"]||e.headers()["x-flash-warning"],"errorMessage",4e3,"error")),400==e.status&&-1!=e.config.url.search(n)&&(angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage("Error : "+e.data.errors,"errorMessage",4e3,"error")),404==e.status&&-1!=e.config.url.search(n)){var t=u.get("$state");i.current_user?t.go("course_list"):t.go("login"),angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage("Error : "+e.data.errors,"errorMessage",4e3,"error")}if(403==e.status&&-1!=e.config.url.search(n)){t=u.get("$state");i.current_user?t.go("course_list"):t.go("login"),angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage("Error : "+e.data.errors,"errorMessage",4e3,"error")}if(500==e.status&&-1!=e.config.url.search(n)){t=u.get("$state");i.current_user?t.go("course_list"):t.go("login"),angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage("A server error occurred. If this continues, please use the Support link in the Help menu to contact technical support.","errorMessage",4e3,"error")}if(401==e.status&&-1!=e.config.url.search(n)){t=u.get("$state");p.get("preview_as_student")&&(_.debug("preview_as_student"),p.remove("preview_as_student"),p.remove("old_user_id"),p.remove("new_user_id"),p.remove("params"),p.remove("state"),i.preview_as_student=!1),angular.isDefined(i.stop)&&(s.cancel(i.stop),i.stop=void 0),l.showMessage("Error : "+(void 0===e.data.errors?e.data.error:e.data.errors),"errorMessage",4e3,"error"),t.go("login")}var n=new RegExp("^"+d.host);if(0==e.status&&-1!=e.config.url.search(n)&&1!=i.unload){1!=i.server_error&&(i.server_error=!0,""==e.data?l.showMessage("Error "+e.status+": "+m.instant("error_message.cant_connect_to_server"),"errorMessage",8e3,"error"):l.showMessage("Error : "+e.data,"errorMessage",1e4,"error"));var a=u.get("$http");o(function(){return a({method:"GET",headers:c,url:d.host+"/en/home/test"})},1e4)}return r.reject(e)}}}]),angular.module("scalearAngularApp").factory("TokenServerInterceptor",["Token",function(n){return{request:function(e){var t=n.getToken();return t&&(e.headers["access-token"]=t["access-token"],e.headers.client=t.client,e.headers.expiry=t.expiry,e.headers.uid=t.uid,e.headers["token-type"]=t["token-type"]),e}}}]),angular.module("scalearAngularApp").factory("ValidateTime",["$rootScope","$translate",function(e,l){return function(e,t,n){if(!/^\d\d:\d\d:\d\d$/.test(e))return l.instant("editor.incorrect_format_time");var a=e.split(":"),i=parseInt(a[0]),r=parseInt(a[1]),o=parseInt(a[2]),s=60*i*60+60*r+o;return i<0||24<i||r<0||59<r||o<0||59<o?l.instant("editor.incorrect_format_time"):t&&n<=s||s<=0?l.instant("editor.time_outside_range"):void 0}}]),angular.module("scalearAngularApp").factory("ErrorHandler",["$log","$rootScope","$interval",function(e,i,r){var o=$();return{showMessage:function(e,t,n,a){i.$broadcast("ErrorMessage:show",a),angular.element(".message").remove(),$("<div/>").addClass("message").addClass("valign-super").addClass(t).hide().fadeIn("fast").appendTo(o).text(e),n&&r(function(){i.$broadcast("ErrorMessage:hide")},n,1)},addToElementList:function(e){o.push(e)}}}]),angular.module("scalearAngularApp").factory("User",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$log","$translate",function(e,t,n,a,i,r,o,s){return t.defaults.useXDomain=!0,e(a.host+"/:lang/users/:id/:action",{lang:s.use()},{getCurrentUser:{method:"GET",headers:i,ignoreLoadingBar:!0,params:{action:"get_current_user"}},signIn:{method:"POST",headers:i,params:{action:"sign_in"}},signOut:{method:"DELETE",headers:i,params:{action:"sign_out"}},signUp:{method:"POST",headers:i},reset_password:{method:"POST",headers:i,params:{action:"password"}},change_password:{method:"PUT",headers:i,params:{action:"password"}},resend_confirmation:{method:"POST",headers:i,params:{action:"confirmation"}},show_confirmation:{method:"GET",headers:i,params:{action:"confirmation"}},update_account:{method:"PUT",headers:i},delete_account:{method:"delete",headers:i},alterPref:{method:"POST",params:{action:"alter_pref"},headers:i},updateCompletionWizard:{method:"POST",params:{action:"update_completion_wizard"},headers:i},samlSignup:{method:"POST",headers:i,params:{action:"saml_signup"}},userExist:{method:"GET",headers:i,params:{action:"user_exist"}},getSubdomains:{method:"GET",headers:i,params:{action:"get_subdomains"}},getWelcomeMessage:{method:"GET",headers:i,params:{action:"get_welcome_message"}},submitWelcomeMessage:{method:"POST",headers:i,params:{action:"submit_welcome_message"}},agreeToPrivacyPolicy:{method:"POST",headers:i,params:{action:"agree_to_privacy_policy"}},validateUser:{method:"POST",headers:i,params:{action:"validate_user"}}})}]),angular.module("scalearAngularApp").factory("UserSession",["$rootScope","User","Home","$q","$log","$translate","Token",function(a,t,i,r,o,e,s){var l=null,u=null;function d(){u=l=null,a.current_user=null}return{getCurrentUser:function(e){return u||(u=r.defer(),t.getCurrentUser().$promise.then(function(e){if(e.signed_in){var t=JSON.parse(e.user);return t.last_name||(t.last_name=""),t.roles=t.roles.map(function(e){return e.id}),t.profile_image=e.profile_image,t.invitations=e.invitations,t.shared=e.shared,t.accepted_shared=e.accepted_shared,n=t,o.debug("current user: "),o.debug(n),l=n,a.current_user=n,u.resolve(l),i.getNotifications().$promise}var n;u.reject(),d()}).then(function(e){e&&(l.invitation_items=e.invitations,l.shared_items=e.shared_items)}).catch(function(e){d()})),u.promise},logout:function(){return t.signOut({},function(){d()}).$promise},allowRefetchOfUser:function(){u=null},deleteUser:function(e){return t.delete_account({password:e},{}).$promise.then(function(){d()})},signIn:function(e){var n=r.defer();return t.signIn({},e,function(e,t){s.setToken(t()),n.resolve({user:e,token:t()})}),n.promise}}}]),angular.module("scalearAngularApp").factory("batchEmailService",function(){var t={value:[],getEmails:function(){return t.value},setEmails:function(e){t.value=e}};return t}),angular.module("scalearAngularApp").factory("Home",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/home/:action",{lang:o.use()},{contactUs:{method:"GET",params:{action:"contact_us"},headers:i},technicalProblem:{method:"GET",params:{action:"technical_problem"},headers:i},getNotifications:{method:"GET",ignoreLoadingBar:!0,params:{action:"notifications"},headers:i},acceptCourse:{method:"POST",params:{action:"accept_course"},headers:i},rejectCourse:{method:"POST",params:{action:"reject_course"},headers:i}})}]),angular.module("scalearAngularApp").factory("Saml",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/saml/:action",{lang:o.use()},{Login:{method:"GET",params:{action:"saml_signin"},headers:i},getDomain:{method:"GET",params:{action:"get_domain"},headers:i}})}]).factory("SWAMID",["Saml","$rootScope",function(e,t){return{list:function(){var t={descr:"The University of Gävle Identity Provider is used by employees and students at the university.",icon:"https://webkonto.student.hig.se/head/loggaengelska.png",icon_height:"94",icon_width:"83",title:"Utrecht University",hidden:"false",title_order:"Utrecht University",entityID:"https://namidp.services.uu.nl/nidp/saml2/metadata"};return e.getDomain().$promise.then(function(e){return e.domains.forEach(function(e){e.title_order=e.title,"KTH Royal Institute of Technology"==e.title?e.title_order="1 "+e.title:"Uppsala University"==e.title&&(e.title_order="2 "+e.title)}),e.domains.push(t),e.domains}).catch(function(e){return[]})}}}]),angular.module("scalearAngularApp").factory("Lti",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/lti/:action",{lang:o.use()},{embedCourseList:{method:"GET",params:{action:"embed_course_list"},headers:i},sendURLtoToolConsumer:{method:"GET",params:{action:"send_url_to_tool_consumer"},headers:i},getLtiCustomSharedKey:{method:"GET",params:{action:"get_lti_custom_shared_key"},headers:i},generateNewLtiKeys:{method:"GET",params:{action:"generate_new_lti_keys"},headers:i},ltiToolRedirectSaveData:{method:"GET",params:{action:"lti_tool_redirect_save_data"},headers:i}})}]),angular.module("scalearAngularApp").factory("Forum",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/discussions/:action",{lang:o.use()},{createPost:{method:"POST",params:{action:"create_post"},headers:i},votePost:{method:"POST",params:{action:"vote"},headers:i},flagPost:{method:"POST",params:{action:"flag"},headers:i},createComment:{method:"POST",params:{action:"create_comment"},headers:i},deletePost:{method:"DELETE",params:{action:"delete_post"},headers:i},deleteComment:{method:"DELETE",params:{action:"delete_comment"},headers:i},voteComment:{method:"POST",params:{action:"vote_comment"},headers:i},flagComment:{method:"POST",params:{action:"flag_comment"},headers:i},removeAllFlags:{method:"DELETE",params:{action:"remove_all_flags"},headers:i},removeAllCommentFlags:{method:"DELETE",params:{action:"remove_all_comment_flags"},headers:i},hideDiscussion:{method:"POST",params:{action:"hide_post"},headers:i},hideComment:{method:"POST",params:{action:"hide_comment"},headers:i},updatePost:{method:"POST",params:{action:"update_post"},headers:i}})}]),angular.module("scalearAngularApp").factory("TimeItem",function(){return function(e,t,n){this.time=e||0,this.type=t||"",this.data=n||null}}).factory("Timeline",["TimeItem",function(r){return function(){this.items=[],this.items.push(new r),this.add=function(e,t,n){for(var a=this.items.length-1,i=new r(e,t,n);0<=a;a--)if(i.time>=this.items[a].time){this.items.splice(a+1,0,i);break}return a+1},this.getIndexById=function(e,t){for(var n=this.items.length-1;0<=n;n--)if(this.items[n].data.id==e&&this.items[n].type==t)return n},this.removeById=function(e,t){this.items.splice(this.getIndexById(e,t),1)},this.getNearestEvent=function(e){for(var t=this.items[this.items.length-1].time,n=this.items[this.items.length-1],a=this.items.length-1;0<=a;a--){var i=Math.abs(e-this.items[a].time);Math.abs(e-this.items[a].time)<t&&(t=i,n=this.items[a])}return n},this.filterByType=function(t){return this.items.filter(function(e){return e.type==t})},this.filterByNotType=function(t){return this.items.filter(function(e){return e.type!=t})},this.getNextItem=function(e){return this.items[this.items.indexOf(e)+1]},this.getPrevItem=function(e){return this.items[this.items.indexOf(e)-1]},this.getNextByType=function(e){var t=this.filterByType(e.type);return t[t.indexOf(e)+1]},this.getPrevByType=function(e){var t=this.filterByType(e.type);return t[t.indexOf(e)-1]},this.getItemsBetweenTime=function(n,a){return this.items.filter(function(e,t){return e.time>=n&&e.time<=a&&0<t}).sort(function(e,t){return e.time-t.time})},this.getItemsBetweenTimeByType=function(n,a,e){return this.filterByType(e).filter(function(e,t){return e.time>=n&&e.time<=a}).sort(function(e,t){return e.time-t.time})},this.removeAllByType=function(e){this.items=this.filterByNotType(e)}}}]),angular.module("scalearAngularApp").factory("VideoInformation",["$http","$q","$interval",function(a,i,n){var r={youtube_video_information:{},duration:0,current_time:0,volume:.8,speed:1,quality:"720p"};return r.requestInfoFromYoutube=function(e){var t=i.defer(),n="https://www.googleapis.com/youtube/v3/videos?id="+e+"&key=AIzaSyAztqrTO5FZE2xPI4XDYbLeOXE0vtWoTMk&callback=JSON_CALLBACK&part=status,contentDetails,snippet";return r.youtube_video_information[n]?t.resolve(r.youtube_video_information[n]):a.jsonp(n).then(function(e){r.youtube_video_information[n]=e.data,t.resolve(r.youtube_video_information[n])}).catch(function(e){emptyCachedInfo(),t.reject(e)}),t.promise},r.emptyCachedInfo=function(){r.youtube_video_information={}},r.isYoutube=function(e){var t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)([^\s&]{11})/);return t||e.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)?([^\s&]{11})/)},r.isFinalUrl=function(e){return e.match(/^(http|https):\/\/www\.youtube\.com\/watch\?v=[^\s]{11}[\W\w]*$/)},r.getFinalUrl=function(e){return"https://www.youtube.com/watch?v="+e},r.isMP4=function(e){return e.match(/(.*mp4$)/)},r.isMediaSite=function(e){return e.match(/^(http|https):\/\/.*(\/Play\/)/)},r.isKaltura=function(e){return e.match(/https?:\/\/.*\/[a-zA-Z]+\/[0-9]+\/[a-zA-Z]+\/[0-9]+00\/[a-zA-Z]+\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+).*&entry_id=(.+)(&.*)?/)},r.invalidUrl=function(e){return e.trim().length<=0||!r.isMP4(e)&&!r.isYoutube(e)&&!r.isMediaSite(e)&&!r.isKaltura(e)},r.setDuration=function(e){r.duration=e},r.waitForDurationSetup=function(){var e=i.defer(),t=n(function(){r.duration&&(e.resolve(r.duration),n.cancel(t))},500);return e.promise},r.resetValues=function(){r.duration=0,r.current_time=0,r.volume=.8,r.speed=1,r.quality="720p"},r}]),angular.module("scalearAngularApp").factory("URLInformation",["$cookieStore",function(t){var n=null,a=null,i=[];function r(){return n}function o(){return a||t.get("enroll_link")}return{shouldRedirect:function(){return!!n},getRedirectLink:r,setRedirectLink:function(e){return n=e,r()},clearRedirectLink:function(){n=null},addToHistory:function(e){i.push(e)},getHistory:function(){return i.pop()},setEnrollLink:function(e){return a=e,t.put("enroll_link",e),o()},getEnrollLink:o,clearEnrollLink:function(){a=null,t.remove("enroll_link")},hasEnroll:function(){return!!o()}}}]),angular.module("scalearAngularApp").factory("Page",["$rootScope","$filter","$log",function(n,a,i){var r="Home",o="home";return{title:function(){return r},pageName:function(){return o.replace(".","_")},setTitle:function(e,t){o=e,r=a("translate")(e),t&&(r+=t),n.current=e,i.debug(n.current)},startTour:function(){}}}]),angular.module("scalearAngularApp").factory("ScalTour",["$rootScope","$filter","$tour","Page","User",function(n,e,t,a,i){n.$on("tour_ended",function(){var t=n.$watch("current_user",function(){if(n.current_user){var e=n.current_user.completion_wizard;1==e.intro_watched&&(e[a.pageName()]=!0,$log.debug(e),i.updateCompletionWizard({id:n.current_user.id},{completion_wizard:e},function(){n.current_user.completion_wizard[a.pageName()]=!0,t()},function(){t()}))}})})}]),angular.module("scalearAngularApp").service("ScalearUtils",["$rootScope","$translate",function(n,c){var a=function(e,t,n){if(!/^\d\d:\d\d:\d\d(\.\d\d\d)?$/.test(e))return c.instant("editor.incorrect_format_time");var a=e.split(":"),i=parseInt(a[0]),r=parseInt(a[1]),o=parseInt(a[2]),s=60*i*60+60*r+o;return i<0||24<i||r<0||59<r||o<0||59<o?c.instant("editor.incorrect_format_time"):n&&(t<=s||s<=0)?c.instant("editor.time_outside_range"):void 0};return{getKeys:function(e){return Object.keys?Object.keys(e):function(e){var t,n=[];for(t in e)hasOwn.call(e,t)&&n.push(t);return n}(e)},safeApply:function(e){var t=n.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():n.$apply(e)},parseDuration:function(e){var t=e.match(/^P([0-9]+Y|)?([0-9]+M|)?([0-9]+D|)?T?([0-9]+H|)?([0-9]+M|)?([0-9]+S|)?$/),n={};return!!t&&(n.year=parseInt(t[1])||0,n.month=parseInt(t[2])||0,n.day=parseInt(t[3])||0,n.hour=parseInt(t[4])||0,n.minute=parseInt(t[5])||0,n.second=parseInt(t[6])||0,n.toString=function(){var e="";return this.year&&(e+=this.year+" Year"+(1==this.year?"":"s")+" "),this.month&&(e+=this.month+" Month"+(1==this.month?"":"s")+" "),this.day&&(e+=this.day+" Day"+(1==this.day?"":"s")+" "),this.hour&&(e+=this.hour+" Hour"+(1==this.hour?"":"s")+" "),this.minute&&(e+=this.minute+" Minute"+(1==this.minute?"":"s")+" "),this.second&&(e+=this.second+" Second"+(1==this.second?"":"s")+" "),e},n)},hour12:function(e){var t=e%24,n="AM";return 0==t?t=12:12<t&&(t%=12,n="PM"),t+" "+n},toHourMin:function(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60);return t<10&&(t="0"+t),n<10&&(n="0"+n),t+":"+n},toObjectById:function(e){var t={};return e instanceof Array&&e.forEach(function(e){t[e.id]=e}),t},urlWithProtocol:function(e){return e?e.match(/^http/)?e:"http://"+e:e},shorten:function(e,t){var n=void 0!==t?t:50,a=e.replace("http://","").replace("https://","");if(a.length<=n)return a;var i=n/2;return this.shortString(a,i,!1)+".."+this.shortString(a,i,!0)},shortString:function(e,t,n){for(var a=[" ","/","&"],i=.8*t,r=n?e.split("").reverse().join(""):e,o="",s=0;s<t-1&&(o+=r[s],!(i<=s&&0<=a.indexOf(e[s])));s++);return n?o.split("").reverse().join(""):o},getIndexById:function(e,t){for(var n in e)if(e[n].id==t)return n;return-1},isHtml:function(e){return"string"==typeof e&&/<[a-z][\s\S]*>/i.test(e)},getHtmlText:function(e){if(this.isHtml(e)){var t=$(e);return t.find(".MathJax_Preview").remove(),t.text()}return e},getShortAnswerText:function(e,t){return 1.7<window.innerWidth/window.innerHeight&&1280<window.innerWidth?5<=t&&20<e.length?e.substring(0,20)+"..":e:20<=e.length?5<=t&&10<=e.length?e.substring(0,10)+"..":e.substring(0,20)+"..":e},capitalize:function(e){return e[0].toUpperCase()+e.slice(1)},gcd:function(e,t){return 0==t?e:this.gcd(t,e%t)},calculateScreenRatio:function(){var e=screen.width,t=screen.height,n=this.gcd(e,t);return e/n+":"+t/n},validateTimeWithDuration:function(e,t){return a(e,t,!0)},validateTimeWithoutDuration:function(e,t){return a(e,t,!1)},validateTimeWithDurationForTrim:function(e,t,n){return function(e,t,n,a){var i=/^\d\d:\d\d:\d\d$/;if(!i.test(e))return c.instant("editor.incorrect_format_time");var r=e.split(":"),o=parseInt(r[0]),s=parseInt(r[1]),l=parseInt(r[2]),u=60*o*60+60*s+l;if(o<0||24<o||s<0||59<s||l<0||59<l)return c.instant("editor.incorrect_format_time");if(n&&(t<u||u<0))return c.instant("editor.time_outside_range");if(a&&i.test(a)){var d=a.split(":");if(u<=60*parseInt(d[0])*60+60*parseInt(d[1])+parseInt(d[2]))return c.instant("editor.start_time_bigger_than_end_time")}}(e,t,!0,n)},arrayToSeconds:function(e){return 60*+e[0]*60+60*+e[1]+ +e[2]},listTimezones:function(){return[{name:"American Samoa",offset:-11,value:"(GMT-11:00) American Samoa"},{name:"Hawaii",offset:-10,value:"(GMT-10:00) Hawaii"},{name:"Alaska",offset:-9,value:"(GMT-09:00) Alaska"},{name:"Pacific Time (US & Canada)",offset:-8,value:"(GMT-08:00) Pacific Time (US & Canada)"},{name:"Mountain Time (US & Canada)",offset:-7,value:"(GMT-07:00) Mountain Time (US & Canada)"},{name:"Central Time (US & Canada)",offset:-6,value:"(GMT-06:00) Central Time (US & Canada)"},{name:"Eastern Time (US & Canada)",offset:-5,value:"(GMT-05:00) Eastern Time (US & Canada)"},{name:"Atlantic Time (Canada)",offset:-4,value:"(GMT-04:00) Atlantic Time (Canada)"},{name:"Greenland",offset:-3,value:"(GMT-03:00) Greenland"},{name:"Mid-Atlantic",offset:-2,value:"(GMT-02:00) Mid-Atlantic"},{name:"Azores",offset:-1,value:"(GMT-01:00) Azores"},{name:"UTC",offset:0,value:"(GMT+00:00) UTC"},{name:"Stockholm",offset:1,value:"(GMT+01:00) Stockholm"},{name:"Cairo",offset:2,value:"(GMT+02:00) Cairo"},{name:"Kuwait",offset:3,value:"(GMT+03:00) Kuwait"},{name:"Abu Dhabi",offset:4,value:"(GMT+04:00) Abu Dhabi"},{name:"Mumbai",offset:5,value:"(GMT+05:30) Mumbai"},{name:"Dhaka",offset:6,value:"(GMT+06:00) Dhaka"},{name:"Bangkok",offset:7,value:"(GMT+07:00) Bangkok"},{name:"Hong Kong",offset:8,value:"(GMT+08:00) Hong Kong"},{name:"Tokyo",offset:9,value:"(GMT+09:00) Tokyo"},{name:"Sydney",offset:10,value:"(GMT+10:00) Sydney"},{name:"New Caledonia",offset:11,value:"(GMT+11:00) New Caledonia"},{name:"Fiji",offset:12,value:"(GMT+12:00) Fiji"}]}}}]),angular.module("scalearAngularApp").factory("MobileDetector",function(){var a=/iPhone/i,i=/iPod/i,r=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,l=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,u=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,d=/IEMobile/i,c=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,_=/BlackBerry/i,m=/BB10/i,p=/Opera Mini/i,g=/(CriOS|Chrome)(?=.*\bMobile\b)/i,h=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,f=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),v=function(e,t){return e.test(t)},e=new function(e){var t=e||navigator.userAgent,n=t.split("[FBAN");return void 0!==n[1]&&(t=n[0]),this.apple={phone:v(a,t),ipod:v(i,t),tablet:!v(a,t)&&v(r,t),device:v(a,t)||v(i,t)||v(r,t)},this.amazon={phone:v(l,t),tablet:!v(l,t)&&v(u,t),device:v(l,t)||v(u,t)},this.android={phone:v(l,t)||v(o,t),tablet:!v(l,t)&&!v(o,t)&&(v(u,t)||v(s,t)),device:v(l,t)||v(u,t)||v(o,t)||v(s,t)},this.windows={phone:v(d,t),tablet:v(c,t),device:v(d,t)||v(c,t)},this.other={blackberry:v(_,t),blackberry10:v(m,t),opera:v(p,t),firefox:v(h,t),chrome:v(g,t),device:v(_,t)||v(m,t)||v(p,t)||v(h,t)||v(g,t)},this.seven_inch=v(f,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,this};return{devices:e,isMobile:function(){return e.any},isPhone:function(){return e.phone},isTablet:function(){return e.tablet},isiPhone:function(){return e.apple.iphone||e.apple.ipod},isiPad:function(){return e.apple.tablet},isAndroidPhone:function(){return e.android.phone},isAndroidTablet:function(){return e.android.tablet},isAndroid:function(){return e.android.phone||e.android.tablet}}}),angular.module("scalearAngularApp").factory("Impersonate",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/en/impressionate/:action",{},{create:{method:"POST",headers:i},destroy:{method:"DELETE",headers:i}})}]).factory("Preview",["Impersonate","$state","$cookieStore","ContentNavigator","$rootScope","$log","UserSession","Token",function(i,r,o,s,l,u,d,c){var _=null,m=function(){o.remove("preview_as_student"),o.remove("old_user_id"),o.remove("new_user_id"),o.remove("params"),o.remove("state")};return{start:function(){d.getCurrentUser().then(function(e){_=e,function(){(!r.params||r.params&&!r.params.course_id)&&(r.params=o.get("params"),r.current.name=o.get("state"),_.id=o.get("old_user_id"));var t=function(e){var t={course_id:e.params.course_id};if(e.params.module_id){var n="course.module.courseware";return e.params.lecture_id?n+=".lecture":e.params.quiz_id?n+=".quiz":n+=".overview",{name:n,params:e.params,prev:n.replace("courseware","course_editor")}}return 0<=e.params.prevState.indexOf("course.edit_course_information")?{name:"course.course_information",params:t,prev:"course.edit_course_information"}:{name:"course",params:t,prev:"course"}}(r),e=t.prev,n=r.params;o.put("old_user_id",_.id),o.put("state",e),o.put("params",n),s.close(),i.create({},{course_id:r.params.course_id},function(e){r.go(t.name,t.params,{notify:!1,reload:!1,location:"replace",inherit:!1}),d.allowRefetchOfUser(),o.put("preview_as_student",!0),o.put("new_user_id",e.user.id),c.setToken(e.token),l.preview_as_student=!0,_=null,r.go(t.name,t.params,{reload:!0}),l.$broadcast("Course:get_current_courses")},function(){u.debug("Failed to Start Preview"),m()})}()})},stop:function(){var e=r.current.name,t=r.params;if(o.get("preview_as_student")){var n=o.get("params"),a=o.get("state");s.close(),l.$broadcast("exit_preview"),i.destroy({old_user_id:o.get("old_user_id"),new_user_id:o.get("new_user_id")},function(e){d.allowRefetchOfUser(),c.setToken(e.token),m(),l.preview_as_student=!1,_=null,r.go(a,n,{reload:!0}),l.$broadcast("Course:get_current_courses")},function(){l.preview_as_student=!0,r.go(e,t,{notify:!1,reload:!1,location:"replace",inherit:!0}),u.debug("Failed Closing Preview"),m()})}}}}]),angular.module("scalearAngularApp").factory("Dashboard",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(e,t,n,a,i,r,o){return t.defaults.useXDomain=!0,e(a.host+"/:lang/dashboard/:action",{lang:o.use()},{getDashboard:{method:"GET",params:{action:"get_dashboard"},headers:i}})}]),angular.module("scalearAngularApp").factory("ContentNavigator",["$rootScope",function(t){return{status:!1,getStatus:function(){return this.status},setStatus:function(e){this.status=e,t.$broadcast("content_navigator_change",this.status)},open:function(){this.setStatus(!0)},close:function(){this.setStatus(!1)}}}]),angular.module("scalearAngularApp").factory("TimelineNavigator",["$rootScope",function(t){return{status:!1,getStatus:function(){return this.status},setStatus:function(e){this.status=e,t.$broadcast("timeline_navigator_change",this.status)},open:function(){this.setStatus(!0)},close:function(){this.setStatus(!1)}}}]).factory("TimelineFilter",["$rootScope",function(e){var n={};return n=e.preview_as_student?{quiz:!0,confused:!1,discussion:!1,note:!1,marker:!0}:{quiz:!0,confused:!0,discussion:!0,note:!0,marker:!0},{get:function(e){return n[e]},set:function(e,t){n[e]=t},toggle:function(e){n[e]=!n[e]},get_filter:function(){return n}}}]),angular.module("scalearAngularApp").factory("DetailsNavigator",["$rootScope","$timeout",function(t,e){return{status:!1,getStatus:function(){return this.status},setStatus:function(e){this.status=e,t.$broadcast("details_navigator_change",e)},open:function(){this.setStatus(!0)},close:function(){this.setStatus(!1)},module_details_groups:{module:!0,settings:!1},lecture_details_groups:{video:!0,settings:!1,quizzes:!1,markers:!1}}}]),angular.module("scalearAngularApp").factory("VideoEventLogger",["$q","Lecture","$log",function(d,c,_){return{log:function(e,t,n,a,i,r,o,s,l){var u=d.defer();return null!=a&&0<=a?(_.debug("log video event",n),c.logVideoEvent({course_id:e,lecture_id:t},{event:n,from_time:a,to_time:i,in_quiz:r,speed:o,volume:s,fullscreen:l}).$promise.then(function(e){_.debug("event successfully logged"),u.resolve(e)}).catch(function(e){u.reject(e)})):u.reject(),u.promise}}}]),angular.module("scalearAngularApp").factory("Token",["$cookieStore","$q","$interval",function(a,i,r){var o=null;return{getToken:function(){return o||!!a.get("token")&&(o=a.get("token"))},setToken:function(e){o=e,a.put("token",e)},setTokenWithPromise:function(e){o=e,a.put("token",e);var t=i.defer(),n=r(function(){o.uid&&a.get("token").uid==o.uid&&(r.cancel(n),t.resolve())},250);return t.promise}}}]),angular.module("scalearAngularApp").controller("MainCtrl",["$scope","$log","Page","$rootScope","Home","$state","$location","scalear_api","ngDialog",function(e,t,n,a,i,r,o,s,l){n.setTitle("ScalableLearning: Active in-class and online learning for teachers, students, and flipped classroom teaching."),e.play_teacher=!1,e.play_student=!1,e.beta=s.beta,e.teacher_welcome_video=s.teacher_welcome_video,e.instruction_manual=s.instruction_manual,e.flipped_manual=s.flipped_manual,e.teacher_forum_link=s.teacher_forum_link,e.student_welcom_video=s.student_welcom_video,$("a.page-scroll").bind("click",function(e){$("html, body").stop().animate({scrollTop:$($(this).attr("href")).offset().top},1500,"easeInOutExpo"),e.preventDefault()}),$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()}),$("body").scrollspy({target:".navbar-fixed-top"}),e.goTo=function(e){r.go(e)},e.playerTeacher=function(){e.play_teacher=!0,l.open({template:"teacherIntro",className:"ngdialog-theme-default ngdialog-theme-custom ngdialog-theme-custom-video",scope:e})},e.playerStudent=function(){e.play_student=!0,l.open({template:"studentIntro",className:"ngdialog-theme-default ngdialog-theme-custom ngdialog-theme-custom-video",scope:e})},e.sendTechnical=function(){e.submitted=!0,e.user&&e.user.name&&e.user.email&&e.comment_data&&(e.sending_technical=!0,i.contactUs({name:e.user.name,email:e.user.email,url:o.url(),comment:e.comment_data,agent:navigator.userAgent},function(){e.user={},e.comment_data=null,e.sending_technical=!1,e.show_thanks=!0,e.submitted=!1}))}}]),angular.module("scalearAngularApp").controller("HomeCtrl",["$scope","$log","Page","$rootScope","$state",function(e,t,n,a,i){}]),angular.module("scalearAngularApp").controller("AboutCtrl",["$scope","Page","$rootScope","$translate",function(e,t,n,a){t.setTitle("footer.about"),n.subheader_message=a.instant("footer.about")}]),angular.module("scalearAngularApp").controller("indexCtrl",["$scope","$timeout","$rootScope","$translate","$window","$log","Page","$cookieStore","ContentNavigator","scalear_api","MobileDetector","CourseModel","UserSession",function(n,a,t,i,r,e,o,s,l,u,d,c,_){function m(){n.current_teacher_courses=null,n.current_student_courses=null,c.currentCourses().then(function(e){n.current_teacher_courses=e.teacher_courses,n.current_student_courses=e.student_courses})}FastClick.attach(document.body),n.Page=o,t.preview_as_student=s.get("preview_as_student"),n.ContentNavigator=l,n.isTeacher=c.isTeacher,n.isStudent=c.isStudent,n.ContentNavigator.delayed_navigator_open=n.ContentNavigator.status,t.is_mobile=d.isMobile(),n.$on("content_navigator_change",function(e,t){t?(n.cancelDelay&&a.cancel(n.cancelDelay),n.ContentNavigator.delayed_navigator_open=!0):n.cancelDelay=a(function(){n.ContentNavigator.delayed_navigator_open=!1},300)}),_.getCurrentUser().then(function(e){m()},function(e){t.preview_as_student&&(t.preview_as_student=null,s.remove("preview_as_student"))}),t.$on("Course:get_current_courses",function(){m()}),n.changeLanguage=function(e){i.use(e),t.current_lang=e,r.moment.locale(e)},n.changeLanguage(i.use()),ga("create",u.ga_token),ga("send","pageview")}]),angular.module("scalearAngularApp").controller("LoginCtrl",["$state","$scope","$rootScope","scalear_api","$window","$log","$translate","User","Page","ErrorHandler","ngDialog","MobileDetector","Saml","$location","SWAMID","$cookieStore","$timeout","URLInformation","UserSession","$http","Token",function(t,n,a,e,i,r,o,s,l,u,d,c,_,m,p,g,h,f,v,b,y){n.user={},n.user.email=t.params.email||"",t.params["access-token"]&&(y.setToken(t.params),s.getCurrentUser({},function(){t.go("dashboard")})),l.setTitle("navigation.login"),$("#user_email").select(),p.list().then(function(e){n.swamid_list=e}),n.previous_provider=g.get("login_provider"),n.toggleProviders=function(){n.show_providers?n.hideProviders():n.showProviders()},n.showProviders=function(){n.show_providers=!0,h(function(){$("#search").select()}),shortcut.add("Enter",function(){n.swamid[0]&&n.samlLogin(n.swamid[0])})},n.hideProviders=function(){n.show_providers=!1,shortcut.remove("Enter",function(){n.samlLogin(n.swamid[0])})},n.showLoginForm=function(){n.show_scalable_login=!n.show_scalable_login,n.hideProviders()},n.login=function(){n.sending=!0,v.allowRefetchOfUser(),v.signIn(n.user).then(function(e){g.put("login_provider","scalablelearning"),r.debug("login success"),n.sending=!1,a.$broadcast("Course:get_current_courses"),n.is_mobile=c.isMobile(),n.is_mobile&&(c.isTablet()||c.isPhone())?w(function(){k(e.user.data)}):k(e.user.data)})},n.join=function(){s.userExist({email:n.user.email},function(e){t.go("signup",{input1:n.user.email,input2:n.user.password})})};var w=function(e){d.open({template:"mobileSupport",className:"ngdialog-theme-default ngdialog-theme-custom",preCloseCallback:e})},k=function(e){e.info_complete?f.hasEnroll()?(i.location.href=f.getEnrollLink(),f.clearEnrollLink()):f.shouldRedirect()?(i.location.href=f.getRedirectLink(),f.clearRedirectLink()):t.go("dashboard"):(t.go("edit_account"),u.showMessage(o.instant("error_message.update_account_information"),"errorMessage",null,"error"))},z=function(e){"POST"==e.action?$(e.saml_url).appendTo("body").submit():window.location=e.saml_url};n.samlLogin=function(e){g.put("login_provider",e),a.busy_loading=!0,_.Login({idp:e.entityID},function(e){n.is_mobile=c.isMobile(),n.is_mobile&&(c.isTablet()||c.isPhone())?(a.busy_loading=!1,w(function(){a.busy_loading=!0,z(e)})):z(e)},function(){a.busy_loading=!1,u.showMessage("Could not reach provider","errorMessage",4e3,"error")})}}]),angular.module("scalearAngularApp").controller("PrivacyCtrl",["$scope","Page","$rootScope","$translate",function(e,t,n,a){t.setTitle("privacy.policy"),n.subheader_message="ScalableLearning "+a.instant("privacy.policy")}]),angular.module("scalearAngularApp").controller("FaqCtrl",["$scope","Page","$rootScope","$translate",function(e,t,n,a){t.setTitle("faq"),n.subheader_message=a.instant("faq"),e.questions_count=new Array(6)}]),angular.module("scalearAngularApp").controller("courseCtrl",["$rootScope","$stateParams","$scope","Course","$log","$cookieStore","ScalearUtils","CourseData","$state","ContentNavigator","$window","MobileDetector","CourseModel",function(e,t,n,a,i,r,o,s,l,u,d,c,_){if(l.includes("**.course"))if(_.isStudent())if(c.isPhone()&&angular.element(d).width()<700)l.go("course.content_selector",{course_id:s.id});else if(-1!=s.next_item.module){var m={module_id:s.next_item.module};m[s.next_item.item.class_name+"_id"]=s.next_item.item.id,l.go("course.module.courseware."+s.next_item.item.class_name,m)}else l.go("course.course_information",{course_id:s.id});else l.go("course.edit_course_information",{course_id:s.id});n.$on("$destroy",function(){u.close(),l.includes("**.course.**")||(_.removeSelectedCourse(),_.removeCourseRole())})}]),angular.module("scalearAngularApp").controller("moduleCtrl",["$scope","$state","ModuleModel","ErrorHandler",function(e,t,n,a){var i=n.getById(t.params.module_id);i?n.setSelectedModule(i):(t.go("course_list"),a.showMessage("Model is not publised .","errorMessage",4e3,"error")),e.$on("$destroy",function(){n.clearSelectedModule()})}]),angular.module("scalearAngularApp").controller("sharedCtrl",["$scope","Page","SharedItem","Module","Lecture","Quiz","$rootScope","$translate","$log",function(t,e,n,a,i,r,o,s,l){e.setTitle("sharing.view"),o.subheader_message=s.instant("sharing.manage");n.showShared({},function(e){l.debug(e),t.shared_items=e.all_shared,t.courses=e.courses},function(){})}]),angular.module("scalearAngularApp").controller("ReportTechnicalCtrl",["$scope","$modalInstance","$log","$rootScope","Home","$translate","$stateParams","$location","$interval","$state","UserSession","scalear_api",function(r,o,s,l,u,d,c,_,m,e,t,p){r.issue_types=[{value:"system",text:d.instant("feedback.system")}],e.includes("course")&&r.issue_types.push({value:"content",text:d.instant("feedback.course_content")}),r.selected_type=r.issue_types[0],t.getCurrentUser().then(function(e){r.current_user=e}),r.issue_scalable_website_types=[{value:"none",text:d.instant("feedback.none")},{value:"no_access",text:d.instant("feedback.no_access")},{value:"question_before_sign",text:d.instant("feedback.question_before_sign")},{value:"request_feature",text:d.instant("feedback.request_feature")},{value:"no_email",text:d.instant("feedback.no_email")},{value:"confused",text:d.instant("feedback.confused")},{value:"bug",text:d.instant("feedback.bug")},{value:"other",text:d.instant("feedback.other")}],r.selected_scalable_website_type=r.issue_scalable_website_types[0],r.hide_issue_scalable_website_types=!1,r.hide_content=!1,r.selectedScalableWebsiteTypeEnable=function(e){r.hide_issue_scalable_website_types=!("system"==e.value)},r.sendTechnical=function(e,t,n,a){if(a||(a={name:r.current_user.full_name,email:r.current_user.email}),r.current_user||a&&a.name&&a.email)if(r.no_text=null,n){r.no_text=null,r.sending_technical=!0,s.debug(r.selected_type.value),s.debug(r.technical_data);var i=navigator.userAgent.split(";").join(",");u.technicalProblem({name:a.name,email:a.email,issue_type:e.value,issue_website_type:t.text,course:c.course_id||-1,module:c.module_id||-1,lecture:c.lecture_id||-1,quiz:c.quiz_id||-1,url:_.url(),problem:n,lang:l.current_lang,agent:i,version:p.version},function(){angular.element(".reveal-modal").css("height","auto"),r.hide_content=!0,r.technical_data=null,m(function(){o.close()},3e3,1)})}else r.no_text=d.instant("feedback.provide_desciption");else r.no_text=d.instant("feedback.provide_email_name")},r.cancel=function(){r.selected_type=r.issue_types[0],r.selected_scalable_website_type=r.issue_scalable_website_types[0],r.technical_data=null,r.no_text=null,o.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("announcementsCtrl",["$scope","Announcement","$stateParams","$translate","$log","$window","Page","ContentNavigator",function(a,i,r,e,t,n,o,s){s.close(),o.setTitle("navigation.announcements"),a.disable_new=!1;a.deleteAnnouncement=function(e){e.id&&i.destroy({course_id:r.course_id,announcement_id:e.id},{}),a.announcements.splice(a.announcements.indexOf(e),1),a.disable_new=!1},a.createAnnouncement=function(){for(var e in a.disable_new=!0,a.announcements)a.announcements[e].show&&a.hideAnnouncement(e);a.newAnnouncement={announcement:"",created_at:new Date,show:!0},a.announcements instanceof Array||(a.announcements=[]),a.announcements.push(a.newAnnouncement)},a.hideAnnouncement=function(t){"string"!=typeof t&&(a.disable_new=!1,a.saving=!1,t.show=!1,t.id?i.show({course_id:r.course_id,announcement_id:t.id},function(e){t=e}):a.announcements.splice(a.announcements.indexOf(t),1))},a.showAnnouncement=function(e){for(var t in a.announcements)a.announcements[t].show&&a.hideAnnouncement(t);a.disable_new=!0,e.show=!0,e.overclass=""},a.saveAnnouncement=function(t){a.saving=!0;var e=document.createElement("DIV");e.innerHTML=t.announcement;var n=e.textContent||e.innerText||"";(n=n.replace(/\s/g,"")).length||(t.announcement=n),t.id?i.update({course_id:r.course_id,announcement_id:t.id},{announcement:{announcement:t.announcement}},function(e){a.announcements[a.announcements.indexOf(t)]=e.announcement,a.disable_new=!1,a.saving=!1},function(e){t.errors=e.data.errors,a.saving=!1}):i.create({course_id:r.course_id},{announcement:{announcement:t.announcement,course_id:r.course_id}},function(e){a.announcements[a.announcements.length-1]=e.announcement,a.disable_new=!1,a.saving=!1},function(e){t.errors=e.data.errors,a.saving=!1})},i.index({course_id:r.course_id},function(e){a.announcements=e,a.show_button=!0,(r.show=!0)&&a.createAnnouncement()})}]),angular.module("scalearAngularApp").controller("courseListCtrl",["$scope","Course","$stateParams","$translate","$log","$window","Page","$rootScope","ngDialog","$timeout","UserSession",function(r,i,e,t,n,a,o,s,l,u,d){o.setTitle("navigation.courses"),o.startTour(),s.subheader_message=t.instant("navigation.courses"),r.column="start_date",r.is_reverse=!0,r.course_filter="!!",r.teacher_courses=[],r.student_courses=[],r.course_loading=!1,d.getCurrentUser().then(function(e){r.current_user=e});var c=function(e,t){var n=e,a=t;i.index({offset:n,limit:a},function(e){r.teacher_courses=r.teacher_courses.concat(e.teacher_courses),r.student_courses=r.student_courses.concat(e.student_courses),(n+=a)<e.total?c(n,a):r.course_loading=!0})},_=function(e,t){var n=t+"_courses",a="current_"+n;r[n].splice(r[n].indexOf(e),1);var i=r[a].map(function(e){return e.id}).indexOf(e.id);-1<i&&r[a].splice(i,1)};r.deleteCourse=function(t){l.open({template:'              <div class="ngdialog-message">                  <h2><b><span translate>courses.list.delete_popup.warning</span>!</b></h2>                  <span>                    <span>                      <span translate>courses.list.delete_popup.delete_course</span>                      <b> "'+t.short_name+" | "+t.name+'" </b>                      <span translate>courses.list.delete_popup.will_delete</span></span>                    <ul>                      <li translate>courses.list.delete_popup.all_modules</li>                      <li translate>courses.list.delete_popup.all_items</li>                      <li translate>courses.list.delete_popup.all_progress</li>                    </ul>                    <span translate>courses.list.delete_popup.are_you_sure</span>                    <span translate>courses.list.delete_popup.cannot_undo</span>                  </span>              </div>              <div class="ngdialog-buttons">                  <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>button.cancel</button>                  <button type="button" class="ngdialog-button ngdialog-button-alert delete_confirm" ng-click="delete()" translate>button.delete</button>              </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1,controller:["$scope",function(e){e.delete=function(){i.destroy({course_id:t.id},{},function(){_(t,"teacher")}),e.closeThisDialog()}}]})},r.unenrollCourse=function(e){i.unenroll({course_id:e.id},{},function(){_(e,"student")},function(){})},r.filterTeacher=function(e,t){r.filtered_teacher_name=e,r.filtered_teacher=t},r.filterCourse=function(e){r.course_filter=e},r.removeFilter=function(){r.filtered_teacher=""},r.order=function(e){r.column=e,r.is_reverse=!r.is_reverse},c(0,10)}]),angular.module("scalearAngularApp").controller("newCourseCtrl",["$rootScope","$scope","Course","$state","$window","$log","Page","ScalearUtils","$translate","$filter","CourseModel","$q","$modal","UserSession","User",function(e,u,t,i,n,a,r,o,d,s,l,c,_,m,p){n.scrollTo(0,0),u.getHtmlText=o.getHtmlText,r.setTitle("navigation.new_course"),e.subheader_message=d.instant("navigation.new_course"),u.submitting=!1,u.show_course_selection=!1,u.course={},u.status="  ",u.welcome_message=null,u.course.selected_subdomain={All:!0},u.hide_ask_copy=!1,u.course.email_discussion=!1,u.selected_course_details=!1,u.selected_course=null,u.selected_course_description=null,u.selected_course_prerequists=null,l.getUserOtherCourses().then(function(e){u.importing=e.importing,u.subdomains=e.subdomains}),u.timezones=o.listTimezones(),u.course.time_zone=u.timezones[11],u.course.start_date=new Date,u.course.end_date=new Date;u.course.end_date.setDate(u.course.start_date.getDate()+70),u.import_from=null,m.getCurrentUser().then(function(e){u.current_user=e,p.getWelcomeMessage({id:e.id},function(e){e&&(u.welcome_message=e.welcome_message)})}),u.addImportInformation=function(e){var t="["+d.instant("navigation.copied_from"),n="",a="",i="",r="",o="",s=u.import_from=e;if(s){var l="\n"+t+" "+s.name+" :]\n";s.description&&(n=l+s.description),i=s.description,s.prerequisites&&(a=l+s.prerequisites),r=s.prerequisites,o=s.image_url}u.course.description?u.course.description=u.course.description.split(t)[0].trim()+n:u.course.description=i,u.course.prerequisites?u.course.prerequisites=u.course.prerequisites.split(t)[0].trim()+a:u.course.prerequisites=r,u.course.image_url||(u.course.image_url=o)},u.unselectCourse=function(){u.import_from=null,u.addImportInformation()},u.toggleRegistration=function(){u.disable_registration_checked?u.course.disable_registration=u.course.end_date:u.course.disable_registration=null},u.toggleDomain=function(e){e.stopPropagation(),_.open({templateUrl:"/views/teacher/course_list/school_registration_modal.html",plain:!0,scope:u,controller:["$scope","$modalInstance",function(e,t){e.subdomain={},e.course_domain={},e.course_domain.selected_subdomain={},e.subdomain.boolean="all",e.course.selected_subdomain.All||(e.subdomain.boolean="custom"),e.close=function(){t.dismiss()},e.updateDomainList=function(){e.course.selected_subdomain=e.course_domain.selected_subdomain},e.setBooleanDomain=function(){"all"==e.subdomain.boolean?e.course.selected_subdomain={All:!0}:delete e.course.selected_subdomain.All}}]}).result.finally(function(){-1==Object.keys(u.course.selected_subdomain).map(function(e){return u.course.selected_subdomain[e]}).indexOf(!0)&&(u.course.selected_subdomain={All:!0})})},u.createCourse=function(){var e,t,n;u.submitting=!0,(e=c.defer(),t={},n=!0,"Invalid Date"!=u.course.start_date&&null!=u.course.start_date||(t.start_date=["not a Date"],e.reject(t),n=!1),"Invalid Date"!=u.course.end_date&&null!=u.course.end_date||(t.end_date=["not a Date"],e.reject(t),n=!1),n&&(u.course.start_date<u.course.end_date?(t.start_date=[],t.end_date=[],e.resolve(t)):(t.start_date=["must be before end date"],e.reject(t))),e.promise).then(function(e){var t=u.import_from?u.import_from.id:null,n=u.course.selected_subdomain,a=u.course.email_discussion;l.create(u.course,t).then(function(e){u.submitting=!1,e.importing?i.go("course_list"):i.go("course.course_editor",{course_id:e.course.id,new_course:!0})}).catch(function(e){u.submitting=!1,u.server_errors=e.data.errors,u.course.selected_subdomain=n,u.course.email_discussion=a})}).catch(function(e){u.server_errors=e,u.submitting=!1})},u.showConfirm=function(){_.open({templateUrl:"/views/teacher/course_list/copy_from_course.html",scope:u,controller:["$scope","$modalInstance",function(e,t){e.close=function(){e.import_from=e.selected_course,t.dismiss()}}]})},u.$on("$viewContentLoaded",function(){u.showConfirm()}),u.hideAskCopy=function(){u.hide_ask_copy=!0},u.showCourseSeleciton=function(){u.show_course_selection=!0},u.showSelectedCourseDetails=function(e){u.selected_course_details=!0,u.selected_course=e,u.selected_course_description=o.getHtmlText(e.description),u.selected_course_prerequists=o.getHtmlText(e.prerequisites)}}]),angular.module("scalearAngularApp").controller("ltiCourseListCtrl",["$rootScope","$scope","Lti","$state","$window","$location","Page","$stateParams","UserSession","$translate","Token",function(e,o,i,t,n,a,r,s,l,u,d){o.return_url=s.return_url,o.full_name=s.full_name,o.email=s.email,o.first_name=s.first_name,o.last_name=s.last_name,e.subheader_message=u.instant("global.courses_list"),o.loading_lti=!0,o.selected_lauch_url=!1,o.create_new_account=!1,o.no_common_courses=!1,o.selected_resource=!1,n.scrollTo(0,0),r.setTitle("lti.lti"),o.location_state=a.path().split("/").pop(),"lti_course_list"===o.location_state&&"lti_tool_redirect"===s.return_url&&(o.location_state="lti_tool_redirect"),t.params["access-token"]&&d.setToken(t.params),l.getCurrentUser().then(function(e){"null"===e.user?(o.create_new_account=!0,o.loading_lti=!1):i.embedCourseList({consumer_key:s.consumer_key}).$promise.then(function(e){o.no_common_courses=0===e.courses_common,o.loading_lti=!1,o.courses=e.courses})}),o.embed=function(e,t,n,a){n&&(n.preventDefault(),n.stopPropagation());var i=location.protocol+"//"+location.host+"/en/lti/lti_launch_use?sl_type_id="+t+"&sl_type="+e,r=o.return_url+"?return_type=lti_launch_url&url="+i+"&text="+a+"&title="+a;window.location.href=r},o.join=function(){var e=a.absUrl().split("lti")[0]+"users/signup?mail="+o.email+"&givenName="+o.first_name+"&sn="+o.last_name;window.open(e,"_blank")},o.choose_item=function(e,t,n,a){n&&(n.preventDefault(),n.stopPropagation()),o.selected_lauch_url=!0,o.sl_url=location.protocol+"//"+location.host+"/en/lti/lti_launch_use?sl_type_id="+t+"&sl_type="+e},o.lti_tool_redirect=function(e,t,n,a){n&&(n.preventDefault(),n.stopPropagation()),i.ltiToolRedirectSaveData({consumer_key:s.consumer_key,resource_context_id:s.resource_context_id,type:e,type_id:t}).$promise.then(function(e){o.selected_resource=!0})}}]),angular.module("scalearAngularApp").controller("ltiSignInTokenCtrl",["$rootScope","$scope","Lti","$state","$window","$location","Page","$stateParams","User","$translate","Token",function(e,t,n,a,i,r,o,s,l,u,d){i.scrollTo(0,0),o.setTitle("lti.lti"),t.loading=!0,"false"===a.params.redirect_boolean&&"no_teacher_enrollment"===a.params.status&&(t.loading=!1,t.no_teacher_enrollment=!0)}]),angular.module("scalearAngularApp").controller("courseEditorCtrl",["$rootScope","$scope","$state","$translate","$log","Page","$modal","$timeout","ContentNavigator","DetailsNavigator","Preview","ScalearUtils","CourseModel","ModuleModel","ItemsModel","LectureModel","QuizModel","LinkModel",function(i,r,n,e,a,t,o,s,l,u,d,c,_,m,p,g,h,f){function v(e,t){"video"==e?r.addLecture(0):"inclass_video"==e?r.addLecture(1):"distance_peer"==e?r.addLecture(2):"link"==e?r.addCustomLink(t||n.params.module_id):r.addQuiz(e)}r.course=_.getSelectedCourse(),t.setTitle(e.instant("navigation.content")+": "+r.course.name),l.open(),u.open(),r.DetailsNavigator=u,r.ContentNavigator=l,r.delayed_details_status=u.getStatus(),r.delayed_details_status2=u.getStatus(),r.$on("details_navigator_change",function(e,t){a.debug("datails status event",t),t?(r.delayed_details_status=!0,s(function(){r.delayed_details_status2=!0},350)):(r.delayed_details_status2=!1,s(function(){r.delayed_details_status=!1},350))}),r.$on("share_copy",function(e,t){y(t)}),r.$on("add_module",function(){r.addModule()}),r.$on("add_item",function(e,t){n.params.module_id?v(t):r.addModule(function(e){s(function(){v(t,e)})}),l.open()}),r.$on("delete_module",function(e,t){r.removeModule(t)}),r.$on("delete_item",function(e,t){"lecture"==t.class_name?r.removeLecture(t):"customlink"==t.class_name?r.removeCustomLink(t):r.removeQuiz(t)}),r.$on("clear_item",function(e,t){b()}),r.$on("copy_item",function(e,t){r.copy(t)}),r.$on("paste_item",function(e,t,n){r.paste(t,n)}),n.params.new_course&&o.open({templateUrl:"/views/teacher/course_list/email_student_answers_modal.html",scope:r,controller:["$modalInstance",function(t){r.updateEmailDiscussion=function(e){r.course.updateTeacherDiscussionEmail(e),t.dismiss("cancel")}}]}),r.capitalize=function(e){return c.capitalize(e)},r.addModule=function(t){m.create().then(function(e){n.go("course.module.course_editor.overview",{module_id:e.id}),l.open(),t&&t(e.id)})},r.removeModule=function(t){t.remove().then(function(){b();var e=m.getSelectedModule();e&&e.id==t.id&&n.go("course.course_editor")})},r.addLecture=function(e){g.create(e).then(function(e){b(),n.go("course.module.course_editor.lecture",{lecture_id:e.id})})},r.removeLecture=function(e){e.remove().then(function(){b(),n.params.lecture_id==e.id&&n.go("course.module.course_editor.overview")})},r.addQuiz=function(e){h.create(e).then(function(e){b(),n.go("course.module.course_editor.quiz",{quiz_id:e.id})})},r.removeQuiz=function(e){e.remove().then(function(){b(),n.params.quiz_id==e.id&&n.go("course.module.course_editor.overview")})},r.addCustomLink=function(e){f.create().then(function(e){n.go("course.module.course_editor.customlink",{customlink_id:e.id})})},r.removeCustomLink=function(e){e.remove().then(function(){b(),n.params.customlink_id==e.id&&n.go("course.module.course_editor.overview")})},r.previewStudent=function(){d.start()},r.copy=function(e){i.clipboard={id:e.id,name:e.name,type:e.class_name||"module",show_msg:!0,remove:e.remove}};var b=function(){i.clipboard=null};r.paste=function(e,t){var n,a=i.clipboard;a&&("module"==a.type?n=m.paste(a):"lecture"==a.type?n=g.paste(a,e):"quiz"==a.type?n=h.paste(a,e):"customlink"==a.type&&(n=f.paste(a,e)),n.then(function(){t.cut&&(r.$broadcast("delete_item",a),i.$broadcast("content_navigator_overlay",{status:!1}))}).catch(function(e){console.log(e),i.$broadcast("content_navigator_overlay",{status:!1})}))};var y=function(e){o.open({templateUrl:"/views/teacher/course_editor/sharing_modal.html",controller:"sharingModalCtrl",resolve:{selected_module:function(){return m.getById(e.module_id)},selected_item:function(){if(e.item)return p.getById(e.item.id,e.item.class_name)}}})}}]),angular.module("scalearAngularApp").controller("moduleMiddleCtrl",["$scope","$state","Module","CustomLink","$stateParams","$translate","ModuleModel",function(t,e,n,a,i,r,o){function s(){t.module.getStatistics().then(function(e){t.module_statistics=e})}t.module=o.getSelectedModule(),s(),t.$on("update_module_statistics",function(){s()})}]),angular.module("scalearAngularApp").controller("moduleDetailsCtrl",["$scope","$state","$q","$log","ModuleModel","DetailsNavigator","CourseEditor",function(a,e,t,n,i,r,o){a.module=i.getSelectedModule(),a.link_url=e.href("course.module.courseware",{module_id:a.module.id},{absolute:!0}),a.module.due_date&&(a.due_date_enabled=!o.isDueDateDisabled(a.module.due_date)),a.module_details_groups=r.module_details_groups,a.validateModule=function(e,t){var n={id:a.module.id,course_id:a.module.course_id};return n[e]=t,i.createInstance(n).validate()},a.updateModule=function(){a.module.update()},a.updateDueDate=function(){var e=new Date(a.module.due_date);if(o.isDueDateDisabled(a.module.due_date)&&!a.due_date_enabled)var t=-200;else if(!o.isDueDateDisabled(a.module.due_date)&&a.due_date_enabled)t=200;else t=0;e.setFullYear(e.getFullYear()+t);var n=new Date(a.module.appearance_time);e<=n&&(e=n).setDate(n.getDate()+7),a.module.due_date=e,a.due_date_enabled=!o.isDueDateDisabled(a.module.due_date)}}]),angular.module("scalearAngularApp").controller("lectureDetailsCtrl",["$stateParams","$scope","$state","$log","$rootScope","$modal","$filter","ItemsModel","DetailsNavigator","CourseEditor","LectureModel","VideoQuizModel","MarkerModel",function(e,i,t,n,a,r,o,s,l,u,d,c,_){i.lecture=s.getLecture(e.lecture_id),i.video={},i.lecture.inclass?i.video.type=1:i.lecture.distance_peer?i.video.type=2:i.video.type=0,s.setSelectedItem(i.lecture);var m=i.lecture.module();i.setting={},i.setting.due_date_enabled=!u.isDueDateDisabled(i.lecture.due_date),i.disable_module_due_controls=u.isDueDateDisabled(m.due_date),i.link_url=t.href("course.module.courseware.lecture",{module_id:m.id,lecture_id:i.lecture.id},{absolute:!0}),i.lecture_details_groups=l.lecture_details_groups,i.getSelectedVideoQuiz=c.getSelectedVideoQuiz,i.getSelectedMarker=_.getSelectedMarker,c.getQuizzes(),_.getMarkers(),i.validateLecture=function(e,t){var n={id:i.lecture.id,course_id:i.lecture.course_id,group_id:i.lecture.group_id};n[e]=t;var a=d.createInstance(n);return"url"==e?(a.url=o("formatURL")(a.url),a.validateUrl()):a.validate()},i.updateLecture=function(){i.lecture.update()},i.setVideoType=function(){i.lecture.inclass=!1,i.lecture.distance_peer=!1,1==i.video.type&&(i.lecture.inclass=!0),2==i.video.type&&(i.lecture.distance_peer=!0),i.updateLecture()},i.updateDueDate=function(){var e=i.setting.due_date_enabled,t=new Date(i.lecture.due_date),n=0;u.isDueDateDisabled(i.lecture.due_date)&&e?n=-200:u.isDueDateDisabled(i.lecture.due_date)||e||(n=200),t.setFullYear(t.getFullYear()+n);var a=new Date(i.lecture.appearance_time);t<=a&&(t=a).setDate(a.getDate()+7),i.lecture.due_date=t,i.setting.due_date_enabled=!u.isDueDateDisabled(i.lecture.due_date),i.lecture.due_date_module=!i.disable_module_due_controls&&i.setting.due_date_enabled},i.visible=function(e){return new Date(e)<=new Date},i.updateLectureUrl=function(){i.lecture.updateUrl().then(function(e){e&&r.open({templateUrl:"/views/teacher/course_editor/trim_modal.html",controller:["$scope","$rootScope","$modalInstance",function(e,t,n){e.trim=function(){t.$broadcast("start_trim_video"),n.close()},e.cancel=function(){n.dismiss("cancel")}}]})})},i.showQuiz=function(e){a.$broadcast("show_online_quiz",e)},i.deleteQuiz=function(e){a.$broadcast("delete_online_quiz",e)},i.showMarker=function(e){a.$broadcast("show_online_marker",e)},i.deleteMarker=function(e){a.$broadcast("delete_online_marker",e)}}]),angular.module("scalearAngularApp").controller("lectureMiddleCtrl",["$state","$stateParams","$scope","$translate","$log","$rootScope","$timeout","$q","DetailsNavigator","ngDialog","ItemsModel","VideoQuizModel","ScalearUtils","MarkerModel","$urlRouter","VideoInformation",function(a,e,d,o,t,i,r,n,s,l,u,c,_,m,p,g){function h(t,n){t.cue=d.lecture_player.controls.cue(d.lecture.start_time+(t.time-.1),function(){d.lecture_player.controls.paused()||r(function(){var e;"quiz"==n?(d.lecture_player.controls.seek_and_pause(t.time),d.showOnlineQuiz(t)):t.as_slide?(e=t,i.$broadcast("show_online_marker",e)):d.showAnnotation(t)})})}function f(e){e.cue&&d.lecture_player.controls.removeTrackEvent(e.cue.id)}function v(e){e.isTextQuiz()&&(d.quiz_layer.backgroundColor="white",d.quiz_layer.overflowX="hidden",d.quiz_layer.overflowY="auto")}function b(){d.quiz_layer.backgroundColor="transparent",d.quiz_layer.overflowX="",d.quiz_layer.overflowY=""}function y(){z(),d.submitted=!1,d.quiz_layer.backgroundColor="",function(){d.selected_quiz&&(d.selected_quiz.selected=!1);d.selected_quiz=null,d.quiz_errors={},d.quiz_deletable=!1,c.clearSelectedVideoQuiz()}(),q()}function w(){var t=n.defer(),e=n.when(!1);return d.editing_mode&&(d.selected_marker?e=d.saveMarkerBtn(d.selected_marker,{exit:!0}):d.selected_quiz&&(e=d.saveQuizBtn({exit:!0}))),e.then(function(e){e?t.reject():t.resolve()}),t.promise}function k(){z(),d.dismissMarkerAnnotation(),d.marker_errors={},m.clearSelectedMarker()}function z(){d.editing_mode=!1,d.hide_alerts=!0,d.editing_type=null}function q(){d.filtered_timeline_items=null,d.selected_inclass_item=null}function $(e,t,n){d.leave_state=!0,a.go(e,t,n),x()}d.lecture=u.getLecture(e.lecture_id),u.setSelectedItem(d.lecture),d.quiz_layer={},d.lecture_player={},d.lecture_player.events={},d.marker_errors={},d.quiz_errors={},d.alert={type:"alert",msg:"error_message.got_some_errors"},d.hide_alerts=!0,shortcut.add("i",function(){d.addQuestion()},{disable_in_input:!0,propagate:!1}),shortcut.add("n",function(){d.addOnlineMarker(!0)},{disable_in_input:!0,propagate:!1}),shortcut.add("Shift+n",function(){d.addOnlineMarker(!1)},{disable_in_input:!0,propagate:!1}),d.$on("show_online_quiz",function(e,t){d.showOnlineQuiz(t)}),d.$on("delete_online_quiz",function(e,t){d.deleteQuizButton(t)}),d.$on("show_online_marker",function(e,t){d.showOnlineMarker(t)}),d.$on("delete_online_marker",function(e,t){d.deleteMarkerButton(t)}),d.$on("add_online_quiz",function(e,t,n){d.insertQuiz(t,n)}),d.$on("start_trim_video",function(){d.editing_mode=!0,d.editing_type="video"}),d.$on("close_trim_video",function(){d.lecture.start_time=Math.floor(d.lecture.start_time),d.lecture.end_time=Math.floor(d.lecture.end_time),z(),d.refreshVideo()}),d.$on("show_quiz_background",function(e,t){v(t)}),d.$on("hide_quiz_background",function(e){b()}),d.lecture_player.events.onMeta=function(){var e=d.lecture_player.controls.getDuration();Math.ceil(d.lecture.duration)!=Math.ceil(e)&&(d.lecture.duration=e,d.lecture.update(),i.$broadcast("update_module_time",d.lecture.group_id)),d.slow=!1,d.video_ready=!1},d.lecture_player.events.onReady=function(){g.waitForDurationSetup().then(function(){d.video_ready=!0;var t=a.params.time;t?r(function(e){d.seek(t-.2)}):i.is_mobile||d.lecture_player.controls.seek_and_pause(0),d.lecture.timeline.items.forEach(function(e){e.data&&h(e.data,e.type)})})},d.lecture_player.events.onPlay=function(){d.slow=!1,d.selected_quiz&&(d.selected_quiz.hide_quiz_answers=!0,b())},d.lecture_player.events.onSlow=function(e){d.is_youtube=e,d.slow=!0},d.closeAlerts=function(){d.hide_alerts=!0},d.refreshVideo=function(){d.slow=!1,d.video_ready=!1;var e=d.lecture.url;d.lecture.url="",r(function(){d.lecture.url=e})},d.seek=function(e){d.lecture_player.controls.seek(e),d.editing_mode||d.dismissMarkerAnnotation()},d.addQuestion=function(){d.lecture_player.controls.pause(),d.openQuestionsModal()},d.insertQuiz=function(e,t){var n=d.lecture_player.controls.getTime();c.addVideoQuiz(n,e,t).then(function(e){d.lecture_player.controls.seek_and_pause(e.time),d.editing_mode=!1,d.quiz_deletable=!0,d.showOnlineQuiz(e),h(e,"quiz"),s.open()})},d.showOnlineQuiz=function(e){d.selected_quiz=c.getSelectedVideoQuiz(),d.last_details_state=s.getStatus(),d.selected_quiz!=e&&w().then(function(){d.hide_alerts=!0,d.submitted=!1,d.editing_mode=!1,r(function(){d.editing_mode=!0}),d.selected_quiz=c.createInstance(e).setAsSelected(),d.selected_quiz.selected=!0,d.selected_quiz.hide_quiz_answers=!1,d.editing_type="quiz",d.lecture_player.controls.seek_and_pause(e.time),d.selected_quiz.isTextQuiz()?(d.selected_quiz.getTextQuizAnswers(),d.double_click_msg="",v(d.selected_quiz)):(d.selected_quiz.getInVideoQuizAnswers(),d.double_click_msg="editor.messages.double_click_new_answer",b())})},d.addDoubleClickBind=function(e){if(d.editing_mode&&"quiz"==d.editing_type&&!d.selected_quiz.hide_quiz_answers&&!d.selected_quiz.isFreeTextVideoQuiz()){var t,n,a="Answer "+(d.selected_quiz.answers.length+1);n=d.selected_quiz.isDragQuiz()?(t=150,40):t=13;var i=angular.element(e.target);if("ontop"==i.attr("id")){var r=e.pageX-i.offset().left-6,o=(e.pageY-i.offset().top-6)/i.height(),s=r/i.width(),l=t/i.width(),u=n/i.height();d.selected_quiz.addAnswer(a,u,l,s,o),window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}}},d.saveQuizBtn=function(n){return d.quiz_errors={},d.selected_quiz.validate().then(function(e){return e&&e.errors?(angular.extend(d.quiz_errors,e.errors),!0):(f(d.selected_quiz),h(d.selected_quiz,"quiz"),d.selected_quiz.update(),t=n,(d.answer_form.$valid&&d.selected_quiz.isTextVideoQuiz()||(!d.selected_quiz.isTextVideoQuiz()||d.selected_quiz.isTextSurvey())&&function(){var e=0;if(!d.selected_quiz.isFreeTextVideoQuiz()){for(var t in d.selected_quiz.answers){if(!d.selected_quiz.answers[t].answer||""==d.selected_quiz.answers[t].answer.trim())return!(d.alert.msg="editor.messages.provide_answer");e=d.selected_quiz.isDragQuiz()?1:d.selected_quiz.answers[t].correct||e}if(!e&&!d.selected_quiz.isSurvey()&&!d.selected_quiz.isTextSurvey())return!(d.alert.msg="editor.messages.quiz_no_answer")}return!0}())&&d.selected_quiz.answers.length?(d.submitted=!1,d.hide_alerts=!0,d.quiz_deletable=!1,d.selected_quiz.updateAnswers().then(function(){t&&t.exit||d.selected_quiz.getQuizAnswers()}),t&&t.exit&&d.exitQuizBtn(),!1):(d.selected_quiz.isTextVideoQuiz()&&(d.alert.msg=d.answer_form.$error.atleastone?"editor.messages.quiz_no_answer":"editor.messages.provide_answer"),d.submitted=!0,d.hide_alerts=!1,d.lecture_player.controls.seek_and_pause(d.selected_quiz.time),d.selected_quiz.hide_quiz_answers=!1,v(d.selected_quiz),!0));var t})},d.exitQuizBtn=function(){d.quiz_deletable&&d.selected_quiz.deleteQuiz(),y(),d.last_details_state||s.close()},d.deleteQuizButton=function(e){d.selected_quiz==e&&y(),e.deleteQuiz().then(function(){f(e)})},d.createVideoLink=function(){var e=Math.floor(d.lecture_player.controls.getTime());return{url:a.href("course.module.courseware.lecture",{module_id:d.lecture.group_id,lecture_id:d.lecture.id,time:e},{absolute:!0}),time:e}},d.openQuizList=function(e){s.open(),angular.element(e.target).blur();var t={};d.lecture.addToTimeline(0,"quiz",t),r(function(){d.lecture.removeFromTimeline(t,"quiz")})},d.addOnlineMarker=function(t){var n=d.lecture_player.controls.getTime();angular.element("#ontop");m.addMarker(n,.1,.5,0,.9).then(function(e){h(e,"marker"),t&&(d.lecture_player.controls.seek_and_pause(n),s.open(),(!d.editing_mode||d.editing_mode&&"quiz"!=d.editing_type)&&d.showOnlineMarker(e))})},d.showOnlineMarker=function(e){d.selected_marker=m.getSelectedMarker(),d.selected_marker!=e&&w().then(function(){d.editing_mode=!1,r(function(){d.editing_mode=!0}),d.selected_marker=m.createInstance(e).setAsSelected(),d.editing_type="marker",d.lecture_player.controls.seek_and_pause(e.time)})},d.showAnnotation=function(e){d.selected_marker=e,d.lecture_player.controls.cue(d.lecture.start_time+(e.time-.1+e.duration),function(){d.dismissMarkerAnnotation()})},d.dismissMarkerAnnotation=function(){d.selected_marker=null},d.deleteMarkerButton=function(e){d.selected_marker==e&&k(),e.deleteMarker().then(function(){f(e)})},d.saveMarkerBtn=function(t,e){return t.validate().then(function(){var e=d.lecture.timeline.getItemsBetweenTimeByType(t.time,t.time,"marker");return 0<e.length&&e[0].data.id!=t.id?(d.alert.msg="error_message.another_marker",!(d.hide_alerts=!1)):(f(t),h(t,"marker"),t.update(),k(),!1)}).catch(function(e){return angular.extend(d.marker_errors,e),!0})},d.togglePreviewInclass=function(){d.filtered_timeline_items?q():function(){d.filtered_timeline_items=angular.copy(d.lecture.timeline.getItemsBetweenTime(d.selected_quiz.start_time,d.selected_quiz.end_time));for(var e=0;e<d.filtered_timeline_items.length;e++){var t=d.filtered_timeline_items[e];if(t.data.background="lightgrey",t.data.color="black","quiz"!=t.type);else{t.data.inclass_title=o.instant("inclass.self_stage"),t.data.background="#008CBA",t.data.color="white";var n={time:t.data.start_time,type:"marker",data:{time:t.data.start_time}};d.filtered_timeline_items.splice(0,0,n),e++;var a=angular.copy(t);a.data.inclass_title=o.instant("inclass.group_stage"),a.data.background="#43AC6A",d.filtered_timeline_items.splice(++e,0,a);var i=angular.copy(t);if(i.data.inclass_title=o.instant("inclass.discussion_stage"),i.data.background="darkorange",i.data.color="white",d.filtered_timeline_items.splice(++e,0,i),t.data.time<t.data.end_time){var r={time:t.data.end_time,type:"marker",data:{time:t.data.end_time}};d.filtered_timeline_items.splice(d.filtered_timeline_items.length,0,r)}}}d.filtered_timeline_items[0].data.inclass_title=o.instant("inclass.intro_stage"),d.filtered_timeline_items[0].data.background="lightgrey",d.filtered_timeline_items[0].data.color="black",d.goToInclassItem(d.filtered_timeline_items[0])}()},d.goToInclassItem=function(e){d.selected_inclass_item=e,d.lecture_player.controls.seek_and_pause(d.selected_inclass_item.data.time),d.selected_quiz.hide_quiz_answers="quiz"!=d.selected_inclass_item.type,"quiz"==d.selected_inclass_item.type?(d.selected_quiz.hide_quiz_answers=!1,v(d.selected_quiz)):(d.selected_quiz.hide_quiz_answers=!0,b())},d.inclassNextItem=function(){var e=d.filtered_timeline_items.indexOf(d.selected_inclass_item)+1;e<d.filtered_timeline_items.length&&d.goToInclassItem(d.filtered_timeline_items[e])},d.inclassPrevItem=function(){var e=d.filtered_timeline_items.indexOf(d.selected_inclass_item)-1;0<=e&&d.goToInclassItem(d.filtered_timeline_items[e])};var x=i.$on("$stateChangeStart",function(e,t,n,a,i,r){e.preventDefault(),w().then(function(){$(t,n,{})},function(){l.openConfirm({template:'<div class="ngdialog-message">                  <h2><b><span translate>lectures.messages.change_lost</span></b></h2>                  <span translate>lectures.messages.navigate_away</span>                  </div>                  <div class="ngdialog-buttons">                      <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>global.leave</button>                      <button type="button" class="ngdialog-button ngdialog-button-primary"  ng-click="confirm(1)"translate>global.stay</button>                  </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1}).catch(function(e){d.selected_marker?k():d.selected_quiz&&d.exitQuizBtn(),$(t,n,{})})})});d.$on("$destroy",function(){shortcut.remove("i"),shortcut.remove("n"),shortcut.remove("Shift+n")})}]),angular.module("scalearAngularApp").controller("quizDetailsCtrl",["$stateParams","$scope","$log","$state","ItemsModel","QuizModel","CourseEditor","QuestionModel",function(e,i,t,n,a,r,o,s){i.quiz=a.getQuiz(e.quiz_id),a.setSelectedItem(i.quiz);var l=i.quiz.module();i.due_date_enabled=!o.isDueDateDisabled(i.quiz.due_date),i.disable_module_due_controls=o.isDueDateDisabled(l.due_date),i.link_url=n.href("course.module.courseware.quiz",{module_id:i.quiz.group_id,quiz_id:i.quiz.id},{absolute:!0}),i.updateQuiz=function(){i.quiz.update()},i.updateDueDate=function(){var e=i.due_date_enabled,t=new Date(i.quiz.due_date);if(o.isDueDateDisabled(i.quiz.due_date)&&e)var n=-200;else if(o.isDueDateDisabled(i.quiz.due_date)||e)n=0;else var n=200;t.setFullYear(t.getFullYear()+n);var a=new Date(l.due_date);e&&a<t&&t.setDate(a.getDate()),i.quiz.due_date=t,i.due_date_enabled=!o.isDueDateDisabled(i.quiz.due_date),i.quiz.due_date_module=!i.disable_module_due_controls&&i.due_date_enabled},i.visible=function(e){return new Date(e)<=new Date},i.$on("questions_count:updated",function(e,t){i.quiz.questions_count=t}),i.validateQuiz=function(e,t){if("correct_question_count"==e&&t>i.quiz.questions_count)return"Must be less than or equal to number of questions";if("retries"==e&&t<1)return"Must be more than 1";var n={id:i.quiz.id,course_id:i.quiz.course_id,group_id:i.quiz.group_id};return n[e]=t,r.createInstance(n).validate()}}]),angular.module("scalearAngularApp").controller("quizMiddleCtrl",["$stateParams","$scope","Quiz","CourseEditor","$translate","$log","$rootScope","ErrorHandler","$timeout","$state","$q","ItemsModel","QuizModel","QuestionModel","CourseModel","ModuleModel",function(e,a,t,n,i,r,o,s,l,u,d,c,_,m,p,g){a.currentDate=null,a.saved=!1,a.quiz=c.getQuiz(e.quiz_id),c.setSelectedItem(a.quiz),a.course=p.getSelectedCourse(),a.module=g.getSelectedModule(),a.publish_state_visible=a.quiz.isVisible(),a.module_visible=a.module.isVisible();var h=null;function f(e){a.saveQuestions();var t=new Date(a.module.appearance_time);e||t.setFullYear(t.getFullYear()+200),a.quiz.appearance_time=t,a.quiz.appearance_time_module=!1,a.publish_state_visible=a.quiz.isVisible(),a.quiz.update()}a.alert={type:"alert",msg:"error_message.got_some_errors"},a.quizSortableOptions={axis:"y",dropOnEmpty:!1,handle:".handle",cursor:"crosshair",items:".quiz_sort",opacity:.4,scroll:!0},angular.extend(a,m),shortcut.add("Shift+Enter",function(){}),a.getEditableQuestions().then(function(e){a.questions=e}),a.$on("$destroy",function(){shortcut.remove("Enter")}),a.closeAlerts=function(){a.hide_alerts=!0},a.removeAndSaveQuestions=function(){a.removeQuestion(),setTimeout(function(){a.saveQuestions()},500)},a.removeAndSaveAnswer=function(e,t){a.removeAnswer(e,t),a.saveQuestions()},a.saving=!1,a.saveQuestions=function(){setTimeout(function(){h&&clearTimeout(h),h=setTimeout(function(){a.tform.$valid?(a.submitted=!1,a.hide_alerts=!0,a.saving=!0,a.saved=!1,m.updateQuestions().then(function(){a.currentDate=(new Date).toLocaleString([],{hour12:!0}),a.saved=!0,a.saving=!1})):(a.submitted=!0,a.hide_alerts=!1)},500)},500)},a.publish=function(){f(!0)},a.unpublish=function(){f(!1)},a.validateQuiz=function(e,t){var n={id:a.quiz.id,course_id:a.quiz.course_id,group_id:a.quiz.group_id};return n[e]=t,_.createInstance(n).validate()}}]),angular.module("scalearAngularApp").controller("customLinkDetailsCtrl",["$stateParams","$scope","$q","$filter","CustomLink","$log","ItemsModel","LinkModel",function(e,a,t,n,i,r,o,s){a.link=o.getLink(e.customlink_id),o.setSelectedItem(a.link),a.validateLink=function(e,t){var n={id:a.link.id};return n[e]=t,s.createInstance(n).validate()},a.updateLink=function(){a.link.update().then(function(){a.link.errors=""}).catch(function(e){a.link.errors=e.data.errors})}}]),angular.module("scalearAngularApp").controller("customLinkMiddleCtrl",["$stateParams","$scope","ItemsModel",function(e,t,n){t.link=n.getLink(e.customlink_id),n.setSelectedItem(t.link)}]),angular.module("scalearAngularApp").controller("sharingModalCtrl",["$scope","$rootScope","$timeout","$window","$log","Module","$stateParams","Course","SharedItem","$modalInstance","$translate","selected_module","selected_item",function(n,e,t,a,i,r,o,s,l,u,d,c,_){n.shareItem=function(e){var t={modules:[],lectures:[],quizzes:[],customlinks:[]};n.selected_module.selected?t.modules.push(n.selected_module.id):n.selected_module.items.forEach(function(e){e.selected&&("lecture"==e.class_name?t.lectures.push(e.id):"quiz"==e.class_name?t.quizzes.push(e.id):"customlink"==e.class_name&&t.customlinks.push(e.id))}),t.modules.length||t.lectures.length||t.quizzes.length||t.customlinks.length?n.selected_teacher.email?l.create({},{shared_item:{data:t},shared_with:n.selected_teacher.email},function(){u.close()},function(e){n.errors=e.data.errors,i.debug(n.errors)}):n.errors=d.instant("sharing.please_enter_email"):n.errors=d.instant("sharing.nothing_selected")},n.selectAll=function(t,e){t.selected=!t.selected,t.items.forEach(function(e){e.selected=t.selected}),e&&e.stopPropagation()},n.deSelectAll=function(t){t.selected=!1,t.items.forEach(function(e){e.selected=t.selected})},n.selectItem=function(e,t,n){n?n.stopPropagation():t.selected=!t.selected;var a=0;e.items.forEach(function(e){e.selected&&(a+=1)}),e.selected=a==e.items.length},n.selected_module=c,n.selected_item=_,n.selected_teacher={},n.deSelectAll(n.selected_module),n.selected_item?n.selectItem(n.selected_module,n.selected_item,null):n.selectAll(n.selected_module)}]),angular.module("scalearAngularApp").controller("progressCtrl",["$scope","$stateParams","ContentNavigator","Page","Course","Module","$timeout","$log","CourseModel","ErrorHandler","$translate",function(n,a,e,t,i,r,o,s,l,u,d){t.setTitle("navigation.progress"),e.close(),n.course=l.getSelectedCourse();var c=function(e,t){n.module_limit=t,n.module_offset=e,n.loading_modules=!0,i.getModuleProgress({course_id:a.course_id,offset:n.module_offset,limit:n.module_limit},function(e){s.debug("getModuleProgress response",e);var t={};t.module_names=e.module_names,t.total=e.total,t.module_students=n.module_students||[],t.module_status=n.module_status||{},t.late_modules=n.late_modules||{},t.module_students=t.module_students.concat(JSON.parse(e.students)),angular.extend(t.module_status,e.module_status),angular.extend(t.late_modules,e.late_modules),s.debug(t),angular.extend(n,t),o(function(){n.getRemainingModuleProgress()})})};n.getRemainingModuleProgress=function(){n.module_offset+n.module_limit<=parseInt(n.total)?c(n.module_offset+n.module_limit,n.module_limit):n.loading_modules=!1},n.updateStatus=function(e,t,n){n=n?"Finished on Time"==n?1:2:0,r.changeModuleStatus({course_id:a.course_id,module_id:t},{user_id:e,status:n})},n.export=function(){i.exportModuleProgress({course_id:a.course_id}).$promise.then(function(e){e.notice&&u.showMessage(d.instant("error_message.export_course"),"errorMessage",4e3,"success")})},c(0,20)}]),angular.module("scalearAngularApp").controller("progressOverviewCtrl",["$scope","$state","ContentNavigator","$translate","$log","Page","ErrorHandler","CourseModel",function(e,t,n,a,i,r,o,s){e.course=s.getSelectedCourse(),r.setTitle(a.instant("navigation.progress")+": "+e.course.name),n.open(),e.goTo=function(e){t.params.module_id?t.go(e):o.showMessage(a.instant("error_message.select_module_first"),"errorMessage",4e3,"error")}}]),angular.module("scalearAngularApp").controller("progressMainCtrl",["$scope","$timeout","$stateParams","Course","Module","$translate","$log","Page","ContentNavigator",function(n,a,i,r,o,s,l,e,t){e.setTitle("navigation.progress"),t.close(),n.moduleProgressTab=function(){d(),null==n.module_offset&&u(0,20)};var u=function(e,t){n.module_limit=t,n.module_offset=e,n.loading_modules=!0,c(),r.getModuleProgress({course_id:i.course_id,offset:n.module_offset,limit:n.module_limit},function(e){l.debug(e);var t={};t.module_names=e.module_names,t.total=e.total,t.module_students=n.module_students||[],t.module_status=n.module_status||{},t.late_modules=n.late_modules||{},t.module_students=t.module_students.concat(JSON.parse(e.students)),angular.extend(t.module_status,e.module_status),angular.extend(t.late_modules,e.late_modules),l.debug(t),angular.extend(n,t),a(function(){d(),n.loading_modules=!1,$(".student").tooltip({placement:"left",container:"body"})})})};n.getRemainingModuleProgress=function(){n.module_offset+n.module_limit<=parseInt(n.total)?u(n.module_offset+n.module_limit,n.module_limit):c()};var d=function(){n.module_scroll_disable=!1},c=function(){n.module_scroll_disable=!0};n.updateStatus=function(e,t,n){n=n?"Finished on Time"==n?1:2:0,o.changeModuleStatus({course_id:i.course_id,module_id:t},{user_id:e,status:n})},n.totalChartTab=function(){c(),n.total_chart||(n.loading_total_charts=!0,_())};var _=function(){r.getTotalChart({course_id:i.course_id},function(e){n.student_progress=e.student_progress,n.total_chart=m(n.student_progress),n.loading_total_charts=!1},function(){})};n.getTotalChartHeight=function(e){return 30*e.length+50},n.formatTotalChartData=function(e){var t={};for(var n in t.cols=[{label:s.instant("global.students"),type:"string"},{label:s.instant("progress.quiz"),type:"number"},{label:s.instant("progress.lecture"),type:"number"}],t.rows=[],e){var a={c:[{v:e[n][0]},{v:e[n][1],f:e[n][1].toFixed(0)+"%"},{v:e[n][2],f:e[n][2].toFixed(0)+"%"}]};t.rows.push(a)}return t};var m=function(e){var t={type:"BarChart"};return t.options={colors:["#195a92","#759c45"],title:"Student Progress",isStacked:"false",fill:20,height:n.getTotalChartHeight(e),displayExactValues:!0,fontSize:12,hAxis:{maxValue:100,minValue:0},chartArea:{top:10}},t.data=n.formatTotalChartData(e),t};n.moduleProgressTab()}]),angular.module("scalearAngularApp").controller("progressGraphCtrl",["$scope","$stateParams","ContentNavigator","Page","Course","$translate",function(n,e,t,a,i,r){a.setTitle("navigation.progress"),t.close();n.getTotalChartHeight=function(e){return 30*e.length+50},n.formatTotalChartData=function(e){var t={};for(var n in t.cols=[{label:r.instant("global.students"),type:"string"},{label:r.instant("progress.quiz"),type:"number"},{label:r.instant("progress.lecture"),type:"number"}],t.rows=[],e){var a={c:[{v:e[n][0]},{v:e[n][1],f:e[n][1].toFixed(0)+"%"},{v:e[n][2],f:e[n][2].toFixed(0)+"%"}]};t.rows.push(a)}return t};var o=function(e){var t={type:"BarChart"};return t.options={colors:["#195a92","#759c45"],title:"Student Progress",isStacked:"false",fill:20,height:n.getTotalChartHeight(e),displayExactValues:!0,fontSize:12,hAxis:{maxValue:100,minValue:0},chartArea:{top:10}},t.data=n.formatTotalChartData(e),t};n.loading_total_charts=!0,i.getTotalChart({course_id:e.course_id},function(e){n.student_progress=e.student_progress,n.total_chart=o(n.student_progress),n.loading_total_charts=!1})}]),angular.module("scalearAngularApp").controller("progressLectureCtrl",["$scope","$stateParams","Timeline","Module","Quiz","OnlineQuiz","$log","$window","$translate","$timeout","Forum","Page","ContentNavigator","Lecture","ScalearUtils","ModuleModel",function(s,o,l,a,u,i,n,e,w,r,d,t,c,_,k,m){t.setTitle("navigation.progress"),c.close(),s.Math=window.Math,s.highlight_index=-1,s.inner_highlight_index=0,s.progress_player={},s.timeline={},s.highlight_level=0,s.time_parameters={quiz:3,question:2},s.selected_module=m.getSelectedModule(),s.module_id=o.module_id,s.course_id=o.course_id,s.module_summary={},s.module_summary[s.module_id]={},s.module_summary[s.module_id].type="teacher",s.module_summary[s.module_id].review_page_trigger=!0,s.module_summary[s.module_id].loading={summary:!0,online_quiz:!0,discussion:!0},s.$on("$destroy",function(){S()}),s.$on("progress_item_filter_update",function(e,t){s.check_sub_items=t}),s.$on("progress_filter_update",function(e,t){s.check_items=t}),s.$on("print",function(){s.print()}),s.$on("scroll_to_item",function(e,t){if("customlink"!=t.class_name){var n="quiz"==t.class_name?t.quiz_type:t.class_name;v("#"+n+"_"+t.id,130),z();var a=angular.element("#"+n+"_"+t.id).find(".ul_item")[0];s.highlight_index=angular.element(".ul_item").index(a)-1}}),s.$on("scroll_to_item_summary",function(e,t){null!=t&&b(t)}),s.check_sub_items={lecture_quizzes:!0,confused:!0,charts:!0,discussion:!0,free_question:!0},s.check_items={quiz:!0,survey:!0},s.grade_options=[{value:0,text:w.instant("quizzes.grade.under_review")},{value:1,text:w.instant("quizzes.grade.incorrect")},{value:2,text:w.instant("quizzes.grade.partial")},{value:3,text:w.instant("quizzes.grade.correct")}];var p=function(){a.getModuleProgress({course_id:o.course_id,module_id:o.module_id},function(e){for(var t in angular.extend(s,e),s.module=m.getSelectedModule(),s.progress_player.controls.isYoutube(s.first_lecture.url)?(s.video_start=s.first_lecture.start_time,s.video_end=s.first_lecture.end_time,s.url=s.first_lecture.url+"&controls=1&fs=1&theme=light"):s.url=s.first_lecture.url,s.url_lecture_id=s.first_lecture.id,s.timeline.lecture={},s.inclass_quizzes_time=0,s.lectures)for(var n in s.timeline.lecture[t]=new l,s.lectures[t])if("meta"!=n)for(var a in s.lectures[t][n]){if("discussion"==n)for(var i in s.lectures[t][n][a][0]=s.lectures[t][n][a][1][0].time,s.lectures[t][n][a][1])for(var r in s.lectures[t][n][a][1][i].hide=!s.lectures[t][n][a][1][i].hide,s.lectures[t][n][a][1][i].comments)s.lectures[t][n][a][1][i].comments[r].hide=!s.lectures[t][n][a][1][i].comments[r].hide;else"charts"==n&&(s.lectures[t][n][a][1].hide=!s.lectures[t][n][a][1].hide,s.lectures[t][n][a][1].inclass&&s.lectures[t][n][a][1].hide&&(s.inclass_quizzes_time+=(s.lectures[t][n][a][1].timers.intro+s.lectures[t][n][a][1].timers.self+s.lectures[t][n][a][1].timers.in_group+s.lectures[t][n][a][1].timers.discussion)/60));s.timeline.lecture[t].add(s.lectures[t][n][a][0],n,s.lectures[t][n][a][1])}null!=o.item_id&&b(o.item_id)},function(){})},g=function(){a.getModuleSummary({module_id:s.module_id,course_id:s.course_id},function(e){s.timeline.module=new l,s.module_summary[s.module_id].loading.summary=!1,angular.extend(s.module_summary[s.module_id],e.module)}),a.getOnlineQuizSummary({module_id:s.module_id,course_id:s.course_id},function(e){s.module_summary[s.module_id].loading.online_quiz=!1,angular.extend(s.module_summary[s.module_id],e.module)})},h=function(){a.getQuizCharts({course_id:o.course_id,module_id:o.module_id},function(e){var t=e.quizzes;for(var n in s.review_quiz_count=e.review_quiz_count,s.review_quiz_reply_count={},s.timeline.quiz={},t)for(var a in s.timeline.quiz[n]=new l,s.review_quiz_reply_count[n]={},t[n].questions){var i=t[n].questions[a].id;s.review_quiz_reply_count[n][i]=0;var r=t[n].charts[i]||t[n].free_question[i];r.type=t[n].questions[a].type,r.id=i,r.quiz_type="quiz",r.show=t[n].questions[a].show,r.title=t[n].questions[a].question;var o="Free Text Question"==t[n].questions[a].type?"free_question":"charts";"free_question"==o&&r.answers.forEach(function(e){e.hide||s.review_quiz_reply_count[n][i]++,e.hide=!e.hide}),r.show&&(s.review_quiz_count+=s.review_quiz_reply_count[n][i]),s.timeline.quiz[n].add(0,o,r,"quiz")}s.quizzes=angular.extend({},t,s.quizzes)},function(){})},f=function(){a.getSurveyCharts({course_id:o.course_id,module_id:o.module_id},function(e){var t=e.surveys;for(var n in s.review_survey_count=e.review_survey_count,s.review_survey_reply_count={},s.timeline.survey={},t)for(var a in s.timeline.survey[n]=new l,s.review_survey_reply_count[n]={},t[n].questions){var i=t[n].questions[a].id;s.review_survey_reply_count[n][i]=0;var r=t[n].charts[i]||t[n].free_question[i];r.type=t[n].questions[a].type,r.id=i,r.quiz_type="survey";var o="Free Text Question"==t[n].questions[a].type?"free_question":"charts";"free_question"==o&&r.answers.forEach(function(e){e.hide||s.review_survey_reply_count[n][i]++,e.hide=!e.hide}),r.show&&(s.review_survey_count+=s.review_survey_reply_count[n][i]),s.timeline.survey[n].add(0,o,r)}s.quizzes=angular.extend({},t,s.quizzes)},function(){})},v=function(e,t){var n=t||$("html").innerHeight()/2-10;$(".main_content").parent().scrollToThis(angular.element(e),{offsetTop:n})},b=function(e){if(-1!=e.indexOf("disc")){var t=e.split("a"),n=t[0],a=parseInt(n.split("_")[1]),i=parseInt(t[1]);r(function(){s.timeline.lecture[i].items.forEach(function(t){"discussion"==t.type&&t.data.forEach(function(e){e.id==a&&(e.show_feedback=!0,(s.selected_item=t).lec_id=e.lecture_id,e.show_feedback=!0,q())})}),v("#"+n,140)})}else r(function(){v("#"+e,130)})};s.manageHighlight=function(e){var t=angular.element(".ul_item");angular.element(t[s.highlight_index]).removeClass("highlight"),angular.element("li.highlight").removeClass("highlight"),s.highlight_index=s.highlight_index+e,s.highlight_index<0?s.highlight_index=0:s.highlight_index>t.length-1&&(s.highlight_index=t.length-1);var n=angular.element(t[s.highlight_index]);n.addClass("highlight").addClass("full-opacity"),s.highlight_level=1,angular.element(".ul_item").not(".highlight").removeClass("full-opacity");var a=n.closest("div");if(a.attr("id")){var i=a.attr("id").split("_");s.selected_item=s.timeline[i[0]][i[1]].items[n.attr("index")],s.selected_item.lec_id=i[1]}else s.selected_item=null;v(t[s.highlight_index]),s.inner_highlight_index=0,y(),q()},s.manageInnerHighlight=function(e){var t=angular.element("ul.highlight").find("ul");if(t.length){var n=t.find("li").not(".no_highlight");if(angular.element("li.highlight").length&&angular.element("li.highlight").removeClass("highlight"),s.inner_highlight_index=s.inner_highlight_index+e,s.inner_highlight_index<0)s.inner_highlight_index=0;else if(s.inner_highlight_index>n.length-1)return void s.manageHighlight(1);angular.element(n[s.inner_highlight_index]).addClass("highlight"),s.highlight_level=2}v(n[s.inner_highlight_index]),q()},s.highlight=function(e,t){var n=angular.element(e.target).closest("ul.ul_item"),a=angular.element(".ul_item");$(".highlight").removeClass("highlight"),s.highlight_index=a.index(n),angular.element(n).addClass("highlight").addClass("full-opacity"),angular.element(".ul_item").not(".highlight").removeClass("full-opacity"),s.highlight_level=1,y(),s.selected_item=t;var i=n.closest("div");if(i.attr("id")){var r=i.attr("id").split("_");s.selected_item.lec_id=r[1]}s.inner_highlight_index=0;var o=angular.element(e.target).closest("li.li_item");o.length&&(angular.element("li.highlight").length&&angular.element("li.highlight").removeClass("highlight"),s.inner_highlight_index=n.find("li.li_item").index(o[0]),angular.element(o[0]).addClass("highlight"),s.highlight_level=2),q()};var y=function(){$(document).click(function(e){angular.element(e.target).find(".inner_content").length&&(z(),$(document).off("click"))})},z=function(){C(),$(".highlight").removeClass("highlight"),angular.element(".ul_item").addClass("full-opacity"),s.highlight_level=0};s.resetHighlightVariables=function(){z(),s.highlight_index=-1,s.inner_highlight_index=0},s.updateHideQuiz=function(e,t){var n=t?-1:1;e.data.inclass?(s.inclass_quizzes_time+=n*(e.data.timers.intro+e.data.timers.self+e.data.timers.in_group+e.data.timers.discussion)/60,s.inclass_quizzes_count+=n):s.review_video_quiz_count+=n,a.hideQuiz({course_id:o.course_id,module_id:o.module_id},{quiz:e.data.id,hide:t})},s.updateHideDiscussion=function(e,t){t?s.review_question_count--:s.review_question_count++,d.hideDiscussion({},{post_id:e,hide:t},function(){},function(){})},s.updateHideComment=function(e,t){d.hideComment({},{post_id:t.id,comment_id:e.id,hide:e.hide},function(){e.hide&&!t.hide&&(t.hide=!0,s.updateHideDiscussion(t.id,!t.hide))},function(){})},s.updateHideResponse=function(e,t,n,a){"survey"==a?n.hide?(s.review_survey_reply_count[e][t.data.id]--,t.data.show&&s.review_survey_count--):(s.review_survey_reply_count[e][t.data.id]++,t.data.show&&s.review_survey_count++):n.hide?(s.review_quiz_reply_count[e][t.data.id]--,t.data.show&&s.review_quiz_count--):(s.review_quiz_reply_count[e][t.data.id]++,t.data.show&&s.review_quiz_count++),u.hideResponses({course_id:o.course_id,quiz_id:e},{hide:{id:n.id,hide:n.hide}},function(){n.hide&&!t.data.show&&(t.data.show=!0,s.updateHideQuizQuestion(e,t.data.id,t.data.show,t.type,a))})},s.updateHideResponseOnlineQuiz=function(e,t,n){i.hideResponses({course_id:o.course_id,online_quizzes_id:e},{hide:{id:t,hide:n}})},s.updateHideQuizQuestion=function(e,t,n,a,i){var r="charts"==a?1:s["review_"+i+"_reply_count"][e][t]+1;n?s["review_"+i+"_count"]+=r:s["review_"+i+"_count"]-=r,u.showInclass({course_id:o.course_id,quiz_id:e},{question:t,show:n})},s.updateHideConfused=function(e,t,n,a){_.confusedShowInclass({course_id:o.course_id,lecture_id:e},{time:t,hide:n,very:a})},s.makeSurveyVisible=function(e,t){e.meta.visible=t,u.makeVisible({course_id:e.meta.course_id,quiz_id:e.meta.id},{visible:t})},s.sendComment=function(t){if(t.temp_response&&t.temp_response.length&&""!=t.temp_response.trim()){var e=t.temp_response;t.temp_response=null,d.createComment({comment:{content:e,post_id:t.id,lecture_id:t.lecture_id}},function(e){e.comment.hide=!1,t.comments.push(e.comment),angular.element("ul.highlight .feedback textarea").blur()},function(){})}},s.sendFeedback=function(e){if(e.temp_response&&e.temp_response.length&&""!=e.temp_response.trim()){var t=e.temp_response;e.temp_response=null,u.sendFeedback({quiz_id:e.quiz_id,course_id:o.course_id},{groups:[e.id],response:t},function(){e.response=angular.copy(t),angular.element("ul.highlight .feedback textarea").blur()},function(){})}},s.deleteFeedback=function(e){u.deleteFeedback({quiz_id:e.quiz_id,course_id:o.course_id},{answer:e.id},function(){e.response=null})},s.deletePost=function(e,t){var n=e[t];d.deletePost({post_id:n.post.id},function(){e.splice(t,1)},function(){})},s.deleteComment=function(e,t){d.deleteComment({comment_id:e.id,post_id:t.id},function(){t.comments.splice(t.comments.indexOf(e),1)},function(){})},s.removeFlag=function(e){d.removeAllFlags({post_id:e.id},function(){e.flags_count=0},function(){})},s.removeCommentFlag=function(e,t){d.removeAllCommentFlags({comment_id:e.id,post_id:t.id},function(){t.comments[t.comments.indexOf(e)].flags_count=0},function(){})},s.updateGrade=function(e){u.updateGrade({course_id:o.course_id,quiz_id:e.quiz_id},{answer_id:e.id,grade:e.grade})},s.updateOnlineQuizGrade=function(e){i.updateGrade({course_id:o.course_id,online_quizzes_id:e.online_quiz_id},{answer_id:e.id,grade:e.grade})},s.seek=function(e,t){-1==s.url.indexOf(t.url)?((s.progress_player.controls.isYoutube(t.url)||s.progress_player.controls.isKaltura(t.url))&&(s.video_start=t.start_time,s.video_end=t.end_time,s.progress_player.controls.setStartTime(t.start_time),s.url_lecture_id=t.id,s.progress_player.controls.isYoutube(t.url)?(s.url=t.url+"&controls=1&fs=1&theme=light",r(function(){s.progress_player.controls.seek_and_pause(e)},250)):s.progress_player.controls.isKaltura(t.url)&&(s.url=t.url,r(function(){s.progress_player.controls.seek_and_pause(e)},1500))),s.progress_player.controls.isMP4(t.url)&&(s.url=t.url,s.url_lecture_id=t.id,r(function(){s.progress_player.controls.seek_and_pause(e)}))):s.selected_item.lec_id!=s.url_lecture_id?(s.video_start=t.start_time,s.video_end=t.end_time,s.progress_player.controls.setStartTime(t.start_time),r(function(){s.progress_player.controls.seek_and_pause(e)},250),s.url_lecture_id=t.id):r(function(){s.progress_player.controls.seek_and_pause(e)})},s.formatModuleChartData=function(e){var t={};t.cols=[{label:w.instant("global.students"),type:"string"},{label:w.instant("global.students"),type:"number"}],t.rows=[];var n=[w.instant("progress.chart.not_started_watching"),w.instant("progress.chart.watched")+" <= 50%",w.instant("progress.chart.watched")+" > 50%",w.instant("progress.chart.completed_on_time"),w.instant("progress.chart.completed_late")];for(var a in e){var i={c:[{v:n[a]},{v:e[a]}]};t.rows.push(i)}return t},s.formatLectureChartData=function(e,t){var n={};for(var a in n.cols=[{label:w.instant("global.students"),type:"string"},{label:w.instant("editor.correct")+" ("+w.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:w.instant("editor.correct")+" ("+w.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:w.instant("editor.incorrect")+" ("+w.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:w.instant("editor.incorrect")+" ("+w.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:"",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:w.instant("dashboard.solved"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],n.rows=[],e){var i=0,r=0,o=0,s=0,l=0,u=0,d=k.getHtmlText(e[a][2]),c=k.getShortAnswerText(d,Object.keys(e).length),_=e[a][2],m="",p="",g="",h="",f="",v="";"orange"==e[a][1]?("Survey"!=t&&(c+=" ("+w.instant("editor.incorrect")+")"),o=e[a][0],s=e[a][3],g="<div style='color:black;padding:8px'>"+_+"<br>"+w.instant("editor.incorrect")+" ("+w.instant("dashboard.first_try")+")  : "+e[a][0]+"</div>",h="<div style='color:black;padding:8px'>"+_+"<br>"+w.instant("editor.incorrect")+" ("+w.instant("dashboard.final_try")+")  : "+e[a][3]+"</div>"):"gray"==e[a][1]?(l=e[a][0],f="<div style='color:black;padding:8px'>"+w.instant("dashboard.never_tried")+"  : "+e[a][0]+"</div>"):"blue"==e[a][1]?(u=e[a][0],v="<div style='color:black;padding:8px'>"+_+"<br>"+w.instant("dashboard.solved")+" : "+e[a][0]+"</div>"):("Survey"!=t&&(c+=" ("+w.instant("editor.correct")+")"),i=e[a][0],r=e[a][3],m="<div style='color:black;padding:8px'>"+_+"<br>"+w.instant("editor.correct")+" ("+w.instant("dashboard.first_try")+")  : "+e[a][0]+"</div>",p="<div style='color:black;padding:8px'>"+_+"<br>"+w.instant("editor.correct")+" ("+w.instant("dashboard.final_try")+")  : "+e[a][3]+"</div>");var b={c:[{v:c},{v:i},{v:m},{v:r},{v:p},{v:o},{v:g},{v:s},{v:h},{v:l},{v:f},{v:u},{v:v}]};n.rows.push(b)}return n},s.formatQuizChartData=function(e){var t={};for(var n in t.cols=[{label:w.instant("global.students"),type:"string"},{label:w.instant("editor.correct"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:w.instant("editor.incorrect"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],t.rows=[],e){var a,i,r,o,s;a=k.getHtmlText(e[n][2]);var l=k.getShortAnswerText(a,Object.keys(e).length),u=e[n][2];e[n][1]?(l+=" ("+w.instant("editor.correct")+")",i=e[n][0],r=0,o="<div style='color:black;padding:8px'>"+u+"<br>"+w.instant("editor.correct")+" : "+e[n][0]+"</div>"):(l+=" ("+w.instant("editor.incorrect")+")",i=0,r=e[n][0],s="<div style='color:black;padding:8px'>"+u+"<br>"+w.instant("editor.incorrect")+" : "+e[n][0]+"</div>");var d={c:[{v:l},{v:i},{v:o},{v:r},{v:s}]};t.rows.push(d)}return t},s.formatSurveyChartData=function(e){var t,n,a,i={};for(var r in i.cols=[{label:w.instant("global.students"),type:"string"},{label:w.instant("progress.chart.answered"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],i.rows=[],e){t=k.getHtmlText(e[r][1]),n=k.getShortAnswerText(t,Object.keys(e).length),a="<div style='color:black;padding:8px'>"+(a=e[r][1])+" : "+e[r][0]+"</div>";var o={c:[{v:n},{v:e[r][0]},{v:a}]};i.rows.push(o)}return i};var q=function(){if(s.selected_item&&0<=s.selected_item.time&&s.lectures[s.selected_item.lec_id]){var e=s.selected_item.time;if("discussion"==s.selected_item.type){var t=s.inner_highlight_index;e=s.selected_item.data[t].time,n.debug(e)}s.seek(e,s.lectures[s.selected_item.lec_id].meta)}};s.createChart=function(e,t,n,a,i,r){var o={};return r?o=s.createChartSelfGroup(e,t,{},"formatSelfGroupChartData",i):(o.type="ColumnChart",o.options={colors:["#16A53F","#1bca4d","#ED9467","#E66726","#a4a9ad","#355BB7"],isStacked:"true",fill:20,height:135,displayExactValues:!0,fontSize:10,legend:{position:"none"},chartArea:{left:30,width:"95%"},vAxis:{gridlines:{count:7},viewWindow:{max:t},textPosition:"none"},tooltip:{isHtml:!0}},"formatQuizChartData"!=a&&"formatSurveyChartData"!=a||(o.options.colors=["#16A53F","#E66726"]),angular.extend(o.options,n),o.data=s[a](e,i)),o},s.createChartSelfGroup=function(e,t,n,a,i){var r={type:"ColumnChart",options:{colors:["#16A53F","#1bca4d","#ED9467","#E66726","#a4a9ad","#355BB7","#16A53F","#1bca4d","#ED9467","#E66726","#a4a9ad","#355BB7"],isStacked:"true",fill:20,height:135,displayExactValues:!0,legend:{position:"none"},fontSize:10,chartArea:{left:30,width:"95%"},tooltip:{isHtml:!0},vAxis:{gridlines:{count:7},viewWindow:{max:t}}},data:s[a](e,i)};return angular.extend(r.options,n),r},s.formatSelfGroupChartData=function(e,t){var n={};for(var a in n.cols=[{label:w.instant("global.students"),type:"string"},{label:w.instant("editor.correct")+" ("+w.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:w.instant("editor.correct")+" ("+w.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:w.instant("editor.incorrect")+" ("+w.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:w.instant("editor.incorrect")+" ("+w.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:"",type:"number"},{type:"string",p:{role:"style"}},{label:w.instant("dashboard.solved"),type:"number"},{type:"string",p:{role:"style"}}],n.rows=[],e){var i=0,r=0,o=0,s=0,l=0,u=0,d=0,c=0,_=0,m=0,p=0,g=0,h=e[a][2],f="green"==e[a][1]?"stroke-color: black;stroke-width: 3;":"",v=h+" ("+w.instant("inclass.self_stage")+")",b=h+" ("+w.instant("inclass.group_stage")+")";"green"==e[a][1]?(i=e[a][0]||0,r=e[a][3]||0,d=e[a][4]||0,c=e[a][5]||0):"orange"==e[a][1]?("Survey"!=t&&(h+=" ("+w.instant("editor.incorrect")+")"),o=e[a][0]||0,s=e[a][3]||0,_=e[a][4]||0,m=e[a][5]||0):"gray"==e[a][1]?(l=e[a][0],p=e[a][3]):"blue"==e[a][1]&&(u=e[a][0],g=e[a][3]);var y={c:[{v:k.getHtmlText(v)},{v:i},{v:f},{v:r},{v:f},{v:o},{v:f},{v:s},{v:f},{v:l},{v:f},{v:u},{v:f}]};n.rows.push(y);y={c:[{v:k.getHtmlText(b)},{v:d},{v:f},{v:c},{v:f},{v:_},{v:f},{v:m},{v:f},{v:p},{v:f},{v:g},{v:f}]};n.rows.push(y)}return n};var x=function(){shortcut.add("r",function(){!s.selected_item||"free_question"!=s.selected_item.type&&"discussion"!=s.selected_item.type||0<=s.inner_highlight_index&&(s.selected_item.data.answers?s.selected_item.data.answers[s.inner_highlight_index].show_feedback=!s.selected_item.data.answers[s.inner_highlight_index].show_feedback:s.selected_item.data[s.inner_highlight_index].post.show_feedback=!s.selected_item.data[s.inner_highlight_index].post.show_feedback,s.$apply(),angular.element("textarea").focus())},{disable_in_input:!0,propagate:!1}),shortcut.add("Down",function(){s.highlight_level<=1?s.manageHighlight(1):s.manageInnerHighlight(1),s.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Up",function(){s.highlight_level<=1?s.manageHighlight(-1):s.manageInnerHighlight(-1),s.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Right",function(){0==s.highlight_level?s.manageHighlight(0):s.manageInnerHighlight(0),s.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Left",function(){s.highlight_level<=1?z():s.manageHighlight(0),s.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Space",function(){s.selected_item&&0<=s.selected_item.time&&!s.large_player?T():C(),s.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("m",function(){if(s.selected_item)if("discussion"==s.selected_item.type){var e=s.inner_highlight_index;s.selected_item.data[e].post.hide=!s.selected_item.data[e].post.hide,s.updateHideDiscussion(s.selected_item.data[e].post.id,!s.selected_item.data[e].post.hide)}else if("charts"==s.selected_item.type)null!=s.selected_item.data.hide?(s.selected_item.data.hide=!s.selected_item.data.hide,s.updateHideQuiz(s.selected_item,!s.selected_item.data.hide)):null!=s.selected_item.data.show&&(s.selected_item.data.show=!s.selected_item.data.show,s.updateHideQuizQuestion(s.selected_item.lec_id,s.selected_item.data.id,s.selected_item.data.show,s.selected_item.type,s.selected_item.data.quiz_type));else if("free_question"==s.selected_item.type)if("survey"==s.selected_item.data.quiz_type)if(1==s.highlight_level)s.selected_item.data.show=!s.selected_item.data.show,s.updateHideQuizQuestion(s.selected_item.data.answers[0].quiz_id,s.selected_item.data.id,s.selected_item.data.show,s.selected_item.type,s.selected_item.data.quiz_type);else{e=s.inner_highlight_index;s.updateHideResponse(s.selected_item.data.answers[e].quiz_id,s.selected_item,s.selected_item.data.answers[e]),s.selected_item.data.answers[e].hide=!s.selected_item.data.answers[e].hide}else if("Quiz"==s.selected_item.data.quiz_type)if(1==s.highlight_level)s.selected_item.data.show=!s.selected_item.data.show,s.updateHideQuiz(s.selected_item,!s.selected_item.data.show);else{e=s.inner_highlight_index;s.selected_item.data.answers[e].hide=!s.selected_item.data.answers[e].hide,s.updateHideResponseOnlineQuiz(s.selected_item.data.answers[e].online_quiz_id,s.selected_item.data.answers[e].id,!s.selected_item.data.answers[e].hide)}},{disable_in_input:!0,propagate:!1}),shortcut.add("ESC",function(){C(),"discussion"==s.selected_item.type?s.selected_item.data.forEach(function(e){e.post.show_feedback=!1,e.post.temp_response=null}):"free_question"==s.selected_item.type&&s.selected_item.data.answers.forEach(function(e){e.show_feedback=!1,e.temp_response=null}),angular.element("ul.highlight .feedback textarea").blur(),s.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("enter",function(){if("discussion"==s.selected_item.type){var e=s.inner_highlight_index;s.sendComment(s.selected_item.data[e].post),s.selected_item.data[e].post.show_feedback=!1}else if("free_question"==s.selected_item.type){e=s.inner_highlight_index;s.sendFeedback(s.selected_item.data.answers[e]),s.selected_item.data.answers[e].show_feedback=!1}s.$apply()},{disable_in_input:!1,propagate:!1})},S=function(){shortcut.remove("r"),shortcut.remove("Down"),shortcut.remove("Up"),shortcut.remove("Right"),shortcut.remove("Left"),shortcut.remove("Space"),shortcut.remove("m"),shortcut.remove("ESC"),shortcut.remove("enter")};s.print=function(){var e=document.getElementById("printarea"),t=window.open("","_blank");t.document.open(),t.document.write('<html><title>::Progress Report::</title><link rel="stylesheet" type="text/css" href="styles/externals/print/progress_print.css" /></head><body onload="window.print()"><center><b>'+s.module.name+"</b></center>"),t.document.write(e.innerHTML),t.document.write("</html>"),t.document.close()},s.filterSubItems=function(e){var t=!1;for(var n in s.check_sub_items)s.check_sub_items[n]&&(t=t||-1!=e.type.indexOf(n)&&null!=e.data);return""!=e.type&&t},s.filterItems=function(e){var t=!1;if("lecture"==e.class_name)return!0;for(var n in s.check_items)s.check_items[n]&&(t=t||e.quiz_type==n);return t},s.calculateReviewPercent=function(e,t){return Math.ceil(e/t*100)||0},s.getReviewColor=function(e){return e<10?"gray":20<e?"#f5c343":"black"};var T=function(){s.large_player=!0},C=function(){s.large_player=!1};s.getKeys=function(e){return Object.keys?Object.keys(e):function(e){var t=[];for(var n in e)hasOwn.call(e,n)&&t.push(n);return t}(e)},s.timeline=new l,g(),p(),h(),f(),x()}]),angular.module("scalearAngularApp").controller("studentStatisticsCtrl",["$scope","$stateParams","$timeout","Module","$translate","$log","$window","ModuleModel","ErrorHandler",function(l,e,t,n,o,a,i,r,s){l.statistics_player={},l.statistics_player.events={},l.module=r.getSelectedModule(),l.types=["questions","confused","back","pauses"];var u=function(e){return(e||l.url||"").match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)?([^\s&]{11})/)};l.chartToolTipOnreadyHandler=function(e,t,n){$("body").click(function(e){"rect"==e.target.nodeName&&5==e.target.width.baseVal.value||"tooltip-content"==e.target.className||"medium-editor-p"==e.target.className||n.visualization.setSelection(null)})},l.getStatisticsType=function(e){return l.types[e]};var d=function(){return 90.5*angular.element(i).width()/100};l.formatStatisticsChartData=function(e){var t={};for(var n in t.cols=[{label:o.instant("global.students"),type:"timeofday"},{label:"#"+o.instant("global.students"),type:"number"}],t.rows=[],e){var a=new Date(1e3*e[n][0]),i={c:[{v:[a.getUTCHours(),a.getMinutes(),a.getSeconds(),0]},{v:e[n][1]}]};t.rows.push(i)}return t},l.createStatisticsChart=function(e){var t=l.statistics[e],n={},a=new Date(1e3*l.statistics.min),i=new Date(1e3*l.statistics.max);n.type="ColumnChart",n.options={colors:["#0c81c8","darkred"],isStacked:"true",fill:20,height:100,width:d()+100,displayExactValues:!0,fontSize:12,hAxis:{viewWindow:{min:[a.getUTCHours(),a.getMinutes(),a.getSeconds(),0],max:[i.getUTCHours(),i.getMinutes(),i.getSeconds(),0]}},legend:"none",chartArea:{left:35,width:d()},bar:{groupWidth:5}},n.options.tooltip={isHtml:!0},n.data=l.formatStatisticsChartData(t),"confused"==e&&(n.data=c(n.data)),"questions"==e&&(n.options.tooltip.trigger="both",n.data=_(n.data)),l["chart"+e]=n};var c=function(e){for(var t in e.cols.push({label:o.instant("progress.really_confused"),type:"number"}),e.rows)if(l.statistics.really_confused[t]){var n=new Date(1e3*l.statistics.really_confused[t][0]);e.rows.push({c:[{v:[n.getUTCHours(),n.getMinutes(),n.getSeconds(),0]},{v:0},{v:l.statistics.really_confused[t][1]}]})}return e},_=function(e){for(var t in e.cols.push({type:"string",p:{role:"tooltip",html:!0}}),e.rows){var n=m(e.rows[t].c[0].v,e.rows[t].c[1].v,l.statistics.question_text[t][1]);e.rows[t].c.push({v:n})}return e},m=function(e,t,n){var a=[];a[0]=e[0],a[1]=e[1]<10?"0"+e[1]:e[1],a[2]=e[2]<10?"0"+e[2]:e[2];var i="<div id='toolTip' style='padding:8px 0 0 5px;'><b> "+(a[0]+":"+a[1]+":"+a[2])+"</b><br><b>"+t+" </b>"+o.instant("global.questions")+"</div><hr style='padding:0;margin:4px 0'>";for(var r in i+="<div  class='tooltip-content' style='width:400px;height:90px;margin-left:5px;overflow:scroll;' >",n)i+="-"+n[r]+"<br>";return i+="</div>"};l.statistics_player.events.onReady=function(){l.statistics_player.controls.pause()},l.skipToTime=function(e,t){if("confused"==t&&2==e.column)var n=new Date(1e3*l.statistics.really_confused[e.row-l.statistics.confused.length][0]);else n=new Date(1e3*l.statistics[t][e.row][0]);var a=60*n.getUTCHours()*60+60*n.getMinutes()+n.getSeconds(),i=0,r=0,o="";for(var s in l.statistics.time_list){if(a<parseInt(s)){i=a-r,o=l.statistics.time_list[s];break}r=parseInt(s)}-1==l.lecture_url.indexOf(o)?(l.statistics_player.controls.setStartTime(i),u(l.lecture_url)?l.lecture_url=o+"&controls=1&autohide=1&fs=1&theme=light":l.lecture_url=o):l.statistics_player.controls.seek_and_pause(i)},l.zoomGraph=function(t){var e=d();for(var n in l.types)t?(l["chart"+l.types[n]].options.width*=t,l["chart"+l.types[n]].options.chartArea.width*=t):(l["chart"+l.types[n]].options.width=e+100,l["chart"+l.types[n]].options.chartArea.width=e);t?(l.lecture_names.forEach(function(e){e[0]*=t}),l.win_width*=t):(l.lecture_names.forEach(function(e,t){e[0]=l.statistics.lecture_names[t][0]}),l.win_width=e+100)},l.exportCsv=function(){n.exportModuleTimelineCsv({course_id:e.course_id,module_id:e.module_id},function(e){e.notice&&s.showMessage(e.notice,"errorMessage",4e3,"success")})},l.loading_statistics_chart=!0,n.getStudentStatistics({course_id:e.course_id,module_id:e.module_id},function(e){l.statistics=e,l.lecture_url="none"==l.statistics.lecture_url?"":l.statistics.lecture_url,u(l.lecture_url)&&(l.lecture_url+="&controls=1&autohide=1&fs=1&theme=light"),l.loading_statistics_chart=!1,l.win_width=d();var t=l.win_width/l.statistics.width;l.statistics.lecture_names.forEach(function(e){e[0]*=t}),l.lecture_names=angular.copy(l.statistics.lecture_names)})}]),angular.module("scalearAngularApp").controller("lectureProgressCtrl",["$scope","$stateParams","$timeout","Module","$log","Lecture","Quiz","ModuleModel",function(n,i,a,r,o,s,l,e){n.module=e.getSelectedModule(),n.getAllItemsProgress=function(e,t){n.lecture_limit=t,n.lecture_offset=e,n.loading_lectures=!0,r.getAllItemsProgress({course_id:i.course_id,module_id:i.module_id,offset:n.lecture_offset,limit:n.lecture_limit},function(e){o.debug("getAllItemsProgress response",e);var t={};t.lecture_names=e.lecture_names,t.total_lec_quiz=e.total_lec_quiz,t.total=e.total,t.lecture_students=n.lecture_students||[],t.solved_count=n.solved_count||{},t.lecture_status=n.lecture_status||{},t.late_lectures=n.late_lectures||{},t.lecture_students=t.lecture_students.concat(JSON.parse(e.students)),angular.extend(t.solved_count,e.solved_count),angular.extend(t.lecture_status,e.lecture_status),angular.extend(t.late_lectures,e.late_lectures),o.debug(t),angular.extend(n,t),a(function(){n.getRemainingLectureProgress()})})},n.updateStatus=function(e,t,n,a){n=n?"Finished on Time"==n?1:2:0,1==a?s.changeLectureStatus({course_id:i.course_id,lecture_id:t},{user_id:e,status:n}):l.changeQuizStatus({course_id:i.course_id,quiz_id:t},{user_id:e,status:n})},n.getRemainingLectureProgress=function(){n.lecture_offset+n.lecture_limit<=parseInt(n.total)?n.getAllItemsProgress(n.lecture_offset+n.lecture_limit,n.lecture_limit):n.loading_lectures=!1},n.getAllItemsProgress(0,20)}]),angular.module("scalearAngularApp").controller("surveysCtrl",["$scope","$stateParams","$timeout","Module","Quiz","$translate","$log","ScalearUtils",function(r,o,e,s,a,i,l,u){r.surveysTab=function(){r.tabState(5),r.disableInfinitScrolling(),r.selected_survey||r.getSurveyCharts()},r.getSurveyCharts=function(e,t,n){var a;r.selected_survey&&(a=r.selected_survey?r.selected_survey[1]:"");var i=n||a;r.loading_surveys_chart=!0,s.getSurveyChart({course_id:o.course_id,module_id:o.module_id||t,survey_id:i,display_only:e},function(e){l.debug(e),r.current_survey=e.survey,r.ordered_survey=e.ordered_survey,r.survey_chart_data=e.chart_data,r.survey_chart_questions=e.chart_questions,r.survey_free=e.survey_free,r.related_answers=e.related,r.student_count=e.students_count,r.selected_survey||(r.all_surveys=e.all_surveys,r.selected_survey=r.all_surveys?r.all_surveys[0]:""),r.button_msg=r.selected_survey[2]?"progress.button.hide":"progress.button.make_visible",r.loading_surveys_chart=!1},function(){})},r.getSurveyQuestionTitle=function(e){return r.survey_chart_questions[e].question},r.getSurveyQuestionType=function(e){return r.survey_chart_questions[e].type+" | "},r.formatSurveyChartData=function(e){var t={};for(var n in t.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("progress.chart.answered"),type:"number"}],t.rows=[],e){var a={c:[{v:u.getHtmlText(e[n][1])},{v:e[n][0]}]};t.rows.push(a)}return t},r.createSurveyChart=function(e,t,n){var a={type:"ColumnChart"};return a.options={colors:["green","gray"],title:r.getSurveyQuestionType(t)+u.getHtmlText(r.getSurveyQuestionTitle(t)),isStacked:"true",fill:20,height:200,displayExactValues:!0,fontSize:12,vAxis:{title:i.instant("progress.number_of_students")+" ("+i.instant("progress.out_of")+" "+n+")",gridlines:{count:9},maxValue:n}},a.data=r.formatSurveyChartData(e),a},r.changeSurvey=function(){l.debug("survey change"),r.survey_chart_data={},r.survey_chart_questions={},r.getSurveyCharts()},r.makeVisibleBtn=function(){var e=r.selected_survey[1];r.selected_survey[2]=!r.selected_survey[2],a.makeVisible({quiz_id:e},{visible:r.selected_survey[2]},function(){r.button_msg=r.selected_survey[2]?"progress.button.hide":"progress.button.make_visible"})},r.updateHideSurveyQuestion=function(e,t,n){a.showStudent({course_id:o.course_id,quiz_id:e},{question:t,show:n})}}]),angular.module("scalearAngularApp").controller("freeTextTableCtrl",["$scope","$timeout","Quiz","$log","Lecture","$stateParams","$translate",function(o,e,s,i,n,t,a){o.grade_options=[{value:0,text:a.instant("quizzes.grade.under_review")},{value:1,text:a.instant("quizzes.grade.incorrect")},{value:2,text:a.instant("quizzes.grade.partial")},{value:3,text:a.instant("quizzes.grade.correct")}],o.showFeedback=function(e,t,n){if(!n){for(var a in e.showGroups=!0,e)e[a].show_feedback=!1,e[a].group_selected=!1;e[t].show_feedback=!0,e[t].group_selected=!0}};var l=function(e,t){e.showGroups=!1,e[t].show_feedback=!1,e[t].group_selected=!1};o.saveCheckedHideSurvey=function(e,t){s.hideResponseStudent({quiz_id:o.survey_id},{hide:{id:e,hide:t}})},o.saveCheckedHideQuiz=function(e,t){n.hideResponses({lecture_id:o.lecture_id},{hide:{id:e,hide:t}})},o.sendFeedback=function(e,t){var n=o.survey_id,a=[],i=0,r=e[t].response;e.forEach(function(e){e.group_selected&&(a[i]=e.id,e.response=r,i++)}),s.sendFeedback({quiz_id:n},{groups:a,response:r},function(){l(e,t)},function(){})},o.deleteFeedback=function(e,t){var n=o.survey_id,a=e[t].id;i.debug(e[t]),s.deleteFeedback({quiz_id:n},{answer:a},function(){e[t].response="",l(e,t)},function(){})},o.updateGrade=function(e){s.updateGrade({course_id:t.course_id,quiz_id:e.quiz_id},{answer_id:e.id,grade:e.grade})}}]),angular.module("scalearAngularApp").controller("enrolledStudentsCtrl",["$scope","$state","Course","batchEmailService","$stateParams","$translate","$log","$window","Page","$filter","$modal","$cookieStore","ContentNavigator","$rootScope","ErrorHandler","$interval",function(t,e,n,a,i,r,o,s,l,u,d,c,_,m,p,g){_.close(),o.debug("in enrolled students"),l.setTitle("navigation.enrolled_students"),t.emails=[],a.setEmails(t.emails),t.loading_students=!0,t.delete_mode=!1,t.list_view=c.get("list_view"),n.getEnrolledStudents({course_id:i.course_id},function(e){t.students=e,t.loading_students=!1}),t.removeStudent=function(e){o.debug(e),e.removing=!0,n.removeStudent({course_id:i.course_id,student:e.id},{},function(){t.students.splice(t.students.indexOf(e),1)},function(){e.removing=!1,o.debug(value)})},t.exportStudentsList=function(){o.debug("List "),n.exportStudentCsv({course_id:i.course_id},function(e){e.notice&&p.showMessage(r.instant("error_message.export_student"),"errorMessage",2e3,"success")})},t.emailSingle=function(e){t.deSelectAll(),t.toggleSelect(e),t.emailForm()},t.emailForm=function(){var e=u("filter")(t.students,{checked:!0},!0);t.emails=[],e.forEach(function(e){t.emails.push(e.email)}),a.setEmails(t.emails),d.open({templateUrl:"/views/teacher/course/send_emails.html",controller:"sendEmailsCtrl"})},t.selected=[],t.toggleSelect=function(e){e.checked=!e.checked},t.selectAll=function(){u("filter")(t.students,t.searchText).forEach(function(e){u("filter")(t.students,{id:e.id},!0)[0].checked=!0})},t.deSelectAll=function(){u("filter")(t.students,t.searchText).forEach(function(e){u("filter")(t.students,{id:e.id},!0)[0].checked=!1})},t.toggleHelpEnrolling=function(){t.isCollapsed=!t.isCollapsed,s.scrollTo(0,0)},t.toggleDeleteMode=function(){t.delete_mode=!t.delete_mode},t.listView=function(e){t.list_view=e,c.put("list_view",e)}}]),angular.module("scalearAngularApp").controller("teacherCourseInformationCtrl",["$scope","$state","$translate","$log","$window","Page","ScalearUtils","ContentNavigator","ErrorHandler","$location","CourseModel","TeacherModel","$modal",function(a,i,r,e,t,n,o,s,l,u,d,c,_){function m(){a.formData.disable_registration_checked?a.course.disable_registration||(a.course.disable_registration=a.course.end_date):a.course.disable_registration=null}function p(){c.getTeachers().then(function(e){a.teachers=e.data,a.new_teacher={},i.params.new_course&&_.open({templateUrl:"/views/teacher/course_list/email_student_answers_modal.html",scope:a,controller:["$modalInstance",function(t){var n=a.teachers.findIndex(function(e){return a.current_user.id==e.id});a.updateEmailDiscussion=function(e){a.teachers[n].email_discussion=e,a.updateTeacher(a.teachers[n]),t.dismiss("cancel")}}]})})}t.scrollTo(0,0),a.in_delete=!1,a.toggle_message="courses.information.button.remove_teacher",a.formData={},a.course=d.getSelectedCourse(),a.formData.disable_registration_checked=!!a.course.disable_registration,a.roles=[{value:3,text:"courses.information.professor"},{value:4,text:"courses.information.ta"}],n.setTitle(r.instant("navigation.information")+": "+a.course.name),a.timezones=o.listTimezones(),a.enrollment_url=u.absUrl().split("courses")[0]+"courses/enroll?id="+a.course.unique_identifier,a.course_info_url=i.href("course.course_information",{course_id:a.course.id},{absolute:!0}),a.course_domain={},a.subdomains={},n.startTour(),s.close(),a.timezones.forEach(function(e){e.name!=a.course.time_zone||(a.course.time_zone=e)}),p(),c.getSelectedSubdomains().then(function(e){a.course_domain.selected_subdomain=e.selected_domain,a.subdomains=e.subdomains}),a.updateCourse=function(e,t){e&&e instanceof Date&&(e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),a.course[t]=e),m(),a.course.update()},a.toggleRegistrationCheck=function(){m(),a.updateCourse()},a.validateCourse=function(e,t){var n={id:a.course.id};return n[e]=t,d.createInstance(n).validate()},a.exportCourse=function(){a.course.exportCourse().then(function(e){e.notice&&l.showMessage(r.instant("error_message.export_course"),"errorMessage",4e3,"success")})},a.toggleDelete=function(){a.in_delete=!a.in_delete,a.toggle_message=a.in_delete?"courses.information.done":"courses.information.button.remove_teacher"},a.addNewTeacher=function(){a.teacher_forum=!0},a.updateTeacher=function(e){c.updateTeacher(e)},a.removeNewTeacher=function(){a.new_teacher=null,a.teacher_forum=!1},a.removeTeacher=function(n){c.deleteTeacher(n).then(function(e){e.remove_your_self&&(i.go("course_list"),l.showMessage(r.instant("error_message.remove_your_self"),"errorMessage",4e3,"success"));var t=a.teachers.indexOf(n);-1!=t&&a.teachers.splice(t,1)})},a.saveTeacher=function(){c.saveNewTeacher(a.new_teacher).then(function(){p(),a.teacher_forum=!1}).catch(function(e){a.new_teacher.errors=e.data.errors})},a.animateCopy=function(){$("#enrollment_key").animate({color:"#428bca"},"fast").delay(400).animate({color:"black"},"fast")},a.copySuccess=function(e){$(e.trigger).animate({color:"#428bca"},"fast").delay(300).animate({color:"black"},"fast",function(){e.clearSelection()})},a.copyError=function(e){},a.toggleDomain=function(e){e.stopPropagation(),_.open({templateUrl:"/views/teacher/course_list/school_registration_modal.html",plain:!0,scope:a,controller:["$scope","$modalInstance",function(e,t){e.subdomain={},e.subdomain.boolean="all",e.course_domain.selected_subdomain.All||(e.subdomain.boolean="custom"),e.close=function(){t.dismiss()},e.updateDomainList=function(){},e.setBooleanDomain=function(){"all"==e.subdomain.boolean?e.course_domain.selected_subdomain={All:!0}:delete e.course_domain.selected_subdomain.All}}]}).result.finally(function(){-1==Object.keys(a.course_domain.selected_subdomain).map(function(e){return a.course_domain.selected_subdomain[e]}).indexOf(!0)&&(a.course_domain.selected_subdomain={All:!0}),c.setSelectedSubdomains(a.course_domain.selected_subdomain).then(function(e){})})}}]),angular.module("scalearAngularApp").controller("sendEmailsCtrl",["$scope","$state","Course","batchEmailService","$stateParams","$log","$window","Page","$modalInstance",function(n,e,a,t,i,r,o,s,l){for(o.scrollTo(0,0),s.setTitle("email"),r.debug("in sending emails"),n.batch_emails=t.getEmails(),r.debug(n.batch_emails.length),0==n.batch_emails.length&&e.go("course.enrolled_students");-1!=n.batch_emails.indexOf(",");)for(var u=0;u<n.batch_emails.length;u++)","==n.batch_emails[u]&&n.batch_emails.splice(u,1);n.final_emails="";for(u=0;u<n.batch_emails.length;u++)n.final_emails+=n.batch_emails[u]+"; ";r.debug(n.final_emails),n.sendBatchEmail=function(e,t){r.debug(n.batch_emails),a.send_batch_email_through({course_id:i.course_id},{emails:n.batch_emails,subject:e,message:t},function(){l.close()},function(){})}}]),angular.module("scalearAngularApp").controller("systemEmailCtrl",["$scope","$state","Course","$stateParams","$log","$window","Page","$modalInstance","ngDialog",function(e,t,n,a,i,r,o,s,l){r.scrollTo(0,0),e.announcement={emails:""},e.confirmDialog=function(){l.open({template:'<div class="ngdialog-message">                    <h2><b><span>You are going to send a system wide email!</span></b></h2>                    <span translate>Are you sure you want to continue?</span>                    </div>                    <div class="ngdialog-buttons">                        <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>Cancel</button>                        <button type="button" class="ngdialog-button ngdialog-button-primary" ng-disabled="disable_send" ng-click="sendEmail()">Send</button>                    </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1,scope:e,controller:["$scope","Course",function(e,t){e.sendEmail=function(){e.disable_send=!0,t.systemWideEmail({},{subject:e.announcement.subject,message:e.announcement.message,list_type:e.announcement.list_type,reply_to:e.announcement.reply_to,emails:e.announcement.emails.split(",").map(function(e){return e.trim()})},function(){e.closeThisDialog()})}}]})}}]),angular.module("scalearAngularApp").controller("inclassCtrl",["$scope","$translate","ContentNavigator","Page","CourseModel",function(e,t,n,a,i){e.course=i.getSelectedCourse(),a.setTitle(t.instant("navigation.in_class")+": "+e.course.name),n.open()}]),angular.module("scalearAngularApp").controller("inclassModuleCtrl",["$scope","$modal","$timeout","$window","$log","Module","$stateParams","ScalearUtils","$translate","Timeline","Page","$interval","OnlineQuiz","Forum","Quiz","OnlineMarker","Lecture","ModuleModel","CourseModel",function(c,e,i,n,t,a,r,p,g,o,s,l,u,d,_,m,h,f,v){n.scrollTo(0,0),c.course=v.getSelectedCourse(),s.setTitle(g.instant("navigation.in_class")+": "+c.course.name),c.inclass_player={},c.inclass_player.events={},c.time_parameters={quiz:3,question:2};var b="[REPLACE-STYLING]";function y(e){var t=0;switch(e){case"small":t=1;break;case"medium":t=1.5;break;case"large":t=2}return Math.round(t*window.screen.availWidth)/100}c.display=function(){for(var e in w(),S(),M(),c.hide_video_text=c.button_names[3],c.zooom_graph_text=c.button_names[8],c.zooom_graph=!1,c.setOriginalClass(),c.setInclassShortcuts(),screenfull.request(),c.fullscreen=!0,c.blurButtons(),c.timer=Math.ceil(c.review_question_count*c.time_parameters.question+c.review_video_quiz_count*c.time_parameters.quiz+c.review_survey_count*c.time_parameters.question+c.inclass_quizzes_time+c.review_quiz_count*c.time_parameters.quiz),c.counter=0<c.timer?1:0,c.up_timer=0,c.up_counter=0,c.timerCountUp(),angular.element(n).bind("resize",function(){M(),i(function(){D(),P();var e=angular.element("#inclass_video").height()*(16/9);c.quiz_layer.width=e,c.quiz_layer.marginLeft=(angular.element("#inclass_video").width()-e)/2})}),document.addEventListener(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen||(c.fullscreen=!1,c.exitBtn(),c.$apply())}),c.lectures){var t=c.timeline.lecture[e].filtered.filterByType("inclass");if(0<t.length){O(t[0].data.id,1);break}}};var w=function(){c.play_pause_class="fi-play",c.mute_class="fi-volume",c.loading_video=!0,c.lecture_url="",c.current_quiz=0,c.item_itr=0,c.timeline_itr=0,c.show_black_screen=!1,c.hide_questions=!1,c.zooom_graph=!1,c.dark_buttons="dark_button",c.fullscreen=!1,c.selected_item={start_time:0},c.selected_timeline_item=null,c.quality_set="color-blue",c.inclass_answer=!1,c.quiz_layer={},c.player_button_hover=!1,c.question_class_normal="normal_question_block",c.video_class_normal="original_video",c.question_block_small=30,c.question_block_large=30},k=function(){a.getModuleInclass({course_id:r.course_id,module_id:r.module_id},function(e){for(var t in c.inclass_quizzes_time=0,angular.extend(c,e),c.confused_count=0,c.lectures){for(var n in c.timeline.lecture[t]={all:new o,filtered:new o},c.lectures[t])for(var a in c.lectures[t][n])"markers"==n&&c.lectures[t][n][a][1].title?(c.timeline.lecture[t].all.add(c.lectures[t][n][a][0],"primary_marker",c.lectures[t][n][a][1]||{}),c.markers_count+=1):c.timeline.lecture[t].all.add(c.lectures[t][n][a][0],n,c.lectures[t][n][a][1]||{}),"inclass"==n&&c.lectures[t][n][a][1].show&&(c.inclass_quizzes_time+=(c.lectures[t][n][a][1].timers.intro+c.lectures[t][n][a][1].timers.self+c.lectures[t][n][a][1].timers.in_group+c.lectures[t][n][a][1].timers.discussion)/60),"confused"==n&&(c.confused_count+=c.lectures[t][n].length);c.timeline.lecture[t].filtered.items=c.timeline.lecture[t].all.filterByNotType("markers")}x(c.lectures,f.getSelectedModule().items,c.module.items),q()})},z=function(){a.getQuizChartsInclass({course_id:r.course_id,module_id:r.module_id},function(e){for(var t in c.quizzes=angular.extend({},e.quizzes,c.quizzes),c.review_quiz_count=e.review_quiz_count,c.review_survey_count=e.review_survey_count,c.quizzes){var n=c.quizzes[t].type;for(var a in c.timeline[n][t]={filtered:new o},c.quizzes[t].questions){var i=c.quizzes[t].questions[a].id;c.quizzes[t].answers[i].id=i;var r="Free Text Question"==c.quizzes[t].questions[a].type?c.quizzes[t].questions[a].type:"charts";c.timeline[n][t].filtered.add(0,r,c.quizzes[t].answers[i])}}x(c.quizzes,f.getSelectedModule().items,c.module.items),q()})},q=function(){c.inclass_ready=c.review_question_count||c.review_video_quiz_count||c.review_survey_count||c.inclass_quizzes_count||c.review_quiz_count||c.confused_count||c.markers_count},x=function(e,t,n){var a=p.getKeys(e);for(var i in t)-1!=a.indexOf(t[i].id.toString())&&n.push(t[i]);n.sort(function(e,t){return e.position-t.position})};c.updateHideQuiz=function(t){a.hideQuiz({course_id:r.course_id,module_id:r.module_id},{quiz:t.data.id,hide:t.data.show},function(){var e=t.data.show?1:-1;"inclass"==t.type?(c.inclass_quizzes_time+=e*(t.data.timers.intro+t.data.timers.self+t.data.timers.in_group+t.data.timers.discussion)/60,c.inclass_quizzes_count+=e):c.review_video_quiz_count+=e,q()})},c.updateHideMarker=function(e){m.updateHide({online_markers_id:e.data.id},{hide:e.data.show})},c.updateHideResponseOnlineQuiz=function(e){u.hideResponses({course_id:e.course_id,online_quizzes_id:e.online_quiz_id},{hide:{id:e.id,hide:e.hide}})},c.updateHideDiscussion=function(e,t){d.hideDiscussion({},{post_id:e,hide:t},function(){t?c.review_question_count--:c.review_question_count++})},c.updateHideComment=function(e,t){d.hideComment({},{post_id:t.id,comment_id:e.id,hide:e.hide},function(){e.hide&&!t.hide&&(t.hide=!0,c.updateHideDiscussion(t.id,!t.hide))})},c.updateHideQuizQuestion=function(t,n){_.showInclass({course_id:r.course_id,quiz_id:t.id},{question:n.data.id,show:!n.data.show},function(){var e=n.data.show?1:-1;c["review_"+t.quiz_type+"_count"]+=e*("charts"==n.type?1:n.data.answers.length+1)})},c.updateHideConfused=function(e,t,n,a){h.confusedShowInclass({course_id:r.course_id,lecture_id:e},{time:t,hide:n,very:a},function(){n?c.confused_count-=1:c.confused_count+=1,q()})};var S=function(){angular.element("body").css("overflow","hidden"),angular.element("#main").css("overflow","hidden"),angular.element("html").css("overflow","hidden"),angular.element(n).scrollTop("0px"),c.modalInstance=e.open({templateUrl:"/views/teacher/in_class/inclass_display.html",windowClass:"whiteboard display",controller:"inclassDisplayCtrl",scope:c}),c.modalInstance.result.then(function(){},function(){T()}),c.unregister_back_event=c.$on("$locationChangeStart",function(e){e.preventDefault(),T(),c.$apply()}),c.unregister_state_event=c.$on("$stateChangeStart",function(){T(),c.$apply()})};c.exitBtn=function(){N(),screenfull.exit(),c.modalInstance.dismiss("cancel"),T(),c.timer_interval_up=null};var T=function(){angular.element("body").css("overflow",""),angular.element("#main").css("overflow",""),angular.element("html").css("overflow",""),c.unregister_back_event(),c.unregister_state_event(),c.removeShortcuts(),w(),l.cancel(c.timer_interval_up),R(),F()};c.playBtn=function(){"fi-play"==c.play_pause_class?(c.inclass_player.controls.play(),c.play_pause_class="fi-pause"):c.inclass_player.controls.pause(),c.blurButtons()},c.muteBtn=function(){"fi-volume-strike"==c.mute_class?(c.mute_class="fi-volume",c.inclass_player.controls.unmute(),c.inclass_player.controls.volume(1)):(c.mute_class="fi-volume-strike",c.inclass_player.controls.mute()),c.blurButtons()},c.qualityBtn=function(){c.quality_set?(c.inclass_player.controls.changeQuality("large"),c.quality_set=null):(c.inclass_player.controls.changeQuality("hd720"),c.quality_set="color-blue"),c.blurButtons()},c.seek=function(e){c.selected_item.url&&(-1==c.lecture_url.indexOf(c.selected_item.url)?(c.inclass_player.controls.isYoutube(c.selected_item.url)&&c.inclass_player.controls.setStartTime(e),c.lecture_url=c.selected_item.url,c.inclass_player.controls.isMP4(c.selected_item.url)&&i(function(){c.inclass_player.controls.seek(e)})):c.inclass_player.controls.seek(e))},c.skip=function(e){if(e){var t=c.inclass_player.controls.getTime()+e,n=c.inclass_player.controls.getDuration();t<0?t=0:n<t&&(t=n),c.seek(t)}c.blurButtons()},c.inclass_player.events.onPlay=function(){c.play_pause_class="fi-pause"},c.inclass_player.events.onPause=function(){c.play_pause_class="fi-play"},c.inclass_player.events.onReady=function(){c.loading_video=!1,c.should_mute&&c.muteBtn(),c.timer_interval_up||(c.timer_interval_up=l(c.timerCountUp,1e3))},c.inclass_player.events.onMeta=function(){c.play_pause_class="fi-play",c.loading_video=!1},c.inclass_player.events.seeked=function(){c.inclass_player.controls.pause()};var C=function(e){if(c.selected_timeline_sub_item=e,R(),"primary_marker"==e.type&&"inclass"!=c.selected_timeline_item.type?c.hideQuestionBox():"markers"!=e.type&&c.showQuestionBox(),c.seek(e.time),"inclass"==c.selected_timeline_item.type){if(2==e.data.status||3==e.data.status?(E(c.selected_timeline_item.data.quiz_type),H(c.selected_timeline_item.data.id,c.selected_item.id,3==e.data.status),V()):((4<e.data.status||"answer"==e.data.status)&&(c.loading_chart=!0,u.getChartData({online_quizzes_id:c.selected_timeline_item.data.id},function(e){c.selected_timeline_item.data.answers=e.chart,c.chart=c.createChart(c.selected_timeline_item.data.answers,{colors:["rgb(0, 140, 186)","rgb(67, 172, 106)"]},"formatInclassQuizChartData"),c.chart.is_inclass_quiz=!0})),E()),e.data.timer){F(),Q(e.data.timer);var t=c.$watch("loading_video",function(e){e||(U(),t())})}e.data.status&&"number"==typeof e.data.status?(O(c.selected_timeline_item.data.id,e.data.status),c.inclass_answer=!1):"answer"==e.data.status&&(c.inclass_answer=!0)}};c.nextSubItem=function(){if(c.isBlackScreenOn()&&c.hideBlackScreen(),"lecture"==c.selected_item.class_name){var e=c.selected_timeline_item.sub_items.indexOf(c.selected_timeline_sub_item)+1;if(e<c.selected_timeline_item.sub_items.length)return void C(c.selected_timeline_item.sub_items[e])}c.nextItem()},c.prevSubItem=function(){if(c.isBlackScreenOn()&&c.hideBlackScreen(),"lecture"==c.selected_item.class_name){var e=c.selected_timeline_item.sub_items.indexOf(c.selected_timeline_sub_item)-1;if(0<=e)return void C(c.selected_timeline_item.sub_items[e])}c.prevItem()},c.skipToItem=function(e,t,n){c.item_itr=c.module.items.indexOf(e),c.selected_item=e,t?(c.timeline_itr=c.timeline[n][e.id].filtered.items.indexOf(t),A(angular.noop)):(c.timeline_itr=0,c.nextItem())};var A=function(e){var t="quiz"==c.selected_item.class_name?c.selected_item.quiz_type:c.selected_item.class_name,n=c.timeline[t][c.selected_item.id].filtered.items[c.timeline_itr],a=Array(1);if(Array.isArray(n.data)&&(a=n.data.filter(function(e){return e.hide})),!n.data||!1!==n.data.show&&a.length){if(n!=c.selected_timeline_item){var i;if(c.selected_timeline_item&&"inclass"==c.selected_timeline_item.type&&O(c.selected_timeline_item.data.id,1),c.selected_timeline_item=angular.copy(n),"lecture"==t)c.selected_timeline_item.sub_items=function(e,t){var n,a;if(a="charts"==t.type||"inclass"==t.type?(n=t.data.start_time,t.data.end_time):(n=t.time-15<c.selected_item.start_time?c.selected_item.start_time:t.time-15,t.time+15>c.selected_item.end_time?c.selected_item.end_time:t.time+15),"primary_marker"!=t.type)return"inclass"==t.type?e.getItemsBetweenTime(n,a):e.getItemsBetweenTimeByType(n,a,"markers").concat(t);for(var i=[t],r=e.items.indexOf(t)+1;r<e.items.length&&"markers"==e.items[r].type;r++)i.push(e.items[r]);return i}(c.timeline[t][c.selected_item.id].all,n),"inclass"==c.selected_timeline_item.type?(i=0,c.selected_timeline_item.sub_items=function(e){for(var t,n=0;n<e.length;n++){var a=e[n];if(a.data.background="lightgrey",a.data.color="black","inclass"!=a.type);else{t=a.data.timers,a.data.inclass_title=g.instant("inclass.self_stage"),a.data.status=2,a.data.background="#008CBA",a.data.color="white",a.data.timer=t.self;var i={time:a.data.start_time,type:"marker",data:{time:a.data.start_time,status:1}};e.splice(0,0,i),n++;var r=angular.copy(a);r.data.inclass_title=g.instant("inclass.group_stage"),r.data.status=3,r.data.background="#43AC6A",r.data.timer=t.in_group,e.splice(++n,0,r);var o=angular.copy(a);o.data.inclass_title=g.instant("inclass.discussion_stage"),o.data.status=4,o.data.background="darkorange",o.data.color="white",o.data.timer=t.discussion,e.splice(++n,0,o);var s={time:a.time,type:"marker",data:{time:a.data.time,status:"answer"}};if(e.splice(++n,0,s),a.time<a.data.end_time){var l={time:a.data.end_time,type:"marker",data:{time:a.data.end_time,status:5}};e.splice(e.length,0,l)}}}return e[0].data.inclass_title=g.instant("inclass.intro_stage"),e[0].data.background="lightgrey",e[0].data.color="black",e[0].data.timer=t.intro,e}(c.selected_timeline_item.sub_items)):(i=c.selected_timeline_item.sub_items.indexOf(n),c.selected_timeline_item.sub_items=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.data.background="lightgrey",n.data.color="black","markers"!=n.type&&("discussion"==n.type?e[t].data.inclass_title=g.instant("inclass.discussion"):-1!=n.type.indexOf("confused")?e[t].data.inclass_title=g.instant("inclass.confused"):"primary_marker"!=n.type&&(e[t].data.inclass_title=n.data.type))}return e}(c.selected_timeline_item.sub_items)),C(c.selected_timeline_item.sub_items[i]);if("charts"==c.selected_timeline_item.type){var r="lecture"!=t?{backgroundColor:"white"}:{};c.loading_chart=!0;var o="formatLectureChartData";"survey"==t&&(o="formatSurveyChartData"),c.chart=c.createChart(c.selected_timeline_item.data.answers,r,o)}}}else e()};c.nextItem=function(){if(c.item_itr<0&&(c.item_itr=0,c.timeline_itr+=1),0<=c.item_itr&&c.item_itr<c.module.items.length){c.selected_item=c.module.items[c.item_itr];var e="quiz"==c.selected_item.class_name?c.selected_item.quiz_type:c.selected_item.class_name;c.timeline[e]&&c.timeline[e][c.selected_item.id]&&(c.timeline_itr+=1,0<c.timeline_itr&&c.timeline_itr<c.timeline[e][c.selected_item.id].filtered.items.length?A(c.nextItem):(c.item_itr+=1,c.timeline_itr=c.item_itr<c.module.items.length?0:c.timeline_itr,c.nextItem()))}else c.item_itr=c.module.items.length,c.showBlackScreen("inclass.blackscreen_done"),c.selected_timeline_item&&"inclass"==c.selected_timeline_item.type&&O(c.selected_timeline_item.data.id,1);i(function(){D(),P()}),c.blurButtons()},c.prevItem=function(){if(c.item_itr>=c.module.items.length&&(c.item_itr=c.module.items.length-1),0<=c.item_itr){c.selected_item=c.module.items[c.item_itr];var e="quiz"==c.selected_item.class_name?c.selected_item.quiz_type:c.selected_item.class_name;if(c.timeline[e]&&c.timeline[e][c.selected_item.id])if(c.timeline_itr-=1,0<c.timeline_itr)A(c.prevItem);else{c.item_itr-=1,c.module.items[c.item_itr]&&(c.selected_item=c.module.items[c.item_itr]);e="quiz"==c.selected_item.class_name?c.selected_item.quiz_type:c.selected_item.class_name;c.timeline_itr=c.item_itr<0?0:c.timeline[e][c.selected_item.id].filtered.items.length,c.prevItem()}}i(function(){D(),P()}),c.blurButtons()};var E=function(e){c.quiz_layer.overflowY="html"==e?(c.quiz_layer.backgroundColor="white",c.quiz_layer.overflowX="hidden","auto"):(c.quiz_layer.backgroundColor="",c.quiz_layer.overflowX="")};c.createChart=function(e,t,n){var a={type:"BarChart",options:{width:angular.element(".reveal-modal").width()-50,colors:["green","gray"],isStacked:"false",fill:25,backgroundColor:"white",displayExactValues:!0,legend:{position:"none"},chartArea:{left:"70%",width:"90%",top:"10%"},tooltip:{isHtml:!0},hAxis:{textPosition:"none"}},data:c[n](e)};return c.chooseVideoQuestionBlockGlass(Object.keys(e).length),angular.extend(a.options,t),a},c.chooseVideoQuestionBlockGlass=function(e){c.question_block_small=Math.min(Math.max(30,9*e),95),c.question_block_large=Math.min(95,20*e),c.changeVideoQuestionBoxPercentage(c.question_block_small,!1)},c.formatLectureChartData=function(e){var t={};for(var n in t.cols=[{label:g.instant("global.students"),type:"string"},{label:g.instant("lectures.correct"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{role:"style",type:"string"}],t.rows=[],e){var a,i=e[n][2],r=p.getHtmlText(i),o="<div style='color:black;padding:8px'>",s=e[n][1],l=e[n][3]||0;if("grey"==s)a=Math.floor(e[n][0]/c.students_count*100);else{a=Math.floor((e[n][0]+l)/c.students_count*100);var u="Correct: ";"orange"==s?(s="gray",u="Incorrect: "):r=b+r,I()||(o+=u)}var d={c:[{v:r},{v:a},{v:o+=i+"</div>"},{v:s}]};t.rows.push(d)}return t},c.formatInclassQuizChartData=function(e){var t={};t.cols=[{label:g.instant("global.students"),type:"string"},{label:g.instant("inclass.self_stage"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:g.instant("inclass.group_stage"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],t.rows=[];var n=0,a=0;for(var i in e)"Never tried"!=e[i][2]&&(n+=e[i][0],a+=e[i][4]);for(var r in e){var o=e[r][2],s=p.getHtmlText(o),l=e[r][0]||0,u=e[r][4]||0,d=l/n*100,c=u/a*100,_="<div style='padding:8px'><b>"+o+"</b><br>"+g.instant("inclass.self_stage")+": "+l+" ("+d+"%)<br>"+g.instant("inclass.group_stage")+": "+u+" ("+c+"%)</div>",m={c:[{v:s="green"==e[r][1]?b+s:s},{v:d},{v:_},{v:c},{v:_}]};"Never tried"!=s&&t.rows.push(m)}return t},c.formatSurveyChartData=function(e){var t={};for(var n in t.cols=[{label:g.instant("global.students"),type:"string"},{label:g.instant("progress.chart.answered"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],t.rows=[],e){var a={c:[{v:p.getHtmlText(e[n][2])},{v:Math.floor(e[n][0]/c.students_count*100)},{v:p.getHtmlText(e[n][2])}]};t.rows.push(a)}return t},c.setInclassShortcuts=function(){c.removeShortcuts(),shortcut.add("Right",function(){c.nextSubItem(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Page_down",function(){c.nextSubItem(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Left",function(){c.prevSubItem(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Page_up",function(){c.prevSubItem(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Up",function(){c.prevItem(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Down",function(){c.nextItem(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("b",function(){c.toggleBlackScreen("inclass.blackscreen_close"),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("h",function(){c.toggleHideQuestions(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Space",function(){c.playBtn(),c.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("m",function(){c.muteBtn(),c.$apply()},{disable_in_input:!1,propagate:!1})},c.removeShortcuts=function(){shortcut.remove("Page_up"),shortcut.remove("Page_down"),shortcut.remove("Right"),shortcut.remove("Left"),shortcut.remove("b"),shortcut.remove("h"),shortcut.remove("Space"),shortcut.remove("m")},c.toggleBlackScreen=function(e){c.show_black_screen=!c.show_black_screen,c.blackscreen_msg=e},c.showBlackScreen=function(e){c.show_black_screen=!0,c.blackscreen_msg=e},c.hideBlackScreen=function(){c.show_black_screen=!1,c.blackscreen_msg=""},c.isBlackScreenOn=function(){return c.show_black_screen},c.setOriginalClass=function(){c.question_class="original_question",c.chart_class="original_chart",c.student_question_class="original_student_question",c.question_block="normal_question_block",c.showQuestionBox()},c.toggleHideQuestions=function(){c.hide_questions?c.showQuestionBox():c.hideQuestionBox()},c.toggleZoomGraphVideo=function(){c.zooom_graph?c.showQuestionBox():c.zoomGraph()},c.changeVideoQuestionBoxPercentage=function(e,t){var n=angular.element(".normal_question_block"),a=angular.element(".original_video");i(function(){0!==n.length&&0!==a.length&&(n[0].style.maxHeight=e+"%",n[0].style.minHeight=e+"%",n[0].style.border=(0<e?1:0)+"px solid darkgrey",n[0].style.overflowY=t?"auto":"hidden",a[0].style.maxHeight=95-e+"%",a[0].style.minHeight=95-e+"%")})},c.zoomGraph=function(){c.zooom_graph_text=c.button_names[9],c.hide_video_text=c.button_names[3],c.zooom_graph=!0,c.hide_questions=!1,c.changeVideoQuestionBoxPercentage(c.question_block_large,!0),c.chart&&(c.chart.options.fontSize=y("medium")),c.blurButtons()},c.showQuestionBox=function(){c.zooom_graph=!1,c.hide_questions=!1,c.hide_video_text=c.button_names[3],c.zooom_graph_text=c.button_names[8],c.selected_timeline_item&&"inclass"==c.selected_timeline_item.type?c.changeVideoQuestionBoxPercentage(30,!1):c.changeVideoQuestionBoxPercentage(c.question_block_small,!1),c.chart&&(c.chart.options.fontSize=y("small")),c.blurButtons()},c.hideQuestionBox=function(){c.hide_questions=!0,c.zooom_graph=!1,c.hide_video_text=c.button_names[4],c.zooom_graph_text=c.button_names[8],c.changeVideoQuestionBoxPercentage(0,!1),c.blurButtons()};var M=function(){var e=angular.element(n).width();e<660?(c.button_names=["Ex","Ov","Sh","H","U","","P","R","Z G","Z V"],c.button_class=e<510?"smallest_font_button":"small_font_button"):(c.button_class="big_font_button",c.button_names=[g.instant("inclass.exit"),"","",g.instant("inclass.video_only"),g.instant("inclass.show_graph"),"5sec",g.instant("inclass.pause"),g.instant("inclass.resume"),g.instant("inclass.zoom_graph"),g.instant("inclass.zoom_video")]),c.hide_video_text=c.hide_questions?c.button_names[4]:c.button_names[3],c.zooom_graph_text=c.zooom_graph?c.button_names[9]:c.button_names[8]};function D(){var e=angular.element(".normal_question_block").not(".ng-hide"),t=e.text().trim().length,n=e.height()*e.width(),a=Math.sqrt(n/t)+5,i=y("large");c.fontsize=Math.min(a,i)+"px"}function P(){if(c.chart){var e=angular.element(".normal_question_block").not(".ng-hide").height()-50;if(c.zooom_graph&&95==c.question_block_large){var t=c.chart.is_inclass_quiz?5:4;c.chart.options.height=Object.keys(c.selected_timeline_item.data.answers).length*(e/t)}else c.chart.options.height=e}}c.playerButtonTooltip=function(){c.player_button_hover=!0},c.playerButtonTooltipLeave=function(){c.player_button_hover=!1},c.lightUpButtons=function(){c.last_movement_time=new Date,c.dark_buttons=null,l(function(){5e3<=new Date-c.last_movement_time&&(c.dark_buttons="dark_button")},5e3,1)},c.blurButtons=function(){angular.element(".button").blur()};var I=function(){return c.selected_timeline_item.data.type&&"survey"==c.selected_timeline_item.data.type.toLowerCase()||c.selected_timeline_item.data.type&&"html_survey"==c.selected_timeline_item.data.type.toLowerCase()};c.timerCountUp=function(){59==c.up_counter?(c.up_timer++,c.up_counter=0):c.up_counter++,c.sec_counter_up=c.up_counter<10?"0"+c.up_counter:c.up_counter,c.min_counter_up=c.up_timer<10?"0"+c.up_timer:c.up_timer};var L=function(){0===c.stage_counter?F():c.stage_counter--};c.toggleStageTimer=function(){c.stage_timer?F():U()};var U=function(){c.stage_timer=l(L,1e3)},F=function(){c.stage_timer&&(l.cancel(c.stage_timer),c.stage_timer=null)},Q=function(e){c.stage_counter=e},O=function(e,t){0<=(c.inclass_session=t)&&t<=5&&u.updateInclassSession({online_quizzes_id:e},{status:t})},N=function(){a.updateAllInclassSessions({course_id:r.course_id,module_id:r.module_id},{})},H=function(e,t,n){u.getInclassSessionVotes({online_quizzes_id:e,lecture_id:t,in_group:n},function(e){c.session_votes=e.votes,c.session_max_votes=e.max_votes})},V=function(){c.session_votes_timer=l(function(){H(c.selected_timeline_item.data.id,c.selected_item.id,3==c.selected_timeline_sub_item.data.status)},5e3)},R=function(){c.session_votes_timer&&l.cancel(c.session_votes_timer),c.session_votes=null,c.session_max_votes=null};c.chartReady=function(){c.chart.options.fontSize||(c.chart.options.fontSize=y("small")),$("text:contains('"+b+"')").each(function(e,t){var n=$(t),a=n.text().replace(b,"");n.html("<tspan>"+a+"</tspan>")}),$("div[style*='background: infobackground;']:contains('"+b+"')").each(function(e,t){var n=$(t),a=n.text().replace(b,"");n.text(a)}),$(window).resize(),c.loading_chart=!1},c.timeline={lecture:{},survey:{},quiz:{}},c.markers_count=0,c.module=angular.copy(f.getSelectedModule()),c.module.items=[],c.player_button_hover=!1,k(),z()}]),angular.module("scalearAngularApp").controller("inclassDisplayCtrl",["$scope","$window",function(e,t){t.scrollTo(0,0),e.$on("player ready",function(){e.nextItem()})}]),angular.module("scalearAngularApp").controller("TeacherGettingStartedCtrl",["$scope","$location","$anchorScroll","$rootScope","Page","scalear_api","$translate",function(e,t,n,a,i,r,o){i.setTitle("help.getting_started"),a.subheader_message=o.instant("help.getting_started"),e.scalear_api=r,e.scroll=function(e){$("body").scrollToThis(0,{offsetTop:0,duration:0}),$("body").scrollToThis("#"+e,{offsetTop:95,duration:0})}}]),angular.module("scalearAngularApp").controller("LtiKeyGenerateCtrl",["$scope","$location","$anchorScroll","$rootScope","Page","scalear_api","$translate","Lti","$modal",function(t,e,n,a,i,r,o,s,l){i.setTitle("lti.lti"),a.subheader_message=o.instant("lti.lti"),t.scalear_api=r,t.loading_lti=!0,s.getLtiCustomSharedKey({type:"user"}).$promise.then(function(e){t.shared_sceret=e.shared_sceret,t.consumer_key=e.consumer_key,t.lti_url_xml=e.lti_url_xml,t.lti_url_embed=e.lti_url_embed,t.loading_lti=!1}),t.generateNewLtiKeys=function(){s.generateNewLtiKeys({type:"user"}).$promise.then(function(e){t.consumer_key=e.consumer_key,t.shared_sceret=e.shared_sceret})},t.generateLaunchUrl=function(){l.open({templateUrl:"/views/teacher/course_list/lti_course_list.html",scope:t,controller:"ltiCourseListCtrl"})},t.scroll=function(e){$("body").scrollToThis(0,{offsetTop:0,duration:0}),$("body").scrollToThis("#"+e,{offsetTop:95,duration:0})}}]),angular.module("scalearAngularApp").controller("StudentEnrollModalCtrl",["$rootScope","$scope","$modalInstance","Course","$log","$window","$state","$timeout",function(t,n,a,e,i,r,o,s){r.scrollTo(0,0),n.enrollment={},n.form={},s(function(){$("#enrollkey_field").select()},1e3),n.enrollInputClick=function(e){s(function(){$("#enrollkey_field").focus(),e.stopPropagation()})},n.enrollStudent=function(){i.debug(n),n.form.key.$valid?(n.form.processing=!0,e.enroll({},{unique_identifier:n.enrollment.key},function(e){i.debug(e),n.form.processing=!1,o.go("course.course_information",{course_id:e.course.id,new_enroll:!0}),t.$broadcast("Course:get_current_courses"),a.close(n.enrollment.key)},function(e){n.form.processing=!1,n.form.server_error=e.data.errors.join()})):n.form.submitted=!0},n.cancelEnroll=function(){a.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("CoursesEnrollCtrl",["$scope","Course","$state","$stateParams","$rootScope","$log","ErrorHandler",function(t,e,n,a,i,r,o){e.enroll({},{unique_identifier:a.id},function(e){t.go_to_course(e)},function(e){t.go_to_course(e,!0)}),t.go_to_course=function(e,t){t?n.go("course.course_information",{course_id:e.data.course.id}):n.go("course.course_information",{course_id:e.course.id,new_enroll:!0}),i.$broadcast("Course:get_current_courses")}}]),angular.module("scalearAngularApp").controller("studentCourseInformationCtrl",["$scope","$stateParams","Course","Page","$state","$translate","ContentNavigator","$log","CourseModel","ScalearUtils","$modal",function(n,e,t,a,i,r,o,s,l,u,d){n.course=l.getSelectedCourse(),a.setTitle(r.instant("navigation.information")+": "+n.course.name),o.open(),n.urlWithProtocol=u.urlWithProtocol,i.params.new_enroll&&d.open({templateUrl:"/views/student/course_list/email_due_dates_modal.html",scope:n,controller:["$modalInstance",function(t){n.updateDueDateEmail=function(e){n.email_due_date=e,n.course.updateStudentDueDateEmail(e),t.dismiss("cancel")}}]}),n.course.discussion_link&&(n.short_url=u.shorten(n.course.discussion_link,20)),t.show({course_id:e.course_id},function(e){n.teachers=e.teachers}),n.course.getStudentDueDateEmail().then(function(e){n.email_due_date=e.email_due_date}),n.course.getAnnouncements().then(function(e){n.announcements=e}),n.goToContent=function(){if(-1!=n.course.next_item.module){var e={module_id:n.course.next_item.module};e[n.course.next_item.item.class_name+"_id"]=n.course.next_item.item.id,i.go("course.module.courseware."+n.course.next_item.item.class_name,e)}},n.updateStudentDueDateEmail=function(e){n.course.updateStudentDueDateEmail(e)}}]),angular.module("scalearAngularApp").controller("contentSelectorCtrl",["$scope","$stateParams","Page","$state","$timeout","$rootScope","ContentNavigator","$log",function(e,t,n,a,i,r,o,s){n.setTitle("navigation.information"),o.open()}]),angular.module("scalearAngularApp").controller("studentModuleOverviewCtrl",["$scope","$state","Module","Page",function(t,e,n,a){var i,r;a.setTitle("global.overview"),i=e.params.module_id,r=e.params.course_id,t.module_summary={},t.module_summary.loading={summary:!0,online_quiz:!0,discussion:!0},n.getModuleSummary({module_id:i,course_id:r},function(e){t.module_summary.loading.summary=!1,angular.extend(t.module_summary,e.module)}),n.getOnlineQuizSummary({module_id:i,course_id:r},function(e){t.module_summary.loading.online_quiz=!1,angular.extend(t.module_summary,e.module)}),n.getDiscussionSummary({module_id:i,course_id:r},function(e){t.module_summary.loading.discussion=!1,angular.extend(t.module_summary,e.module)})}]),angular.module("scalearAngularApp").controller("coursewareCtrl",["$scope","$stateParams","$log","Module","Timeline","Page","$state","ModuleModel","ItemsModel","ErrorHandler",function(l,e,u,t,d,n,a,i,c,r){n.setTitle("navigation.lectures"),n.startTour();var o;(o=i.getSelectedModule())&&(l.module_items=o.items,t.getStudentModule({course_id:e.course_id,module_id:o.id},function(e){for(var t in l.module_lectures=e.module_lectures,l.timeline={},l.timeline.lecture={},u.debug("timeline"),l.module_lectures){var n=l.module_lectures[t];l.timeline.lecture[n.id]=new d;var a=c.getLecture(n.id);for(var i in a)null!==a[i]&&void 0!==a[i]||delete a[i];l.timeline.lecture[n.id].meta=angular.extend(n,c.getLecture(n.id));for(var r=n.video_quizzes.length-1;0<=r;r--)0==n.video_quizzes[r].online_answers.length&&"Free Text Question"!=n.video_quizzes[r].question_type?n.video_quizzes.splice(r,1):l.timeline.lecture[n.id].add(n.video_quizzes[r].time,"quiz",n.video_quizzes[r]);for(var o in n.user_confused)l.timeline.lecture[n.id].add(n.user_confused[o].time,"confused",n.user_confused[o]);for(var o in n.posts)l.timeline.lecture[n.id].add(n.posts[o].time,"discussion",n.posts[o]);for(var s in n.lecture_notes)l.timeline.lecture[n.id].add(n.lecture_notes[s].time,"note",n.lecture_notes[s]);for(var s in n.title_markers)l.timeline.lecture[n.id].add(n.title_markers[s].time,"marker",n.title_markers[s])}u.debug("timeline",l.timeline)},function(e){r.showMessage(e.data.errors[0],"errorMessage",4e3,"error"),a.go("course_list")}))}]),angular.module("scalearAngularApp").controller("studentLectureMiddleCtrl",["$scope","$stateParams","Lecture","$interval","$translate","$state","$log","$timeout","Page","$filter","OnlineQuiz","ScalearUtils","ContentNavigator","TimelineNavigator","$rootScope","TimelineFilter","$window","VideoInformation","CourseModel","ModuleModel","ItemsModel","VideoEventLogger","$modal","Course","$q","ErrorHandler","$location","MobileDetector",function(u,e,l,d,o,c,s,r,n,_,t,a,i,m,p,g,h,f,v,b,y,w,k,z,q,x,S,T){u.course=v.getSelectedCourse(),u.video_layer={},u.quiz_layer={},u.lecture_player={},u.lecture_player.controls={},u.lecture_player.events={},u.resize={},u.distance_peer_session_id=null,u.TimelineNavigator=m,u.ContentNavigator=i,T.isPhone()||u.ContentNavigator.open(),u.preview_as_student&&u.TimelineNavigator.open(),u.delayed_timeline_open=u.TimelineNavigator.getStatus(),u.$on("export_notes",function(){u.exportNotes()}),u.$on("timeline_navigator_change",function(e,t){t?u.delayed_timeline_open=t:r(function(){u.delayed_timeline_open=!1},400)}),u.$on("exit_preview",function(){u.lecture_player.element&&(u.skip_pause_update=!0,u.lecture_player.controls.pause())}),u.$watch("distance_peer_session_id",function(e,t){u.distance_peer_session_id&&null!=u.lecture&&(u.distance_peer_status||l.checkIfInDistancePeerSession({course_id:u.lecture.course_id,lecture_id:u.lecture.id}).$promise.then(function(e){"no_peer_session"!=e.distance_peer&&(u.name=e.name,u.distance_peer_status=e.distance_peer.status,F(),u.distance_peer_message_in_box=o.instant("distance_peer.message_video",{name:u.name}),u.lecture_player.events.onReady(!0))}))});var C=function(){u.studentAnswers={},u.explanation={},u.fullscreen=!1,u.total_duration=0,u.elapsed_width=0,u.slow=!1,u.course.warning_message=null,u.video_class="flex-video",u.container_class="",u.passed_requirments=!0,u.lecture=null,u.video_ready=!1,u.show_progressbar=!1,P(),u.next_stop_time=null,u.distance_peer_session_id=null,u.distance_peer_status=null,u.distance_peer_message_in_box=null,u.quiz_cue_distance_peer_list={}},A=function(){u.next_stop_time=null,u.distance_peer_status=null,u.distance_peer_message_in_box=null,u.distance_peer_session_id=null,u.quiz_cue_distance_peer_list={},u.lecture_player.events.onReady(!0)},E=function(){if(p.is_mobile){var e=T.isTablet()?"tiny":"really-tiny";r(function(){$(".button").removeClass("small").addClass(e)})}},M=function(){$("#lecture_container").addClass("ipad"),$(".container").addClass("ipad"),T.isPhone()&&(D(),$(window).bind("orientationchange",D)),E()},D=function(){90==window.orientation||-90==window.orientation?u.TimelineNavigator.close():ee()},P=function(){shortcut.remove("c"),shortcut.remove("q"),shortcut.remove("n"),shortcut.remove("f")},I=function(t){u.timeline&&(r(function(){u.lecture=u.timeline.lecture[t].meta;var e=b.getSelectedModule();n.setTitle(e.name+": "+u.lecture.name+" - "+u.course.name)}),C(),G(),u.closeReviewNotify(),l.getLectureStudent({course_id:c.params.course_id,lecture_id:t},function(e){var t=e.lecture;for(var n in u.next_item=e.next_item,u.alert_messages=e.alert_messages,u.alert_messages)"due"==n?u.course.warning_message=o.instant("events.due_date_passed")+" - "+u.alert_messages[n][0]+" ("+u.alert_messages[n][1]+" "+o.instant("time."+u.alert_messages[n][2])+") "+o.instant("time.ago"):"today"==n&&(u.course.warning_message=o.instant("events.due")+" "+o.instant("time.today")+" "+o.instant("at")+" "+_("date")(u.alert_messages[n],"shortTime"));if(!u.preview_as_student)for(var a in t.requirements)for(var i in t.requirements[a]){y.getById(t.requirements[a][i],a).done||(u.passed_requirments=!1)}u.passed_requirments&&(shortcut.add("c",function(){u.addConfused(),u.$apply()},{disable_in_input:!0}),shortcut.add("q",function(){u.addQuestionBlock(),u.$apply()},{disable_in_input:!0}),shortcut.add("n",function(){u.addNote(),u.$apply()},{disable_in_input:!0}),shortcut.add("f",function(){u.toggleFullscreen(),u.$apply()},{disable_in_input:!0})),r(function(){u.scrollIntoView()},500)}))},L=function(e,t,n){w.log(c.params.course_id,c.params.lecture_id,e,t,n,u.quiz_mode,f.speed,f.volume,u.fullscreen)},U=function(e){var t=u.lecture.video_quizzes.map(function(e){return e.time}).indexOf(e.time);u.next_quiz=null,u.lecture.video_quizzes[t+1]&&u.lecture.video_quizzes[t+1].time-e.time<=1&&(u.next_quiz=u.lecture.video_quizzes[t+1]),u.seek(e.time),u.lecture_player.controls.pause(),u.closeReviewNotify(),u.studentAnswers[e.id]={},u.selected_quiz=e,u.quiz_mode=!0,u.check_answer_title="lectures.button.check_answer",u.selected_quiz.actual_display_text=u.selected_quiz.display_text,u.distance_peer_session_id&&(u.check_answer_title="lectures.button.submit_my_vote"),"html"==e.quiz_type||"html_survey"==e.quiz_type?(s.debug("HTML quiz"),u.quiz_layer.backgroundColor="white",u.quiz_layer.overflowX="hidden",u.quiz_layer.overflowY="auto","DRAG"==e.question_type.toUpperCase()&&(u.studentAnswers[e.id]=e.online_answers_drag)):(u.quiz_layer.backgroundColor="",u.quiz_layer.overflowX="",u.quiz_layer.overflowY=""),"FREE TEXT QUESTION"==e.question_type.toUpperCase()&&(u.studentAnswers[e.id]=""),"survey"!=e.quiz_type&&"FREE TEXT QUESTION"!=e.question_type.toUpperCase()&&"html_survey"!=e.quiz_type||(u.check_answer_title="lectures.button.submit"),u.last_quiz=e,u.backup_quiz=angular.copy(e)},F=function(){1==u.distance_peer_status?u.distance_peer_message_in_box=o.instant("distance_peer.the_another_student_finished_message_video",{name:u.name}):2==u.distance_peer_status?u.distance_peer_message_in_box=o.instant("distance_peer.the_another_student_finished_message_quiz_intro",{name:u.name}):3==u.distance_peer_status?u.distance_peer_message_in_box=o.instant("distance_peer.the_another_student_finished_message_quiz_self",{name:u.name}):4==u.distance_peer_status?u.distance_peer_message_in_box=o.instant("distance_peer.the_another_student_finished_message_quiz_group",{name:u.name}):5==u.distance_peer_status&&(u.distance_peer_message_in_box=o.instant("distance_peer.the_another_student_finished_message_quiz_end",{name:u.name}))},Q=function(e){2==e?me(o.instant("distance_peer.waiting_message_quiz_intro_after_video")):3==e?me(o.instant("distance_peer.waiting_message_quiz_self_after_intro")):4==e?me(o.instant("distance_peer.waiting_message_quiz_group_after_self")):5==e?me(o.instant("distance_peer.waiting_message_quiz_end_after_group")):1==e&&me(o.instant("distance_peer.waiting_message_video_after_quiz_end"))},O=function(e,n,a,i){l.checkIfDistancePeerStatusIsSync({course_id:u.lecture.course_id,lecture_id:u.lecture.id,distance_peer_id:e}).$promise.then(function(e){if("start"==e.status&&(N(),u.distance_peer_status=n,F(),1==u.distance_peer_status?me(o.instant("distance_peer.the_another_student_finished_message_video")):2==u.distance_peer_status?me(o.instant("distance_peer.the_another_student_finished_message_quiz_intro")):3==u.distance_peer_status?me(o.instant("distance_peer.the_another_student_finished_message_quiz_self")):4==u.distance_peer_status?me(o.instant("distance_peer.the_another_student_finished_message_quiz_group")):5==u.distance_peer_status&&me(o.instant("distance_peer.the_another_student_finished_message_quiz_end")),u.next_stop_time=a,be(),3==n||4==n)){u.hide_quiz_button=!0,U(i),d(function(){u.hide_quiz_button=!1},5e3);var t=3==n?i.self:i.in_group;u.selected_quiz.online_answers.forEach(function(e){e.selected&&(e.selected=null)}),ye(t),ve()}})},N=function(){u.check_if_distance_peer_is_sync&&d.cancel(u.check_if_distance_peer_is_sync),u.session_votes=null},H=function(r,o,s){var e="do_not_updated";6!=r&&(e=s.id),u.lecture_player.controls.pause(),l.changeStatusDistancePeer({course_id:u.lecture.course_id,lecture_id:u.lecture.id,status:r,online_quiz_id:e,distance_peer_id:u.distance_peer_session_id}).$promise.then(function(e){var t,n,a,i;6!=r?(t=u.distance_peer_session_id,n=r,a=o,i=s,u.check_if_distance_peer_is_sync=d(function(){O(t,n,a,i)},5e3),Q(r)):(A(),N(),_e())})},V=function(e,t){var n=u.lecture.video_quizzes.map(function(e){return e.time}).indexOf(e.time);if(e.start_time!=e.time)u.lecture_player.controls.cue(u.lecture.start_time+e.start_time,function(){u.lecture.start_time+e.start_time>=u.next_stop_time&&H(2,e.time,e)});u.lecture_player.controls.cue(u.lecture.start_time+e.time,function(){u.lecture.start_time+e.time>=u.next_stop_time&&2==u.distance_peer_status&&H(3,e.time,e),3==u.distance_peer_status?U(e):4==u.distance_peer_status&&U(e)}),u.lecture_player.controls.cue(u.lecture.start_time+(e.end_time+.6),function(){u.lecture.start_time+e.end_time>=u.next_stop_time&&(null!=u.lecture.video_quizzes[n+1]?H(1,u.lecture.video_quizzes[n+1].start_time,e):H(1,u.total_duration,e))})};u.lecture_player.events.onReady=function(e){u.slow=!1,u.total_duration=u.lecture_player.controls.getDuration(),u.lecture_player.controls.removeAllTrackEvents();for(var t=[0],a=0,n=30;n<u.total_duration;n+=30)t.push(n/u.total_duration*100);we().then(function(){e||!u.lecture.distance_peer||u.distance_peer_session_id||u.openStudentList(u.lecture.id,u.lecture.course_id);var n=0;u.lecture.video_quizzes&&u.lecture.video_quizzes.forEach(function(e,t){e.time>=u.total_duration-2&&(e.time=u.total_duration-2+n,n+=.2),u.lecture.distance_peer&&u.distance_peer_session_id?e.id in u.quiz_cue_distance_peer_list?e.id in u.quiz_cue_distance_peer_list||(a=u.lecture_player.controls.cue(u.lecture.start_time+e.start_time,function(){V(e)}),u.quiz_cue_distance_peer_list[e.id]=a.id):a=u.lecture_player.controls.cue(u.lecture.start_time+e.start_time,function(){V(e)}):u.lecture_player.controls.cue(u.lecture.start_time+(e.time-.1),function(){U(e)})})}),u.lecture.annotations&&u.lecture.annotations.forEach(function(e){e.annotation&&(u.lecture_player.controls.cue(u.lecture.start_time+(e.time-.1),function(){e.as_slide?(u.lecture_player.controls.pause(),ge(e)):pe(e)}),e.as_slide||u.lecture_player.controls.cue(u.lecture.start_time+(e.time-.1+e.duration),function(){u.dismissDynamicAnnotation()}))}),t.forEach(function(e){u.lecture_player.controls.cue(u.total_duration*e/100,function(){R(e,"mile_cue")})}),u.video_ready=!0,u.lecture_player.controls.youtube&&p.is_mobile||(u.show_progressbar=!0);var i=c.params.time;i?(r(function(e){u.seek(i)}),r(function(){u.scrollIntoView()},500),S.search("time",0)):p.is_mobile||(u.lecture_player.controls.seek(0),u.lecture_player.controls.pause())};var R=function(t,n){if(!u.lecture.watched_percentage||t>u.lecture.watched_percentage||100==u.lecture.watched_percentage&&!u.lecture.done){var a=u.lecture;return u.not_done_msg=!1,a.updateViewPercentage(t).then(function(e){u.last_navigator_state=u.ContentNavigator.getStatus(),e.lecture_done&&!a.done?a.markDone():100==t&&(u.not_done_msg=!0),s.debug("Watched:"+e.watched+"% solved:"+e.quizzes_done[0]+" total:"+e.quizzes_done[1],n),u.lecture.watched_percentage=e.watched,u.lecture.quiz_percentage=e.quizzes_done[0]+" / "+e.quizzes_done[1]})}return q.when({})};u.scrollIntoView=function(){u.lecture&&$(".student_timeline").scrollToThis("#outline_"+u.lecture.id,{offsetTop:$(".student_timeline").offset().top,duration:400})},u.nextItem=function(){if(u.next_item.id)if(u.last_navigator_state||i.close(),"lecture"==u.next_item.class_name)u.seek(null,u.next_item.id);else{var e="course.module.courseware."+u.next_item.class_name,t={};t[u.next_item.class_name+"_id"]=u.next_item.id,t.module_id=u.next_item.group_id,c.go(e,t)}},u.replay=function(){u.seek(0),r(function(){u.lecture_player.controls.play()},1e3)},u.refreshVideo=function(){u.slow=!1;var e=u.lecture.url;u.lecture.url="",r(function(){u.lecture.url=e})},u.seek=function(e,t){u.closeReviewNotify(),u.dismissAnnotation(),u.dismissDynamicAnnotation();var n=u.lecture_player.controls.getTime(),a=Math.round(n/u.total_duration*100);u.seek_to_time=e;var i=Math.round(u.seek_to_time/u.total_duration*100);u.lecture.watched_percentage<a&&i<a&&R(a,"seek"),t&&t!=u.lecture.id?(c.go("course.module.courseware.lecture",{lecture_id:t},{reload:!1,notify:!1}),I(t),u.go_to_time=e):u.next_stop_time<e&&u.distance_peer_session_id?(u.lecture_player.controls.pause(),me(o.instant("distance_peer.prevent_seek_forward"))):(u.lecture.skip_ahead||i<Math.max(u.lecture.watched_percentage,a))&&0<=e&&u.show_progressbar&&(u.lecture_player.controls.seek(e),u.log_event_timeout||(u.log_event_timeout=r(function(){L("seek",n,u.seek_to_time),R(i,"seek"),u.log_event_timeout=null},1e3))),u.video_end=!1},u.seek_and_pause=function(e,t){u.lecture_player.controls.getTime()!=e&&G(),u.skip_pause_update=!0,u.seek(e,t),u.lecture_player.controls.pause()},u.progressSeek=function(e){u.seek(e),B(),j()};var B=function(){if(u.distance_peer_session_id){if(u.quiz_mode)if(u.selected_quiz.graded&&u.lecture_player.controls.getTime()>=u.selected_quiz.time)if("html"==u.selected_quiz.quiz_type||"html_survey"==u.selected_quiz.quiz_type)u.answer_form.$error.atleastone?W(u.selected_quiz.time):G();else{var t=[];u.selected_quiz.online_answers.forEach(function(e){e.selected&&t.push(e.id)}),0==t.length?W(u.selected_quiz.time):G()}else u.display_review_message&&(se(),u.display_review_message=!1),G(),u.next_quiz&&U(u.next_quiz)}else u.quiz_mode&&(!u.selected_quiz.solved_quiz&&u.selected_quiz.graded&&u.lecture_player.controls.getTime()>=u.selected_quiz.time?W(u.selected_quiz.time):(u.display_review_message&&(se(),u.display_review_message=!1),G(),u.next_quiz&&U(u.next_quiz)))},j=function(){u.slide_note&&K(u.slide_note.time)},G=function(){u.selected_quiz="",u.quiz_mode=!1,u.quiz_layer.backgroundColor="",u.quiz_layer.overflowX="",u.quiz_layer.overflowY=""},W=function(e){u.seek(e),u.lecture_player.controls.pause(),Y("lectures.choose_correct_answer")},K=function(e){u.seek(e),u.lecture_player.controls.pause()};u.lecture_player.events.onPlay=function(){s.debug("playing "),B(),j(),u.dismissAnnotation(),!u.quiz_mode&&u.distance_peer_session_id&&he(),u.video_end=!1,L("play",u.lecture_player.controls.getTime()),T.isPhone()&&u.temp_timeline_item&&((u.temp_timeline_item.type="discussion")&&u.$emit("remove_from_timeline",u.temp_timeline_item),de())},u.lecture_player.events.onPause=function(){if(!u.skip_pause_update){s.debug("pausing");var e=u.lecture_player.controls.getTime(),t=Math.round(e/u.total_duration*100);L("pause",e),R(t,"pause")}u.skip_pause_update=!1},u.lecture_player.events.onEnd=function(){u.video_end=!0,R(100,"end")},u.lecture_player.events.onSlow=function(e){s.debug("youtube is"),s.debug(e),u.is_youtube=e,u.slow=!0},u.lecture_player.events.canPlay=function(){if(u.go_to_time){if(0<=u.go_to_time)var e=u.go_to_time;r(function(){u.seek_and_pause(e)}),u.go_to_time=null}},u.lecture_player.events.waiting=function(){p.is_mobile&&!u.show_progressbar&&(u.video_ready=!0,u.show_progressbar=!0,T.isPhone()&&X())};var Y=function(e,t,n){u.notification_message=o.instant(e),u.notification_middle_message=o.instant(n),u.notification_submessage=o.instant(t),d(function(){J()},3e3,1)},J=function(){u.notification_message&&(u.notification_message=null,window.onmousemove=null)};u.toggleFullscreen=function(){u.fullscreen?Z():X(),L("fullscreen",u.lecture_player.controls.getTime())},u.toggleVideoPlayback=function(){u.lecture_player.controls.paused()?u.lecture_player.controls.play():u.lecture_player.controls.pause()};var X=function(){if(u.fullscreen=!0,p.is_mobile){function t(){u.video_layer.height=angular.element(h).height()-70,u.resize.big(),u.$apply()}u.resize.big(),u.container_class="mobile_video_full",u.video_layer={width:"100%",height:angular.element(h).height()-70,position:"relative"},E(),T.isPhone()&&(u.video_layer.paddingBottom="0"),$(window).bind("orientationchange",function(e){T.isAndroid()?r(t,200):t()})}else"4:3"==a.calculateScreenRatio()?u.video_layer={marginTop:"5.5%",marginBottom:"5.5%"}:"16:9"==a.calculateScreenRatio()&&(u.distance_peer_session_id?u.video_layer={paddingBottom:"44.7%"}:u.video_layer={paddingBottom:"51.7%"})},Z=function(){u.fullscreen=!1,u.video_layer={},p.is_mobile&&(u.resize.small(),u.container_class="",$(window).off("orientationchange"),T.isPhone()&&($(window).bind("orientationchange",D),de()),E())};u.playOnPhone=function(){u.toggleVideoPlayback()};var ee=function(){u.TimelineNavigator.open(),r(function(){u.scrollIntoView()})};u.addQuestionBlock=function(){var e=u.lecture_player.controls.getTime();if(u.last_fullscreen_state=u.fullscreen,u.last_video_state=!u.lecture_player.controls.paused(),u.lecture_player.controls.pause(),g.set("discussion",!0),u.last_timeline_state=!u.TimelineNavigator.getStatus(),u.last_discussion){var t=u.timeline.lecture[c.params.lecture_id].items[u.last_discussion];u.last_discussion=null,u.$broadcast("post_question",t)}u.last_discussion=u.timeline.lecture[c.params.lecture_id].add(e,"discussion",null),T.isPhone()&&u.fullscreen?u.temp_timeline_item=u.timeline.lecture[c.params.lecture_id].items[u.last_discussion]:(Z(),ee())},u.addConfused=function(){var n=u.lecture_player.controls.getTime();l.confused({course_id:c.params.course_id,lecture_id:c.params.lecture_id},{time:n},function(e){if("ask"==e.msg&&Y("lectures.messages.really_confused_use_question"),e.flag||u.timeline.lecture[c.params.lecture_id].add(n,"confused",e.item),e.flag&&"ask"!=e.msg){var t=u.timeline.lecture[c.params.lecture_id].getIndexById(e.id,"confused");u.timeline.lecture[c.params.lecture_id].items[t].data.very=!0}})},u.addNote=function(){var e=u.lecture_player.controls.getTime();u.last_fullscreen_state=u.fullscreen,u.last_video_state=!u.lecture_player.controls.paused(),g.set("note",!0),u.lecture_player.controls.pause(),T.isPhone()&&u.fullscreen?(u.temp_timeline_item={time:e,type:"note",data:null},r(function(){$(".note-textarea").focus(),$(".note-textarea").on("blur",function(){u.temp_timeline_item.data?te(u.temp_timeline_item):ue()})})):(u.timeline.lecture[c.params.lecture_id].add(e,"note",null),u.last_timeline_state=!u.TimelineNavigator.getStatus(),Z(),ee())};var te=function(t){l.saveNote({course_id:c.params.course_id,lecture_id:c.params.lecture_id,note_id:null},{data:t.data,time:t.time},function(e){u.timeline.lecture[c.params.lecture_id].add(t.time,"note",e.note),ue()})};u.checkAnswer=function(){"html"==u.selected_quiz.quiz_type||"html_survey"==u.selected_quiz.quiz_type?ne():ae()};var ne=function(){u.answer_form.$error.atleastone||"Free Text Question"==u.selected_quiz.question_type&&u.answer_form.$error.required?(s.debug("invalid form"),u.submitted=!0):(s.debug("valid form"),u.submitted=!1,l.saveHtml({course_id:c.params.course_id,lecture_id:c.params.lecture_id},{quiz:u.selected_quiz.id,answer:u.studentAnswers[u.selected_quiz.id],in_group:4==u.distance_peer_status,distance_peer:null!=u.distance_peer_session_id},function(e){re(e),"Free Text Question"==u.selected_quiz.question_type&&ie(u.studentAnswers[u.selected_quiz.id])}))},ae=function(){var t;if("OCQ"==u.selected_quiz.question_type||"MCQ"==u.selected_quiz.question_type){if(t=[],u.selected_quiz.online_answers.forEach(function(e){e.selected&&t.push(e.id)}),0==t.length)return void Y("lectures.choose_correct_answer");"OCQ"==u.selected_quiz.question_type&&1==t.length&&(t=t[0])}else if("Free Text Question"==u.selected_quiz.question_type){if(!(t=u.studentAnswers[u.selected_quiz.id]))return void Y("global.required")}else{t={},t=u.studentAnswers[u.selected_quiz.id];var e=0;for(var n in t)t[n]&&e++;if(e<u.selected_quiz.online_answers.length)return void Y("lectures.must_place_items")}l.saveOnline({course_id:c.params.course_id,lecture_id:c.params.lecture_id},{quiz:u.selected_quiz.id,answer:t,in_group:4==u.distance_peer_status,distance_peer:null!=u.distance_peer_session_id},function(e){re(e),"Free Text Question"==u.selected_quiz.question_type&&ie(t)})},ie=function(e){e="Quiz: "+u.selected_quiz.question+"\nAnswer: "+e,l.saveNote({course_id:c.params.course_id,lecture_id:c.params.lecture_id,note_id:null},{data:e,time:u.selected_quiz.time},function(e){u.timeline.lecture[c.params.lecture_id].add(u.selected_quiz.time,"note",e.note)})},re=function(e){u.distance_peer_session_id&&3==u.distance_peer_status?(be(),H(4,u.selected_quiz.time,u.selected_quiz)):u.distance_peer_session_id&&4==u.distance_peer_status?(be(),H(5,u.selected_quiz.end_time,u.selected_quiz)):oe(e)};u.correct_selections=!1;var oe=function(e){if("Empty"!=e.msg){var t="";if("survey"==u.selected_quiz.quiz_type||"html_survey"==u.selected_quiz.quiz_type||"FREE TEXT QUESTION"==u.selected_quiz.question_type.toUpperCase()&&e.review){if(u.selected_quiz.solved_quiz=!0,"survey"!=u.selected_quiz.quiz_type&&"html_survey"!=u.selected_quiz.quiz_type&&"html"!=u.selected_quiz.quiz_type&&"FREE TEXT QUESTION"!==u.selected_quiz.question_type.toUpperCase())var n=p.is_mobile?"lectures.tap_for_explanation":"lectures.hover_for_explanation";if("FREE TEXT QUESTION"==u.selected_quiz.question_type.toUpperCase())for(var a in t="lectures.messages.press_to_continue",e.explanation)u.explanation[a]=e.explanation[a];Y("lectures.messages.thank_you_answer",n||"",t||"")}else{for(var a in e.detailed_exp)u.explanation[a]=e.detailed_exp[a];var i=e.correct?"lectures.correct":"lectures.incorrect";u.correct_selections=!!e.correct;n="";if("html"!=u.selected_quiz.quiz_type||"DRAG"!=u.selected_quiz.question_type.toUpperCase()&&"FREE TEXT QUESTION"!=u.selected_quiz.question_type.toUpperCase())"MCQ"!=u.selected_quiz.question_type.toUpperCase()||e.correct||(t="lectures.multiple_correct");else for(var a in e.explanation)u.explanation[a]=e.explanation[a];n=p.is_mobile?"lectures.tap_for_explanation":"lectures.hover_for_explanation","FREE TEXT QUESTION"==u.selected_quiz.question_type.toUpperCase()&&(t="lectures.messages.press_to_continue",n=""),e.correct||"DRAG"!=u.selected_quiz.question_type.toUpperCase()||"HTML"!=u.selected_quiz.quiz_type.toUpperCase()||(n=""),Y(i,n,t),u.selected_quiz.solved_quiz=!0}u.display_review_message=!0;var r=Math.round(u.lecture_player.controls.getTime()/u.total_duration*100);s.debug("current watched: "+r),R(r,"solved_quiz")}d(function(){window.onmousemove=function(){J(),u.$apply()}},1500,1)},se=function(){if("survey"!=u.selected_quiz.quiz_type&&!u.review_inclass&&!u.review_inclass_inprogress){s.debug("review inclass"),u.review_inclass_inprogress=!0;var e=10,t=le(u.selected_quiz.time,10);t?e=(t-u.selected_quiz.time)/2:u.total_duration-u.selected_quiz.time<=10&&(e=(u.total_duration-u.selected_quiz.time)/2),d(function(){u.review_inclass_inprogress=!1,$("#review_inclass").fadeIn("fast"),d(function(){u.closeReviewNotify()},7500,1)},1e3*e,1)}},le=function(e,t){for(var n in u.lecture.video_quizzes)if(u.lecture.video_quizzes[n].time>e&&u.lecture.video_quizzes[n].time<=e+t)return u.lecture.video_quizzes[n].time};u.voteForReview=function(){s.debug("vote review"),t.voteForReview({online_quizzes_id:u.last_quiz.id},{},function(e){e.done&&(u.last_quiz.reviewed||(u.last_quiz.reviewed=!0,u.last_quiz.votes_count+=1),u.closeReviewNotify())})},u.unvoteForReview=function(){t.unvoteForReview({online_quizzes_id:u.last_quiz.id},{},function(e){e.done&&(u.last_quiz.reviewed&&(u.last_quiz.reviewed=!1,u.last_quiz.votes_count--),u.closeReviewNotify())})},u.closeReviewNotify=function(){$("#review_inclass").fadeOut("fast")},u.retryQuiz=function(){u.explanation={},u.selected_quiz=u.backup_quiz,u.seek_and_pause(u.backup_quiz.time),u.closeReviewNotify()},u.exportNotes=function(){l.exportNotes({course_id:c.params.course_id,lecture_id:c.params.lecture_id},function(e){for(var t,n=angular.fromJson(e),a=[],i=0;i<n.notes.length;i++)2<n.notes[i].length&&(t=angular.fromJson(n.notes[i]),a.push(t));u.Notes=a;var r=document.URL.split("lectures")[0],o=window.open("","_blank");if(o){o.focus();var s='<html><head><title>ScalableLearning - Export Notes</title><style>body{font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;}.table {width: 100%;margin-bottom: 20px; margin: 0 auto;background: white;border: 1px solid lightgrey;}.table td {padding: 8px;line-height: 20px;text-align: left;vertical-align: top;border-top: 1px solid #dddddd; border-right: 1px solid #dddddd;}.table th {font-weight: bold;}.table thead th {vertical-align: bottom;} a{color: green; text-decoration: none;} a:hover{color: darkgreen;}</style></head><body>';for(i=0;i<a.length;i++){s+='<table class="table" style="width:90%">',s+="<h3>"+a[i][0].lecture.name+"</h3>";for(var l=0;l<a[i].length;l++)s+="<tr>",s+="<td>"+_("formattime")(a[i][l].time,"hh:mm:ss")+"</td>",s+="<td>"+a[i][l].data+"</td>",s+='<td><a target="_blank" href="'+r+"lectures/"+a[i][l].lecture.id+"?time="+a[i][l].time+'">go to video</a></td>',s+="</tr>";s+="</table>"}s+="<br /><a href='data:Application/octet-stream,"+encodeURIComponent(s)+'\'Download = "Notes.html">Download Notes</a>',s+="</body></html>",o.document.write(s),o.document.close()}},function(){})},u.$on("note_updated",function(){ue()}),u.$on("discussion_updated",function(){ue()});var ue=function(){u.last_fullscreen_state&&!u.fullscreen&&X(),u.last_video_state&&u.lecture_player.controls.paused()&&!u.quiz_mode&&u.lecture_player.controls.play(),u.last_timeline_state&&u.TimelineNavigator.getStatus()&&r(function(){u.TimelineNavigator.close()},400),de()},de=function(){u.temp_timeline_item=null,u.last_fullscreen_state=null,u.last_video_state=null,u.last_timeline_state=null};u.dismissAnnotation=function(){u.annotation=null},u.dismissDynamicAnnotation=function(){u.dynamic_annotation=null},u.dismissSlideNote=function(){u.slide_note=null},u.dismissQuestionText=function(){u.selected_quiz.actual_display_text=null},u.endDistancePeerSession=function(){u.dismissAnnotation(),u.dismissDynamicAnnotation(),u.dismissSlideNote(),G(),H(6,null)},u.lectureLayerClick=function(){u.quiz_mode||u.dynamic_annotation&&(!u.dynamic_annotation||u.dynamic_annotation.as_slide)||u.toggleVideoPlayback()};var ce=function(){u.check_if_distance_peer_is_alive_timer=d(function(){l.checkIfDistancePeerIsAlive({course_id:u.lecture.course_id,lecture_id:u.lecture.id,distance_peer_id:u.distance_peer_session_id}).$promise.then(function(e){"dead"==e.status&&(_e(),me(o.instant("distance_peer.other_student_ended_session",{name:u.name})),A(),N(),be(),G())})},2e4)},_e=function(){u.check_if_distance_peer_is_alive_timer&&d.cancel(u.check_if_distance_peer_is_alive_timer)},me=function(e){u.dismissDynamicAnnotation(),u.dismissSlideNote(),u.annotation=e},pe=function(e){u.dismissAnnotation(),u.dismissSlideNote(),u.dynamic_annotation=e},ge=function(e){u.dismissAnnotation(),u.dismissDynamicAnnotation(),u.slide_note=e},he=function(){parseInt(u.lecture_player.controls.getTime().toFixed(2))>=parseInt(u.next_stop_time.toFixed(2))&&(u.seek(u.next_stop_time),u.lecture_player.controls.pause(),5==u.distance_peer_status?Q(1):Q(u.distance_peer_status+1))},fe=function(){0==u.status_counter?be():u.status_counter--},ve=function(){u.status_timer=d(fe,1e3)},be=function(){u.status_timer&&(d.cancel(u.status_timer),u.status_timer=null)},ye=function(e){u.status_counter=e},we=function(){u.check_peer_fuction_is_called=!0;var i=q.defer();return u.lecture?l.checkIfInDistancePeerSession({course_id:u.lecture.course_id,lecture_id:u.lecture.id}).$promise.then(function(e){if("no_peer_session"!=e.distance_peer){u.distance_peer_session_id=e.distance_peer.distance_peer_id,ce(),u.name=e.name,u.distance_peer_status=e.distance_peer.status,F();var t=u.lecture.video_quizzes.map(function(e){return e.id}).indexOf(e.distance_peer.online_quiz_id);if(1==u.distance_peer_status&&(u.lecture.video_quizzes[t+1]?u.next_stop_time=u.lecture.video_quizzes[t+1].start_time:u.next_stop_time=u.total_duration),-1==t&&(t=0),u.lecture.video_quizzes[t]){if(5==u.distance_peer_status)u.next_stop_time=u.lecture.video_quizzes[t].end_time;else if(-1!=[2,3,4].indexOf(u.distance_peer_status)&&(u.next_stop_time=u.lecture.video_quizzes[t].time,-1!=[3,4].indexOf(u.distance_peer_status))){if(U(u.lecture.video_quizzes[t]),3==u.distance_peer_status)var n=u.lecture.video_quizzes[t].self;else n=u.lecture.video_quizzes[t].in_group;ye(n),ve()}if(!(u.lecture.video_quizzes[t].id in u.quiz_cue_distance_peer_list)){var a=u.lecture_player.controls.cue(u.next_stop_time,function(){V(u.lecture.video_quizzes[t])});u.quiz_cue_distance_peer_list[u.lecture.video_quizzes[t].id]=a.id}}else u.next_stop_time=u.total_duration}i.resolve()}):i.resolve(),i.promise};u.openStudentList=function(i,r){k.open({templateUrl:"/views/student/inclass/distance_peer_modal.html",scope:u,controller:["$modalInstance",function(e){u.waiting_response_of_back_end=!0,u.check_if_invited=!1,u.wait_for_acceptance=!1,u.invite_student=!1,u.invited_student={},u.loading_students=!0,u.inviteStudent=function(t){u.waiting_response_of_back_end=!0,u.invite_student=!1,l.invitedStudent({course_id:r,lecture_id:i,email:t.email}).$promise.then(function(e){u.waiting_response_of_back_end=!1,u.check_if_invited=!1,u.wait_for_acceptance=!0,u.invite_student=!1,u.invited_student=t.email,u.distance_peer_id=e.distance_peer_id,n()})},u.changeToInviteStatus=function(){u.waiting_response_of_back_end=!1,u.check_if_invited=!1,u.wait_for_acceptance=!1,u.invite_student=!0,u.invited_student={}},u.checkIfInvitedByOrInvited=function(){l.checkIfInvited({course_id:r,lecture_id:i}).$promise.then(function(e){"no_invitation"==e.invite_status?(u.waiting_response_of_back_end=!1,u.check_if_invited=!1,u.wait_for_acceptance=!1,u.invite_student=!0,u.students=e.students):"invited"==e.invite_status?(u.waiting_response_of_back_end=!1,u.check_if_invited=!1,u.wait_for_acceptance=!0,u.invite_student=!1,u.invited_student=e.invite,u.distance_peer_id=e.distance_peer_id,n()):"invited_by"==e.invite_status&&(u.waiting_response_of_back_end=!1,u.check_if_invited=!0,u.cancelled_invited_by_student=null,u.wait_for_acceptance=!1,u.invite_student=!1,u.invited_by_student=e.invite)})},u.acceptInvation=function(n){l.acceptInvation({course_id:r,lecture_id:i,email:n[0],distance_peer_id:n[1]}).$promise.then(function(e){if("cancelled"!=e.status)u.distance_peer_session_id=n[1],u.closeModal();else{var t=u.invited_by_student.findIndex(function(e){return e[1]==n[1]});u.invited_by_student.splice(t,1),u.cancelled_invited_by_student=o.instant("distance_peer.student_cancelled",{name:n[0]})}})},u.caneclAllDistancePeerSession=function(){u.invited_by_student.forEach(function(e){u.caneclDistancePeerSession(e[1])})},u.caneclDistancePeerSession=function(e){l.caneclDistancePeerSession({course_id:r,lecture_id:i,distance_peer_id:e}),a()};var n=function(){u.check_invited_student_accepted_timer=d(function(){var e,t;e=u.invited_student,t=u.distance_peer_id,l.checkInvitedStudentAccepted({course_id:r,lecture_id:i,email:e,distance_peer_id:t}).$promise.then(function(e){0!=e.status&&(a(),"denied"==e.status?u.invited_student+=" denied your invation":1!=e.status&&2!=e.status||(u.distance_peer_session_id=u.distance_peer_id,u.closeModal()))})},5e3)},a=function(){u.check_invited_student_accepted_timer&&d.cancel(u.check_invited_student_accepted_timer),u.session_votes=null};u.closeModal=function(){e.dismiss("cancel"),a()},u.checkIfInvitedByOrInvited()}]})},function(){if(C(),p.is_mobile?M():document.addEventListener(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen||(Z(),u.$apply())}),u.$watch("timeline",function(){u.timeline&&I(c.params.lecture_id)}),u.$on("remove_from_timeline",function(e,t){if(u.timeline){var n=t.data?t.data.lecture_id:c.params.lecture_id,a=u.timeline.lecture[n].items.indexOf(t);u.timeline.lecture[n].items.splice(a,1)}}),!u.preview_as_student)var l=p.$on("$stateChangeStart",function(e,t,n,a,i,r){var o=u.lecture_player.controls.getTime();if(o){e.preventDefault();var s=Math.round(o/u.total_duration*100);R(s,"seek").then(function(){c.go(t,n,r)}),l()}})}()}]),angular.module("scalearAngularApp").controller("studentInclassCtrl",["$scope","ContentNavigator","MobileDetector","Module","$state","$log","$interval","Lecture","Page","WizardHandler","$cookieStore","CourseModel","ModuleModel","$timeout",function(r,e,t,n,o,a,i,s,l,u,d,c,_,m){t.isPhone()&&m(function(){e.close()});var p=d.get("self_answers")||[],g=d.get("group_answers")||[],h=["noclass","intro","self","group","discussion"];r.course=c.getSelectedCourse(),r.module=_.getSelectedModule(),l.setTitle(r.module.name+": In-class - "+r.course.name);var f=function(e){n.getInclassStudentStatus({module_id:o.params.module_id,course_id:o.params.course_id,status:r.inclass_status||0,quiz_id:r.quiz?r.quiz.id:-1},e)};r.getInclassStudentStatus=function(){r.loading=!0,f(function(e){r.loading=!1,e.updated&&(r.quiz=e.quiz,r.quiz.in_group=!1,r.group_quiz=angular.copy(r.quiz),r.group_quiz.in_group=!0,r.lecture=e.lecture,$(".answer_choices input").attr("type","MCQ"==r.quiz.question_type?"checkbox":"radio"),0<p.length&&p.forEach(function(t){var e=r.quiz.answers.filter(function(e){return e.id==t.id});e.length&&(e[0].selected=!0)}),0<g.length&&g.forEach(function(t){var e=r.group_quiz.answers.filter(function(e){return e.id==t.id});e.length&&(e[0].selected=!0)}),r.note={self:"",group:""},r.last_note={self:"",group:""}),r.inclass_status!=e.status?(r.inclass_status=e.status,u.wizard().goTo(h[r.inclass_status]),r.inclass_status<2&&(w(),r.note={self:"",group:""},r.last_note={self:"",group:""})):2!=r.inclass_status&&3!=r.inclass_status||(r.showWaitNotification("Please wait for the teacher to continue."),i(function(){r.removeWaitNotification()},5e3,1))})},r.getInclassStudentStatus();var v=function(e){e.answers.forEach(function(e){e.selected=!1}),2==r.inclass_status?p=[]:3==r.inclass_status&&(g=[])},b=function(e,t){var n,a,i;if("OCQ"==e.question_type||"MCQ"==e.question_type){if(n=[],e.answers.forEach(function(e){e.selected&&n.push(e.id)}),0==n.length)return r.showNotification("lectures.messages.please_choose_an_answer"),!1;"OCQ"==e.question_type&&1==n.length&&(n=n[0])}return e.done=!0,i=n,"OCQ"!=(a=e).question_type&&"MCQ"!=a.question_type||s.saveOnline({course_id:o.params.course_id,lecture_id:r.lecture.id},{quiz:a.id,answer:i,in_group:a.in_group,inclass:!0}),!0},y=function(){var e,t,n={},a=0,i=null;if("OCQ"==quiz.question_type||"MCQ"==quiz.question_type){if(quiz.answers.forEach(function(e){n[e.id]=e.selected,e.selected&&(a++,i=e.id)}),0==a)return r.showNotification("lectures.messages.please_choose_an_answer"),!1;"OCQ"==quiz.question_type&&i&&(n=i)}return quiz.done=!0,e=quiz,t=n,s.saveHtml({course_id:o.params.course_id,lecture_id:r.lecture.id},{quiz:e.id,answer:t,in_group:e.in_group,inclass:!0}),!0};r.checkAnswer=function(e,t){var n,a,i;r.removeNotification(),("html"==e.quiz_type?y():b(e))&&(t&&r.last_note[e.in_group?"group: ":"self"]!==t&&(n=t,a=Math.ceil(e.time),i=e.in_group,s.saveNote({course_id:o.params.course_id,lecture_id:r.lecture.id,note_id:null},{data:(i?"In Class Group Note: ":"In Class Self Note: ")+n,time:a},function(e){r.last_note[i?"group: ":"self"]=n})),u.wizard().next())},r.showNotification=function(e){r.alert_message=e},r.removeNotification=function(){r.alert_message=""},r.showWaitNotification=function(e){r.wait_alert_message=e},r.removeWaitNotification=function(){r.wait_alert_message=""},r.retry=function(e){e.done=!1,v(e)},r.intToChar=function(e){return String.fromCharCode(97+e).toUpperCase()};var w=function(){d.remove("self_answers"),d.remove("group_answers")};r.selectAnswer=function(t,e){var n,a;t.selected?(2==r.inclass_status?p=p.filter(function(e){return e.id!=t.id}):3==r.inclass_status&&(g=g.filter(function(e){return e.id!=t.id})),t.selected=!1):("OCQ"==r.quiz.question_type&&v(e),t.selected=!0,2==r.inclass_status?p.push(t):3==r.inclass_status&&g.push(t)),w(),n=p,a=g,d.put("self_answers",n),d.put("group_answers",a)},r.retry=function(t){f(function(e){"self"==t&&3==e.status||"group"==t&&4==e.status?(r.showWaitNotification("Please click on 'Next' to continue."),i(function(){r.removeWaitNotification()},5e3)):u.wizard().previous()})}}]),angular.module("scalearAngularApp").controller("studentQuizMiddleCtrl",["$scope","Course","$stateParams","$controller","Quiz","$log","CourseEditor","$state","Page","ScalearUtils","$translate","ContentNavigator","CourseModel","ItemsModel","QuestionModel","ErrorHandler","MobileDetector",function(i,e,t,n,a,r,o,s,l,u,d,c,_,m,p,g,h){n("surveysCtrl",{$scope:i}),i.course=_.getSelectedCourse(),i.quiz=m.getQuiz(t.quiz_id);i.nextItem=function(){var e="course.module.courseware."+i.next_item.class_name,t={};t[i.next_item.class_name+"_id"]=i.next_item.id,t.module_id=i.next_item.group_id,r.debug(e),s.go(e,t)},i.selectionUpdateTime,i.saveQuiz=function(e){(null==i.status||i.status.attempts<=i.quiz.retries)&&(i.save_inprogress=!0,i.form.$valid||"save"==e?(i.submitted=!1,i.quiz.studentSolve(i.studentAnswers,e).then(function(e){null!==e.status&&(i.selectionUpdateTime=new Date(e.status.updated_at).toLocaleString([],{hour12:!0})),i.save_inprogress=!1,i.status=e.status,i.alert_messages=e.alert_messages,i.course.warning_message=f(i.alert_messages),i.next_item=e.next_item,e.correct&&(i.correct=e.correct),e.explanation&&(i.explanation=e.explanation),e.done[2]&&i.quiz.markDone()})):(i.save_inprogress=!1,i.submitted=!0))};var f=function(e){for(var t in e){if("submit"==t)return d.instant("quizzes.already_submitted")+" "+i.quiz.quiz_type+" "+d.instant("quizzes.no_more_attempts");if("due"==t)return d.instant("events.due_date_passed")+" - "+i.alert_messages[t][0]+" ("+i.alert_messages[t][1]+" "+i.alert_messages[t][2]+") "+d.instant("time.ago");if("today"==t)return d.instant("events.due")+" "+d.instant("time.today")+" "+d.instant("at")+" "+i.alert_messages[t]}};i.$watch("correct",function(e){e&&(i.numberOfCorrectAnswers=Object.values(e).reduce(function(e,t){return e+("1"==t||"3"==t)},0),i.pass=i.numberOfCorrectAnswers>=i.quiz.correct_question_count)}),i.quiz&&(m.setSelectedItem(i.quiz),i.course.warning_message=null,i.studentAnswers={},i.passed_requirments=!0,l.setTitle(i.quiz.name),h.isPhone()||c.open(),p.getSolvableQuestions().then(function(n){var e=n.quiz;if(!i.preview_as_student)for(var t in e.requirements)for(var a in e.requirements[t])m.getById(e.requirements[t][a],t).done||(i.passed_requirments=!1);null!==n.status&&(i.selectionUpdateTime=new Date(n.status.updated_at).toLocaleString([],{hour12:!0})),i.quiz.questions=n.questions,i.studentAnswers=n.quiz_grades,i.status=n.status,i.correct=n.correct,i.explanation=n.explanation,i.next_item=n.next_item,i.alert_messages=n.alert_messages,i.course.warning_message=f(i.alert_messages),i.quiz.questions.forEach(function(e,t){e.answers=n.answers[t],"DRAG"==e.question_type.toUpperCase()&&null==i.studentAnswers[e.id]&&(i.studentAnswers[e.id]=e.answers[0].content)})}),"survey"==i.quiz.quiz_type&&i.getSurveyCharts("display_only",i.quiz.group_id,i.quiz.id))}]),angular.module("scalearAngularApp").controller("StudentGettingStartedCtrl",["$scope","$location","$anchorScroll","$rootScope","Page","scalear_api","$translate",function(e,t,n,a,i,r,o){i.setTitle("help.getting_started"),a.subheader_message=o.instant("help.getting_started"),e.intro_url=r.student_welcom_video,e.scroll=function(e){$("body").scrollToThis(0,{offsetTop:0,duration:0}),$("body").scrollToThis("#"+e,{offsetTop:95,duration:0})}}]),angular.module("scalearAngularApp").controller("UsersTeacherCtrl",["$scope","User","$state","Page","$log",function(e,t,n,a,i){n.go("login")}]),angular.module("scalearAngularApp").controller("UsersStudentCtrl",["$scope","User","$state","Page","$filter",function(e,t,n,a,i){n.go("login")}]),angular.module("scalearAngularApp").controller("UsersSignUpCtrl",["$scope","User","$state","Page","$filter","$location","ngDialog","$modal","$rootScope",function(t,n,a,e,i,r,o,s,l){e.setTitle("account.sign_up");var u=function(){t.user.screen_name=i("anonymous")(10*Math.random()+t.user.email,"user")};t.user={},t.saml_user={},angular.forEach(r.$$search,function(e,t){this[t]=e.replace(/\+/g," ")},t.saml_user),t.is_saml=t.saml_user.saml,t.user.email=t.saml_user.mail||a.params.input1||"",t.user.name=t.saml_user.givenName||"",t.user.last_name=t.saml_user.sn||"",t.user.university=t.saml_user.o||"",t.user.password=a.params.input2||"",t.user.is_saml=t.is_saml||!1,u(),t.signUp=function(){n.validateUser({},t.user,function(e){t.privacyPopover()},function(e){t.user.errors=e.data.errors})},t.$watch("user.password",function(e,t,n){n.user.errors={},/^(?=.*[a-z])(?=.*\d)/.test(e)&&7<e.length?delete n.user.errors:0<e.length&&(n.user.errors.password=["must include at least one lowercase letter and one digit and at least 8 characters"])}),t.$watch("user.email",function(){u()}),t.privacyPopover=function(){o.openConfirm({template:"/views/privacy_popover.html",className:"ngdialog-theme-default dialogwidth800",showClose:!1,scope:t}).then(function(e){t.is_saml?(t.user.saml=t.is_saml,n.samlSignup({},{user:t.user},function(e){n.agreeToPrivacyPolicy({id:e.user.id},{},function(){a.go("login",{"access-token":e.token["access-token"],uid:e.token.uid,client:e.token.client})})},function(e){t.user.errors=e.data.errors})):(t.user.password_confirmation||(t.user.password_confirmation=" "),delete t.user.errors,n.signUp({},t.user,function(e){n.agreeToPrivacyPolicy({id:e.data.id},{},function(){a.go("thanks_for_registering",{email:t.user.email})})},function(e){e.data.errors.school_provider?s.open({templateUrl:"/views/school_provider_modal.html",controller:["$scope","$modalInstance",function(e,t){e.close=function(){t.dismiss()}}],scope:t}):t.user.errors=e.data.errors}))})}}]),angular.module("scalearAngularApp").controller("UsersPasswordNewCtrl",["$scope","User","$state","Page","ngDialog",function(n,e,t,a,i){a.setTitle("account.password.new_password"),n.user={},n.reset_password=function(){n.sending=!0,delete n.user.errors,e.reset_password({},{email:n.user.email,redirect_url:location.protocol+"//"+location.host+"/#/users/password/edit"},function(){n.sending=!1,t.go("forgot_password_confirmation",{email:n.user.email})},function(e){n.sending=!1,e.data.saml?i.open({template:"passwordDialog",className:"ngdialog-theme-default ngdialog-theme-custom",showClose:!1,preCloseCallback:function(e){t.go("login")}}):n.user.errors=e.data.errors})},n.$watch("current_lang",function(e,t){e!=t&&delete n.user.errors})}]),angular.module("scalearAngularApp").controller("UsersPasswordEditCtrl",["$scope","User","$state","$stateParams","$rootScope","Page","Token","UserSession",function(n,e,a,t,i,r,o,s){r.setTitle("account.password.resetting"),n.user={},n.user["access-token"]=t.token,n.user.uid=t.uid,n.user.client=t.client_id,n.change_password=function(){o.setToken(n.user),delete n.user.errors,e.change_password({},n.user,function(e,t){s.signIn(e.data).then(function(e){a.go("dashboard")})},function(e){n.user.errors=e.data.errors})},n.$watch("current_lang",function(e,t){e!=t&&delete n.user.errors})}]),angular.module("scalearAngularApp").controller("UsersConfirmationNewCtrl",["$scope","User","$state","Page",function(n,e,t,a){a.setTitle("account.resend_confirmation"),n.user={},n.resend=function(){delete n.user.errors,n.sending=!0,e.resend_confirmation({},{email:n.user.email},function(){n.sending=!1,t.go("login")},function(e){n.sending=!1,n.user.errors=e.data.errors})},n.$watch("current_lang",function(e,t){e!=t&&delete n.user.errors})}]),angular.module("scalearAngularApp").controller("UsersConfirmationShowCtrl",["$scope","User","$state","$stateParams","$timeout","$rootScope","UserSession","Page","$log","$modal","ErrorHandler","$translate","Token",function(n,e,t,a,i,r,o,s,l,u,d,c,_){s.setTitle("account.confirm_account"),n.user={},n.sending=!0,n.sending=!1,"true"==a.account_confirmation_success?(n.user_email=a.uid,u.open({template:"<style>.reveal-modal{height:auto;overflow: hidden;}</style><center><span translate='account.account_confirmed' translate-values='{ email: user_email}'></span><span translate>global.please</span> <a class='tiny' ng-click='goTo()' translate>account.login</a> <span translate>account.start_using</span>ScalableLearning.<br><Small translate>account.go_to_support</small></center>",scope:n,controller:["$modalInstance",function(e){n.goTo=function(){t.go("login",{email:n.user_email}),e.dismiss("cancel")}}]})):"false"==a.account_confirmation_success?u.open({template:"<style>.reveal-modal{height:auto;overflow: hidden;}</style><center><span translate>account.invalid_confirmation</span><br><span translate>account.already_confirmation</span> <a class='tiny' ng-click='goTo()' translate>account.click_here</a> <span translate>global.to</span> <span translate>navigation.login</span>.<br><span translate>account.new_confirmation</span> <a ui-sref='new_confirmation' ng-click='closeModal()' translate>account.click_here</a>.<br><Small translate>account.go_to_support</small></center>",scope:n,controller:["$modalInstance",function(e){n.goTo=function(){t.go("login",{email:n.user_email}),e.dismiss("cancel")},n.closeModal=function(){e.dismiss("cancel")}}]}):(_.setToken(a),i(function(){t.go("course_list")},1e3)),n.$watch("current_lang",function(e,t){e!=t&&delete n.user.errors})}]),angular.module("scalearAngularApp").controller("UsersEditCtrl",["$rootScope","$scope","User","$state","$modal","Page","$translate","UserSession",function(e,n,t,a,i,r,o,s){r.setTitle("navigation.account_information"),n.dayNamesOption=[{id:0,name:full_calendar_en.dayNames[0]},{id:1,name:full_calendar_en.dayNames[1]},{id:2,name:full_calendar_en.dayNames[2]},{id:3,name:full_calendar_en.dayNames[3]},{id:4,name:full_calendar_en.dayNames[4]},{id:5,name:full_calendar_en.dayNames[5]},{id:6,name:full_calendar_en.dayNames[6]}],e.subheader_message=o.instant("navigation.account_information"),s.getCurrentUser().then(function(e){n.user={screen_name:e.screen_name,name:e.name,last_name:e.last_name,university:e.university,email:e.email,link:e.link,bio:e.bio,saml:e.saml,first_day:n.dayNamesOption[e.first_day]}}),e.$watch("current_lang",function(e,t){e!=t&&delete n.user.errors}),n.confirmDelete=function(){i.open({templateUrl:"/views/users/confirm_delete.html",controller:"ConfirmDeleteCtrl",resolve:{user_new:function(){return n.user}}})},n.openRequirePassword=function(){delete n.user.errors,n.user.saml?(n.user.first_day=n.user.first_day.id,t.update_account({},n.user,function(){s.allowRefetchOfUser(),a.go("home")},function(e){n.user.errors=e.data.errors,n.user.first_day=n.dayNamesOption[n.user.first_day]})):i.open({templateUrl:"/views/users/update_account_info.html",controller:"SaveAccountCtrl",resolve:{user_new:function(){return n.user},day_options:function(){return n.dayNamesOption}}})}}]),angular.module("scalearAngularApp").controller("ConfirmDeleteCtrl",["$scope","$modalInstance","User","$log","$window","$rootScope","$state","user_new","UserSession",function(t,e,n,a,i,r,o,s,l){i.scrollTo(0,0),t.form={},t.user=s,t.deleteAccount=function(){t.user.saml||t.form.key.$valid?(t.form.processing=!0,l.deleteUser(t.user.pass).then(function(){t.form.processing=!1,e.close(),o.go("login")}).catch(function(e){t.form.processing=!1,t.form.server_error=e.data.errors.join()})):t.form.submitted=!0},t.cancel=function(){e.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("SaveAccountCtrl",["$scope","$modalInstance","User","$log","$window","$state","user_new","ErrorHandler","$translate","UserSession","day_options",function(t,n,e,a,i,r,o,s,l,u,d){i.scrollTo(0,0),t.user=o,t.dayNamesOption=d,t.update_account=function(){t.sending=!0,delete t.user.errors,t.user.first_day=t.user.first_day.id,e.update_account({},t.user,function(e){n.close(),0==t.user.intro_watched?r.go("confirmed"):(u.allowRefetchOfUser(),t.user.first_day=t.dayNamesOption[t.user.first_day])},function(e){t.sending=!1,t.user.errors=e.data.errors,t.user.first_day=t.dayNamesOption[t.user.first_day],t.user.current_password=null,e.data.errors.current_password||n.close()})},t.cancel=function(){t.user.current_password=null,n.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("ThanksForRegisteringCtrl",["$scope","Page","$state",function(e,t,n){t.setTitle("Thanks for Registering"),e.user_email=n.params.email}]),angular.module("scalearAngularApp").controller("ForgotPasswordConfirmationCtrl",["$scope","Page","$state",function(e,t,n){t.setTitle("Reset Password"),e.user_email=n.params.email}]),angular.module("scalearAngularApp").controller("UsersConfirmedCtrl",["$scope","$rootScope","User","UserSession","$state","$interval","Page","scalear_api","$translate","$log","URLInformation","$window",function(t,e,n,a,i,r,o,s,l,u,d,c){t.user_email=i.params.type,t.remaining=5,t.show_ending=!1,t.privacy_approved=!1,t.player={},t.player.controls={},t.player.events={},t.agree_to_terms=!1,o.setTitle("Welcome to ScalableLearning"),e.subheader_message=l.instant("intro.title"),t.student_or_teacher=null,a.getCurrentUser().then(function(e){t.current_user=e}),t.player.events.onEnd=function(){t.show_ending=!0,r(function(){t.remaining--,0==t.remaining&&t.watchedIntro()},1e3,5)},t.set_student_or_teacher=function(e){t.student_or_teacher=!0,t.intro_url="S"==e?(t.student=!0,s.student_welcom_video):(t.student=!1,s.teacher_welcome_video)},t.watchedIntro=function(){var e={intro_watched:!0};n.updateCompletionWizard({id:t.current_user.id},{completion_wizard:e},function(){a.allowRefetchOfUser(),d.hasEnroll()&&(c.location.href=d.getEnrollLink(),d.clearEnrollLink()),i.go("course_list")})}}]),angular.module("scalearAngularApp").controller("statisticsCtrl",["$scope","Kpi","Page","$rootScope","$translate","$modal",function(r,e,t,n,o,a){t.setTitle("statistics.statistics"),n.subheader_message=o.instant("statistics.statistics_dashboard"),r.close_selector=!1;var i=function(){r.chartConfig={options:{chart:{zoomType:"x",spacingRight:20},tooltip:{shared:!0},legend:{enabled:!1},subtitle:{text:void 0===document.ontouchstart?o.instant("statistics.drag_to_zoom"):o.instant("statistics.pinch_to_zoom")},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},lineWidth:1,marker:{enabled:!1},shadow:!1,states:{hover:{lineWidth:1}},threshold:null},line:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},lineWidth:1,states:{hover:{lineWidth:1}},marker:{enabled:!1},threshold:null}}},series:[{type:"line",name:"#",pointInterval:864e5,data:[],pointStart:Date.UTC(2013,0,1)}],title:{text:null},xAxis:{type:"datetime",title:{text:null}},yAxis:{min:0,max:null,title:{text:null}},loading:!1}};r.getSeriesData=function(t){r.selected_series=t;var n=[];r.chartConfig.loading=!0;var a=new Date("2013-01-01").toISOString().split("T")[0],i=(new Date).toISOString().split("T")[0];e.readData({key:t,start:a,end:i},function(e){e.data.forEach(function(e,t){n[t]=e.value}),r.chartConfig.series[0].data=n,r.chartConfig.title.text=o.instant("statistics."+t.toLowerCase())+" "+o.instant("statistics.rate_from")+" "+a+" "+o.instant("statistics.to")+" "+i,r.chartConfig.loading=!1,r.stats_title="statistics."+r.selected_series.toLowerCase()},function(){})},r.toggleSelector=function(){r.close_selector=!r.close_selector},r.emailForm=function(){a.open({templateUrl:"/views/teacher/course/system_email.html",controller:"systemEmailCtrl"})},r.loading_totals=!0,e.readTotals({},function(e){angular.extend(r,e),r.loading_totals=!1},function(){}),e.readSeries({},function(e){r.collection=e.series,r.selected_series=r.collection[0],r.getSeriesData(r.selected_series)},function(){}),i()}]),angular.module("scalearAngularApp").controller("schoolStatisticsCtrl",["$scope","Kpi","Page","$rootScope","$translate","$modal","$q","ScalearUtils","UserSession","User","ErrorHandler",function(n,a,e,t,i,r,o,s,l,u,d){e.setTitle("statistics.statistics"),t.subheader_message=i.instant("statistics.statistics_dashboard"),l.getCurrentUser().then(function(e){u.getSubdomains({id:e.id},function(e){n.subdomains=e.subdomains,1==n.subdomains.length?n.report.selected_domain=n.subdomains[0]:(n.report.selected_domain="All",n.subdomains.unshift("All"))})}),n.show_statistics=!1,n.report={},n.errors={};n.total_hours=0,n.total_online_quiz_solved=0,n.total_questions=0,n.total_questions_answered_students=0;var c=n.total_questions_answered_teachers=0,_=0,m=0,p=0,g=0,h=0;function f(t){a.getReportDataCourseDuration({start_date:n.report.start_date,end_date:n.report.end_date,course_ids:t},function(e){h-=t.length,c+=e.total_hours,_+=e.total_online_quiz_solved,m+=e.total_questions,p+=e.total_questions_answered_students,g+=e.total_questions_answered_teachers,angular.forEach(e.course_data,function(e,t){e.id=t,e.total_view_string=s.toHourMin(e.total_view),e.active_view_string=s.toHourMin(e.active_view),e.total_view=e.total_view,e.active_view=e.active_view,n.course_data_array.push(e)}),0==h&&(n.loading=!1,n.total_hours=c,n.total_online_quiz_solved=_,n.total_questions=m,n.total_questions_answered_students=p,n.total_questions_answered_teachers=g,total_students=0==n.total_students?1:n.total_students,total_courses=0==n.total_courses?1:n.total_courses,total_lectures=0==n.total_lectures?1:n.total_lectures,n.total_student_watched=n.total_hours/total_students,n.total_course_been_watched=n.total_hours/total_courses,n.total_online_quiz_course=(n.total_online_quiz_solved/total_courses).toFixed(1),n.total_online_quiz_lecture=(n.total_online_quiz_solved/total_lectures).toFixed(1),n.total_online_quiz_student=(n.total_online_quiz_solved/total_students).toFixed(1),n.total_questions_students=(n.total_questions/total_students).toFixed(1),n.total_questions_courses=(n.total_questions/total_courses).toFixed(1),n.total_questions_lectures=(n.total_questions/total_lectures).toFixed(1),n.total_hours_string=s.toHourMin(n.total_hours),n.total_student_watched_string=s.toHourMin(n.total_student_watched),n.total_course_been_watched_string=s.toHourMin(n.total_course_been_watched))})}n.report.start_date=moment().subtract(30,"days").format("DD-MMMM-YYYY"),n.report.end_date=moment().format("DD-MMMM-YYYY"),n.showStatistics=function(){var e,t;(e=o.defer(),t={},n.report.start_date=new Date(n.report.start_date),n.report.end_date=new Date(n.report.end_date),"Invalid Date"==n.report.start_date?(t.start_date="not a Date",e.reject(t)):"Invalid Date"==n.report.end_date?(t.end_date="not a Date",e.reject(t)):n.report.start_date<n.report.end_date?(t.start_date=null,t.end_date=null,e.resolve(t)):(t.start_date="must be before end date",e.reject(t)),n.report.start_date=moment(n.report.start_date).format("DD-MMMM-YYYY"),n.report.end_date=moment(n.report.end_date).format("DD-MMMM-YYYY"),e.promise).then(function(e){n.loading=!0,n.show_statistics=!1,n.total_hours=0,n.total_online_quiz_solved=0,n.total_questions=0,n.total_questions_answered_students=0,n.total_questions_answered_teachers=0,n.total_student_watched=0,n.total_course_been_watched=0,n.total_online_quiz_course=0,n.total_online_quiz_lecture=0,n.total_online_quiz_student=0,n.total_questions_students=0,n.total_questions_courses=0,n.total_questions_lectures=0,n.total_hours_string=s.toHourMin(n.total_hours),n.total_student_watched_string=s.toHourMin(n.total_student_watched),n.total_course_been_watched_string=s.toHourMin(n.total_course_been_watched),g=p=m=_=c=0,a.readTotalsForDuration({start_date:n.report.start_date,end_date:n.report.end_date,domain:n.report.selected_domain},function(e){n.show_statistics=!0;for(n.total_courses=e.total_courses,n.total_students=e.total_students,n.total_teachers=e.total_teachers,n.total_lectures=e.total_lectures,h=e.course_ids.length,n.course_data_array=[];0<e.course_ids.length;)f(e.course_ids.splice(0,100))}),angular.extend(n.errors,e)}).catch(function(e){return n.show_statistics=!1,angular.extend(n.errors,e),!0})},n.exportCSV=function(){a.exportSchoolStatistics({start_date:n.report.start_date,end_date:n.report.end_date,domain:n.report.selected_domain},function(e){e.notice&&d.showMessage(i.instant("error_message.export_school_administration"),"errorMessage",4e3,"success")})},n.sortting={total_view_string:function(e){return e.total_view},active_view_string:function(e){return e.active_view}}}]),angular.module("scalearAngularApp").controller("welcomeMessageCtrl",["$scope","Kpi","Page","$rootScope","$translate","$modal","$q","ScalearUtils","UserSession","User","ErrorHandler",function(t,e,n,a,i,r,o,s,l,u,d){n.setTitle("navigation.welcome_message"),a.subheader_message=i.instant("navigation.welcome_message"),t.loading=!0,l.getCurrentUser().then(function(e){t.user=e,u.getWelcomeMessage({id:t.user.id},function(e){t.loading=!1,t.welcome_message=e.welcome_message,t.domain=e.domain})}),t.submitWelcomeMessage=function(){u.submitWelcomeMessage({id:t.user.id},{welcome_message:t.welcome_message},function(e){d.showMessage(i.instant("error_message.welcome_message_updated"),"errorMessage",4e3,"success")})}}]),angular.module("scalearAngularApp").controller("dashboardCtrl",["$scope","$state","$stateParams","Dashboard","NewsFeed","Page","$timeout","$rootScope","$compile","$translate","$filter","$location","Module","ErrorHandler","$interval","Lecture","Quiz","UserSession","ScalearUtils",function(l,u,e,t,n,a,d,i,r,c,_,m,p,o,s,g,h,f,v){a.setTitle("navigation.dashboard"),a.startTour(),i.subheader_message=c.instant("dashboard.whats_new"),l.eventSources=[],l.module_summary_data=[];var b=null;function y(){angular.element("#studentCalendar").fullCalendar("render")}function w(e,t){$(".tooltip.tip-top").remove(),t.attr({"tooltip-html-unsafe":e.tooltip_string,"tooltip-append-to-body":!0,"tooltip-placement":"bottom"}),r(t)(l)}function k(t,e,n,a,i,r){var o={due_date:t.start};t.lecture_id?g.update({course_id:t.course_id,lecture_id:t.lecture_id},{lecture:o},function(e){z(e)},function(e){q(e,n,t,"Lecture")}):t.quiz_id?h.update({course_id:t.course_id,quiz_id:t.quiz_id},{quiz:o},function(e){z(e)},function(e){q(e,n,t,"Quiz")}):p.update({course_id:t.course_id,module_id:t.group_id},{group:o},function(e){z(e)},function(e){q(e,n,t,"Module")})}function z(e){e.notice&&o.showMessage(c.instant("error_message.due_date_changed"),"errorMessage",4e3,"success")}function q(e,t,n,a){if(t(),"must be before due time"==e.data.errors[Object.keys(e.data.errors)[0]][0])var i=c.instant("events.drag_due_date_error_part_1")+a+c.instant("events.drag_due_date_error_part_2")+a+c.instant("events.drag_due_date_error_part_3");else i=Object.keys(e.data.errors)[0].replace("_"," ")+" "+e.data.errors[Object.keys(e.data.errors)[0]][0];o.showMessage(i,"errorMessage",4e3,"error")}function x(){t.getDashboard({},function(e){var t,n,a;for(var i in l.uiConfig={calendar:{header:{right:"today prev,next",left:"title"},eventRender:w,eventDrop:k,firstDay:b.first_day}},l.uiConfig.calendar.editable=!0,angular.extend(l.uiConfig.calendar,"en"==l.current_lang?full_calendar_en:full_calendar_sv),t=e.module_summary_id_list,l.module_summary_id_list=t,l.module_summary={},t.forEach(function(e){var t=e[0],n=e[1],a=e[2];l.module_summary[t]={type:a},l.module_summary[t].loading={summary:!0,online_quiz:!0,discussion:!0},p.getModuleSummary({module_id:t,course_id:n},function(e){"teacher"==e.module.type&&(l.course_id=n),l.module_summary[t].loading.summary=!1,angular.extend(l.module_summary[t],e.module)}),p.getOnlineQuizSummary({module_id:t,course_id:n},function(e){l.module_summary[t].loading.online_quiz=!1,angular.extend(l.module_summary[t],e.module)}),p.getDiscussionSummary({module_id:t,course_id:n},function(e){l.module_summary[t].loading.discussion=!1,angular.extend(l.module_summary[t],e.module)})}),n=e.key,a=Intl.DateTimeFormat().resolvedOptions().timeZone,l.calendar_url=m.absUrl().replace("/#","")+"/dynamic_url?tz="+a+"&key="+n,l.calendar_pop={content:"<div ng-click='preventDropDownHide($event)'><div><b>Subscribe to Calendar:</b></div><div style='padding: 5px;word-wrap: break-word;'>{{calendar_url}}</div></div>",html:!0,placement:"right"},l.calendar=e,l.calendar.events){var r=l.calendar.events[i];r.start=new Date(r.start),r.item_title=r.title.replace(" due",""),r.title=r.course_short_name+": "+r.item_title,r.tooltip_string=r.title+"<br />"+c.instant("events.due")+" "+c.instant("global.at")+" "+_("date")(r.start,"HH:mm"),1==r.status?r.tooltip_string+="<br />"+c.instant("events.completed_on_time"):2==r.status&&(r.tooltip_string+="<br />"+c.instant("events.completed")+" "+r.days+" "+c.instant("time.days")+" "+c.instant("events.late"));var o={course_id:r.course_id,module_id:r.group_id},s="course.module";2==r.role?(s+=".courseware",r.quiz_id?(s+=".quiz",o.quiz_id=r.quiz_id):r.lecture_id&&(s+=".lecture",o.lecture_id=r.lecture_id),r.editable=!1):s=".progress",r.url=u.href(s,o,{absolute:!0})}l.calendar.className=["truncate"],l.eventSources.push({events:l.calendar.events}),d(function(){y()},300)})}f.getCurrentUser().then(function(e){b=e,x(),n.index({},function(e){l.events=[],l.latest_announcements=e.latest_announcements,l.latest_announcements.forEach(function(e){e.timestamp=e.updated_at,l.events.push(e),d(function(){y()},300)})})}),l.toggleLargeCalendar=function(){l.large_calendar=!l.large_calendar,d(function(){y()})},l.preventDropDownHide=function(e){e.preventDefault(),e.stopPropagation()},l.exportCalendar=function(){var e=ics();for(var t in l.calendar.events.__id&&delete l.calendar.events.__id,l.calendar.events){var n=l.calendar.events[t].tooltip_string.replace("<br />"," ")+" "+l.calendar.events[t].url;e.addEvent(l.calendar.events[t].title,n,"Scalable-Learning",l.calendar.events[t].start,l.calendar.events[t].start)}e.download("calendar")},l.createAnnouncement=function(){u.go("course.announcements",{course_id:l.course_id,show:!0})}}]),angular.module("scalearAngularApp").controller("CalendarModalCtrl",["$state","$stateParams","$scope","$modalInstance","Course","$window","$rootScope","$timeout","$filter","$compile",function(n,e,a,t,i,r,o,s,l,u){a.eventRender=function(e,t){var n=e.course_short_name+": "+e.item_title+"<br />Due at  "+l("date")(e.start,"HH:mm");1==e.status?n+="<br />Completed on time":2==e.status&&(n+="<br />Completed "+e.days+" days late"),t.attr({"tooltip-html-unsafe":n,"tooltip-append-to-body":!0}),u(t)(a)};a.eventSources=[],i.getCalendarEvents({course_id:e.course_id},function(e){for(var t in a.uiConfig={calendar:{editable:!1,header:{right:"today prev,next",left:"title"},eventRender:a.eventRender}},a.calendar=e,a.calendar.events)a.calendar.events[t].start=new Date(a.calendar.events[t].start),a.calendar.events[t].item_title=a.calendar.events[t].title.replace(" due",""),a.calendar.events[t].title=a.calendar.events[t].course_short_name+": "+a.calendar.events[t].item_title,2==o.current_user.roles[0].id?a.calendar.events[t].quiz_id?a.calendar.events[t].url=n.href("course.module.courseware.quiz",{course_id:a.calendar.events[t].course_id,module_id:a.calendar.events[t].group_id,quiz_id:a.calendar.events[t].quiz_id}):a.calendar.events[t].lecture_id?a.calendar.events[t].url=n.href("course.module.courseware.lecture",{course_id:a.calendar.events[t].course_id,module_id:a.calendar.events[t].group_id,lecture_id:a.calendar.events[t].lecture_id}):a.calendar.events[t].url=n.href("course.module.courseware",{course_id:a.calendar.events[t].course_id,module_id:a.calendar.events[t].group_id}):a.calendar.events[t].url=n.href("course.module.progress",{course_id:a.calendar.events[t].course_id,module_id:a.calendar.events[t].group_id});a.calendar.className=["truncate"],a.eventSources.push(a.calendar),s(function(){$(window).resize()})},function(){})}]);