+function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(c).is(document.body)?a(window):a(c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a.page-scroll",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.4",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.4",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"),b&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?(this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION),void 0):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery),shortcut={all_shortcuts:{},add:function(a,b,c){var d={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1,disable_in_editable:!1};if(c)for(var e in d)"undefined"==typeof c[e]&&(c[e]=d[e]);else c=d;var f=c.target;"string"==typeof c.target&&(f=document.getElementById(c.target)),a=a.toLowerCase();var g=function(d){if(d=d||window.event,c.disable_in_input){var e;if(d.target?e=d.target:d.srcElement&&(e=d.srcElement),3==e.nodeType&&(e=e.parentNode),"INPUT"==e.tagName||"TEXTAREA"==e.tagName)return;if("DIV"==e.tagName&&e.contentEditable)return}if(c.disable_in_editable){var e;if(d.target?e=d.target:d.srcElement&&(e=d.srcElement),3==e.nodeType&&(e=e.parentNode),"DIV"==e.tagName&&e.contentEditable)return;if("TEXTAREA"==e.tagName)return}d.keyCode?code=d.keyCode:d.which&&(code=d.which);var f=String.fromCharCode(code).toLowerCase();188==code&&(f=","),190==code&&(f=".");var g=a.split("+"),h=0,i={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},j={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},l={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};d.ctrlKey&&(l.ctrl.pressed=!0),d.shiftKey&&(l.shift.pressed=!0),d.altKey&&(l.alt.pressed=!0),d.metaKey&&(l.meta.pressed=!0);for(var m=0;k=g[m],m<g.length;m++)"ctrl"==k||"control"==k?(h++,l.ctrl.wanted=!0):"shift"==k?(h++,l.shift.wanted=!0):"alt"==k?(h++,l.alt.wanted=!0):"meta"==k?(h++,l.meta.wanted=!0):k.length>1?j[k]==code&&h++:c.keycode?c.keycode==code&&h++:f==k?h++:i[f]&&d.shiftKey&&(f=i[f],f==k&&h++);return h!=g.length||l.ctrl.pressed!=l.ctrl.wanted||l.shift.pressed!=l.shift.wanted||l.alt.pressed!=l.alt.wanted||l.meta.pressed!=l.meta.wanted||(b(d),c.propagate)?void 0:(d.cancelBubble=!0,d.returnValue=!1,d.stopPropagation&&(d.stopPropagation(),d.preventDefault()),!1)};this.all_shortcuts[a]={callback:g,target:f,event:c.type},f.addEventListener?f.addEventListener(c.type,g,!1):f.attachEvent?f.attachEvent("on"+c.type,g):f["on"+c.type]=g},remove:function(a){a=a.toLowerCase();var b=this.all_shortcuts[a];if(delete this.all_shortcuts[a],b){var c=b.event,d=b.target,e=b.callback;d.detachEvent?d.detachEvent("on"+c,e):d.removeEventListener?d.removeEventListener(c,e,!1):d["on"+c]=!1}}},$.fn.scrollToThis=function(a,b,c){"function"==typeof b&&2==arguments.length&&(c=b,b=a);var d=$.extend({scrollTarget:a,offsetTop:50,duration:200,easing:"linear"},b);return this.each(function(){var a=$(this),b="number"==typeof d.scrollTarget?d.scrollTarget:$(d.scrollTarget),e="number"==typeof b?b:b.offset().top+a.scrollTop()-parseInt(d.offsetTop);a.animate({scrollTop:e},parseInt(d.duration),d.easing,function(){"function"==typeof c&&c.call(this)})})};var translation_en={global:{name:"Name",email:"Email",at:"at",edit:"Edit",empty:"Empty",back:"Back",pref_language:"Language Preference",welcome:"Welcome",to:"to",or:"or",and:"and",from:"from",preview_student:"Preview as Student",exit_preview_as_student:"Exit Student Preview",settings:"Settings",question:"Question",questions:"Questions",duration:"Duration",video:"Video",videos:"Videos",inclass_lecture:"In-class Video",distance_peer_lecture:"Distance-peer Video",customlink:"Link",customlinks:"Links",title:"Title",description:"Description",note:"Note",discussion:"Discussion",discussions:"Discussions",number_of_students:"Number of Students",copy:"Copy",please:"Please",please_wait:"Please Wait",lecture:"@:global.video",lectures:"@:global.videos",courses:"courses",module:"module",overview:"Module Summary",quiz:"Quiz",quizzes:"Quizzes",video_quizzes:"Video Quizzes",video_quiz:"Video Quiz",survey:"Survey",surveys:"Surveys",marker:"Marker",markers:"Markers",answer:"Answer",free_text_question:"Free Text Question",confused:"Confused",really_confused:"Really Confused",search:"Search",new_course:"New course",required:"Required",optional:"Optional",students:"Students",teacher:"teacher",student:"student",done:"Done",correct:"Correct",incorrect:"Incorrect",warning:"Warning",are_you_sure:"Are you sure you want to proceed?",visible:"Visible",leave:"Leave",stay:"Stay",votes:"Votes",no:"No",courses_list:"Courses List"},mailer:{send_email:"Send An Email",to:"To",send:"Send",subject:"Subject",email_body:"Body"},error_message:{connected:"Connected",cant_connect_to_server:"Cannot connect to server",invalid_email:"Invalid Email",got_some_errors:"Please correct the errors above",required:"@:global.required",invalid_input:"Invalid Input",due_date_changed:"Due Date has been changed.",you_are_not_authorized:"You are not authorized to see requested page",update_account_information:"Please update your account information to use the new version of ScalableLearning.",select_module_first:"Please Select A Module First",change_password_confirmation:"You have successfully changed your password.",confirm_change_email:"You have successfully changed your email.",export_course:"Your anonymized course data will be emailed to you shortly.",export_student:"Your student list will be emailed to you shortly.",export_school_administration:"Statistics will be exported to CSV and sent to your Email.",another_marker:"There is another marker at the same time",remove_your_self:"You were successfully removed from the course",slow:{server:"The server",is_slow:"is taking a long time to load this video",try_reload:"You can continue waiting, or try reloading the page"},welcome_message_updated:"Welcome message updated"},time:{hours:"hours",minutes:"minutes",seconds:"Seconds",weeks:"Weeks",today:"today",day:"day",days:"days",ago:"ago"},tooltip:{list_view:"List View",grid_view:"Grid View"},button:{yes:"Yes",no:"No",next:"Next",submit:"Submit",save:"Save",publish:"Publish",unpublish:"Unpublish",save_close:"Save and Close",close:"Close","delete":"Delete",send:"Send",cancel:"Cancel",show:"Show",save_changes:"Save Changes",remove:"Remove",replay:"Replay",retry:"Retry",reply:"Reply",hide:"Hide",refresh:"Refresh",vote:"Vote","continue":"Continue",no_thanks:"No thanks"},support:{ipad:"iPad support is currently in beta.",mobiles:"Mobile devices are not currently fully supported.",issue_and_recommendation:"Student video support is available for Android 4.4 and higher and iOS 10.3 and higher. We recommend that teachers use a desktop browser for best results.",ie_disclaimer:"Internet Explorer is not fully compatible with the interactive video features used on Scalable Learning. We strongly encourage you to use"},navigation:{logout:"Logout",login:"Login",account_information:"Account Information",courses:"My Courses",notifications:"Notifications",notification:"Notification",dashboard:"Dashboard",settings:"Settings",account:"Account",show_all_courses:"Show all courses",copied_from:"Copied From",description:{settings_description:"Modify your account information/settings"},progress:"Progress",in_class:"In-class",calendar:"Calendar",announcements:"Announcements",calendar_and_announcements:"Calendar and Announcements",content:"Content",information:"Information",course_information:"Course Information",enrolled_students:"Enrolled Students",teachers:"Teachers",lectures:"Lectures",help:"Help",add_students:"Add Students",administration:"Administration",add_teacher:"Add Teacher/TA",student_list:"Student List",join_course:"Join a new course (student)",new_course:"Create a new course (teacher)",review:"Review",welcome_message:"Welcome Message",register:{teacher:"Teacher Registration",student:"Student Registration"},teacher:"For Teachers",student:"For Students",int_video:"New to ScalableLearning? Please watch a short introductory video to help you get started."},content_navigator:{customlink:"@:global.customlink",lecture:"@:global.lecture",inclass_lecture:"@:global.inclass_lecture",quiz:"@:global.quiz",survey:"@:global.survey",empty:"Empty Course",select_module:"Select a Module"},discussion:{private_post:"Private Post",public_post:"Public Post",comment:"Comment",like:"Vote Up",unlike:"Vote Down",write_comment:"Leave a comment...",flag_post:"Flag this post",flag:"Flag",unflag:"Unflag",flagged_post:"Flagged post",flagged_comment:"Flagged comment",unflag_post:"Unflag this post",flags:"Flags",likes:"Likes",remove_flags:"Remove Flag",private_discussion:"Private Discussion (Viewed by teacher only)",public_discussion:"Public Discussion (Viewed by all)",cannot_be_empty:"Cannot be empty",cannot_ask_question_preview:"You cannot ask questions while previewing as a student",q:"Q.",edited:"edited",button:{ask:"Ask",cancel:"@:button.cancel",save:"@:button.save"}},context_menu:{copy:"@:global.copy",paste:"Paste",share:"Share",share_copy:"Share Material"},sharing:{nothing_selected:"Nothing is selected",please_enter_email:"Please enter an Email",teacher_email:"Teacher Email",with_you:"Shared with you",view:"View Shared",manage:"Manage Shared",shared_from:"Data shared from ",shared_by:"shared by,",to_course:"to course",to_module:"to module",copy:"@:global.copy",lecture:"@:global.lecture",items:"items",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",customlink:"@:global.customlink"},footer:{about:"About ",privacy:"Privacy",faq:"FAQ"},feedback:{like_to_comment:"What's your question, comment, or issue?",what_you_think:"What do you need help with?",instructions:"This helps us make sure you get the right answer as fast as possible.",provide_desciption:"Please provide more description",provide_email_name:"Please make sure that you provided your name and email address",thanks:"Thanks for your feedback! We’ll get back to you soon.",leave_feedback:"Share all the details. The more we know, the better we can help you.",course_content:"My Course Contents",system:"The ScalableLearning Website",none:"Please select one...",no_access:"I can't access my account",question_before_sign:"I have a question before I sign up",request_feature:"I want to request a feature",no_email:"I'm not receiving emails",confused:"I'm confused about how something works",bug:"I think something is broken",other:"Other"},enroll_email:{go_to:"(Note: If you have trouble with the above instructions, go to",help_enroll:"Help on Enrollment",instruction:"Students enroll by first registering on the scalable learning website and then entering the Course Enrollment Key. To help your students do this, please send them an email with the following instructions.",dear_student:"Dear Student",this_term_new_system_part_1:"This term in {{course_name}} we will be using ScalableLearning to help make your learning more interactive.  To get started go to ",this_term_new_system_part_2:" and login with your school email.",create_account_with_university:"and create an account with your university email address.",add_course_by_choosing_part_1:" login with your school email, then choose 'Join Course' from the 'Courses' menu and use the Enrollment Key ",add_course_by_choosing_part_2:" to join {{short_name}}. If you have any questions please use the 'Support' form in the 'Help' menu.)",add_course_by_url:" Follow this link ",sincerely:"Sincerely",to_get_started:"To	get	students	started,	send	the	following	email	to	your	class:",if_problem:"if there are problems:",ask_student:"Ask	the	student to",check_spam:"check	SPAM	filters",conf_email:"for	the	confirmation	email.",enroll_manual:"enroll	manually",by_go:"by	going	 to",and_joining:"and	joining	 with	the enrollment key",contact:"Contact	support",from_help:"from	the	Help	menu.",guest_stu:"Guest	Students:",you_may:"You	may	invite	others	to	join	your	 course	as	guests	by	going	 to",guest_may:"Guests	may	see	all	the	online	material,	but	their	answers	and	questions	will	not	 be	visible	to	the	teacher.	Guests	can	enroll	with	the	link	above	or	with	the	guest	enrollment	key"},account:{password:{change_password:"Change my Password",new_password:"New password",forgot_password:"Reset password",send_reset:"Send me Reset Password Instructions",resetting:"Resetting Password",need_password:"We need your current password to confirm your changes",password_confirmation:"Password confirmation",password:"Password",current_password:"Current Password"},confirm_account:"Confirm Account",confirmation_token:"Confirmation Token",resend_confirmation:"Resend confirmation instructions",didnt_receive_confirmation:"Re-send confirmation email",cancel_account:"Delete my account",first_name:"First Name",last_name:"Last Name",screen_name:"Online Name",university:"School or University",saml_disable_edit:"Name, email, and school information provided by UNIVERSITY. If you need to change this information, please contact UNIVERSITY technical support.",first_day:"First day of the week for the calendar",link:"Website",security:"Security",online_name_comment:"Used when you make comments or ask questions. To be anonymous, use the default or a pseudonym.",avatar_comment:"You can change your account image on ",password_comment:"Enter a new password to change your password.",school_email:"School Email",sign_up:"Sign up",sign_in:"Sign in",can_not_use_domain:"You can not register using this domain. To create an account, login through your school provider.",login:"@:navigation.login",join:"Join",remember_me:"Keep me logged in",confirm_destroy:"Are you sure you want to delete your account?",confirm_destroy_note:"Please note that all your data will be deleted from the system and cannot be recovered.",required_marked:"Required fields are marked with *",use_school:"Use your School/University Account",school_not_listed:"If your school is not in this list, you can Login with a ScalableLearning account below",use_scalable:"Use a ScalableLearning Account",login_with:"Login with",other_login:"Other login options",sign_through:"Signing in through",im_student:"I'm a Student",im_teacher:"I'm a Teacher",back:"@:global.back",go_to_support:"If you need help, just go to Support in the Help menu",account_confirmed:"Your account {{email}} has been confirmed.",start_using:" to start using ",invalid_confirmation:"This confirmation link is no longer valid. (It has either expired or already been used.)",click_here:"click here",new_confirmation:"To get a new confirmation link please",already_confirmation:"If you have already confirmed your account,"},lti:{embed:"Embed",lti:"Linking to your School LMS",select:"Select",courses:"@:global.courses",modules:"modules",items:"@:sharing.items",no_account:"You do not have an account on Scalable Learning. To Create an account, click on",contact_teacher:"You are not an instructor in this course on Scalable Learning. Please contact the course owner to add you as a Professor/TA to the course"},events:{due:"Due",deadline_msg:"All deadlines are at midnight on the day specified",done:"@:global.done",done_late:"Done late",not_done:"Not done",not_done_late:"Not done and late",not_done_due:"Not done or due in less than 2 days",completed_on_time:"@:progress.chart.completed_on_time",completed:"Completed",late:"late",due_date_passed:"Due date has passed",drag_due_date_error_part_1:"You cannot move the ",drag_due_date_error_part_2:"'s due date before it's appearance date. To change the appearance date click on the ",drag_due_date_error_part_3:" and choose edit."},notification:{invited:"You have been invited to the course {{course}}, by {{user}}, as a {{role}}",shared:"{{user}} has shared course data with you",accept:"Accept",reject:"Reject",reviewed_inclass:"Would you like the teacher to review this question in class"},privacy:{policy:"Privacy Policy",information_collect:"What information we collect",information_collect_details:"We collect information on how you use the site and interact with the educational content. This includes student responses to quizzes, lecture videos played, pauses, rewinds, questions asked, questions answered, clicks on the confused button, responses to surveys, and general site navigation. We also collect information on how teachers use the site, including use of the course construction tools, progress visualization, in-class display tools, and general site navigation. This information includes the time, type of action, the response, and the account associated with the action.",information_use:"How we use the information",information_use_details:"We use this information to improve ScalableLearning and learn how to improve teaching and learning. For example, student information is used to help teachers understand how their students are learning (quiz answers), where students are having difficulty in their courses (lecture statistics), and what kinds of questions they are having (surveys and anonymous surveys). The source of anonymous survey information is not shown to teachers on the site to maintain student anonymity. Teacher information is used to help develop better interfaces and identify how we can better provide them with insights into where students need more help.",information_use_details2:"We also use this information for research to improve teaching techniques and the tools we provide. All information used for research is anonymized by removing names and email addresses.",confidentiality_and_security:"Confidentiality and security",confidentiality_and_security_details:"We take your privacy and security seriously. We promise to never release your personally identifiable information to a third party without your consent. Your information will be stored and protected according to industry norms.",use_of_cookies:"Use of cookies",use_of_cookies_details:"Cookies are used on this website to remember your login information. While you are logged in, a cookie is used to track your login session. This cookie expires when you close your browser window or sign out. If you select “Remember me” when you login, the cookie will remain for two weeks.",identifiable_information:"Personally identifiable information",identifiable_information_details:"The personally identifiable information for your account consists of the name and email address you provide when you register an account on the site. This information is attached to your actions on the site. You may access, rectify, and delete this information via the Account Information page on the website. We store the IP address of all accesses to the site in the server logs for logged-in and non-logged-in users.",deleting_profile:"Data Retention and Deleting your profile",deleting_profile_details:"Your data is retained in the system while you have a valid account to enable you to enroll in future classes. If you delete your account, then all of your personally identifiable information will be removed from our system. Note that it may take a period of time for this information to be deleted from backup systems. Your anonymized usage behavior may be retained for research",legal_entity:"Legal Entity",legal_entity_details:"ScalableLearning is provided by RISE SICS, Isafjordsgatan 22/Kistagången 16 SE-164 40 Kista, Sweden.",code_conduct:"GÉANT Data Protection Code of Conduct",code_conduct_details:"This privacy policy complies with the GÉANT Data Protection Code of conduct version 1.0, 14 June 2013.",policy_changes:"Privacy policy changes",policy_changes_details:"The current privacy policy will always be located on this page and we encourage you to visit this page to review changes. Changes to the privacy policy take effect when posted here.",last_update:"Last update: 24-May-2017",understand:"I understand",cancel:"Cancel"},faq:{faq:"Frequently Asked Questions",question1:"Who is the owner of the data?",answer1:"Course data is owned by the teacher who created the course. Student data is owned by the student. If a student deletes his or her account the activity data from that student becomes anonymous.",question2:"Where is the data stored, and under what legal jurisdiction?",answer2:"The data is stored in a datacenter in Ireland and ScalableLearning operates under the legal jurisdiction of Sweden, with the RISE SICS as the legal entity.",question3:"Is it possible to retrieve or export the data?",answer3:"Teachers can export complete course data.",question4:"Are backups made of the system?",answer4:"Daily backups are made for recovery.",question5:"How are data storage and transportation secured?",answer5:"Transportation and storage are secured using industry-standard encryption, authentication, and physical access protection.",question6:"Is traffic logged?",answer6:"Traffic is logged for 4-10 days and is available to the development team.",question7:"How is the system secured?",answer7:"See"},intro:{title:"Intro Video",teacher_introduction:"This 10-minute video will give you a rapid overview of how to create lectures, add quizzes, and review your students' online performance. You may",teacher_skip_intro:"the introduction if you really want to, and can always find more detailed help in the Help menu.",student_introduction:"This 3-minute video describes how to use",student_introduction_cont:"and how to study effectively in a flipped class. You may",student_skip_intro:"the introduction if you really want to, and can always find more detailed help in the Help menu.",by_using_service:"By using this service you agree to our",redirect_courselist:"Redirecting to your course list in ",skip:"skip",go_to:"Note: If you have trouble with the above instructions, go to"},dashboard:{large_calendar:"Large Calendar",small_calendar:"Small Calendar",export_calendar:"Export Calendar",whats_new:"What's New",as_ical_file:"As File",as_url:"As Link",student_completion:"Student Completion",completion:"Completion",unanswered_questions:"Unanswered",start_inclass:"@:inclass.start_inclass",review_select_inclass_material:"Review & Select In-Class Material",review_quiz:"Review Quiz",my_questions:"My Questions",try_again:"Try again",ontime:"On-time",incomplete:"Incomplete",complete:"Complete",more_than:"More than",less_than:"Less than",not_started:"Not Started",between:"Between",never_tried:"Never tried",solved:"Solved",not_checked:"Not checked",final_try:"final try",first_try:"first try",voted_for_review:"Voted for review",click_for_information:"Click for information",inclass_question:"In-class Question",distance_peer_question:"Distance-peer Question",complete_video:"Please, complete this video",complete_quiz:"Please, complete this quiz",your:"Your",group:"group",individual:"individual",shown_top:" is shown on top.",shown_below:" is shown below.",is_not_checked:" is not checked.",was:" was ",you:"You",tried_once:", you tried once.",tried_more_once:", you tried more than once.",not_first_try:" not on the first try.",on_first_try:" on the first try .",you_solved_group_survey:"You solved group survey.",you_not_answered_quiz:"You did not answer this quiz.",answered_survey:" answered this survey",answered:" answered",answered_but_not_checked:"You have tried this quiz, but your answer has not been checked by the teacher.",answered_but_not_checked_question:"You have tried this question, but your answer has not been checked by the teacher.",answered_but_group:"You have tried this quiz, but your  ",not_checked_group:" has not been checked by the teacher.",tried_not_correct_first:"You have tried this quiz once, but have ",self_not_correct_question:"You have tried this question, but have ",tried_not_correct_first_answer:"not gotten the answer correct",tried_not_correct_last:"You have tried this quiz more than once, but have ",answered_correct_but:"You've got the answer correct, but ",you_answered:"You've got the answer ",click_retry_quiz:"Click to re-try this quiz.",less_one_hour:"due in less than an hour.",correct:"correct",incorrect:"incorrect",answer:"answer",survey:"survey",continue_watching:"Continue watching",watch_again:"Watch again",start_watching:"Start watching"},inclass:{more:"more",pause:"Pause",resume:"Resume",discussion:"@:global.discussion",discussions:"@:global.discussions",quizzes:"@:global.quizzes",surveys:"@:global.surveys",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",primary_marker:"@:global.marker",free_text_question:"@:global.free_text_question",confused:"@:global.confused",really_confused:"@:global.really_confused",video_quizzes:"@:global.video_quizzes",video_quiz:"@:global.video_quiz",hide:"@:button.hide",show:"@:button.show",video_only:"Video Only",zoom_graph:"Zoom Graph",zoom_video:"Zoom Video",show_graph:"Show Graph",exit:"Exit",blackscreen_close:"Click or Press 'b' to return",blackscreen_done:"Review finished. Press ESC to end",start_inclass:"Start In-class Review",review:"In-class Review",time_estimate:"In-class Time Estimate",total_inclass_time:"Total In-Class Time",peer_problem_time:"Peer Problem Time",review_time:"Review Time",time_per_quiz:"Review Time per quiz",time_per_question:"Review Time per question",display_content:"Display In-class Content",choose_module:"Choose a module to display selected materials In-class",change_defaults:"change defaults",intro_stage:"Intro",self_stage:"Self",group_stage:"Group",discussion_stage:"@:global.discussion",session_not_started:"The in-class session has not started",please_try_or_refresh:"Please try again later or click on the 'Refresh' button below",question_not_started:"The in-class question has not started",click_next_question:"Click on 'Next' when the question shows up",multiple_choice:"multiple choice",click_forward_result:"Press forward to view in-class voting results."},distance_peer:{invited:"Invite a student to Join a distance peer session",invited_instruction:"Choose a student ",distance_peer_instruction:"Please call up your partner while you do these questions so you can discuss them in real-time. Remember that for the Individual quizzes you are both supposed to answer on your own, but when you get to the Group part of the quiz you are encouraged to discuss the answers together.",invited_by:"You are invited by",invited_by_instruction:"Click on button of student you want to join ",wait_for_acceptance:"Wait For Acceptance",wait_for_acceptance_instruction:"Wait For acceptance from student or cancel the invitation",waiting_response_of_back_end:"Check if you're invited to join a distance peer session",invite_another_button:"Invite another student to join",video_stage:"Please watch the video.",intro_stage:"Quiz:Intro",self_stage:"Quiz:Self",multiple_choice:"@:inclass.multiple_choice",group_stage:"Quiz:Group",end_video_stage:"Quiz:End",end_peer_instruction:"End Distance Peer Instruction",in_distance_peer:"You are participating in a distance peer instruction lesson with {{name}}.",the_another_student_finished_status:"{{name}} finished {{status}}, you can resume",waiting_the_another_student_to_finish:"Waiting {{name}} to finish {{status}}",click_on_button_below_to_end_session:"Click on button below to end distance peer session",the_another_student_finished_message_video:"Please watch the video to get to the peer instruction questions.",the_another_student_finished_message_quiz_intro:"Press play to watch the introduction to the question.",the_another_student_finished_message_quiz_self:"Please choose your individual answer. (Do not discuss your answer with your partner.)",the_another_student_finished_message_quiz_group:"Please discuss your answer with your partner and choose your final answer. (You do not have to choose the same answers.)",the_another_student_finished_message_quiz_end:"Please watch the teacher's explanation of the answer.",waiting_message_quiz_intro_after_video:"Waiting for your partner to finish watching the video.",waiting_message_quiz_self_after_intro:"Waiting for your partner to finish watching the introduction.",waiting_message_quiz_group_after_self:"Waiting for your partner to choose his or her individual answer. (Do not discuss your answer with your partner.)",waiting_message_quiz_end_after_group:"Waiting for your partner to choose his or her answer after the discussion.",waiting_message_video_after_quiz_end:"Waiting for your partner to finish watching the teacher's explanation.",prevent_seek_forward:"Please do not skip ahead of your partner.",can_not_leave_this_status:"{{name}} did not finish this status, you can not go to the next status",other_student_ended_session:"{{name}} ended the distance peer session ",student_cancelled:"{{name}} cancelled the invitation"},editor:{explanation:"Explanation",quiz_question:"Quiz Question",quiz_time:"Quiz Time",marker_time:"Marker Time",note_time:"Note Time",note_duration:"Note Duration",note_as_slide:"Fullscreen Note",note_as_slide_description:" (This note will pause the video until the student clicks Continue.)",note_as_slide_empty_description:"Put in your text below in the Annotations box.",start_time:"Start Time",end_time:"End Time",intro_timer:"Intro Timer",self_timer:"Self Timer",group_timer:"Group Timer",discussion_timer:"Discussion Timer",preview_inclass:"Preview in-class",incorrect_format_time:"Incorrect Format for Time",cannot_delete_alteast_one_answer:"Cannot delete, there must be alteast one answer",time_outside_range:"Time Outside Video Range",start_time_bigger_than_end_time:"End time must be after start time",header:"Header",answer:"@:global.answer",inclass_student_note:"Why did you choose that answer? (For your own notes.)",type:"Type",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",note:"@:global.note",course_editor:"Course Editor",link_editor:"Link Editor",video_editor:"Video Editor",correct:"@:global.correct",incorrect:"@:global.incorrect",quiz_editor:"Quiz Editor",survey_editor:"Survey Editor",module_editor:"Module Editor",title:"@:global.title",annotation:"Annotation",tooltip:{invisible:"Not currently visible to students.",invisible_quiz:"Unpublished: not visible to students.",invisible_cont:"Will be visible",students_must_complete_inorder:"Students must complete this item before going on to the next item in the module",students_must_complete_required:"All required items must be completed on-time for the student to receive credit for the module",students_can_not_skep_ahead:"@:editor.details.skip_ahead_description",click_to_delete:"Click here to delete, click outside to close",create_link_time:"Create a link to this time in the video",video_info:"Only YouTube URLs and MP4 H.264 encoded videos are allowed",click_add_question:"Click or type 'i' to add a question",click_add_marker:"Click or type 'm' to add a marker",click_add_note:"Click or type 'n' to add a note. Press 'shift-n' to add a note and continue playing.",quiz_publish_status:"Module not visible to students. Please make sure module is visible before publishing"},drag:{start:"Start",end:"End",instruction:"Enter the name for draggable item and position its Start and End locations on the screen.",correct:"This item is correct here because",incorrect:"Item {{num}} would be incorrect here because"},messages:{random_answers:"The answers below will be presented to the student in random order",provide_answer:"Please provide the answer text for each choice",quiz_no_answer:"Quiz doesn't have a correct answer",enter_url:"Enter the video Title and URL",enter_url_continue:"in the Details on the right.",for_help:"For help uploading videos",for_help_continue:"See 'Getting Started' in the Help menu",double_click_new_answer:"Double-click on the video to add a new answer.",drag_to_reorder:"Drag to reorder"},home:{choose_module:"Choose a module to the left view and edit its contents.",drag_module:"Drag modules around to re-order them.",create_module:"Create modules to organize your course contents.",choose_add:" Add videos, quizzes, surveys, and links.",preview_see:"Preview as Student to see how your content will appear to students",right_click:"Right-click on an item to Copy, Paste, or Share it with other teachers."},regex:{enter_string:"Enter the string to match or a regular expression",correct_if:"will only be correct if the student enters",correct_for:"will be correct for",any_integer:"any integer number between 0 and 9",numbers:"the numbers 10, 14 and 29"},details:{duration:"@:global.duration",details:"Details",video:"@:global.video",video_type:"Video Type",add_video:"Add link to video",add_description:"Add description",title:"@:global.title",description:"@:global.description",instructions:"Instructions",set_date:"Set Date",use_module:"Use Module’s Visibility",use_module_due:"Use Module’s Due Date",use_module_in_order:"Use Module’s Order",use_module_required:"Use Module’s Required",use_module_skip_ahead:"Use Module’s Skip Ahead",vidoe_not_exist:"Video may not exist or may still be uploading",incompatible_video_link:"Invalid movie type. Please provide a valid YouTube, .mp4 or a MediaSite URL.",student_link_lecture:"Student link to lecture",appearance_date:"Appearance Date",due_date:"Due Date",quizzes:"@:global.quizzes",markers:"Markers",note:"Notes",student_link_module:"Student link to module",has_due_date:"has due date",required:"@:global.required",skip_ahead:"Skip Ahead",in_order:"In Order",retries:"Retries",display_text:"Display question over video",display_text_explain:"(Use if the question text is not in the video.)",student_link_quiz:"Student link to quiz",skip_ahead_description:"Allow students to skip ahead in video"},popover:{shown_in_graph:"Shown on results graph",shown_to_student:"Shown to students"},button:{add_video_quiz:"Add Video Quiz Here",add_marker:"Add Marker",show_all_quizzes:"Show All Quizzes",add_content:"Add Content",add_answer:"Add Answer",add_question:"Add Question",add_header:"Add Header",add_module:"Add Module",preview_student:"@:global.preview_student",add_note:"Add Note"}},lectures:{messages:{thank_you_answer:"Thank you for your answer",press_to_continue:"Press play to continue.",did_not_get_credit:"You did not get credit for this video. To get credit for a required video you need to watch the whole thing (no skipping) and answer each question (you don't have to get them right, though).",please_choose_one_answer:"Please choose at least one answer",please_choose_an_answer:"Please choose your answer(s).",finish_before_proceeding:"Please finish previous required lectures before proceeding",really_confused_use_question:"You could ask a question so the teacher can help you.",navigate_away:"Are you sure you want to navigate away from this page?",change_lost:"Your changes will be lost!"},timeline:{timeline:"Timeline",slides:"Slides",description:"@:global.description",question:"@:global.question",confused:"@:global.confused",really_confused:"@:global.really_confused",note:"@:global.note",quiz:"@:global.quiz",marker:"@:global.marker",watched:"Watched",quizzes:"quizzes",required_quizzes:"required quizzes"},button:{ask_question:"Ask a Question",new_note:"New Note",im_confused:"I'm Confused",exit_fullscreen:"Exit Fullscreen",fullscreen:"Fullscreen",check_answer:"Check Answer",start_distance_peer:"Start Distance Peer Instruction",submit:"@:button.submit",submit_my_vote:"Submit my vote"},tooltip:{unsolved_quiz:"You have to complete the quiz as part of the video before you can jump to it",click_or_type_note:"Click or type N to add a note",click_or_type_question:"Click or type Q to ask a question",click_or_type_confused:"Click or type C to say confused",click_or_type_fullscreen:"Click or type F to enter fullscreen",click_or_type_smallscreen:"Click or type F to enter smallscreen",video_shortcut:"press J to rewind 10s or K for play/pause or L for fast forward 10s"},correct:"@:global.correct",incorrect:"@:global.incorrect",confused:"@:global.confused",really_confused:"@:global.really_confused",hover_for_explanation:"Hover for explanation",tap_for_explanation:"Tap for explanation",multiple_correct:"There may be multiple correct answers",other_correct_answers:"There may be other correct answers as well",must_place_items:"You must place all items",answer_question:"Please answer the question",choose_correct_answer:"Please choose the correct answer(s)",answer:"@:global.answer",choices:"Choices",optional:"@:global.optional"},progress:{title:"@:global.title",discussion:"@:global.discussion",free_text_question:"@:global.free_text_question",related:"Related",of_student_review:"voted for review",questions:"@:global.questions",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",out_of:"Out Of",number_of_students:"@:global.number_of_students",confused:"@:global.confused",really_confused:"@:global.really_confused",back:"@:global.back",pauses:"Pauses",finished_on_time:"Finished on Time",finished_not_on_time:"Finished Not on Time",not_finished:"Not Finished",grade:"Grade",course_graph_desc:"Lecture and quiz completion percentages for all students",based_on_invideo:"Based on in-video questions answered",button:{hide:"@:button.hide",make_visible:"Make Survey Visible to Students",see_all:"See All",export_chart:"Export Chart",show_in_class:"Show in class",reply:"@:button.reply",send_reply:"Post reply and send message to student"},tooltip:{see_related:"See related answers to student",quizzes_solved:"quizzes required solved",quizzes_optional_solved:"optional quizzes solved",watched_video:"Watched",correct:"@:global.correct",question_not_checked:"@:dashboard.not_checked",completed:"@:events.completed"},popover:{change_status:"Change Status",original:"Original",on_time:"On Time",not_done:"Not Done"},shortcuts:{go_next_item:"Go to next item",go_previous_item:"Go to previous item",go_inside_item:"Go inside an item",go_outside_item:"Go outside an item",seek_to_location:"Seek to location",resize_video:"Resize video",mark:"Mark",reply:"@:button.reply"},chart:{not_started_watching:"Not Started Watching",watched:"Watched",completed_on_time:"Completed on Time",completed_late:"Completed Late",module_progress_charts_quizzes:"Module Progress Charts - Based on invideo quizzes",module_progress:"Module Progress",answered:"Answered"},home:{module_completion:"Module Completion",review_module:"Review Module",module_review:"Module Review",module_timeline:"Module Timeline",review_course:"Review Course",course_completion:"Course Completion",course_graph:"Course Graph",view_respond_students:"View and respond to students’ quizzes and questions, and choose material for in-class.",view_interaction:"View student interactions across a module.",view_module_completed:"View which students have completed each video in a module on-time or late.",view_course_completed:"View which students have completed each module on-time or late.",view_course_graph:"View a percentage graph of overall lectures and quizzes completion."}},quizzes:{used_up_all:"Used up all",attempts:" attempts",attempt_number:"Attempt number",must_choose_answer:"Must choose at least one answer",optional:"@:global.optional",already_submitted:"You've submitted the",no_more_attempts:"and have no more attempts left",grade:{under_review:"Under Review",partial:"Partial",correct:"@:global.correct",incorrect:"@:global.incorrect"}},enrollment:{enter_enrollment:"Please Enter Enrollment Key",get_enrollment_key:"Please contact your instructor if you didn't receive it.",enrollement_key_format:"You should receive an enrollement key of the form",enroll:"Enroll"},enrolled_students:{name:"@:global.name",email:"@:global.email",remove_student:"Remove students",enrolled_students:"@:navigation.enrolled_students",help_enroll_student:"Help on enrolling students",select_all:"Select All",deselect_all:"Deselect All",done:"@:global.done",export_as:"Export Student List"},groups:{module:"Module",groups:"Groups",statistics:{videos:"@:global.videos",customlinks:"@:global.customlinks",quizzes:"@:global.quizzes",surveys:"@:global.surveys",video_quizzes:"@:global.video_quizzes",questions:"@:global.questions"},delete_popup:{warning:"@:global.warning",delete_module:"Deleting the module",will_delete:"will delete all items inside it.",are_you_sure:"@:global.are_you_sure"}},courses:{information:{adding_teacher:"A teacher or TA must have a teacher account on",create_account:"To create a teacher account visit",go_to_course:"Go to Course",edit_course:"Edit Course",description:"@:global.description",done:"@:global.done",professor:"Professor",prof:"@:courses.information.professor",ta:"TA",discussion_forum_link:"Discussion Forum Link",enrollment_key:"Enrollment Key",enrollment_url:"Enrollment URL",course_link:"Course Link",taught_by:"Taught by",taught_by_small_cap:"taught by",receive_student_ask_email:"Receive email when a student asks a question",receive_due_dates_email_question:"Would you like to receive email reminders about your course deadlines?",receive_due_date_email:"Receive email reminders of upcoming due dates.",receive_student_ask_email_question:"Would you like to receive an email whenever a student asks a question with a link to reply?",change_email_question:"(You can change this at any time on the Course Information page.)",button:{add_teacher:"Add Teacher",remove_teacher:"Remove Teacher",export_as:"Export anonymized course data",invite:"Invite to Join",send_email_reminder:"Send email reminders"},tooltip:{click_to_copy:"Click to Copy"}},list:{finished:"Finished",all_finished:"@:courses.list.finished",all:"All",current:"Current",duration:"@:global.duration",lectures:"@:global.lectures",quizzes:"@:global.quizzes",surveys:"@:global.surveys",number_of_students:"@:global.number_of_students",importing_data:"Importing Data",button:{new_course:"@:global.new_course",back:"@:global.back",sort_by:"Sort By"},messages:{no_courses:"Currently, you don't have any courses you can access. You can start by adding one.",enroll_instruction:"To enroll in a course choose 'Join a new course' from the Courses menu and enter the Enrollment Key from your instructor.",create_enroll_instruction:"To create or enroll in a course choose 'New course' or 'Join a new course' from the My Courses menu and enter the Enrollment Key from your instructor.",enroll_instruction:"To enroll in a new course, choose 'Join a new course' from the My Courses menu and enter the Enrollment Key from your instructor.",create_instruction:"To create a new course, choose 'Create a new course' from the My Courses menu."},tooltip:{unenroll:"Unenroll"},delete_popup:{warning:"@:global.warning",delete_course:"Deleting the course",will_delete:"will delete",all_modules:"All modules",all_items:"All items inside each modules",all_progress:"All students progress",are_you_sure:"Are you sure you want to proceed?",cannot_undo:"This cannot be undone!"}},"new":{button:{create_course:"Create Course",unselect:"Unselect"},copy_from_existing:"Copy Data from Existing Course",course_item_shift:"Course items will be shifted according to the course start date."},start_date:"Start Date",end_date:"End Date",disable_registration:"Disable Registration After",limit_registration_domain:"Registrable Schools",limit_registration_domain_description:"Allow only students from specific school domains to register",limit_registration_all_students:"Allow any student to register",duration:"Course Duration (weeks)",prerequisites:"Prerequisites",course_image_url:"Course Image URL",short_name:"Short Name",time_zone:"Course Timezone",course_code:"Course Code",course_name:"Course Name",university_note:"University Note"},statistics:{statistics:"Statistics",administration:"Administration",statistics_dashboard:"Statistics Dashboard",registration:"Registration",report_period:"Report Period",generate_report:"Generate Report",login:"@:navigation.login",lecture_views:"Lecture Views",questions_asked:"Questions Asked",confused:"@:global.confused",courses_created:"Courses Created",lectures_created:"Lectures Created",video_quizzes_created:"Video Quizzes Created",normal_quizzes_created:"Normal Quizzes Created",surveys_created:"Surveys Created",video_quizzes_solved:"Video Quizzes Solved",normal_quizzes_solved:"Normal Quizzes Solved",surveys_solved:"Surveys Solved",total_courses:"Total Courses",total_students:"Total Students",total_teachers:"Total Teachers",total_lectures:"Total Lectures",total_quizzes:"Total Quizzes",total_surveys:"Total Surveys",total_questions_asked:"Total Questions Asked",total_confused:"Total Confused",rate_from:"rate from",to:"to",drag_to_zoom:"Click and drag in the plot area to zoom in",pinch_to_zoom:"Pinch the chart to zoom in",write_welcome_message:"Write welcome message"},player:{click_video_quality:"Click to change video quality",quality:"Quality",speed:"Speed"},announcements:{create_announcement:"New Announcement",empty:"No announcements yet.",post:"Post announcements to the class here"},help:{getting_started:{getting_started:"Getting Started",student:"for Students",teacher:"for Teachers"},support:"Support",teacher_forum:"Teacher Forum",instruction_manual:"Instruction Manual",tips:"Tips",how_to_flip:"How to Flip your Class",privacy_faq:"Privacy & FAQ"},course_settings:{show_notes:"Show Notes",show_quizzes:"Show Quizzes",show_surveys:"Show Surveys",show_confused:"Show Confused",show_markers:"Show Markers",show_charts:"Show Charts",show_discussion:"Show Discussion",show_lecture_quizzes:"Show Lecture Quizzes",print:"Print",download_notes:"Download Notes"},content:{add_new_content:"Add New Content",types:{customlink:"@:global.customlink",video:"@:global.video",inclass_video:"@:global.inclass_lecture",distance_peer_video:"@:global.distance_peer_lecture",video_desc:"You can add quiz questions on top of the video.",quiz:"@:global.quiz",survey:"@:global.survey",link_desc:"Web link to other sites or pages.",quiz_or_survey:"Quiz or Survey",quiz_or_survey_desc:"Text-based, not part of a video. Can be graded or optional."},questions:{insert_video_question:"Insert a Video Question",categories:{on_video:{title:"On-video Quiz",desc:"Place quiz choices on top of the video. Use this if the answers are visible in the video."},text_quiz:{title:"Text Quiz",desc:"Text quiz on a white background. Use this if the quiz answers are not visible in the video."},on_video_survey:{title:"On-video Survey",desc:"Surveys have no correct answer. Use this if the survey choices are visible in the video."},text_survey:{title:"Text Survey",desc:"Text Surveys have no correct answer on a white background. Use this if the survey choices are not visible in the video."}},types:{ocq:"One answer",mcq:"Multiple answers",drag:"Drag and drop",text:"Free text answer"},quiz_types:{mcq:"Multiple Choice (multiple correct answers)",ocq:"Multiple Choice (one correct answer)",drag:"Drag-and-Drop (ordering)",text:"Free Answer (text answer)",free_text:"Free Text",match_text:"Match Text"},survey_types:{mcq:"Multiple Choice (multiple selections)",ocq:"Multiple Choice (one selection)"}}},languages:{languages:"Languages",en:"English",sv:"Svenska"},welcome_messages:{description:"Enter the text to display to users from the {{domain}} domain when they log in. This text will be displayed at the top of the 'Create Course' page."}},full_calendar_en={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{today:"Today",month:"Month",week:"Week",day:"Day"}},translation_sv={global:{name:"Namn",email:"E-post-adress",at:"vid",edit:"Redigera",empty:"Fältet är tomt",back:"Tillbaka",pref_language:"Språkinställning",welcome:"Välkommen",to:"till",or:"eller",and:"och",from:"från",preview_student:"Förhandsvisa som student",exit_preview_as_student:"Gå ur förhandsvisning som student",settings:"Inställningar",question:"Fråga",questions:"frågor",duration:"Längd",video:"Video",videos:"Videos",inclass_lecture:"I klassrummet video",distance_peer_lecture:"Distance-peer video",customlink:"Länk",customlinks:"Länkar",title:"Titel",description:"Beskrivning",note:"Anteckning",discussion:"Diskussion",discussions:"Diskussioner",number_of_students:"Antal studenter",copy:"Kopia",please:"Var god",please_wait:"Var god vänta",lecture:"@:global.video",lectures:"@:global.videos",courses:"kurser",module:"modul",overview:"Modul Sammanfattning",quiz:"Quiz",quizzes:"Quiz-frågor",video_quizzes:"Video-quiz-frågor",video_quiz:"Video-quiz",survey:"Enkät",surveys:"Enkäter",marker:"Markering",markers:"Markeringar",answer:"Svar",free_text_question:"Fritext-fråga",confused:"Förvirrad",really_confused:"Verkligen förvirrad",search:"Sök",new_course:"Skapa ny kurs",required:"Nödvändig",optional:"Valfri",students:"Studenter",teacher:"lärare",student:"student",done:"Klart",correct:"Korrekt",incorrect:"Felaktig",warning:"Varning",are_you_sure:"Är du säker på att du vill fortsätta?",visible:"Synlig",leave:"Lämna",stay:"Stanna",votes:"Röster",no:"Nej",courses_list:"kurser List"},mailer:{send_email:"Skicka ett mail",to:"Till",send:"Skicka",subject:"Ämne",email_body:"Textyta"},error_message:{connected:"Ansluten",cant_connect_to_server:"Kan inte ansluta till servern",invalid_email:"Ogiltig e-post-adress",got_some_errors:"Rätta till felen ovan",required:"@:global.required",invalid_input:"Ogiltiga indata",due_date_changed:"Färdigdatum har ändrats.",you_are_not_authorized:"Du har inte behörighet att visa den begärda sidan",update_account_information:"Vänligen uppdatera din kontoinformation för att använda den nya versionen av Scalable Learning.",select_module_first:"Välj först en modul i menyn.",change_password_confirmation:"Du har nu ändrat ditt lösenord.",confirm_change_email:"Du har nu ändrat ditt E-post-adress.",export_course:"Dina anonymiserade kursdata kommer strax att skickas dig via email",export_student:"Listan över dina studenter kommer strax att skickas dig via email",export_school_administration:"Statistiken kommer strax att skickas dig via email",another_marker:"Det finns en annan markör vid samma tid",remove_your_self:"Du har framgångsrikt tagits bort från kursen",slow:{server:"Videoservern",is_slow:" tar lång tid på sig för att visa den här videon",try_reload:"Du kan fortsätta vänta eller prova att uppdatera sidan"},welcome_message_updated:"Välkommen Meddelande uppdaterad"},time:{hours:"timmar",minutes:"minuter",seconds:"Sekunder",weeks:"Veckor",today:"Idag",day:"dag",days:"dagar",ago:"sedan"},tooltip:{list_view:"Listvy",grid_view:"Rutnätsvy"},button:{yes:"Ja",no:"Nej",next:"Nästa",submit:"Skicka in",save:"Spara",publish:"Publicera",unpublish:"Opublicera",save_close:"Spara och stäng",close:"Stäng","delete":"Radera",send:"Skicka",cancel:"Avbryt",show:"Visa",save_changes:"Spara ändringar",remove:"Ta bort",replay:"Spela igen",retry:"Försök igen",reply:"Svara",hide:"Göm",refresh:"Uppdatera skärmen",vote:"Rösta","continue":"Fortsätt",no_thanks:"Nej tack"},support:{ipad:"Stöd för iPad är för närvarande i beta.",mobiles:"Mobila enheter har för närvarande inte fullständigt stöd.",issue_and_recommendation:"Studentvideostöd är tillgängligt för Android 4.4 och senare och iOS 10.3 och senare. Vi rekommenderar att lärare använder en skrivbords-webbläsare för bästa resultat.",ie_disclaimer:"Internet Explorer stöder inte alla interaktiva videofunktioner som används av Scalable Learning. Vi rekommenderar att du använder"},navigation:{logout:"Logga ut",login:"Inloggning",account_information:"Kontoinformation",courses:"Mina kurser",notifications:"Meddelanden",notification:"Meddelande",dashboard:"Instrumentpanel",settings:"Inställningar",account:"Konto",show_all_courses:"Visa mina kurser",copied_from:"Kopierad från",description:{settings_description:"Ändra dina kontoinställningar"},progress:"Framsteg",in_class:"I klassrummet",calendar:"Kalender",announcements:"Meddelanden",calendar_and_announcements:"Kalender och meddelanden",content:"Kursinnehåll",information:"Information",course_information:"Kursinformation",enrolled_students:"Inskrivna studenter",teachers:"Lärare",lectures:"Videos",help:"Hjälp",add_students:"Lägg till studenter",administration:"Administrera",add_teacher:"Lägg till lärare/assistent",student_list:"Lista av studenter",join_course:"Delta i en ny kurs (elev)",new_course:"Skapa en ny kurs (lärare)",review:"Bedöm",welcome_message:"Välkommen Meddelande",register:{teacher:"Lärare, registrering",student:"Student, registrering"},teacher:"För lärare",student:"För elever",int_video:"Ny på ScalableLearning? Prova att se en kort introduktions-video för att komma igång fortare."},content_navigator:{customlink:"@:global.customlink",lecture:"@:global.lecture",inclass_lecture:"@:global.inclass_lecture",quiz:"@:global.quiz",survey:"@:global.survey",empty:"Kursen saknar innehåll",select_module:"Välj en modul"},discussion:{private_post:"Privat inlägg",public_post:"Öppet inlägg",comment:"Kommentera",like:"Rösta för",unlike:"Rösta emot",write_comment:"Lämna en kommentar...",flag_post:"Flagga detta inlägg",flag:"Flagga",unflag:"Av-flagga",flagged_post:"Flaggade inlägget",flagged_comment:"Flaggade kommentaren",unflag_post:"Av-flagga detta inlägg",flags:"Flaggor",likes:"Gillar",remove_flags:"Ta bort flaggor",private_discussion:"Privat diskussion (ses endast av läraren)",public_discussion:"Öppen diskussion (ses av alla)",cannot_be_empty:"kan inte vara tomt",cannot_ask_question_preview:"Du kan inte ställa frågor medan du förhandsgranskar som student",q:"F.",edited:"redigerad",button:{ask:"Fråga",cancel:"@:button.cancel",save:"@:button.save"}},context_menu:{copy:"@:global.copy",paste:"Klistra in",share:"Dela",share_copy:"Dela markerat objekt"},sharing:{nothing_selected:"Inget är valt",please_enter_email:"Ange en e-post-adress",teacher_email:"Lärarens e-post-adress",with_you:"Delat med dig",view:"Visa delat",manage:"Hantera delat",shared_from:"Data delas av ",shared_by:"delas med,",to_course:"till kurs",to_module:"till modul",copy:"@:global.copy",lecture:"@:global.lecture",items:"objekt",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",customlink:"@:global.customlink"},footer:{about:"Om ",privacy:"Sekretesspolicy",faq:"Vanliga frågor"},feedback:{like_to_comment:"Vad är din fråga, kommentar, eller problem?",what_you_think:"Vad behöver du hjälp med?",instructions:"Detta för att hjälpa oss att ge ett så korrekt svar så fort som möjligt.",provide_desciption:"Hjälp oss med en beskrivning av ditt problem!",provide_email_name:"Lämna ditt namn och e-post så att vi kan återkomma till dig!",thanks:"Tack för din kommentar! Vi återkommer till dig snart.",leave_feedback:"Ge oss alla detaljer. Ju mer vi vet, dess då lättare och bättre kan vi hjälpa dig.",course_content:"Mitt kursinnehåll",system:"Scalable Learnings webbplats",none:"Var god välj en...",no_access:"Jag får inte access till mitt konto",question_before_sign:"Innan jag registrerar mig har jag en fråga",request_feature:"Jag skulle vilja föreslå ny funktionalitet",no_email:"Jag får ingen email",confused:"Jag är förvirrad och förstår inte hur det hänger ihop",bug:"Jag tror att något inte fungerar som det ska",other:"Annat"},enroll_email:{go_to:"(Om du inte förstår instruktionerna ovan, gå till",help_enroll:"Hjälp med registrering",instruction:"Studenter anmäler sig genom att först registrera sig på Scalable Learnings webbplats och sedan mata in kursnyckeln. För att hjälpa eleverna med detta, skicka ett e-postmeddelande med följande instruktioner.",dear_student:"Hej!",this_term_new_system_part_1:"I denna termins upplaga av  {{course_name}} kommer vi att använda oss utav ScalableLearning för att kunna erbjuda en mer interaktiv inlärning.  För att komma igång gå till ",this_term_new_system_part_2:" och logga in med ditt skolmail.",create_account_with_university_:"och skapa ett konto med din e-postadress från din skola/universitet.",add_course_by_choosing_part_1:" logga in med ditt skol-email, och välj sedan 'Delta i en ny kurs' under menyn 'Mina kurser' och ange kursnyckel",add_course_by_choosing_part_2:" för att delta i {{short_name}}. Om du har några frågor, var god använd 'Support' formuläret under menyn 'Hjälp'.",add_course_by_url:" Följ denna länk",sincerely:"Vänliga hälsningar",to_get_started:"För	att	få	igång	era	eleverna,	skicka	följande	email	till	er	klass:",if_problem:"om det uppstår problem:",ask_student:"Be	eleven	att",check_spam:"kontrollera	SPAM	filtren",conf_email:"för	konfirmations-mail.",enroll_manual:"registrera	manuellt",by_go:"genom	att	 gå	 till",and_joining:"och	gå	 med	 genom	 att	 använda	registrerings-nyckeln",contact:"Kontakta	support",from_help:"från	Hjälp-menyn.",guest_stu:"Gäststudent:",you_may:"Du 	kan	invitera	andra	att	gå	med	din	 kurs	som	gäster	genom	att	 gå	till",guest_may:"Gäster	kan	se	allt	online	material,	men	deras	svar	och	frågot	kommer	inte	 att	synas	för	läraren.	Gäster	kan	registrera	sig	via	länken	ovan	eller	med	en	registrerings-nyckel	för	gäster"},account:{password:{change_password:"Ändra mitt lösenord",new_password:"Nytt lösenord",forgot_password:"Återställ lösenord",send_reset:"Skicka mig instruktioner för att återställa lösenordet",resetting:"Återställer lösenord",need_password:"Vi behöver ditt nuvarande lösenord för att bekräfta dina ändringar.",password_confirmation:"Bekräfta lösenord",password:"Lösenord",current_password:"Nuvarande lösenord"},confirm_account:"Bekräfta Konto",confirmation_token:"Bekräftelsekod",resend_confirmation:"Skicka bekräftelse och instruktioner igen",didnt_receive_confirmation:"Skicka e-postbekräftelsen igen",cancel_account:"Ta bort mitt konto",first_name:"Förnamn",last_name:"Efternamn",screen_name:"Ditt online-namn",university:"Skola eller universitet",saml_disable_edit:"Namn, email och information tillhandahållen av högskolan/universitet. Om du behöver ändra något i denna info var vänlig ta kontakt med högskolans/universitetets tekniska support.",first_day:"Första dagen i veckan för kalendern",link:"Hemsida",security:"Säkerhet",avatar_comment:"Du kan byta din avatar på ",online_name_comment:"(Ditt online-namn visas för andra elever och lärare när du skriver kommentarer eller ställer frågor. Du kan ändra det till vad du vill.)",password_comment:"Skriv in ett nytt lösenord som ersätter ditt gamla.",school_email:"E-post-adress",sign_up:"Registrera dig",sign_in:"Logga in",can_not_use_domain:"Du kan inte registrera sig med den här domänen. För att skapa ett konto, logga in via din skola.",login:"@:navigation.login",join:"Registrera",remember_me:"Förbli inloggad",confirm_destroy:"Är det riktigt att du vill ta bort ditt konto?",confirm_destroy_note:"Observera att alla data kommer att tas bort från systemet och kan inte återställas.",required_marked:"Obligatoriska fält är markerade med *",use_school:"Använd kontot på din skola/universitet",school_not_listed:"Om din skola inte finns med på listan, så kan du logga in med ett konto på ScalableLearning nedan",use_scalable:"Använd ett konto på ScalableLearning",login_with:"Logga in med",other_login:"Andra inloggnings-alternativ",sign_through:"Logga in via",im_student:"Jag är student",im_teacher:"Jag är lärare",back:"@:global.back",go_to_support:"Om du behöver hjälp, gå till Support under Hjälp-menyn",account_confirmed:"Ditt konto {{email}} har konfirmerats.",start_using:"att börja använda",invalid_confirmation:"Bekräftelselänken är inte längre giltigt. (Det har antingen gått ut eller har redan använts.)",click_here:"Klicka här",new_confirmation:"För att få en ny bekräftelse länk vänligen",already_confirmation:"Om du redan har bekräftat ditt konto,"},lti:{embed:"Bädda in",lti:"Länkas till din skolas LMS",select:"Välj",courses:"@:global.courses",modules:"moduler",items:"@:sharing.items",no_account:"Du har inget konto på Scalable Learning. För att skapa ett konto, klicka på",contact_teacher:"Du är inte lärare/assistent på denna kurs hos Scalable Learning. Vänligen kontakta kursens ägare för att lägga till dig som lärare/assistent på kursen"},events:{due:"Förfaller",deadline_msg:"Alla deadlines är vid midnatt den angivna dagen.",done:"@:global.done",done_late:"Klart sent",not_done:"Inte klart",not_done_late:"Inte klart och sen",not_done_due:"Inte klart eller skall vara färdigt inom 2 dagar",completed_on_time:"@:progress.chart.completed_on_time",complete:"Klart",late:"sen",due_date_passed:"Färdigdatum har passerats",drag_due_date_error_part_1:"Du kan inte flytta ",drag_due_date_error_part_2:"färdigdatum före dess publiceringsdatum. För att ändra publiceringsdatum, klicka på ",drag_due_date_error_part_3:" och välj redigera."},notification:{invited:"Du har blivit inbjuden till kursen {{course}} av {{user}} som {{role}}",shared:"{{user}} har delat sina kursuppgifter med dig",accept:"Acceptera",reject:"Avböj",reviewed_inclass:"Vill du att läraren skall gå igenom denna fråga i klassrummet"},privacy:{policy:"Sekretesspolicy",information_collect:"Information som vi samlar in",information_collect_details:"Vi samlar in information om hur du använder webbplatsen och interagerar med det pedagogiska innehållet. Detta inkluderar studenters svar på quiz-frågor, vilka videor som spelas, pauser, tillbakaspolning, frågor som ställs och besvaras, klick på förvirrad-knappen, svar på enkäter och allmän navigering inom webbplatsen. Vi samlar också in information om hur lärare använder webbplatsen, inklusive användning av verktygen för att skapa kurser, för att visualisera framsteg, för genomgång i klassrummet och allmän navigering inom webbplatsen. Denna information inkluderar tiden, typen av åtgärd, eventuell respons och kontot associerat med åtgärden.",information_use:"Hur vi använder informationen",information_use_details:"Vi använder denna information för att förbättra Scalable Learning och för att lära oss hur vi kan förbättra undervisning och lärande. Till exempel används informationen om studenterna för att hjälpa lärare att förstå hur deras studenter lär sig (svar på quiz-frågor), var studenterna har svårigheter i sina kurser (videostatistik) och vilka typer av frågor de har (enkäter och anonyma enkäter). Studenter som svarar anonymt på enkäter är alltid anonyma för lärarna. Informationen om lärarna används för att utveckla bättre gränssnitt och för att identifiera hur vi bättre kan visa var studenterna behöver mer hjälp.",information_use_details2:"Vi använder även denna information för forskning på bättre undervisningsmetoder och på de verktyg vi tillhandahåller. All information som används för forskning anonymiseras genom att ta bort studenternas namn och e-postadresser",confidentiality_and_security:"Sekretess och säkerhet",confidentiality_and_security_details:"Vi tar din integritet och säkerhet på allvar. Vi lovar att aldrig ge din personligt identifierbara information till tredje part utan ditt medgivande. Dina uppgifter kommer att lagras och skyddas enligt branschens normer.",use_of_cookies:"Användning av cookies",use_of_cookies_details:"Cookies används på denna webbplats för att komma ihåg dina inloggningsuppgifter. Medan du är inloggad används en cookie för att spåra din inloggningssession. Denna cookie upphör att gälla när du stänger webbläsaren eller loggar ut. Om du väljer “Kom ihåg mig” när du loggar in så finns cookien kvar i två veckor.",identifiable_information:"Personligt identifierbar information",identifiable_information_details:"Personligt identifierbar information knuten till ditt konto består av det namn och den email-adress som du anger då du registrerar ett konto på webbplatsen. Denna information är knuten till all din aktivitet på webbplatsen. Du kan kan nå, rätta och ta bort denna information via webbplatsens sida för kontoinformation. Vi lagrar IP-adressen för alla åtkomster till platsen i serverloggar för inloggade och icke-inloggade användare.",deleting_profile:"Ta bort din profil",deleting_profile_details:"Dina data sparas i systemet så länge du har ett gällande konto för du ska ha möjlighet att registrera dig för nya kurser. Om du raderar ditt konto, kommer alla din personligt identifierbara information att tas bort från systemet. Notera att det kan dröja en tid innan denna information har raderats från befintliga backupsystem. Ditt anonymiserade användarbeteende kan komma att sparas i forskningssyfte.",legal_entity:"Juridisk person",legal_entity_details:"ScalableLearning tillhandahålls av RISE SICS, Isafjordsgatan 22/Kistagången 16 SE-164 40 Kista, Sweden.",code_conduct:"GÉANT Data Protection Code of Conduct",code_conduct_details:"Denna sekretesspolicy följer GÉANT Data Protection Code of conduct, version 1.0, 14 juni 2013.",policy_changes:"Förändringar av sekretesspolicyn",policy_changes_details:"Den aktuella sekretesspolicyn kommer alltid att finnas på denna sida och vi uppmanar dig att besöka denna sida för att granska ändringar. Ändringar av sekretesspolicyn börjar gälla när de publiceras här.",last_update:"Senast uppdaterad: 2017-05-24",understand:"I understand",cancel:"Cancel"},faq:{faq:"Vanliga frågor",question1:"Vem äger den lagrade informationen?",answer1:"Kursinformationen ägs av den som skapat kursen. Studentinformationen ägs av studenten. Om en student tar bort sitt konto blir tidigare sparad informationen från deltagande i kurser kvar men helt anonymt.",question2:"Var lagras informationen och under vilket lands jurisdiktion?",answer2:"Informationen lagras på ett datacenter på Irland och ScalableLearning-tjänsten drivs under svensk jurisdiktion, med RISE SICS som ansvarig",question3:"Kan informationen kommas åt eller exporteras?",answer3:"Lärare kan exportera fullständig information från sina kurser.",question4:"Tas backuper av systemet?",answer4:"Det tas daglig backup.",question5:"Hur säkras lagring och överföring av information?",answer5:"Lagring och överföring säkras med kryptering, autenticering och skydd mot fysisk åtkomst enligt moderna industriella standarder.",question6:"Loggas trafiken?",answer6:"Trafiken loggas 4-10 dagar och är tillgänglig för utvecklingsgruppen för felsökning och andra utvecklingsändamål.",question7:"Hur säkras systemet?",answer7:"Se detaljerad information (på engelska) om vår applikationsplattform Heroku:"},intro:{title:"Introduktionsvideo",teacher_introduction:"Denna 10-minuters video ger dig en snabb introduktion till hur du lägger till videos och quizzar och följer dina studenters framsteg på nätet. Du kan",teacher_skip_intro:"introduktionen om du vill och kan alltid hitta hjälp under Hjälp-menyn.",student_introduction:"Denna 3-minuters video beskriver hur du använder",student_introduction_cont:"och hur man studerar effektivt i en flippad kurs. Du kan",student_skip_intro:"introduktionen om du vill och kan alltid hitta hjälp under Hjälp-menyn.",by_using_service:"Genom att använda den här tjänsten samtycker du till vår",redirect_courselist:"Går till din kurslista om ",skip:"hoppa över",go_to:"Om du inte förstår instruktionerna ovan, gå till"},dashboard:{large_calendar:"Stor kalender",small_calendar:"Liten kalender",export_calendar:"Exportera kalender",whats_new:"Nyheter",as_ical_file:"Som fil ",as_url:"Som länk ",student_completion:"Studenten slutför",student_completion:"Slutför",unanswered_questions:"Obesvarade",start_inclass:"@:inclass.start_inclass",review_select_inclass_material:"Gransla & välj in-class material",review_quiz:"Granska quiz",my_questions:"Mina frågor",try_again:"Försök igen",ontime:"I tid",incomplete:"Ofullständig",complete:"Komplett",more_than:"Mer än",less_than:"Mindre än",not_started:"Inte börjat",between:"Mellan",never_tried:"Aldrig provat",solved:"Lösta",not_checked:"Ej markerad",final_try:"slutliga försök",first_try:"första försöket",voted_for_review:"Röstade för granskning",click_for_information:"Klicka för mer information",inclass_question:"In-class fråga",distance_peer_question:"Distance-peer fråga",complete_video:"Var god se denna video klart",your:"Din",group:"grupp",individual:"enskild",shown_top:" visas på högst upp.",shown_below:" visas nedan.",is_not_checked:" är ej markerad.",was:" var",you:"Du",tried_once:", du försökte en gång.",tried_more_once:", du försökte dig mer än en gång.",not_first_try:" inte på första försöket.",on_first_try:" på första försöket.",you_solved_group_survey:"Du har fyllt i gruppenkäten.",you_not_answered_quiz:"Du har inte besvarat detta quiz",answered_survey:" besvarade denna enkät",answered:" svarade",answered_but_not_checked:"Du har provsvarat på detta test, men svaret har inte granskats av läraren än.",answered_but_not_checked_question:"Du har provsvarat på detta fråga, men svaret har inte granskats av läraren än.",answered_but_group:"Du har provat det här testet, men din ",not_checked_group:" har inte kontrollerats av läraren.",tried_not_correct_first:"Du har provat detta test en gång, men har ",self_not_correct_question:"Du har provat detta fråga , men har ",tried_not_correct_first_answer:"inte fått korrekt svar.",tried_not_correct_last:"Du har provat det här testet mer än en gång, men har",answered_correct_but:"Du har svaret korrekt, men ",you_answered:"Du har svaret ",click_retry_quiz:"Klicka för att försöka igen.",less_one_hour:"färdigdatum mindre än om en timme.",correct:"korrekt",incorrect:"felaktig",answer:"svar",survey:"enkät",continue_watching:"Fortsätt att titta",watch_again:"Titta igen",start_watching:"Börja titta"},inclass:{more:"mer",pause:"Paus",resume:"Återuppta",discussion:"@:global.discussion",discussions:"@:global.discussions",quizzes:"@:global.quizzes",surveys:"@:global.surveys",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",primary_marker:"@:global.marker",free_text_question:"@:global.free_text_question",confused:"@:global.confused",really_confused:"@:global.really_confused",video_quizzes:"@:global.video_quizzes",video_quiz:"@:global.video_quiz",hide:"@:button.hide",show:"@:button.show",video_only:"Endast Video",zoom_graph:"Zoom Graf",zoom_video:"Zooma Video",show_graph:"Visa Graf",exit:"Avsluta",blackscreen_close:"Klicka eller tryck på 'b' för att gå tillbaka",blackscreen_done:"Genomgången klar. Klicka på ESC för att avsluta",start_inclass:"Visa för genomgång i klassrummet",review:"Genomgång i klassrummet",time_estimate:"Tidsuppskattning för genomgång",total_inclass_time:"Sammanlagd lektions-tid",peer_problem_time:"Diskussion-tid",review_time:"Sammanlagd tid för genomgång",time_per_quiz:"Tid per quiz",time_per_question:"Tid per fråga",display_content:"Visa I-klassinnehåll",choose_module:"Välj en modul för att visa utvalt material i klassrummet",change_defaults:"byt standard-inställningar",intro_stage:"Introduktion",self_stage:"Individuell del",group_stage:"Grupp-del",discussion_stage:"Diskussions-del",session_not_started:"Lektionen har inte börjat",please_try_or_refresh:"Var god försök igen eller tryck på uppdatera-knappen (refresh) nedan",question_not_started:"Frågan har inte givits på lektionen än",click_next_question:"Klicka på 'Nästa' när frågan visas",multiple_choice:"multipla val",click_forward_result:"Tryck framåt för att se i klassrummet omröstningsresultat."},distance_peer:{invited:"Bjud in en elev för en Distance Peer session",invited_instruction:"Välj en elev",distance_peer_instruction:"Ring upp din partner medans du går igenom frågorna så att ni kan diskutera dem i realtid. Kom ihåg att för individuella quiz så ska ni svara var för sig, men för grupp-delen av ett quiz så uppmuntras ni att diskutera svaret sinsemellan.",invited_by:"Du är inbjuden",invited_by_instruction:"Tryck på knappen för den elev du vill samarbeta med ",wait_for_acceptance:"Vänta på acceptans",wait_for_acceptance_instruction:"Vänta på acceptans från elev eller inhibera inbjudan ",waiting_response_of_back_end:"Kontrollera om du är inbjuden att delta i en Distance Peer session ",invite_another_button:"Bjud in en annan elev",video_stage:"Var god se videon.",intro_stage:"Quiz:Intro",self_stage:"Quiz:Själv",multiple_choice:"@:inclass.multiple_choice",group_stage:"Quiz:Grupp",end_video_stage:"Quiz:Slut",end_peer_instruction:"Avsluta Distance Peer sessionen",in_distance_peer:"Du deltar i en Distance Peer session med namnet {{name}}.",the_another_student_finished_status:"{{name}} har slutfört {{status}}, du kan fortsätta",waiting_the_another_student_to_finish:"Väntar på att {{name}} ska slutföra {{status}}",click_on_button_below_to_end_session:"Klicka på knappen nedan för att avsluta Distance Peer sessionen",the_another_student_finished_message_video:"Snälla du titta på videon för att komma till peer-instruktionsfrågorna.",the_another_student_finished_message_quiz_intro:"Snälla du tryck på play för att titta på introduktionen av frågan.",the_another_student_finished_message_quiz_self:"Snälla du  välj ett svar frågan på egen hand. (Diskutera inte det med din partner.)",the_another_student_finished_message_quiz_group:"Snälla du diskutera ditt svar med din partner och välj ditt senaste svar. (Du behöver inte välja samma svar.)",the_another_student_finished_message_quiz_end:"Snälla du tryck på play för att titta på lärarens förklaring av svaret.",waiting_message_quiz_intro_after_video:"Väntar på att din partner slutföra titta på videon.",waiting_message_quiz_self_after_intro:"Väntar på att din partner slutföra titta på introduktionen.",waiting_message_quiz_group_after_self:"Väntar på din partner att välja sitt individuella svar. (Diskutera inte ditt svar med din partner.)",waiting_message_quiz_end_after_group:"Väntar på din partner att välja sitt svar efter diskussionen.",waiting_message_video_after_quiz_end:"Väntar på din partner att slutföra titta på lärarens förklaring.",prevent_seek_forward:"Var snäll och gå inte över din partner.",can_not_leave_this_part:"{{name}} har inte avslutat denna del än, så du kan inte fortsätta till nästa del",other_student_ended_session:"{{name}} avslutade Distance Peer sessionen",student_cancelled:"{{name}} avbrutit inbjudan."},editor:{explanation:"Förklaring",quiz_question:"Quiz-fråga",quiz_time:"Quiz-tidpunkt",marker_time:"Markörens tid",note_time:"Anteckning tid",note_duration:"Anteckning varaktighet",note_as_slide:"Fullskärm Anteckning",note_as_slide_description:" (Den här anteckningen pausar videon tills studenten klickar på Fortsätt.)",note_as_slide_empty_description:"Sätt i texten nedan i rutan annotering.",start_time:"Start-tid",end_time:"Slut-tid",intro_timer:"Timer Intro del",self_timer:"Timer individuell del",group_timer:"Timer grupp del",discussion_timer:"Timer diskussions del",preview_inclass:"Förhandsvisa lektion",incorrect_format_time:"Felaktigt format på tiden",cannot_delete_alteast_one_answer:"Kan inte ta bort; det måste finnas minst ett svar",time_outside_range:"Tid utanför videons speltid",start_time_bigger_than_end_time:"Slut-tid måste vara efter start-tid",header:"Rubrik",answer:"@:global.answer",inclass_student_note:"Varför valde du det svaret? (För dina egna anteckningar.)",type:"Typ",quiz:"@:global.quiz",survey:"@:global.survey",marker:"@:global.marker",note:"@:global.note",course_editor:"Redigera kurs",link_editor:"Redigera länk",video_editor:"Redigera video",correct:"@:global.correct",incorrect:"@:global.incorrect",quiz_editor:"Redigera Quiz",survey_editor:"Redigera Enkät",module_editor:"Redigera Modul",title:"@:global.title",annotation:"Annotering",tooltip:{invisible:"Inte synlig för eleverna.",invisible_quiz:"Opublicera: Inte synlig för eleverna.",invisible_con:"Kommer att synas på detta datum.",students_must_complete_inorder:"Studenter måste avsluta detta moment innan de går vidare",students_must_complete_required:"Alla nödvändiga objekt måste fyllas i, i tid, för att studenten ska få tillgodoräkna sig modulen",students_can_not_skep_ahead:"@:editor.details.skip_ahead_description",click_to_delete:"Klicka här för att ta bort, klicka utanför för att stänga",create_link_time:"Skapa en länk till den här tidpunkten i videon",video_info:"Endast YouTube-webbadresser och MP4-H.264-kodade videofilmer tillåts",click_add_question:"Klicka eller skriv 'i' för att lägga till en fråga.",click_add_marker:"Klicka eller skriv 'm' för att lägga till en markering",click_add_note:"Klicka eller skriv 'n' för att lägga till en notering. Tryck 'shift-n' för att lägga till en notering och fortsätta uppspelningen",quiz_publish_status:"Modul inte synlig för eleverna. Se till att modulen är synlig före publicering"},drag:{start:"Start",end:"Slut",instruction:"Ange namn för dragbara objekt och placera Start och Slut på skärmen.",correct:"Denna post är korrekt här eftersom",incorrect:"Punkt {{num}} skulle vara felaktig här eftersom"},messages:{random_answers:"Svaren nedan kommer att presenteras för studenten i slumpmässig ordning",provide_answer:"Ange svarstext för varje alternativ",quiz_no_answer:"Quizzen saknar korrekt svar",enter_url:"Ange videons titel och dess länk",enter_url_continue:"i Detaljer till höger.",for_help:"För hjälp att ladda upp videoklipp",for_help_continue:"Se 'Komma igång' i Hjälp-menyn",double_click_new_answer:"Dubbelklicka på videon för att lägga till ett nytt svar",drag_to_reorder:"Dra för att ordna"},home:{choose_module:"Välj en modul till vänster för att visa och redigera dess innehåll.",drag_module:"Dra moduler upp och ner för att ändra ordningen.",create_module:"Skapa moduler för att organisera dina kursinnehåll.",choose_add:"Lägg till videor, quizzar, undersökningar och länkar.",preview_see:"Förhandsvisa hur ditt innehåll kommer att visas för studenter",right_click:"Högerklicka på ett objekt för att kopiera, klistra, eller dela det med andra lärare."},regex:{enter_string:"Ange strängen för att matcha eller ett reguljärt uttryck",correct_if:"kommer endast vara korrekt för",correct_for:"kommer att vara korrekt för",any_integer:"varje heltal mellan 0 och 9",numbers:"siffrorna 10, 14 och 29"},details:{duration:"@:global.duration",details:"Detaljer",video:"@:global.video",video_type:"Video-typ",add_video:"Lägg till länk till videon",add_description:"Lägg till beskrivning",title:"@:global.title",description:"@:global.description",instructions:"Instruktioner",set_date:"Välj datum",use_module:"Använd modulens synlighet",use_module_due:"Använd modulens färdigdatum",use_module_in_order:"Använd moduls ordning",use_module_required:"Använd moduls nödvändighet",use_module_skip_ahead:"Använd moduls hoppa över",vidoe_not_exist:"Videon saknas eller laddas fortfarande upp",incompatible_video_link:"Ej valid filmtyp. Var god välj en YouTube, .mp4 eller MediaSite URL.",student_link_lecture:"Student-länk till video",appearance_date:"Publiceringsdatum",due_date:"Färdigdatum",quizzes:"@:global.quizzes",markers:"Markeringar",note:"Anteckningar",student_link_module:"Student-länk till modulen",has_due_date:"Har färdigdatum",required:"@:global.required",skip_ahead:"Hoppa över",in_order:"I ordning",retries:"försök",display_text:"Visa fråga över videon",display_text_explain:"(Använd om frågan texten är inte i videon.)",student_link_quiz:"Student-länk till quiz",skip_ahead_description:"Tillåta eleverna hoppa framåt i video"},popover:{shown_in_graph:"Visas i resultatdiagram",shown_to_student:"Visas för studenterna"},button:{add_video_quiz:"Lägg till video-quiz här",add_marker:"Lägg till markering",show_all_quizzes:"Visa alla quizzar",add_content:"Lägg till Innehåll",add_answer:"Lägg till svar",add_question:"Lägg till fråga",add_header:"Lägg till rubrik",add_module:"Lägg till modul",preview_student:"@:global.preview_student",add_note:"Lägg till en notering"}},lectures:{messages:{thank_you_answer:"Tack för ditt svar",press_to_continue:"Tryck spela till fortsätta.",did_not_get_credit:"Videon ej markerad som sedd. För att markeras som sedd måste hela videon ses och frågorna besvaras (men inte nödvändigtvis rätt!).",please_choose_one_answer:"Välj minst ett svar",please_choose_an_answer:"Var god välj ditt (dina) svar",finish_before_proceeding:"Se klart tidigare videos innan du fortsätter",really_confused_use_question:"Du kan ställa en fråga så att läraren kan hjälpa dig.",navigate_away:"Är du säker på att du vill navigera bort från denna sida?",change_lost:"Alla dina ändringar kommer att gå förlorade!"},timeline:{timeline:"Tidslinje",slides:"Bilder",description:"@:global.description",question:"@:global.question",confused:"@:global.confused",really_confused:"@:global.really_confused",note:"@:global.note",quiz:"@:global.quiz",marker:"@:global.marker",watched:"Sedda",quizzes:"quizzar",required_quizzes:"erfoderliga quiz"},button:{ask_question:"Ställ en fråga",new_note:"Ny anteckning",im_confused:"Jag är förvirrad",exit_fullscreen:"Gå ur helskärmsläge",fullscreen:"Helskärm",check_answer:"Kontrollera svaret",start_distance_peer:"Starta Distance Peer sessionen",submit:"@:button.submit",submit_my_vote:"Skicka min rösta"},tooltip:{unsolved_quiz:"Du måste ha svarat på quizen innan du kan hoppa till den",click_or_type_note:"Klicka eller skriv N för att lägga till en anteckning",click_or_type_question:"Klicka eller skriv Q för att ställa en fråga",click_or_type_confused:"Klicka eller skriv C för att säga att du är förvirrad",click_or_type_fullscreen:"Klicka eller skriv F för att gå till helskärmsläge",click_or_type_smallscreen:"Klicka eller skriv F för att gå ur helskärmsläge",video_shortcut:"tryck J för att backa 10s eller K för att spela/pausa eller L för att snabbspola framåt 10s"},correct:"@:global.correct",incorrect:"@:global.incorrect",confused:"@:global.confused",really_confused:"@:global.really_confused",hover_for_explanation:"Hovra med pekaren för förklaring",tap_for_explanation:"Knacka (tap) för förklaring",multiple_correct:"Det kan finnas flera rätta svar",other_correct_answers:"Det kan finnas fler rätta svar",must_place_items:"Du måste placera alla objekt",answer_question:"Vänligen svara på frågan",choose_correct_answer:"Välj det rätta svaret",answer:"@:global.answer",choices:"Svarsalternativen",optional:"@:global.optional"},progress:{title:"@:global.title",discussion:"@:global.discussion",free_text_question:"@:global.free_text_question",related:"Relaterat",of_student_review:"röstade för genomgång",questions:"@:global.questions",lecture:"@:global.lecture",quiz:"@:global.quiz",survey:"@:global.survey",out_of:"Av",number_of_students:"@:number_of_students",confused:"@:global.confused",really_confused:"@:global.really_confused",back:"@:global.back",pauses:"Pauser",finished_on_time:"Klar i tid",finished_not_on_time:"Klar sent",not_finished:"Inte klart",grade:"Betyg",course_graph_desc:"Videos och quizzar klara, procentsatser för alla studenter",based_on_invideo:"Baserat på antal in-video-frågor besvarade",button:{hide:"@:button.hide",make_visible:"Gör enkäten synlig för studenterna",see_all:"Se alla",export_chart:"Exportera tabell",show_in_class:"Visa i klassen",reply:"@:button.reply",send_reply:"Posta svar och skicka meddelande till elev"},tooltip:{see_related:"Se relaterade svar för elev",quizzes_solved:"quizzar lösta",quizzes_optional_solved:"extra quiz lösta",watched_video:"Sedd",correct:"@:global.correct",question_not_checked:"@:dashboard.not_checked",completed:"@:events.completed"},popover:{change_status:"Ändra status",original:"Original",on_time:"I tid",not_done:"Ej utfört"},shortcuts:{go_next_item:"Gå till nästa objekt",go_previous_item:"Gå till föregående objekt",go_inside_item:"Gå in i ett objekt",go_outside_item:"Gå ut ur ett objekt",seek_to_location:"Sök till plats",resize_video:"Växla videostorlek",mark:"Markera för genomgång",reply:"@:button.reply"},chart:{not_started_watching:"Inte börjat titta",watched:"Sedd",completed_on_time:"Klar i tid",completed_late:"Klar sent",module_progress_charts_quizzes:"Framsteg i modulen, baserat på video-quizzar",module_progress:"Modul-framsteg",answered:"Besvarade"},home:{review_module:"Bedöm en modul",module_review:"Bedöm arbete med modul",module_timeline:"Bedöm interaktion med videos",module_completion:"Bedöm slutförande av modul",review_course:"Bedöm hela kursen",course_completion:"Bedöm slutförande av moduler",course_graph:"Bedöm slutförande av videos och quizzar",view_respond_students:"Visa quizresultat och frågor, svara på frågor och välj material till klassrummet.",view_interaction:"Visa hur studenter interagerat med videor.",view_module_completed:"Visa om studenter tittat på videor inom en modul i tid.",view_course_completed:"Visa slutförandestatus för varje modul i kursen.",view_course_graph:"Visa slutförandestatus för alla videos och quizzar i kursen."}},quizzes:{used_up_all:"Förbrukat alla",attempts:" försök",attempt_number:"Försök nummer",must_choose_answer:"Måste välja minst ett svar",optional:"@:global.optional",already_submitted:"Du har lämnat in",no_more_attempts:"och har inga fler försök kvar",grade:{under_review:"föremål för översyn",partial:"Partiell",correct:"@:global.correct",incorrect:"@:global.incorrect"}},enrollment:{enter_enrollment:"Ange kursnyckel",get_enrollment_key:"Kontakta din lärare om du inte fått en kursnyckel.",enrollement_key_format:"Du skall ange en kursnyckel på formen",enroll:"Registrera"},enrolled_students:{name:"@:global.name",email:"@:global.email",remove_student:"Avlägsna studenter",enrolled_students:"@:navigation.enrolled_students",help_enroll_student:"Hjälp med registrering av studenter",select_all:"Markera alla",deselect_all:"Avmarkera alla",done:"@:global.done",export_as:"Exportera listan över studenter "},groups:{module:"Modul",groups:"Grupper",statistics:{videos:"@:global.videos",customlinks:"@:global.customlinks",quizzes:"@:global.quizzes",surveys:"@:global.surveys",video_quizzes:"@:global.video_quizzes",questions:"@:global.questions"},delete_popup:{warning:"@:global.warning",delete_module:"Att ta bort modulen",will_delete:"kommer att ta bort allt den innehåller.",are_you_sure:"@:global.are_you_sure"}},courses:{information:{adding_teacher:"En lärare eller assisterande lärare måste ha ett lärarkonto på",create_account:"För att skapa ett lärarkonto gå till",go_to_course:"Gå till kurs",edit_course:"Redigera kurs",description:"@:global.description",done:"@:global.done",professor:"Lärare",prof:"@:courses.information.professor",ta:"Lärarassistent",discussion_forum_link:"Länk till diskussionsforum",enrollment_key:"Kursnyckel",enrollment_url:"URL för registrering",course_link:"Kurslänk",taught_by:"Ges av",taught_by_small_cap:"ges av",receive_student_ask_email:"Få notifiering via email när student ställer fråga",receive_due_dates_email_question:"Vill du ta emot e-påminnelser om dina kurs deadlines?",receive_due_date_email:"Få påminnelse om kommande senaste färdigdatum.",receive_student_ask_email_question:"Vill du få notifiering via email när student ställer fråga med en länk för att svara?",change_email_question:"(Du kan ändra detta när som helst på kursinformation sida.)",button:{add_teacher:"Lägg till lärare",remove_teacher:"Ta bort lärare",export_as:"Exportera anonymiserade kursdata",invite:"Bjud in",send_email_reminder:"Skicka ett mail påminnelser"},tooltip:{click_to_copy:"Klicka för att kopiera"}},list:{finished:"Avslutad",all_finished:"Avslutade",all:"Alla",current:"Pågående",duration:"@:global.duration",lectures:"@:global.lectures",quizzes:"@:global.quizzes",surveys:"@:global.surveys",number_of_students:"@:global.number_of_students",importing_data:"Importera data",button:{new_course:"@:global.new_course",back:"@:global.back",sort_by:"Sortera efter"},messages:{no_courses:"Just nu har du inte några kurser som du kan komma åt. Du kan börja genom att skapa en ny.",enroll_instruction:"För att anmäla dig till en kurs, välj 'Delta i en ny kurs' under menyn 'Mina kurser' och ange kursnyckeln du fått från din lärare. ",create_enroll_instruction:"För att skapa eller följa en kurs välj 'Skapa ny kurs' eller 'Delta i en ny kurs' under menyn 'Mina kurser' och fyll i kursnyckeln som du fått av din lärare. ",create_instruction:"För att skapa ny kurs, välj 'Skapa ny kurs'  under menyn 'Mina kurser' och.",enroll_instruction:"För följa en kurs välj 'Delta i en ny kurs' under menyn 'Mina kurser' och fyll i kursnyckeln som du fått av din lärare."},tooltip:{unenroll:"Avregistrera"},delete_popup:{warning:"@:global.warning",delete_course:"Tar bort kursen",will_delete:"kommer att ta bort",all_modules:"Alla moduler",all_items:"Allt innehåll i moduler",all_progress:"All information om studenters arbete",are_you_sure:"Är du säker att du vill fortsätta?",cannot_undo:"Detta kan inte återställas!"}},"new":{button:{create_course:"Skapa kurs",unselect:"Avmarkera"},copy_from_existing:"Kopiera data från befintlig kurs",course_item_shift:"Kurs objekt kommer att skiftad i enlighet med startdatum."},start_date:"Startdatum",end_date:"Slutdatum",disable_registration:"Stäng registrering efter",limit_registration_domain:"Registrering Skolor",limit_registration_domain_description:"Tillåt endast studenter från specifika skol domäner för att registrera",limit_registration_all_students:"Låt någon student att registrera",duration:"Kurslängd i veckor",prerequisites:"Förkunskaper",course_image_url:"Länk till bild",short_name:"Kortnamn",time_zone:"Tidszon",course_code:"Kurskod",course_name:"Kursens namn",university_note:"Universitet Anteckning"},statistics:{statistics:"Statistik",administration:"Administration",statistics_dashboard:"Statistikpanelen",registration:"Registrering",report_period:"Rapport-period",generate_report:"Generera rapport",login:"@:navigation.login",lecture_views:"Videos visade",questions_asked:"Frågor ställda",confused:"Förvirrad",courses_created:"Kurser skapade",lectures_created:"Videos skapade",video_quizzes_created:"Video-quiz-frågor skapade",normal_quizzes_created:"Normala quiz-frågor skapade",surveys_created:"Enkäter skapade",video_quizzes_solved:"Video-quiz-frågor besvarade",normal_quizzes_solved:"Normala quiz-frågor besvarade",surveys_solved:"Enkäter besvarade",total_courses:"Totalt antal kurser",total_students:"Totalt antal studenter",total_teachers:"Totalt antal lärare",total_lectures:"Totalt antal videos",total_quizzes:"Totalt antal quiz-frågor",total_surveys:"Totalt antal enkäter",total_questions_asked:"Totalt antal frågor ställda",total_confused:"Totalt antal förvirrad-klick",rate_from:"värdera från",to:"till",drag_to_zoom:"Klicka och dra i hela området för att zooma in",pinch_to_zoom:'"Nyp" diagrammet för att zooma in',write_welcome_message:"Skriv välkomstmeddelande"},player:{click_video_quality:"Klicka för att ändra videokvalitet",quality:"Kvalitet",speed:"Hastighet"},announcements:{create_announcement:"Skapa nytt meddelande",empty:"Inga meddelanden ännu",post:"Inlägg meddelanden till klass här"},help:{getting_started:{getting_started:"Komma igång",student:"för studenter",teacher:"för lärare"},support:"Support",teacher_forum:"Lärarforum",instruction_manual:"Bruksanvisning",tips:"Tips",how_to_flip:"Hur du flippar",privacy_faq:"Sekretesspolicy och vanliga frågor"},course_settings:{show_notes:"Visa anteckningar",show_quizzes:"Visa quizzar",show_surveys:"Visa enkäter",show_confused:"Visa förvirrade",show_markers:"Visa markeringar",show_charts:"Visa diagram",show_discussion:"Visa diskussion",show_lecture_quizzes:"Visa video-quizzar",print:"Skriv ut",download_notes:"Ladda ner anteckningar"},content:{add_new_content:"Lägg till nytt innehåll",types:{customlink:"@:global.customlink",video:"@:global.video",inclass_video:"@global.inclass_lecture",distance_peer_video:"@:global.distance_peer_lecture",video_desc:"Du kan lägga till quizfrågor ovanpå videon.",quiz:"@:global.quiz",survey:"@:global.survey",link_desc:"Länk till andra webbplatser eller sidor.",quiz_or_survey:"Quiz eller enkät",quiz_or_survey_desc:"Text-baserad, kan vara obligatorisk eller frivillig."},questions:{insert_video_question:"Lägg till en video-quiz",categories:{on_video:{title:"Video-quiz",desc:"Placera quizzen på videon. Använd detta om svaren är synliga i videon."},text_quiz:{title:"Text-quiz",desc:"Text-quiz på en vit bakgrund. Använd detta om frågesport-svaren inte syns i videon"},on_video_survey:{title:"Video-enkät",desc:"Enkäter har inget rätt svar. Använd detta om undersöknings-val syns i videon."},text_survey:{title:"Text enkät ",desc:"Text enkäter visar inte korrekt svar mot vit bakgrund. Använd om alternativen i enkäten inte är synliga i videon. "}},types:{ocq:"Ett svar",mcq:"Flera svar",drag:"Dra-och-släpp",text:"Fritext"},quiz_types:{mcq:"Flervals (flera korrekta svar)",ocq:"Flervals (ett korrekta svar)",drag:"Dra-och-släpp (ordnad lista)",text:"Text (fritext eller matcha text)",free_text:"Fritext",match_text:"Matcha text"},survey_types:{mcq:"Flervals (flera korrekta svar)",ocq:"Flervals (ett korrekt svar)"}}},languages:{languages:"Languages",en:"English",sv:"Svenska"},welcome_messages:{description:"Ange texten som ska visas för användare från domänen {{domain}} när de loggar in. Denna text kommer att visas längst upp på sidan 'Skapa Kurs'."}},full_calendar_sv={monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthNamesShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],dayNames:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],dayNamesShort:["sön","mån","tis","ons","tor","fre","lör"],buttonText:{today:"Idag",month:"Månad",week:"Vecka",day:"Dag"}};
angular.module("scalearAngularApp",["ngCookies","ngResource","ngSanitize","ui.router","ngTouch","ui.bootstrap.datepicker","ui.bootstrap.timepicker","ui.sortable","ui.calendar","ngDragDrop","infinite-scroll","xeditable","googlechart","pascalprecht.translate","angularMoment","textAngular","highcharts-ng","config","chieffancypants.loadingBar","anguFixedHeaderTable","mm.foundation","dcbImgFallback","ngclipboard","ngTextTruncate","ngDialog","mgo-angular-wizard","angular-medium-editor","smart-table"]),angular.module("scalearAngularApp").constant("headers",{withCredentials:!0,"X-Requested-With":"XMLHttpRequest"}),angular.module("scalearAngularApp").run(["$http","$rootScope","editableOptions","editableThemes","UserSession","$state","ErrorHandler","$timeout","$window","$log","$translate","$cookies","$tour","Course","URLInformation","CourseModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){try{MathJax&&MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"]]},showProcessingMessages:!1,showMathMenu:!1})}catch(q){}a.defaults.headers.common["X-CSRF-Token"]=l["XSRF-TOKEN"],c.theme="default",d["default"].submitTpl='<button class="button tiny with-tiny-padding with-medium-padding-right with-medium-padding-left no-margin-bottom size-1 success check" type="submit"><i class="fi-check"></i></button>',d["default"].cancelTpl='<button class="button tiny with-tiny-padding with-medium-padding-right with-medium-padding-left no-margin-bottom size-1 alert cancel" type="button" ng-click="$form.$cancel()"><i class="fi-x"></i></button>',d["default"].errorTpl='<small class="error with-tiny-padding position-relative" ng-show="$error" ng-bind="$error" style="z-index:90"></small>',b.textAngularOpts={toolbar:[["h1","h2","h3","p","pre","quote"],["bold","italics","underline","ul","ol","redo","undo","clear"],["insertLink","unlink","insertImage"]],classes:{toolbarGroup:"button-group tiny custom_button_group",toolbarButton:"button tiny secondary",textEditor:"form-control",htmlEditor:"form-control"}},j.debug("lang is "+b.current_lang);var r=["login","teacher_signup","student_signup","thanks_for_registering","forgot_password","change_password","show_confirmation","new_confirmation","home","privacy","faq","about","ie","student_getting_started","teacher_getting_started","landing","signup","lti_course_list"],s=["course.student_calendar","course.course_information","course.module.courseware","lti_course_list"],t=["new_course","course.course_editor","course.calendar","course.enrolled_students","send_email","send_emails","course.announcements","course.edit_course_information","course.teachers","course.progress","course.progress.main","course.progress.module","statistics","course.module.course_editor","lti_course_list"],u=["login","student_signup","teacher_signup","thanks_for_registering","new_confirmation","forgot_password","change_password"],v=function(a){for(var b in u){var c=u[b];if(a.substring(0,c.length)===c)return!0}return!1},w=function(a){for(var b in r){var c=r[b];if(a.substring(0,c.length)===c)return!0}return!1},x=function(a){for(var b in s){var c=s[b];if(a.substring(0,c.length)===c)return!0}return!1},y=function(a){for(var b in t){var c=t[b];if(a.substring(0,c.length)===c)return!0}return!1},z=function(a){g.showMessage("Error : "+k.instant("error_message.you_are_not_authorized"),"errorMessage",4e3,"error"),o.setRedirectLink(a)};i.onbeforeunload=function(){b.unload=!0},b.$on("$stateChangeStart",function(a,b,c,d,h){m.isActive()&&m.end(),o.addToHistory(f.href(d,h)),e.getCurrentUser().then(function(a){/MSIE (\d+\.\d+);/.test(i.navigator.userAgent)&&"home"!==b.name&&f.go("ie"),a.info_complete?(c.course_id&&p.getCourseRole(c.course_id).then(function(){(y(b.name)&&p.isStudent()||x(b.name)&&p.isTeacher())&&(f.go("course_list"),z(f.href(b,c)))}),"home"===b.name&&f.go("course_list"),"confirmed"===b.name&&a.intro_watched?(f.go("home"),z(f.href(b,c))):"confirmed"===b.name||a.intro_watched||"edit_account"===b.name?"login"===b.name||"teacher_signup"===b.name||"student_signup"===b.name?f.go("course_list"):v(b.name)&&(f.go("home"),z(f.href(b,c))):f.go("confirmed")):(f.go("edit_account",{},{notify:!1}),g.showMessage(k.instant("error_message.update_account_information"),"errorMessage",4e3,"error"))}).catch(function(){if("home"===b.name&&f.go("landing"),!w(b.name)){f.go("login");var a=f.href(b,c);/courses\/enroll\?id=/.test(a)&&o.setEnrollLink(a),z(a)}})})}]),angular.module("scalearAngularApp").config(["$stateProvider","$urlRouterProvider","$httpProvider","$translateProvider","$logProvider","cfpLoadingBarProvider","scalear_api","$sceProvider",function(a,b,c,d,e,f,g,h){f.includeSpinner=!0,e.debugEnabled(g.debug),h.enabled(!1),d.translations("en",translation_en).translations("sv",translation_sv).preferredLanguage("en").useCookieStorage().useSanitizeValueStrategy("escape"),c.defaults.withCredentials=!0,c.interceptors.push("ServerInterceptor"),c.interceptors.push("TokenServerInterceptor"),b.otherwise("/"),a.state("home",{url:"/",templateUrl:"/views/empty_view.html",controller:"HomeCtrl"}).state("landing",{url:"/home",views:{landing:{templateUrl:"/views/main.html",controller:"MainCtrl"}}}).state("about",{url:"/about",templateUrl:"/views/about.html",controller:"AboutCtrl"}).state("ie",{url:"/ie",templateUrl:"/views/ie.html"}).state("login",{url:"/users/login",templateUrl:"/views/login.html",controller:"LoginCtrl",params:{email:null}}).state("teacher_signup",{url:"/users/teacher",templateUrl:"/views/users/signup.html",controller:"UsersTeacherCtrl"}).state("student_signup",{url:"/users/student",templateUrl:"/views/users/signup.html",controller:"UsersStudentCtrl"}).state("signup",{url:"/users/signup",templateUrl:"/views/users/unified_signup.html",controller:"UsersSignUpCtrl",params:{input1:null,input2:null}}).state("thanks_for_registering",{url:"/users/thanks",templateUrl:"/views/users/thanks.html",controller:"ThanksForRegisteringCtrl",params:{email:null}}).state("confirmed",{url:"/users/confirmed",templateUrl:"/views/users/confirmed.html",controller:"UsersConfirmedCtrl"}).state("edit_account",{url:"/users/edit",templateUrl:"/views/users/edit.html",controller:"UsersEditCtrl"}).state("forgot_password",{url:"/users/password/new",templateUrl:"/views/users/password/new.html",controller:"UsersPasswordNewCtrl"}).state("forgot_password_confirmation",{url:"/users/forgot_password_confirmation",templateUrl:"/views/users/password/forgot_password_confirmation.html",controller:"ForgotPasswordConfirmationCtrl",params:{email:null}}).state("change_password",{url:"/users/password/edit?token&client_id&uid",templateUrl:"/views/users/password/edit.html",controller:"UsersPasswordEditCtrl"}).state("new_confirmation",{url:"/users/confirmation/new",templateUrl:"/views/users/confirmation/new.html",controller:"UsersConfirmationNewCtrl"}).state("show_confirmation",{url:"/users/confirmation?confirmation_token",templateUrl:"/views/users/confirmation/show.html",controller:"UsersConfirmationShowCtrl"}).state("privacy",{url:"/privacy",templateUrl:"/views/privacy.html",controller:"PrivacyCtrl"}).state("faq",{url:"/faq",templateUrl:"/views/faq.html",controller:"FaqCtrl"}).state("course_list",{url:"/courses",templateUrl:"/views/course_list.html",controller:"courseListCtrl"}).state("student_enroll_course",{url:"/courses/enroll?id",templateUrl:"/views/empty_view.html",controller:"CoursesEnrollCtrl"}).state("new_course",{url:"/courses/new",templateUrl:"/views/teacher/course_list/new_course.html",controller:"newCourseCtrl"}).state("course",{url:"/courses/:course_id",template:"<ui-view/>",controller:"courseCtrl",resolve:{CourseData:["CourseModel","ModuleModel","ItemsModel","$stateParams",function(a,b,c,d){return a.getData(d.course_id)}]}}).state("course.content_selector",{url:"/content",templateUrl:"/views/empty_view.html",controller:"contentSelectorCtrl"}).state("course.module",{url:"/modules/:module_id",templateUrl:"/views/empty_view.html",controller:"moduleCtrl","abstract":!0}).state("course.module.course_editor",{url:"/course_editor",templateUrl:"/views/teacher/course_editor/course_editor.html",controller:"courseEditorCtrl","abstract":!0}).state("course.module.course_editor.overview",{url:"",views:{details:{templateUrl:"/views/teacher/course_editor/module.details.html",controller:"moduleDetailsCtrl"},module:{templateUrl:"/views/teacher/course_editor/module.middle.html",controller:"moduleMiddleCtrl"}}}).state("course.module.course_editor.lecture",{url:"/lectures/:lecture_id",views:{details:{templateUrl:"/views/teacher/course_editor/lecture.details.html",controller:"lectureDetailsCtrl"},middle:{templateUrl:"/views/teacher/course_editor/lecture.middle.html",controller:"lectureMiddleCtrl"}},params:{time:null}}).state("course.module.course_editor.quiz",{url:"/quizzes/:quiz_id",views:{details:{templateUrl:"/views/teacher/course_editor/quiz.details.html",controller:"quizDetailsCtrl"},middle:{templateUrl:"/views/teacher/course_editor/quiz.middle.html",controller:"quizMiddleCtrl"}}}).state("course.module.course_editor.customlink",{url:"/link/:customlink_id",views:{details:{templateUrl:"/views/teacher/course_editor/customlink.details.html",controller:"customLinkDetailsCtrl"},middle:{templateUrl:"/views/teacher/course_editor/customlink.middle.html",controller:"customLinkMiddleCtrl"}}}).state("course.course_editor",{url:"/course_editor?new_course",templateUrl:"/views/teacher/course_editor/course_editor.html",controller:"courseEditorCtrl"}).state("course.progress",{url:"/progress",templateUrl:"/views/teacher/progress/progress.html",controller:"progressCtrl"}).state("course.progress_graph",{url:"/progress/graph",templateUrl:"/views/teacher/progress/progress_graph.html",controller:"progressGraphCtrl"}).state("course.progress_overview",{url:"/progress_overview",templateUrl:"/views/teacher/progress/progress_overview.html",controller:"progressOverviewCtrl"}).state("course.module.progress_overview",{url:"/progress_overview",templateUrl:"/views/teacher/progress/progress_overview.html",controller:"progressOverviewCtrl"}).state("course.module.progress",{url:"/progress?item_id",templateUrl:"/views/teacher/progress/progress_lecture.html",controller:"progressLectureCtrl"}).state("course.module.progress_statistics",{url:"/progress/statistics",templateUrl:"/views/teacher/progress/student_statistics_tab.html",controller:"studentStatisticsCtrl"}).state("course.module.progress_students",{url:"/progress/students",templateUrl:"/views/teacher/progress/lecture_progress_tab.html",controller:"lectureProgressCtrl"}).state("course.module.courseware",{url:"/courseware",templateUrl:"/views/student/lectures/courseware.html",controller:"coursewareCtrl"}).state("course.module.courseware.overview",{url:"/overview",templateUrl:"/views/student/course/module_overview.html",controller:"studentModuleOverviewCtrl"}).state("course.module.courseware.lecture",{url:"/lectures/:lecture_id?time",reloadOnSearch:!1,templateUrl:"/views/student/lectures/lecture.middle.html",controller:"studentLectureMiddleCtrl"}).state("course.module.student_inclass",{url:"/student_inclass",templateUrl:"/views/student/inclass/inclass.html",controller:"studentInclassCtrl"}).state("course.module.courseware.quiz",{url:"/quizzes/:quiz_id",templateUrl:"/views/student/lectures/quiz.middle.html",controller:"studentQuizMiddleCtrl"}).state("course.enrolled_students",{url:"/enrolled_students",templateUrl:"/views/teacher/course/enrolled_students.html",controller:"enrolledStudentsCtrl"}).state("course.send_emails",{url:"/send_emails",templateUrl:"/views/teacher/course/send_emails.html",controller:"sendEmailsCtrl"}).state("course.announcements",{url:"/announcements",templateUrl:"/views/teacher/announcements/announcements.html",controller:"announcementsCtrl",params:{show:null}}).state("course.course_information",{url:"/course_information?new_enroll",templateUrl:"/views/student/course/course_information.html",controller:"studentCourseInformationCtrl"}).state("course.edit_course_information",{url:"/information?new_course",templateUrl:"/views/teacher/course/course_information.html",controller:"teacherCourseInformationCtrl"}).state("course.inclass",{url:"/inclass",templateUrl:"/views/teacher/in_class/inclass.html",controller:"inclassCtrl"}).state("course.module.inclass",{url:"/inclass",templateUrl:"/views/teacher/in_class/inclass_module.html",controller:"inclassModuleCtrl"}).state("course.module.inclass.display_quizzes",{url:"/display_quizzes",templateUrl:"/views/teacher/in_class/display_quizzes.html",controller:"displayQuizzesCtrl"}).state("dashboard",{url:"/dashboard",templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).state("statistics",{url:"/statistics",templateUrl:"/views/statistics/statistics.html",controller:"statisticsCtrl"}).state("lti_course_list",{url:"/lti_course_list?return_url&email&full_name&first_name&last_name&consumer_key&resource_context_id",templateUrl:"/views/teacher/course_list/lti_course_list.html",controller:"ltiCourseListCtrl"}).state("school_statistics",{url:"/school_statistics",templateUrl:"/views/statistics/school_statistics.html",controller:"schoolStatisticsCtrl"}).state("welcome_message",{url:"/welcome_message",templateUrl:"/views/welcome_message.html",controller:"welcomeMessageCtrl"}).state("show_shared",{url:"/show_shared",templateUrl:"/views/teacher/sharing/shared.html",controller:"sharedCtrl"}).state("student_getting_started",{url:"/help/student/getting_started",templateUrl:"/views/student/help/student_getting_started.html",controller:"StudentGettingStartedCtrl"}).state("lti_help",{url:"/help/lti_help",templateUrl:"/views/teacher/help/lti_help.html",controller:"LtiKeyGenerateCtrl"}).state("teacher_getting_started",{url:"/help/teacher/getting_started",templateUrl:"/views/teacher/help/teacher_getting_started.html",controller:"TeacherGettingStartedCtrl"}).state("preview",{url:"/preview",params:{course_id:null,module_id:null,lecture_id:null,quiz_id:null,time:null},controller:["Preview","$state",function(a){a.start()}]})}]),angular.module("config",[]).constant("scalear_api",{beta:!0,debug:!0,ga_token:"",host:"",redirection_url:"",version:"4.3.0 (Mon, 29 Jan 2018 09:07:25 GMT)",instruction_manual:"external_documents/Manual - Using Scalable Learning v.3.22.pdf",flipped_manual:"external_documents/Manual - Flipped Teaching v.1.0.pdf",teacher_welcome_video:"https://www.youtube.com/watch?v=tqE7wRQCgmU",teacher_new_course_video:"https://www.youtube.com/watch?v=rDWIUYybFPs",teacher_review_course_video:"https://www.youtube.com/watch?v=DhJgqWBm0XY",student_welcom_video:"https://www.youtube.com/watch?v=bLiZfyBuFkc",teacher_forum_link:"https://groups.google.com/forum/#!forum/scalablelearning-teachers-forum"}),angular.module("scalearAngularApp").filter("format",function(){return function(a,b){var c=Math.floor(a/3600),d=Math.floor((a-3600*c)/60),e=Math.floor(a-3600*c-60*d);if(10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),b){var f=b.replace("hh",c);return f=f.replace("h",1*c+""),f=f.replace("mm",d),f=f.replace("m",1*d+""),f=f.replace("ss",e),f=f.replace("s",1*e+"")}return c+":"+d+":"+e}}).filter("formattime",function(){return function(a,b){if(a>0){var c=Math.floor(a/3600),d=Math.floor((a-3600*c)/60),e=Math.floor(a-3600*c-60*d);if(60>a&&(d=1,e=0),0==c?b=b.replace("hh:","").replace("h:",""):10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),b){var f=b.replace("hh",c);return f=f.replace("h",1*c+""),f=f.replace("mm",d),f=f.replace("m",1*d+""),f=f.replace("ss",e),f=f.replace("s",1*e+"")}return c+":"+d+":"+e}return"0:00"}}).filter("roundedformattime",function(){return function(a,b){if(a>0){var c=Math.floor(a/3600),d=Math.floor((a-3600*c)/60),e=Math.floor(a-3600*c-60*d);if(e>0&&(d+=1,e=0),10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),b){var f=b.replace("hh",c);return f=f.replace("h",1*c+""),f=f.replace("mm",d),f=f.replace("m",1*d+""),f=f.replace("ss",e),f=f.replace("s",1*e+"")}return c+":"+d+":"+e}return"0:00"}}).filter("fromNow",function(){return function(a){return moment(a).fromNow()}}).filter("inclass",function(){return function(a,b){if(!b)return a;var c={};return angular.forEach(a,function(a,b){a.show&&(c[b]=a)}),c}}).filter("survey",function(){return function(a,b){if(!b)return a;var c=[];return angular.forEach(a,function(a){a.student_hide||c.push(a)}),c}}).filter("currentCourse",function(){var a=new Date;return function(b){var c=start_date.setDate(start_date.getDate()+7*duration);return a>c?b:void 0}}).filter("formatURL",function(){return function(a){return a.match(/^[a-zA-Z]+:\/\//)||(a="http://"+a),a}}).filter("saveStateFormatter",function(){return function(a){return a==EditorState.DIRTY?"You have unsaved changes":a==EditorState.SAVE?"Saving in Google Drive...":a==EditorState.LOAD?"Loading...":a==EditorState.READONLY?"Read only":"Video and notes saved in Google Drive"}}).filter("bytes",function(){return function(a){if(a=parseInt(a),isNaN(a))return"...";var b=[" bytes"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"],c=a>0?Math.floor(Math.log(a)/Math.LN2/10):0,d=Math.round(a/Math.pow(2,10*c));return d+b[c]}}).filter("capitalize",function(){return function(a){return a&&a.length>0?a[0].toUpperCase()+a.slice(1):void 0}}).filter("anonymous",function(){return function(a,b){return b.charAt(0).toUpperCase()+b.slice(1).toLowerCase()+"-"+md5(a).substring(0,4).toUpperCase()}}).filter("courseActive",["$state",function(a){return function(b){return a.includes("**.course.**")&&a.params.course_id==b}}]).filter("reverse",function(){return function(a){return a?a.slice().reverse():void 0}}).filter("href",["$state",function(a){return function(b){return b?a.href(b,{},{absolute:!0}):void 0}}]).filter("visible",function(){return function(a){return a?new Date(a)<=new Date:void 0}}).filter("inclassMenuFilter",function(){return function(a){return a.filter(function(a){return a.data?"discussion"!=a.type?a.data.show:!0:!1})}}).filter("parseUrlFilter",function(){var a=/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/gi;return function(b,c){return-1===b.indexOf("<img")?b.replace(a,'<a target="'+c+'" href="$&">$&</a>'):b}}),angular.module("scalearAngularApp").directive("autoFillSync",["$timeout",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=c.val();a(function(){var a=c.val();e.$pristine&&f!==a&&e.$setViewValue(a)},500)}}}]).directive("format",["$filter",function(a){return{require:"?ngModel",link:function(b,c,d,e){e&&e.$formatters.unshift(function(){return a("formattime")(e.$modelValue,d.format)})}}}]).directive("profileImage",["$window",function(){return{replace:!0,restrict:"E",scope:{email:"=",imagesize:"@",background:"@"},templateUrl:"/views/profile_image.html",link:function(a){a.$watch("email",function(){a.source_image=a.email?"https://www.gravatar.com/avatar/"+md5(a.email)+"?s="+a.imagesize+"&r=pg&default=https%3A%2F%2Fs.gravatar.com%2Favatar%2F7b2c0c5390921bbccd4818d0cf4bcb71%3Fs%3D"+a.imagesize+"%26r%3Dpg":"https://www.gravatar.com/avatar/000000000?s="+a.imagesize+"&r=pg&default=https%3A%2F%2Fs.gravatar.com%2Favatar%2F7b2c0c5390921bbccd4818d0cf4bcb71%3Fs%3D"+a.imagesize+"%26r%3Dpg"})}}}]).directive("contextMenu",["$window","$log",function(a,b){return{restrict:"A",link:function(c,d,e){var f=angular.element(d.find("."+e.target));f.css("position","fixed"),f.css("cursor","pointer");var g=function(){c.opened=!1,angular.element(".open").removeClass("open").css("display","none"),angular.element(a).add(d).off("click")},h=function(e){g(),c.opened=!0,f.css("width","10%"),f.css("top",e.clientY+5+"px"),f.css("left",e.clientX-10+"px"),f.css("zIndex",1e4),f.addClass("open"),f.css("display","block"),angular.element(a).add(d).on("click",function(a){b.debug(a),c.opened&&c.$apply(function(){a.preventDefault(),a.stopPropagation(),g()})})};d.bind("contextmenu",function(a){c.$apply(function(){a.preventDefault(),a.stopPropagation(),h(a)})})}}}]).directive("teacherCourseItem",["ErrorHandler",function(){return{restrict:"E",scope:{course:"=",teachers:"=",deletecourse:"=",filterteacher:"=",currentuser:"="},templateUrl:"/views/teacher/course_list/teacher_course_item.html",link:function(){}}}]).directive("courseItem",["ErrorHandler",function(){return{replace:!0,restrict:"E",scope:{course:"=",teachers:"=",unenroll:"="},templateUrl:"/views/student/course_list/student_course_item.html",link:function(){}}}]).directive("userItem",["ErrorHandler",function(){return{replace:!0,restrict:"E",scope:{user:"=",select:"=",emailsingle:"=",removestudent:"=",deletemode:"="},templateUrl:"/views/user_item.html",link:function(a){a.toggleSelect=function(){a.select(a.user)}}}}]).directive("announcementItem",["ErrorHandler",function(){return{restrict:"E",scope:{announcement:"=",saveannouncement:"=",showannouncement:"=",hideannouncement:"=",deleteannouncement:"=",saving:"=",index:"="},templateUrl:"/views/announcementItem.html",link:function(){}}}]).directive("screenfull",function(){return{restrict:"A",scope:{active:"="},link:function(a,b){a.$watch("active",function(){screenfull.enabled&&(a.active?screenfull.request(angular.element(b)[0]):screenfull.exit())})}}}).directive("enrollmentModal",["$modal",function(a){return{restrict:"A",replace:!0,link:function(b){b.open=function(){angular.element(".button").blur(),a.open({templateUrl:"/views/student/course_list/enroll_modal.html",controller:"StudentEnrollModalCtrl"})}}}}]).directive("calendarModal",["$modal",function(a){return{restrict:"A",replace:!0,link:function(b){b.openCalendar=function(){angular.element(".button").blur(),a.open({templateUrl:"/views/student/calendar/calendar.html",controller:"CalendarModalCtrl"})}}}}]).directive("enrollHelpModal",["$modal","UserSession","$location",function(a,b,c){return{restrict:"A",replace:!0,link:function(d){d.openHelpModal=function(e){b.getCurrentUser().then(function(a){d.current_user=a}),d.course=e,d.enrollment_url=c.absUrl().split("courses")[0]+"courses/enroll?id="+d.course.unique_identifier,d.enrollment_url_guest=c.absUrl().split("courses")[0]+"courses/enroll?id="+d.course.guest_unique_identifier,d.copySuccess=function(a){$("#enrollment_message, #enrollment_message li").children().animate({color:"#428bca"},"fast").delay(300).animate({color:"black"},"fast",function(){a.clearSelection()})},d.copyError=function(){},a.open({templateUrl:"/views/teacher/course/help_enroll.html",controller:["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss()}}],scope:d})}}}}]).directive("embedSrc",function(){return{restrict:"A",link:function(a,b,c){var d=b;a.$watch(function(){return c.embedSrc},function(){var a=b.clone().attr("src",c.embedSrc);d.replaceWith(a),d=a})}}}).directive("ngAutoExpand",function(){return{restrict:"A",link:function(a,b){b.bind("keyup",function(a){var b=a.target;$(b).height(0);var c=$(b)[0].scrollHeight;20>c&&(c=28),$(b).height(c-8)}),setTimeout(function(){var a=b;$(a).height(0);var c=$(a)[0].scrollHeight;20>c&&(c=28),$(a).height(c-8)},0)}}}).directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&0==b.shiftKey&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),angular.module("scalearAngularApp").directive("richTextarea",["$timeout",function(a){return{replace:!0,restrict:"EA",template:"<textarea medium-editor bind-options='medium_editor_options' class='medium-editor-textarea' ></textarea>",controller:["$scope","$attrs","$interpolate",function(b,c,d){function e(a){var b=a?a.toRgbString():"rgba(0,0,0,0)";l.base.importSelection(j),l.document.execCommand("styleWithCSS",!1,!0),l.document.execCommand("foreColor",!1,b)}function f(a){$(a).spectrum({allowEmpty:!0,color:"#f00",showInput:!0,showAlpha:!0,showPalette:!0,showInitial:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex3",change:function(a){e(a)},hide:function(a){e(a)},palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]})}function g(){for(var a=MathJax.HTML,b=MathJax.Hub.getAllJax(),c=0,d=b.length;d>c;c++){var e=b[c].SourceElement(),f=-1==e.type.indexOf("mode=display")?"$":"$$",g=f+b[c].originalText+f;b[c].Remove();var h=e.previousSibling,i=e.parentNode,j=a.Element("span",{className:"mathjax_original"},[g]);i.insertBefore(j,h),h&&"MathJax_Preview"===h.className&&i.removeChild(h),i.removeChild(e),$(j).replaceWith(function(){return $(this).text()})}}function h(a){for(var b=MathJax.Hub.getAllJax(a),c=0;c<b.length;c++){var d=$("<span contenteditable='false'></span>").css({width:"100%",height:"100%",background:"rgba(0, 0, 0, 0)",position:"absolute"});$("#"+b[c].inputID+"-Frame").css("outline","none").prepend(d)}}function i(a){$(a).find("span[class*=MathJax]").remove()}var j,k=MediumEditor.extensions.button.extend({name:"colorPicker",action:"applyForeColor",aria:"color picker",contentDefault:"<span class='editor-color-picker'>Color<span>",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML="<i class='fi-paint-bucket size-18'></i>",f(this.button),this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(a){j=this.base.exportSelection();var b=$(this.base.getSelectedParentElement()).css("color");$(this.button).spectrum("set",b),a.preventDefault(),a.stopPropagation();var c=this.getAction();c&&this.execAction(c)}}),l=new k,m=MediumEditor.extensions.button.extend({name:"increaseFontSize",action:"fontSize",aria:"increase font size",contentDefault:"+",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML='<b title="increase text size">+</b>',this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(a){a.preventDefault(),a.stopPropagation();var b=this.document.queryCommandValue("fontSize")+"";8>b&&this.execAction("fontSize",{value:parseInt(b)+1}||3)}}),n=MediumEditor.extensions.button.extend({name:"decreaseFontSize",action:"fontSize",aria:"decrease font size",contentDefault:"-",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.innerHTML='<b title="decrease text size">-</b>',this.on(this.button,"click",this.handleClick.bind(this))},handleClick:function(a){a.preventDefault(),a.stopPropagation();var b=this.document.queryCommandValue("fontSize")+"";b>1&&this.execAction("fontSize",{value:parseInt(b)-1}||3)}}),o=MediumEditor.extensions.button.extend({name:"mathjax",aria:"Math Latex support",contentDefault:"Math",init:function(){this.button=this.document.createElement("button"),this.button.classList.add("medium-editor-action"),this.button.classList.add("mathjax-btn"),this.button.title="Use this button to turn on/off equation formatting. Write equations using LaTeX formatting surrounded by $$ (new line) or $ (in-line). For example: $$E=mc^2$$",this.button.innerHTML='<b title="Math Latex">&#8721;</b>',this.on(this.button,"click",this.handleClick.bind(this));var b=this,c=this.base.elements[0];a(function(){i(c),MathJax.Hub.Queue(["Rerender",MathJax.Hub,c,function(){h(c),b.setActive()}])})},handleClick:function(a){var b=this,c=this.base.elements[0];this.isActive()?(g(c),b.setInactive()):MathJax.Hub.Queue(["Typeset",MathJax.Hub,c,function(){h(c),b.setActive(),$(".mathjax-btn").tooltip(b.isActive()?"destroy":"show")}]),a.preventDefault(),a.stopPropagation(),this.base.trigger("editableInput",{},c)},isActive:function(){var a=this.base.options.activeButtonClass;return this.button.classList.contains(a)},setInactive:function(){if(0==MathJax.Hub.getAllJax(this.base.elements[0]).length){var a=this.base.options.activeButtonClass;this.button.classList.remove(a)}},setActive:function(){if(MathJax.Hub.getAllJax(this.base.elements[0]).length>0){var a=this.base.options.activeButtonClass;this.button.classList.add(a)}}});b.medium_editor_options={toolbar:{buttons:["bold","italic","underline","strikethrough","subscript","superscript","increaseFontSize","decreaseFontSize","colorPicker",{name:"anchor",contentDefault:"<i class='fi-link size-18'></i>"},"anchor",{name:"image",contentDefault:"<i class='fi-photo size-18'></i>"},"quote","pre",{name:"orderedlist",contentDefault:"<i class='fi-list-number size-22' style='line-height:0'></i>"},{name:"unorderedlist",contentDefault:"<i class='fi-list-bullet size-22' style='line-height:0'></i>"},"justifyLeft","justifyCenter","justifyRight","mathjax","removeFormat"]},placeholder:c.placeholder?{text:d(c.placeholder)()}:!1,extensions:{colorPicker:l,increaseFontSize:new m,decreaseFontSize:new n,mathjax:new o},disableReturn:!1}}]}}]),angular.module("scalearAngularApp").directive("teacherModuleSummary",["ScalearUtils","$filter","$translate","$state","CourseEditor",function(a,b,c,d,e){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/teacher/progress/teacher_module_summary.html",link:function(f){var g=f.$watch("moduledata.duration",function(d){if(d){f.moduledata.hour_min=a.toHourMin(f.moduledata.duration),f.moduledata.time_left_string=a.toHourMin(f.moduledata.due_date).split(":")[0],f.moduledata.due_date_enabled=!e.isDueDateDisabled(f.moduledata.due_date_string),f.subtitle=f.moduledata.hour_min+" "+c.instant("time.hours")+", "+f.moduledata.quiz_count+" "+c.instant("global.quizzes")+", "+f.moduledata.survey_count+" "+c.instant("global.surveys")+". ",f.subtitle+=f.moduledata.due_date_enabled?c.instant("events.due")+" "+b("date")(new Date(f.moduledata.due_date_string),"dd-MMMM-yyyy")+" "+c.instant("global.at")+" "+b("date")(new Date(f.moduledata.due_date_string),"HH:mm")+".":c.instant("global.no")+" "+c.instant("editor.details.due_date");var h={on_time:{text:c.instant("dashboard.ontime"),color:"#16A53F"},late:{text:c.instant("events.late"),color:"#E66726"},incomplete:{text:c.instant("dashboard.incomplete"),color:"#a4a9ad"},completed:{text:c.instant("dashboard.complete"),color:"#16A53F"},more_than_50:{text:c.instant("dashboard.more_than")+" 50%",color:"#1bca4d"},less_than_50:{text:c.instant("dashboard.less_than")+" 50%",color:"#F5C09E"},not_watched:{text:c.instant("dashboard.not_started"),color:"#a4a9ad"},completed_late:{text:c.instant("events.late"),color:"#1bca4d"},more_than_80:{text:c.instant("dashboard.more_than")+" 80%",color:"#E66726"},between_50_80:{text:c.instant("dashboard.between")+" 50% & 80%",color:"#800000"}},i=[];Object.keys(f.moduledata.students_completion).forEach(function(a){var b={name:h[a].text,data:[f.moduledata.students_completion[a]],color:h[a].color};i.push(b)}),f.student_completion_chart_config={options:{chart:{type:"bar",margin:[0,0,10,0],spacing:[0,0,0,0]},plotOptions:{series:{stacking:"normal"}},legend:{enabled:!1},tooltip:{formatter:function(){return'<b style="color:'+this.series.color+'">'+this.series.name+"</b> ("+this.y+" of "+f.moduledata.students_count+")"},positioner:function(a,b,c){var d=c.plotX-c.h,e=c.plotX,f=d+(e-d)/2,g=a/2,h=f-g,i=c.plotY+10;return 0>h?h=0:h+a>e&&(h=e-a-5),{x:h,y:i}}}},size:{height:50},title:{text:null},xAxis:{categories:null,gridLineWidth:0,labels:{enabled:!1},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,labels:{enabled:!1},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,min:0,max:f.moduledata.students_count},series:i},g()}});f.goTo=function(a,b,c,e){d.go(a,{course_id:b,module_id:c,item_id:e})}}}}]).directive("teacherOnlineQuizSummary",["$state","$compile","$timeout","$rootScope","$translate",function(a,b,c,d,e){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/teacher/progress/teacher_online_quiz_summary.html",link:function(f){function g(){return"<div >"+e.instant("dashboard.click_for_information")+"</div>"
}function h(){var a=f.moduledata.online_quiz[this.points[0].point.index],g=Object.keys(a)[0],h=a[g],i=h.type,j=[];if(f.quiz_completion_chart_config.getHighcharts().hover_tooltip.hide(0),f.title=this.x,h.inclass&&(f.title="<b>"+e.instant("dashboard.inclass_question")+": </b>"+this.x),h.distance_peer&&(f.title="<b>"+e.instant("dashboard.distance_peer_question")+": </b>"+this.x),f.left="","quiz"==i){f.quiz_only_one_bar_config={options:{chart:{type:"column",spacing:[0,0,0,0],margin:[0,0,1,0]},plotOptions:{series:{stacking:"normal",animation:!1}},legend:{reversed:!0}},size:{width:70,height:h.data.review_vote>0?150:130},title:{text:null},xAxis:{categories:null,gridLineWidth:0,labels:{useHTML:!0,enabled:!1},lineColor:"transparent",lineWidth:0,minorGridLineWidth:0,minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,plotLines:[{color:"black",width:1,value:0}],labels:{enabled:!1}},series:[{showInLegend:!1,name:e.instant("dashboard.never_tried"),data:[h.data.never_tried],color:"#a4a9ad"},{showInLegend:!1,name:e.instant("dashboard.not_checked"),data:[h.data.not_checked],color:"#551a8b"},{showInLegend:!1,name:e.instant("editor.incorrect")+" ("+e.instant("dashboard.final_try")+")",data:[h.data.not_correct_many_tries],color:"#E66726"},{showInLegend:!1,name:e.instant("editor.incorrect")+" ("+e.instant("dashboard.first_try")+")",data:[h.data.not_correct_first_try],color:"#ED9467"},{showInLegend:!1,name:e.instant("editor.incorrect"),data:[h.data.not_correct_quiz],color:"#E66726"},{showInLegend:!1,name:e.instant("editor.correct")+" ("+e.instant("dashboard.final_try")+")",data:[h.data.tried_correct_finally],color:"#1bca4d"},{showInLegend:!1,name:e.instant("editor.correct")+" ("+e.instant("dashboard.first_try")+")",data:[h.data.correct_first_try],color:"#16A53F"},{showInLegend:!1,name:e.instant("editor.correct"),data:[h.data.correct_quiz],color:"#16A53F"},{showInLegend:!1,name:e.instant("dashboard.voted_for_review"),data:[-1*h.data.review_vote],color:"#f5c343"}]},f.left+="<div style='margin-bottom: 26px;'> ",f.quiz_only_one_bar_config.series.forEach(function(a){var b=Math.abs(a.data[0]);"null"==a.data[0]||isNaN(a.data[0])||(f.left+="Voted for review"==a.name?"</div><div><b>"+b+"  ("+Math.round(100*(b/f.moduledata.students_count))+'%)     <span style="color:'+a.color+'">'+a.name+"</span></b></div>":"<div><b>"+b+"  ("+Math.round(100*(b/f.moduledata.students_count))+'%)     <span style="color:'+a.color+'">'+a.name+"</span></b></div>")});var k="<div class='dashboard' style='width:460px; height:100%'><div ng-bind-html='title' class='row collapse'></div><div class='row collapse' style='width:420px; height:100%'><div class='small-2 columns no-padding'><highchart class='chart' config='quiz_only_one_bar_config'  style='width: 100%;'></highchart></div><div style='padding-top: 40px;' class='small-10 columns'><div ng-bind-html='left' style='font-size:12px'></div></div></div><div ng-show='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButtonReview' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px; color:white;' translate>dashboard.review_quiz</a></div><div ng-hide='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButton' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px;' translate>dashboard.review_quiz</a></div></div>"}else{var l=[],j=[];f.left+="<br/><b>"+this.points[0].y+"  ("+Math.round(this.points[0].percentage)+"%)     <span >"+this.points[0].series.name+"</span></b>",Object.keys(h.answer).forEach(function(a){l.push(h.answer[a]),j.push(a),f.left+="<br/><b>"+h.answer[a]+"  ("+Math.round(100*(h.answer[a]/f.moduledata.students_count))+"%)     <span >"+a+"</span></b>"}),f.quiz_only_one_bar_config={options:{chart:{type:"column",spacing:[0,0,0,0],margin:[0,0,1,0]},plotOptions:{series:{stacking:"normal",animation:!1},column:{borderWidth:0}},legend:{reversed:!0}},size:{width:150,height:130},title:{text:null},credits:{enabled:!1},xAxis:{categories:j,gridLineWidth:0,labels:{useHTML:!0,enabled:!1},lineColor:"transparent",lineWidth:0,minorGridLineWidth:0,minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,plotLines:[{color:"black",width:1,value:0}],labels:{enabled:!1}},series:[{showInLegend:!1,data:l,color:"#355BB7"}]};var k="<div class='dashboard' style='width:520px; height:100%; min-height:164px'><div ng-bind-html='title' class='row collapse'></div><div class='row collapse' style='width:400px; height:100%'><div class='small-5 columns no-padding'><div id='custom_chart' ></div><highchart class='chart' config='quiz_only_one_bar_config'  style='width: 100%;'>></highchart></div><div style='padding-top: 40px;' class='small-7 columns'><div ng-bind-html='left' style='font-size:12px'></div></div></div><div ng-show='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButtonReview' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px; color:white' translate>dashboard.review_quiz</a></div><div ng-hide='moduledata.review_page_trigger' style='bottom: 0px;position: absolute;right: 10px;'><a class='button left tiny green module-review gotToQuizButton' style='pointer-events: visible;margin-bottom: 0;margin-top: 10px;' translate>dashboard.review_quiz</a></div></div>"}return $("#quiz_bar").html(k),b($("#quiz_bar"))(f),f.$digest(),c(function(){$(".gotToQuizButton").click(function(){f.goTo("course.module.progress",f.moduledata.course_id,f.moduledata.id,"vq_"+g)})}),c(function(){$(".gotToQuizButtonReview").click(function(){d.$broadcast("scroll_to_item_summary","vq_"+g)})}),$("#quiz_bar").html()}f.width_online_quiz=100,f.tooltip_template_click_hover="hover";var i={never_tried:{name:e.instant("dashboard.never_tried"),data:[],color:"#a4a9ad"},survey_solved:{name:e.instant("dashboard.solved"),data:[],color:"#355BB7"},not_checked:{name:e.instant("dashboard.not_checked"),data:[],color:"#551a8b"},not_correct_many_tries:{name:e.instant("editor.incorrect")+" ("+e.instant("dashboard.final_try")+")",data:[],color:"#E66726"},not_correct_first_try:{name:e.instant("editor.incorrect")+" ("+e.instant("dashboard.first_try")+")",data:[],color:"#ED9467"},not_correct_quiz:{name:e.instant("editor.incorrect"),data:[],color:"#E66726"},tried_correct_finally:{name:e.instant("editor.correct")+" ("+e.instant("dashboard.final_try")+")",data:[],color:"#1bca4d"},correct_first_try:{name:e.instant("editor.correct")+" ("+e.instant("dashboard.first_try")+")",data:[],color:"#16A53F"},correct_quiz:{name:e.instant("editor.correct"),data:[],color:"#16A53F"},review_vote:{name:e.instant("dashboard.voted_for_review"),data:[],color:"#f5c343"}},j=[],k=f.$watch("moduledata.online_quiz",function(a){if(a){f.moduledata.online_quiz.length<20&&(f.width_online_quiz=5*f.moduledata.online_quiz.length),f.moduledata.online_quiz.forEach(function(a){Object.keys(a).forEach(function(b){j.push("<b>"+a[b].lecture_name+": </b>"+a[b].quiz_name),Object.keys(a[b].data).forEach(function(c){"null"==a[b].data[c]?i[c].data.push(null):"review_vote"==c?(f.review_vote_exist=f.review_vote_exist||a[b].data[c]>0,i[c].data.push(-1*a[b].data[c])):a[b].inclass?i[c].data.push({y:a[b].data[c],borderColor:"black",borderWidth:1}):i[c].data.push({y:a[b].data[c]})}),"quiz"==a[b].type?i.survey_solved.data.push(null):(i.not_correct_many_tries.data.push(null),i.not_correct_first_try.data.push(null),i.not_correct_quiz.data.push(null),i.tried_correct_finally.data.push(null),i.correct_first_try.data.push(null),i.correct_quiz.data.push(null),i.not_checked.data.push(null))})});var b={borderColor:"#000000",shared:!0,useHTML:!0,enabled:!0,animation:!0,padding:8,snap:10,backgroundColor:"white",borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"},positioner:function(a,b,c){var d=c.plotX-a/2,e=100;return 0>d&&(d=0),$("#teacher_completion").width()<c.plotX+a&&(d=$("#teacher_completion").width()-1.025*a),{x:d,y:e}}},c=angular.copy(b);c.formatter=h;var d=angular.copy(b);d.formatter=g,f.quiz_completion_chart_config={options:{chart:{type:"column",events:{load:function(){this.quiz_tooltip=new Highcharts.Tooltip(this,c),this.hover_tooltip=new Highcharts.Tooltip(this,d)}},margin:f.review_vote_exist?[0,0,0,0]:[0,0,30,0]},plotOptions:{series:{stacking:"normal",point:{events:{mouseOver:function(a){this.index!=f.previous_tooltoip&&(f.quiz_completion_chart_config.getHighcharts().quiz_tooltip.hide(0),f.previous_tooltoip=this.index,f.quiz_completion_chart_config.getHighcharts().hover_tooltip.refresh([a.target],a))},mouseOut:function(){f.quiz_completion_chart_config.getHighcharts().hover_tooltip.hide(0),f.quiz_completion_chart_config.getHighcharts().quiz_tooltip.isHidden&&(f.previous_tooltoip=null)}}}},column:{pointWidth:20,borderWidth:0,events:{click:function(a){a.stopPropagation(),this.chart.quiz_tooltip.refresh([a.point],a);var b=this;$(document).click(function(){b.chart.quiz_tooltip.hide(0),f.quiz_completion_chart_config.getHighcharts().hover_tooltip.hide(0),$(document).off("click")})}}}},tooltip:{enabled:!1},legend:{enabled:!1}},size:{height:125},title:{text:null},xAxis:{categories:j,gridLineWidth:0,labels:{enabled:!1},lineColor:"transparent",lineWidth:0,minorGridLineWidth:0,minorTickLength:0,tickLength:0},yAxis:{title:{text:null},gridLineWidth:0,plotLines:[{color:"black",width:1,value:0}],labels:{enabled:!1},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,max:f.moduledata.students_count},series:i},k()}});f.goTo=function(b,c,d,e){a.go(b,{course_id:c,module_id:d,item_id:e})}}}}]).directive("teacherDiscussionSummary",["$state",function(a){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/teacher/progress/teacher_discussion_summary.html",link:function(b){b.goTo=function(b,c,d,e){a.go(b,{course_id:c,module_id:d,item_id:e})}}}}]).directive("studentModuleSummary",["ScalearUtils","$filter","$translate","$state","CourseEditor","ModuleModel",function(a,b,c,d,e){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/student/progress/student_module_summary.html",link:function(f){var g=f.$watch("moduledata.due_date_string",function(d){d&&(f.moduledata.hour_min=a.toHourMin(f.moduledata.duration),f.moduledata.time_left_string=a.toHourMin(f.moduledata.due_date).split(":")[0],f.subtitle=f.moduledata.hour_min+" "+c.instant("time.hours")+", "+f.moduledata.quiz_count+" "+c.instant("global.quizzes")+", "+f.moduledata.survey_count+" "+c.instant("global.surveys")+". ",f.next_lecture={},f.next_lecture.type="lecture",-1==f.moduledata.first_lecture?f.continue_button=null:f.moduledata.module_done_perc>0&&f.moduledata.module_done_perc<100&&f.moduledata.last_viewed>-1?(f.continue_button=c.instant("dashboard.continue_watching"),f.next_lecture.id=f.moduledata.last_viewed):100==f.moduledata.module_done_perc&&-1!=f.moduledata.first_lecture?(f.continue_button=c.instant("dashboard.watch_again"),f.next_lecture.id=f.moduledata.first_lecture):0==f.moduledata.module_done_perc&&(f.continue_button=c.instant("dashboard.start_watching"),f.next_lecture.id=f.moduledata.first_lecture),f.moduledata.due_date_enabled=!e.isDueDateDisabled(f.moduledata.due_date_string),f.subtitle+=f.moduledata.due_date_enabled?c.instant("events.due")+" "+b("date")(new Date(f.moduledata.due_date_string),"dd-MMMM-yyyy")+" "+c.instant("global.at")+" "+b("date")(new Date(f.moduledata.due_date_string),"HH:mm")+".":c.instant("global.no")+" "+c.instant("editor.details.due_date"),g())});f.goTo=function(a,b,c,e){d.go("course.module.courseware.lecture",{course_id:a,module_id:b,lecture_id:c,time:e},{time:e})},f.goToLectureQuiz=function(a,b,c,e){"lecture"==e?d.go("course.module.courseware.lecture",{course_id:a,module_id:b,lecture_id:c}):d.go("course.module.courseware.quiz",{course_id:a,module_id:b,quiz_id:c})}}}}]).directive("studentOnlineQuizSummary",["ScalearUtils","$translate","$state",function(a,b,c){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/student/progress/student_online_quiz_summary.html",link:function(d){d.online_quiz_color={},d.online_quiz_group_color={};var e="("+b.instant("dashboard.complete_video")+")",f="("+b.instant("dashboard.complete_quiz")+")";d.quiz_completion_data_series={group_never_tried:{name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.group")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.shown_top"),color:"#a4a9ad"},group_survey_solved:{name:b.instant("dashboard.you_solved_group_survey"),color:"#355BB7"},group_not_checked:{name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.group")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.is_not_checked"),color:"#551a8b"},group_tried_not_correct_first:{name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.group")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#ED9467'>"+b.instant("dashboard.incorrect")+"</span>"+b.instant("dashboard.tried_once"),color:"#ED9467"},group_tried_not_correct_finally:{name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.group")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#E66726'>"+b.instant("dashboard.incorrect")+"</span>"+b.instant("dashboard.tried_more_once"),color:"#E66726"},group_tried_correct_finally:{name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.group")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#1bca4d'>"+b.instant("dashboard.correct")+"</span>"+b.instant("dashboard.not_first_try"),color:"#1bca4d"},group_correct_first_try:{name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.group")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#16A53F'>"+b.instant("dashboard.correct")+"</span>"+b.instant("dashboard.on_first_try"),color:"#16A53F"},self_never_tried:{name:b.instant("dashboard.you_not_answered_quiz"),group_name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.individual")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.shown_below"),color:"#a4a9ad"},self_survey_solved:{name:b.instant("dashboard.you")+" <span style='color:#355BB7'>"+b.instant("dashboard.answered_survey")+"</span>.",group_name:b.instant("dashboard.you")+b.instant("dashboard.answered")+" <b>"+b.instant("dashboard.individual")+"<b/> "+b.instant("dashboard.survey")+" ",color:"#355BB7"},self_not_checked:{name:b.instant("dashboard.answered_but_not_checked"),group_name:b.instant("dashboard.answered_but_group")+"<b>"+b.instant("dashboard.invdividual")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.not_checked_group"),color:"#551a8b"},self_not_checked_question:{name:b.instant("dashboard.answered_but_not_checked_question"),color:"#551a8b"},self_tried_not_correct_first:{name:b.instant("dashboard.tried_not_correct_first")+"<span style='color:#ED9467'>"+b.instant("dashboard.tried_not_correct_first_answer")+"</span>.",group_name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.individual")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#ED9467'>"+b.instant("dashboard.incorrect")+"</span>"+b.instant("dashboard.tried_once"),color:"#ED9467"},self_not_correct_question:{name:b.instant("dashboard.self_not_correct_question")+"<span style='color:#ED9467'>"+b.instant("dashboard.tried_not_correct_first_answer")+"</span>.",color:"#E66726"},self_tried_not_correct_finally:{name:b.instant("dashboard.tried_not_correct_last")+"<span style='color:#E66726'>"+b.instant("dashboard.tried_not_correct_first_answer")+"</span>.",group_name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.individual")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#E66726'>"+b.instant("dashboard.incorrect")+"</span>"+b.instant("dashboard.tried_more_once"),color:"#E66726"},self_tried_correct_finally:{name:b.instant("dashboard.answered_correct_but")+"<span style='color:#1bca4d'>"+b.instant("dashboard.not_first_try")+"</span>",group_name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.individual")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#1bca4d'>"+b.instant("dashboard.correct")+"</span>"+b.instant("dashboard.not_first_try"),color:"#1bca4d"},self_correct_first_try:{name:b.instant("dashboard.you_answered")+"<span style='color:#16A53F'>"+b.instant("dashboard.correct")+"</span>"+b.instant("dashboard.on_first_try"),group_name:b.instant("dashboard.your")+" <b>"+b.instant("dashboard.individual")+"</b> "+b.instant("dashboard.answer")+b.instant("dashboard.was")+"<span style='color:#16A53F'>"+b.instant("editor.correct")+"</span>"+b.instant("dashboard.on_first_try"),color:"#16A53F"},self_correct_question:{name:b.instant("dashboard.you_answered")+"<span style='color:#16A53F'>"+b.instant("dashboard.correct")+"</span>.",color:"#16A53F"}};var g=d.$watch("moduledata.remaining_duration",function(c){if(null!=c){d.remaining="Remaining: "+a.toHourMin(d.moduledata.remaining_duration)+" "+b.instant("time.hours")+", "+d.moduledata.remaining_quiz+" "+b.instant("global.quizzes")+", "+d.moduledata.remaining_survey+" "+b.instant("global.surveys")+". ",d.group_width=100*(1/d.moduledata.online_quiz_count),d.quiz_completion_bar={width:5*d.moduledata.online_quiz_count},d.quiz_completion_bar.width>100&&(d.quiz_completion_bar.width=100),d.quiz_completion_bar.width+="%",d.online_popover={},d.online_quiz_name={},d.content={},d.lecture_quiz_boolean={};var h=0;d.moduledata.module_completion.forEach(function(a){a.completion_style={position:"relative",width:a.duration+"%",background:"linear-gradient(to right, #16A53F "+a.percent_finished+"%, #a4a9ad 0%)"},a.item_style={},a.quiz_bar_style={},a.online_quizzes&&(a.item_style.width=d.group_width*a.online_quizzes.length+"%",a.quiz_bar_style.width=100/a.online_quizzes.length+"%",a.online_quizzes.forEach(function(b){d.online_quiz_name[b.id]="<b>"+a.item_name+"</b>: "+b.quiz_name,b.inclass&&(d.online_quiz_name[b.id]="<b>In-Class Question: </b>"+d.online_quiz_name[b.id]),b.distance_peer&&(d.online_quiz_name[b.id]="<b>Distance-Peer Question: </b>"+d.online_quiz_name[b.id]),"lecture"==a.type&&b.required&&("self_never_tried"==b.data[0]&&!b.data[1]||"self_never_tried"==b.data[0]&&"group_never_tried"==b.data[1])&&(d.online_quiz_name[b.id]=e),"quiz"==a.type&&b.required&&"self_never_tried"==b.data[0]&&!b.data[1]&&(d.online_quiz_name[b.id]=f),d.online_quiz_color[b.id]={backgroundColor:d.quiz_completion_data_series[b.data[0]].color},d.content[b.id]=d.quiz_completion_data_series[b.data[0]].name,d.lecture_quiz_boolean[b.id]="lecture"==a.type,d.online_popover[b.id]={title:"<span style='font-size:12px;' ng-bind-html='online_quiz_name[online_quiz.id]' ></span> ",content:"<div ng-bind-html='content[online_quiz.id]' style='margin-bottom: 10px;font-size:12px;'></div><div ng-if='lecture_quiz_boolean[online_quiz.id]'><div ng-if=\"quiz_completion_data_series[online_quiz['data'][0]].color != '#a4a9ad' \" style='font-size:12px;' translate>dashboard.click_retry_quiz</div></div>",html:!0,trigger:"hover",placement:"bottom",container:"#student_popover"},2==b.data.length&&(d.online_quiz_color[b.id]={backgroundColor:d.quiz_completion_data_series[b.data[0]].color},d.online_quiz_group_color[b.id]={backgroundColor:d.quiz_completion_data_series[b.data[1]].color},d.content[b.id]={},d.content[b.id][0]=d.quiz_completion_data_series[b.data[0]].group_name,d.content[b.id][1]=d.quiz_completion_data_series[b.data[1]].name,d.online_popover[b.id].content="<div class='row collapse' style='height: 135px;width: 100%;'><div style='height: 45px;width: 100%;' ><div style='width: 10%;margin-right: 10px;float: left;' ng-style='online_quiz_group_color[online_quiz.id]'  class='quiz-inner-bar'></div><div  ng-bind-html='content[online_quiz.id][1]' style='font-size:12px;'></div></div><div style='height: 45px;width: 100%;margin-top: 2px'><div style='width: 10%;margin-right: 10px;float: left;' ng-style='online_quiz_color[online_quiz.id]'  class='quiz-inner-bar'></div><div  ng-bind-html='content[online_quiz.id][0]' style='font-size:12px;'></div><div ng-if=\"quiz_completion_data_series[online_quiz['data'][0]].color != '#a4a9ad' || quiz_completion_data_series[online_quiz['data'][1]].color != '#a4a9ad'\" style='font-size:12px;' translate>dashboard.click_retry_quiz</div> "),h+=1}))}),g()}});d.lectureTooltip=function(a){a.item_style.border="2px solid #000000",a.completion_style.border="2px solid #000000",a.show_tooltip=!0},d.lectureTooltipLeave=function(a){a.completion_style.border="1px solid #EFE7E7",a.item_style.border="none",a.show_tooltip=!1},d.goTo=function(a,b,d,e,f,g){var h;"lecture"==a?(h="course.module.courseware.lecture",g.required&&"self_never_tried"==g.data[0]||c.go(h,{course_id:b,module_id:d,lecture_id:e,time:f},{time:f})):(h="course.module.courseware.quiz",g.required&&"self_never_tried"==g.data[0]||c.go(h,{course_id:b,module_id:d,quiz_id:e,time:f},{time:f}))},d.goToLectureQuiz=function(a,b,d,e){"lecture"==e?c.go("course.module.courseware.lecture",{course_id:a,module_id:b,lecture_id:d}):c.go("course.module.courseware.quiz",{course_id:a,module_id:b,quiz_id:d})}}}}]).directive("studentDiscussionSummary",["$state",function(a){return{scope:{moduledata:"="},replace:!0,templateUrl:"/views/student/progress/student_discussion_summary.html",link:function(b){b.goTo=function(b,c,d,e){a.go("course.module.courseware.lecture",{course_id:b,module_id:c,lecture_id:d,time:e},{time:e})}}}}]),angular.module("scalearAngularApp").directive("appMessages",["ErrorHandler",function(a){return{scope:{server_error:"=serverError"},replace:!0,templateUrl:"/views/app_messages.html",link:function(b,c){a.addToElementList($(c).find(".alert-message")),b.$on("ErrorMessage:show",function(a,c){b.status=c}),b.$on("ErrorMessage:hide",function(){b.status=null})}}}]).directive("errorMessage",["$log",function(a){return{restrict:"E",scope:{column:"@",data:"="},replace:!0,template:"<div ng-if='error' class='errormessage valign-super'>{{error}}</div>",link:function(b){a.debug("in error directive"),b.$watch(function(){if(b.data){var a=b.data[b.column];b.error=a.join()}})}}}]),angular.module("scalearAngularApp").directive("videoContainer",function(){return{transclude:!0,replace:!0,restrict:"E",template:'<div class="videoborder panel widescreen " style="padding:0; border:none; margin:0" ng-transclude></div>'}}).directive("youtube",["$rootScope","$log","$timeout","$window","$cookieStore","$interval","VideoInformation",function(a,b,c,d,e,f,g){return{transclude:!0,restrict:"E",replace:!0,scope:{url:"=",ready:"&",id:"@",player:"=",autoplay:"@",controls:"@",start:"=",end:"="},template:"<div><div ng-transclude></div></div>",link:function(d,e){d.vq="hd720",d.$on("$destroy",function(){d.kill_popcorn(),d.player={},d.id="",d.ready="",d.url=""});var h,i={},j={},k=function(){if(d.kill_popcorn(),i.youtube=!1,d.controls&&void 0!=d.controls||(d.controls=0),d.autoplay&&void 0!=d.autoplay||(d.autoplay=0),a.is_mobile&&(d.autoplay=1),o(d.url)){b.debug("youtube"),i.youtube=!0;var c=Popcorn.HTMLYouTubeVideoElement("#"+d.id);h=Popcorn(c),c.src=l(d.url,d.vq,d.video_start||d.start,d.video_end||d.end,d.autoplay,d.controls),b.debug(c.src)}else if(q(d.url))b.debug("vimeo"),h=Popcorn.smart("#"+d.id,d.url+"?autoplay=true&controls=0&portrait=0&byline=0&title=0&fs=0",{width:"100%",height:"100%",controls:0}),h.controls(d.controls),h.autoplay(d.autoplay);else if(r(d.url)){b.debug("mp4");var c=Popcorn.HTMLVideoElement("#"+d.id);h=Popcorn(c,{}),c.src=d.url,h.video.className="fit-inside",(a.is_mobile||"default"==d.controls)&&h.controls(!0),h.autoplay(!1)}else if(s(d.url)){b.debug("mediasite");var c=Popcorn.HTMLMediaSiteVideoElement("#"+d.id);h=Popcorn(c),c.src=d.url,b.debug(c.src)}d.player&&(d.player.element=h),m(),parent.focus(),d.timeout_promise=f(function(){0!=i.readyState()||a.is_mobile||d.$emit("slow",o(d.url))},15e3,1)},l=function(a,b,c,d,e,f){var g,h,i=p(a);if(i)g="https://www.youtube.com/watch",h="&v="+i[1];else{var j=a.split("?");g=j[0],h="&"+j[1]}return c&&(h+="&start="+c),d&&(h+="&end="+d),b&&(h+="&vq="+b),g+"?modestbranding=0&showinfo=0&rel=0&autohide=0&playsinline=1&autoplay="+e+"&controls="+f+"&theme=light"+h};d.kill_popcorn=function(){h&&(Popcorn.destroy(h),h.media.destroy&&h.media.destroy()),e.find("iframe").remove(),e.find("video").remove(),d.slow_off&&d.slow_off(),d.timeout_promise&&c.cancel(d.timeout_promise)},i.play=function(){h.play()},i.pause=function(){h.pause()},i.mute=function(){h.mute(),g.volume=0},i.volume=function(a){h.volume(a),g.volume=a},i.unmute=function(){h.unmute(),g.volume=.8},i.paused=function(){return h.paused()},i.getTime=function(){return h.currentTime()-d.start},i.getAbsoluteDuration=function(){var a=h.duration();return d.player.controls.youtube?a-1:a},i.getDuration=function(){return d.end-d.start},i.readyState=function(){return h.readyState()},i.seek=function(a){b.debug("entering sekking",a),a=parseFloat(a),0>a&&(a=0),a>i.getDuration()&&(a=i.getDuration()),i.getDuration()-a<1&&(a=i.getDuration()-1),a+=d.start||0,0==i.readyState()?h.on("loadeddata",function(){c(function(){h.currentTime(a)})}):(b.debug("seeking now",a),h.currentTime(a)),parent.focus()},i.absoluteSeek=function(a){h.currentTime(a)},i.seek_and_pause=function(a){i.seek(a),h.pause()},i.setStartTime=function(a){d.video_start=Math.round(a)},i.setEndTime=function(a){d.video_end=Math.round(a)},i.getStartTime=function(){return d.video_start},i.getEndTime=function(){return d.video_end},i.setVideoStartTime=function(a){d.start=Math.round(a)},i.setVideoEndTime=function(a){d.end=Math.round(a)},i.getVideoStartTime=function(){return d.start},i.getVideoEndTime=function(){return d.end},i.refreshVideo=function(){b.debug("refreshVideo!"),d.kill_popcorn(),k()},i.hideControls=function(){h.controls(!1)},i.cue=function(a,b){return h.cue(a,b),i.getLastCueEvent()},i.getLastCueEvent=function(){return h.getTrackEvent(h.getLastTrackEventId())},i.removeTrackEvent=function(a){h.removeTrackEvent(a)},i.getTrackEvents=function(){return h.getTrackEvents()},i.removeAllTrackEvents=function(){h.getTrackEvents().forEach(function(a){h.removeTrackEvent(a.id)})},i.replay=function(){i.pause(),i.seek(0),i.play()},i.getSpeeds=function(){return h.media.getSpeeds()},i.changeSpeed=function(a){d.player.controls.youtube?-1!=i.getSpeeds().indexOf(a)&&h.media.setSpeed(a):h.video.playbackRate=a,g.speed=a},i.getAvailableQuality=function(){return h.media.getAvailableQuality()},i.getQuality=function(){return h.media.getQuality()},i.changeQuality=function(a){if(-1!=i.getAvailableQuality().indexOf(a)&&i.getQuality()!=a){var b=i.paused();h.media.setQuality(a),b&&i.pause()}g.quality=a};var m=function(){h.on("loadeddata",function(){b.debug("Video data loaded and ready"),a.is_mobile&&h.controls(!1),j.onReady&&(j.onReady(),d.$apply());var c=i.youtube?i.getDuration():i.getAbsoluteDuration();g.setDuration(c)}),h.on("playing",function(){b.debug("youtube playing"),parent.focus(),j.onPlay&&(j.onPlay(),d.$apply())}),h.on("pause",function(){parent.focus(),j.onPause&&(j.onPause(),d.$apply())}),h.on("timeupdate",function(){j.timeUpdate&&(j.timeUpdate(),d.$apply())}),h.on("loadedmetadata",function(){parent.focus(),j.onMeta&&(j.onMeta(),d.$apply())}),h.on("canplay",function(){parent.focus(),j.canPlay&&(j.canPlay(),d.$apply())}),h.on("seeking",function(){parent.focus(),j.seeking&&(j.seeking(),d.$apply())}),h.on("seeked",function(){parent.focus(),j.seeked&&(j.seeked(),d.$apply())}),h.on("waiting",function(){parent.focus(),j.waiting&&(j.waiting(),d.$apply())}),h.on("ended",function(){parent.focus(),j.onEnd&&(j.onEnd(),d.$apply())}),d.slow_off=d.$on("slow",function(a,b){parent.focus(),j.onSlow&&j.onSlow(b)})};a.$on("refreshVideo",function(){i.refreshVideo()});var n=function(a){return a.match(/^(http|https):\/\/www\.youtube\.com\/watch\?v=[^\s]{11}[\W\w]*$/)},o=function(a){var b=a||d.url||"",c=b.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)([^\s&]{11})/);return c?c:b.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)?([^\s&]{11})/)},p=function(a){var b=a||d.url||"";return b.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)?\.be\/([^\s&]{11})/)},q=function(a){var b=a||d.url||"";return b.match(/vimeo/)},r=function(a){var b=a||d.url||"";return b.match(/(.*mp4$)/)},s=function(a){var b=a||d.url||"";return b.match(/^(http|https):\/\/.*(\/Play\/)/)};i.isYoutube=o,i.isMP4=r,d.$watch("url",function(){d.url&&(o(d.url)&&n(d.url)||q(d.url)||r(d.url)||s(d.url))&&i.refreshVideo()});var t=d.$watch("player",function(){d.player&&(d.player.controls=i,d.player.events&&(j=d.player.events),d.player.element=h,d.$emit("player ready"),t())})}}}]).directive("resizableVideo",["$window","$rootScope","$timeout","$log",function(a,b,c,d){return{restrict:"A",scope:{container:"=",quiz_layer:"=quizLayer",video_layer:"=videoLayer",aspect_ratio:"=aspectRatio",fullscreen:"=active",resize:"=",max_width:"=maxWidth"},link:function(c){c.resize.small=function(){c.fullscreen=!1,angular.element("body").css("overflow",""),angular.element("body").css("position","");var a={top:"",left:"",position:"",width:"",height:"","z-index":0},b=angular.copy(a),d={position:"absolute","margin-left":"0px","margin-top":"0px","z-index":1,width:"100%",height:"100%",top:"0px",left:"0px"};c.container&&angular.extend(c.container,a),c.video_layer&&angular.extend(c.video_layer,b),c.quiz_layer&&angular.extend(c.quiz_layer,d),c.unregister_back_event&&c.unregister_back_event(),c.unregister_state_event&&c.unregister_state_event()},c.resize.big=function(){d.debug("resizing big");var e="smallscreen"==c.aspect_ratio?4/3:16/9,f=angular.element(a);if(c.fullscreen=!0,angular.element("body").css("overflow","hidden"),angular.element("body").css("position","fixed"),b.is_mobile)var g=70,h=f.height(),i=f.width();else var g=80,h=screen.height,i=screen.width;f.scrollTop("0px");var j={top:0,left:0,position:"fixed",width:i-c.max_width,height:h,"z-index":1031},k=angular.copy(j);k.height-=g,k.width="auto",k.position="";var l=k.height,m=l*e,n={};if(m>i-c.max_width){d.debug("width cutt offff"),l=1*(i-c.max_width)/e;var o=(h-g-l)/2;n={position:"fixed",top:0,left:0,width:i-c.max_width,height:l,"margin-top":o+"px","margin-left":"0px"}}else{d.debug("height cutt offff"),d.debug(i),d.debug(m),d.debug((i-c.max_width-m)/2);var p=(i-c.max_width-m)/2;n={position:"fixed",top:0,left:0,width:m,height:l,"margin-left":p+"px","margin-top":"0px"}}c.container&&angular.extend(c.container,j),c.video_layer&&angular.extend(c.video_layer,k),c.quiz_layer&&angular.extend(c.quiz_layer,n)}}}}]).directive("progressBar",["$rootScope","$log","$window","$cookieStore","$timeout","VideoQuizModel","$filter","VideoInformation",function(a,b,c,d,e,f,g,h){return{transclude:!0,restrict:"E",replace:!1,scope:{player:"=",seek:"&",timeline:"=",role:"&",editing:"="},templateUrl:"/views/progress_bar.html",link:function(c,i){c.user_role=c.role();var j=c.player.element,k=angular.element(".progressBar");i.find(".playhead"),i.find(".elapsed");var l=!1;c.progress_bar=$(".progressBar"),c.progress_width=c.progress_bar.width(),c.current_time=0,c.volume_class="mute",c.quality=!1,c.chosen_quality="hd720",c.chosen_speed=1,c.is_mobile=a.is_mobile,e(function(){c.duration=c.player.controls.getDuration(),c.video={start_time:c.player.controls.getVideoStartTime(),end_time:c.player.controls.getVideoEndTime()},c.$watch("editing",function(){"video"==c.editing?(c.video.start_time=c.player.controls.getVideoStartTime(),c.video.end_time=c.player.controls.getVideoEndTime(),c.duration=c.player.controls.getAbsoluteDuration()):c.duration=c.player.controls.getDuration()}),c.is_mobile&&e(function(){document.getElementsByClassName("progressBar")[0].addEventListener("touchstart",c.playHeadMouseDown,!0)
})});var m=function(){if("video"==c.editing)$(".squarebrackets_left").css("left",100*(c.video.start_time/c.duration)+"%"),$(".squarebrackets_right").css("left",100*(c.video.end_time/c.duration)+"%"),$(".repeating_green_pattern").css("left",100*(c.video.start_time/c.duration)+"%");else if("quiz"==c.editing){var a=f.getSelectedVideoQuiz();a&&($(".squarebrackets_left").css("left",100*(a.start_time/c.duration)+"%"),$(".squarebrackets_right").css("left",100*(a.end_time/c.duration)+"%"),$(".quiz_circle").css("left",100*(a.time/c.duration)-.51+"%"),$(".repeating_grey_pattern").css("left",100*(a.start_time/c.duration)+"%"),$(".repeating_orange_pattern").css("left",100*(a.time/c.duration)+"%"))}};$(window).resize(m),a.$on("details_navigator_change",m),c.play_class=c.is_mobile?"pause":"play",c.quality_names={auto:"Auto",tiny:"144p",small:"240p",medium:"360p",large:"480p",hd720:"720p (HD)",hd1080:"1080p (HD)",highres:"High"},c.setSpeed=function(a){b.debug("setting youtube speed to "+a),c.player.controls.changeSpeed(a),c.chosen_speed=a,d.put(c.player.controls.youtube?"youtube_speed":"mp4_speed",c.chosen_speed)},c.showPlayhead=function(){c.playhead_timeout&&e.cancel(c.playhead_timeout),c.playhead_class="playhead_big"},c.hidePlayhead=function(){l||(c.playhead_timeout=e(function(){c.playhead_class="",c.playhead_timeout=null,c.$apply()},1e3))},c.playHeadMouseDown=function(){l=!0,c.is_mobile?(c.showPlayhead(),window.addEventListener("touchmove",c.moveplayhead,!0),window.addEventListener("touchend",c.playHeadMouseUp,!0)):(window.addEventListener("mousemove",c.moveplayhead,!0),window.addEventListener("mouseup",c.playHeadMouseUp,!0))},c.playHeadMouseUp=function(a){1==l&&(l=!1,c.is_mobile?(c.hidePlayhead(),window.removeEventListener("touchmove",c.moveplayhead,!0),window.removeEventListener("touchend",c.playHeadMouseUp,!0)):(window.removeEventListener("mousemove",c.moveplayhead,!0),window.removeEventListener("mouseup",c.playHeadMouseUp,!0)),c.progressSeek(a)),c.$apply()},c.moveplayhead=function(a){var b=(a.pageX-k.offset().left)/k.outerWidth(),d=100*b-.51;d>=0&&100>=d&&(c.elapsed_head=d>99.4?99.4:d,c.elapsed_width=d+.45,c.current_time=c.duration*b),0>d&&(c.elapsed_head=0,c.elapsed_width=0,c.current_time=0),d>100&&(c.elapsed_head=99.4,c.elapsed_width=100,c.current_time=c.duration),c.seek()(c.current_time),c.$apply()},c.play=function(){c.player.controls.paused()?(c.player.controls.play(),c.play_class="pause"):(c.player.controls.pause(),c.play_class="play")},c.rewind=function(){var a=c.player.controls.getTime();c.seek()(a-10)},c.fastForward=function(){var a=c.player.controls.getTime();c.seek()(a+10)},c.muteToggle=function(){"mute"==c.volume_class?c.mute():c.unmute()};var n=c.$watch("volume",function(){c.volume&&(d.put("volume",c.volume),0!=c.volume?("unmute"==c.volume_class&&c.player.controls.unmute(),c.volume_class="mute"):c.volume_class="unmute",c.player.controls.volume(c.volume))});c.mute=function(){c.player.controls.mute(),c.volume_class="unmute",c.volume=0,d.put("volume",c.volume)},c.unmute=function(){c.player.controls.unmute(),c.volume_class="mute",c.volume=.8,d.put("volume",c.volume)},c.progressSeek=function(a){if(!c.skip_progress_seek||"quiz"!=c.editing){var b=angular.element(".progressBar"),d=(a.pageX-b.offset().left)/b.outerWidth();c.seek()(c.duration*d),s(),c.timeline&&2==c.user_role&&q(c.duration*d)}c.skip_progress_seek=!1},c.showQuality=function(){c.quality=!c.quality},c.setQuality=function(a){c.player.controls.changeQuality(a),c.chosen_quality=a},c.scrollEvent=function(a,b){o(a,b),p(a,b)};var o=function(a,b){$(".student_timeline").scrollToThis("#"+a+"_"+b,{offsetTop:100,duration:350})},p=function(a,b){$("#"+a+"_"+b).animate({backgroundColor:"#ffff99"},"fast"),$("#"+a+"_"+b).animate({backgroundColor:"#ffffff"},2e3)},q=function(a){var b=c.timeline.getNearestEvent(a);b.data&&Math.abs(b.time-a)<=30&&o(b.type,b.data.id)},r=function(a,b,d){var e=c.progress_bar.width(),f=d.time/c.duration*e;b.position.left<f&&angular.element(a.target).toggleClass("squarebrackets_left_hover"),b.position.left>f?angular.element(a.target).toggleClass("squarebrackets_right_hover"):angular.element(a.target).find(".dot_circle").toggleClass("dot_circle_hover"),d.has_start=d.start_time!=d.time,d.has_end=d.end_time!=d.time};c.calculateQuizBoundaries=function(a,b,d){b.position.top=-4;var e=c.progress_bar.width();c.quiz_circle_width=$(".quiz_circle").width(),d.data.start_location=d.data.start_time/c.duration*e,d.data.end_location=d.data.end_time/c.duration*e,d.data.quiz_location=d.data.time/c.duration*e,d.data.has_start=d.data.start_time!=d.data.time,d.data.has_end=d.data.end_time!=d.data.time;var f=c.timeline.getNextByType(d),g=c.timeline.getPrevByType(d);d.data.next_quiz_start=f?f.data.start_time/c.duration*e:e,d.data.prev_quiz_end=g?g.data.end_time/c.duration*e:0,r(a,b,d.data)},c.calculateQuizTime=function(b,d,e){d.position.top=-4;var f=1,h=c.quiz_circle_width;d.position.left>e.data.end_location-h&&(d.position.left=e.data.has_end?e.data.end_location-h:e.data.quiz_location-6),d.position.left<e.data.start_location+f&&(d.position.left=e.data.has_start?e.data.start_location+f:e.data.quiz_location-6),e.time=(d.position.left+6)/c.progress_bar.width()*c.duration,e.data.time=(d.position.left+6)/c.progress_bar.width()*c.duration,e.data.hide_quiz_answers=!1,a.$broadcast("show_quiz_background",e.data),e.data.formatedTime=g("format")(e.data.time),c.seek()(e.data.time)},c.calculateStartQuizTime=function(b,d,e){d.position.top=-4;var f=5,g=c.quiz_circle_width/2+1;d.position.left>e.quiz_location-g&&(d.position.left=e.quiz_location-g),d.position.left<e.prev_quiz_end+f&&(d.position.left=e.prev_quiz_end+f),e.start_time=d.position.left/c.progress_bar.width()*c.duration,e.hide_quiz_answers=!0,a.$broadcast("hide_quiz_background"),c.seek()(e.start_time)},c.calculateEndQuizTime=function(b,d,e){d.position.top=-4;var f=c.quiz_circle_width/2+1,g=5;d.position.left>e.next_quiz_start-g&&(d.position.left=e.next_quiz_start-g),d.position.left<e.quiz_location+f&&(d.position.left=e.quiz_location+f),e.end_time=d.position.left/c.progress_bar.width()*c.duration,e.hide_quiz_answers=!0,a.$broadcast("hide_quiz_background"),c.seek()(e.end_time)},c.cleanUpDrag=function(a,b,c){r(a,b,c.data)},c.calculateVideoBoundaries=function(a,b){b.position.top=-4;var d=c.progress_bar.width();c.video.start_location=c.video.start_time/c.duration*d,c.video.end_location=c.video.end_time/c.duration*d,c.video.progress_width=d},c.calculateVideoStartTime=function(a,b){b.position.top=-4;var d=25;b.position.left<0&&(b.position.left=0),b.position.left>c.video.end_location-d&&(b.position.left=c.video.end_location-d),c.video.start_time=b.position.left/c.video.progress_width*c.duration,c.player.controls.setVideoStartTime(c.video.start_time),c.player.controls.absoluteSeek(c.video.start_time)},c.calculateVideoEndTime=function(a,b){b.position.top=-4;var d=25;b.position.left<c.video.start_location+d&&(b.position.left=c.video.start_location+d),b.position.left>c.video.progress_width&&(b.position.left=c.video.progress_width),c.video.end_time=b.position.left/c.video.progress_width*c.duration,c.player.controls.setVideoEndTime(c.video.end_time),c.player.controls.absoluteSeek(c.video.end_time)},c.seekToQuiz=function(b){b.hide_quiz_answers=!1,c.skip_progress_seek=!0,c.seek()(b.time),c.player.controls.pause(),a.$broadcast("show_quiz_background",b)},c.showQuiz=function(b){c.seekToQuiz(b),a.$broadcast("show_online_quiz",b)};var s=function(){c.timeline.items.forEach(function(a){a.data&&a.data.selected&&(a.data.hide_quiz_answers=!0)}),a.$broadcast("hide_quiz_background")},n=c.$watch("volume",function(){c.volume&&(c.player.controls.volume(c.volume),c.volume_class=0!=c.volume?"mute":"unmute")});j.on("timeupdate",function(){0==l&&"video"!=c.editing&&(c.current_time=c.player.controls.getTime(),h.current_time=c.current_time,c.elapsed_width=100*(c.current_time/c.duration),c.elapsed_head=c.elapsed_width>.5?c.elapsed_width-.45:0,c.elapsed_head=c.elapsed_head>99.4?99.4:c.elapsed_head),c.$apply()}),j.on("pause",function(){c.play_class="play",c.$apply()}),j.on("playing",function(){c.player.controls.youtube&&(c.chosen_quality=c.player.controls.getQuality()),c.play_class="pause",c.$apply()}),c.player.controls.youtube?(c.speeds=c.player.controls.getSpeeds(),c.chosen_speed=d.get("youtube_speed")||1,null!=d.get("volume")?(c.volume=d.get("volume"),c.volume||c.mute()):c.volume=.8,c.qualities=["auto","small","medium","large"],e(function(){c.qualities=c.player.controls.getAvailableQuality().reverse()},2e3),c.setQuality(c.chosen_quality)):(c.speeds=[.8,1,1.2,1.5,1.8],c.chosen_speed=d.get("mp4_speed")||1,c.volume=d.get("volume")||.8,c.qualities=["auto"],c.chosen_quality=c.qualities[0]),c.setSpeed(c.chosen_speed),shortcut.add("Space",function(){c.play()},{disable_in_input:!0}),shortcut.add("j",function(){c.rewind(),c.$apply()},{disable_in_input:!0}),shortcut.add("k",function(){c.play(),c.$apply()},{disable_in_input:!0}),shortcut.add("l",function(){c.fastForward(),c.$apply()},{disable_in_input:!0}),shortcut.add("b",function(){var a=c.player.controls.getTime();c.player.controls.pause(),c.player.controls.seek(a-10),c.player.controls.play()},{disable_in_input:!0}),c.$on("$destroy",function(){shortcut.remove("b"),shortcut.remove("Space"),shortcut.remove("j"),shortcut.remove("k"),shortcut.remove("l"),n(),$(window).off("resize",m)})}}}]),angular.module("scalearAngularApp").directive("popOver",["$parse","$compile","$q","$window","$log","$timeout",function(a,b,c,d,e,f){return{restrict:"A",link:function(c,g,h){var i=a(h.popOver);c.$watch(h.popOver,function(){var a=i(c);if(a){g.popover("destroy"),g.popover(a);var j=g.data("popover");if(a.content){h.unique&&g.on("show",function(){$(".popover.in").each(function(){var a=$(this),b=a.data("popover");b&&!b.$element.is(g)&&a.popover("hide")})}),h.highlight&&g.on("show",function(){g.find(".video_link").select()}),j.getPosition=function(){var d=$.fn.popover.Constructor.prototype.getPosition.apply(this,arguments);return b(this.$tip)(c),c.$digest(),this.$tip.data("popover",this),a.displayontop&&angular.element(".popover").css("z-index","999999"),a.topcut&&k(d),a.adjustRight&&(d=a.adjustRight(d,g,angular.element(".popover"))),d};var k=function(a){e.debug("topcut"),angular.element(d);var b=angular.element(".arrow"),c=g.offset().top;e.debug(c);var f;225>c&&(e.debug(angular.element(".popover").parent().position()),f=angular.element(".popover").parent().position().top+a.height,b.css("top",f+"px"),a.top=angular.element(".popover").height()-angular.element(".popover").height()/4+a.height)};a.instant_show&&f(function(){g.trigger(a.instant_show),a.instant_show=!1}),$(document).on("click",function(a){var b=$(a.target),c=b.closest(".popover").length>0,d=b.is(g);c||d||g.popover("hide")})}}})}}}]),angular.module("scalearAngularApp").directive("mainNavigation",["$state","$tour","scalear_api","$timeout","$cookieStore","$rootScope","Impersonate","ContentNavigator","User","Preview","$log","UserSession",function(a,b,c,d,e,f,g,h,i,j,k,l){return{replace:!0,restrict:"E",transclude:"true",scope:{user:"=",teacher_courses:"=teacherCourses",student_courses:"=studentCourses"},templateUrl:"/views/main_navigation.html",link:function(b){b.scalear_api=c,b.lti_embed=-1!=location.hash.indexOf("lti_course_list"),f.$watch("preview_as_student",function(){b.preview_as_student=f.preview_as_student}),b.logout=function(){f.busy_loading=!0,d(function(){l.logout().then(function(){a.go("login"),f.busy_loading=!1})},200)},b.areShared=function(){return b.user&&b.user.accepted_shared},b.getEndDate=function(a,b){return a.setDate(a.getDate()+7*b)},b.goToCourse=function(b){b.id!=a.params.course_id&&a.go("course",{course_id:b.id})},b.startTour=function(){k.debug(a.current.name),b.$emit("start_tour",{state:a.current.name})},b.closeMenu=function(){d(function(){angular.element(".toggle-topbar").click()})},b.disablePreview=function(){j.stop()}}}}]).directive("teacherNavigation",["$rootScope","$state","ContentNavigator","DetailsNavigator","Impersonate","$cookieStore",function(a,b,c,d){return{replace:!0,restrict:"E",scope:{},templateUrl:"/views/teacher/teacher_sub_navigation.html",link:function(e){e.ContentNavigator=c,e.DetailsNavigator=d,e.$state=b,e.$on("Course:ready",function(a,b){e.course=b}),e.initFilters=function(){e.progress_item_filter={lecture_quizzes:!0,confused:!0,charts:!0,discussion:!0,free_question:!0},e.progress_filter={quiz:!0,survey:!0}},e.toggleNavigator=function(){c.setStatus(!c.getStatus())},e.toggleDetails=function(){d.setStatus(!d.getStatus())};var f=function(a){d.setStatus(a)};e.goToEditor=function(){b.includes("**.module.**")?b.go("course.module.course_editor.overview"):b.go("course.course_editor")},e.goToProgress=function(){b.includes("**.module.**")?b.go("course.module.progress_overview"):b.go("course.progress_overview")},e.goToClass=function(){b.includes("**.module.**")?b.go("course.module.inclass"):b.go("course.inclass")},e.pasteItem=function(){a.$broadcast("paste_item")},e.print=function(){a.$broadcast("print")},e.updateProgressItemFilter=function(b){"lecture_quizzes"==b&&(e.progress_item_filter.charts=!e.progress_item_filter.lecture_quizzes,e.progress_item_filter.free_question=!e.progress_item_filter.lecture_quizzes),e.progress_item_filter[b]=!e.progress_item_filter[b],a.$broadcast("progress_item_filter_update",e.progress_item_filter)},e.updateProgressFilter=function(b){e.progress_filter[b]=!e.progress_filter[b],a.$broadcast("progress_filter_update",e.progress_filter)},f(!0)}}}]).directive("studentNavigation",["ContentNavigator","TimelineNavigator","$state",function(a,b,c){return{replace:!0,restrict:"E",transclude:!0,scope:{},templateUrl:"/views/student/student_sub_navigation.html",link:function(d){d.ContentNavigator=a,d.TimelineNavigator=b,d.$on("Course:ready",function(a,b){d.course=b}),d.toggleNavigator=function(){c.includes("course.content_selector")||a.setStatus(!a.getStatus())},d.toggleTimeline=function(){b.setStatus(!b.getStatus())}}}}]).directive("contentNavigator",["Module","$stateParams","$state","$timeout","Lecture","Course","ContentNavigator","$rootScope","Preview","$log","MobileDetector","UserSession","VideoInformation",function(a,b,c,d,e,f,g,h,i,j,k,l,m){return{restrict:"E",replace:!0,transclude:!0,scope:{mode:"@",open_navigator:"=open"},templateUrl:"/views/content_navigator.html",link:function(b){b.$state=c,l.getCurrentUser().then(function(a){b.current_user=a}),b.$on("Module:ready",function(a,c){b.modules=c}),b.$watch("$state.params",function(){c.params.module_id?(b.currentmodule={id:c.params.module_id},b.currentitem={id:c.params.lecture_id||c.params.quiz_id||c.params.customlink_id},d(function(){b.scrollIntoView(b.currentmodule)})):(b.currentmodule=null,b.currentitem=null)}),h.$watch("clipboard",function(){b.clipboard=h.clipboard}),b.$on("item_done",function(a,b){var c=0;g.getStatus()||(c=700),d(function(){b.done||(b.done=!0,b.blink=!0,d(function(){b.blink=!1},1e3))},c)}),b.moduleSortableOptions={axis:"y",dropOnEmpty:!1,handle:".handle",cursor:"crosshair",items:".module",opacity:.4,scroll:!0,update:function(){a.saveSort({course_id:c.params.course_id},{group:b.modules})}},b.itemSortableOptions={axis:"y",dropOnEmpty:!1,handle:".handle",cursor:"crosshair",items:".item",opacity:.4,scroll:!0,update:function(a,b){var d=b.item.scope().item.group_id,f=b.item.scope().$parent.module.items;e.saveSort({course_id:c.params.course_id,group:d},{items:f})}},b.showModuleCourseware=function(a,d){b.currentmodule=a,c.go("course.module.courseware.overview",{module_id:a.id}),d.stopPropagation()},b.showItem=function(a,e){if(c.includes("**.progress.**")||c.includes("**.progress_overview"))c.includes("course.module.progress")&&h.$broadcast("scroll_to_item",a);else{var f={module_id:a.group_id};j.debug(a);var i=a.class_name.toLowerCase();f[i+"_id"]=a.id,k.isPhone()&&d(function(){g.close()}),c.go("course.module."+e+"."+i,f),("courseware"!=e||"customlink"!=i)&&(b.currentitem={id:c.params.lecture_id||c.params.quiz_id||c.params.customlink_id})}},b.showModule=function(a,e){b.currentmodule&&b.currentmodule.id==a.id&&e.stopPropagation(),c.includes("course.progress_overview")||c.includes("course.progress_main")||c.includes("course.progress_graph")||c.includes("course.progress")?c.go("course.module.progress_overview",{module_id:a.id}):c.includes("course.module.progress_overview")||c.includes("course.module.progress")||c.includes("course.module.progress_statistics")||c.includes("course.module.progress_students")?c.go(".",{module_id:a.id}):c.includes("course.module.inclass")||c.includes("course.inclass")?c.go("course.module.inclass",{module_id:a.id}):c.go("course.module.course_editor.overview",{module_id:a.id}),b.currentmodule={id:c.params.module_id},d(function(){b.scrollIntoView(b.currentmodule)})},b.preview=function(){0!=m.current_time&&(c.params.time=Math.floor(m.current_time)),c.go("preview",c.params,{reload:!0})},b.addModule=function(){h.$broadcast("add_module")},b.paste=function(a,c){"module"==b.clipboard.type?h.$broadcast("paste_item"):h.$broadcast("paste_item",c)},b.scrollIntoView=function(a){$("#module_"+a.id).length&&$(".modules_container").scrollToThis("#module_"+a.id,{offsetTop:$(".modules_container").offset().top,duration:400})},b.goToCourseInfoStudent=function(){b.currentmodule=null,c.go("course.course_information")}}}}]).directive("timelineFilters",["$rootScope","$log","TimelineFilter",function(a,b,c){return{restrict:"E",scope:{},template:'<i class="timeline-settings" id="timeline_settings_btn" pop-over="popover_options"></i>',link:function(b){b.initFilters=function(){b.timeline_filter=c},b.exportNotes=function(){a.$broadcast("export_notes")},b.updateLectureFilter=function(a){b.timeline_filter.toggle(a)};var d='<ul ng-init="initFilters()" class="no-margin"><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'note\')"><input id="showNotesCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'note\')" /><span style="font-size:12px" translate>course_settings.show_notes</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'discussion\')"><input id="showQuestionsCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'discussion\')" /><span style="font-size:12px" translate>course_settings.show_discussion</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'quiz\')"><input id="showQuizzesCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'quiz\')" /><span style="font-size:12px" translate>course_settings.show_quizzes</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'confused\')"><input id="showConfusedCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'confused\')" /><span style="font-size:12px" translate>course_settings.show_confused</span></div></li><li><div class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="updateLectureFilter(\'marker\')"><input id="showMarkersCheckbox" class="with-tiny-margin-right" type="checkbox" ng-checked="timeline_filter.get(\'marker\')" /><span style="font-size:12px" translate>course_settings.show_markers</span></div></li><li><a class="looks-like-a-link lighter-grey dark-text with-small-padding-left with-small-padding-right" ng-click="exportNotes()"><span style="font-size:12px" translate>course_settings.download_notes</span></a></li></ul>';b.popover_options={content:d,html:!0,placement:"left"}}}}]).directive("userNavigation",[function(){return{replace:!0,restrict:"E",scope:{message:"="},templateUrl:"/views/user_sub_navigation.html",link:function(){}}}]),angular.module("scalearAngularApp").directive("version",["scalear_api",function(a){return{restrict:"E",template:'<div style="font-size:10px;color:lightgray;font-weight: 200">v'+a.version+"</div>"}}]).directive("scalearFooter",["scalear_api",function(a){return{restrict:"E",template:'<div class="row size-12" style="text-align: center; line-height: 12px;">&copy; '+(new Date).getFullYear()+' <span tooltip-html-unsafe="{{tooltip_text}}">ScalableLearning</span> | <a ui-sref="about" class="color-green" translate="footer.about"></a> | <a ui-sref="privacy" class="color-green" translate="footer.privacy"></a></div>',link:function(b){b.tooltip_text='<div style="font-size:10px;color:lightgray;font-weight: 200">build: v'+a.version+"</div>"}}}]).directive("reportTechnical",["Home","$location","$log","$stateParams","$interval","$translate","$rootScope","$modal",function(a,b,c,d,e,f,g,h){return{restrict:"A",link:function(a){a.toggleTechnicalDisplay=function(){angular.element(".btn").blur(),h.open({templateUrl:"/views/report_technical.html",controller:"ReportTechnicalCtrl"})}}}}]),angular.module("scalearAngularApp").directive("notificationItem",["$rootScope","Home","SharedItem","$state","UserSession",function(a,b,c,d,e){return{restrict:"E",scope:{id:"=",notification:"=",type:"="},templateUrl:"/views/teacher/invitation/invitation_item.html",link:function(c){e.getCurrentUser().then(function(a){c.current_user=a}),c.accept=function(){b.acceptCourse({},{invitation:c.id},function(b){c.current_user.invitations=b.invitations,delete c.current_user.invitation_items[c.id],d.go("course.edit_course_information",{course_id:c.notification.course_id,new_course:!0}),a.$broadcast("Course:get_current_courses")})},c.reject=function(){b.rejectCourse({},{invitation:c.id},function(a){c.current_user.invitations=a.invitations,delete c.current_user.invitation_items[c.id]})}}}}]).directive("sharedItemNotification",["$rootScope","Home","SharedItem","$state","UserSession",function(a,b,c,d,e){return{restrict:"E",scope:{id:"=",notification:"=",type:"="},templateUrl:"/views/teacher/sharing/shared_item_notification.html",link:function(a){e.getCurrentUser().then(function(b){a.current_user=b}),a.accept=function(){c.accpetShared({shared_item_id:a.notification.id},{},function(b){a.current_user.shared=b.shared_items,delete a.current_user.shared_items[a.id],d.go("show_shared",{},{reload:!0})})},a.reject=function(){c.rejectShared({shared_item_id:a.notification.id},{},function(b){a.current_user.shared=b.shared_items,delete a.current_user.shared_items[a.id]})}}}}]),angular.module("scalearAngularApp").directive("sharedItem",["$rootScope","Module","Lecture","Quiz","SharedItem","CustomLink","$state","$log",function(a,b,c,d,e,f,g,h){return{restrict:"E",scope:{data:"=",courses:"="},templateUrl:"/views/teacher/sharing/shared_item.html",link:function(a){a.addModule=function(c,d,f){b.moduleCopy({course_id:f},{module_id:a.data[c].modules[d].id},function(b){h.debug(b),a.data[c].modules.splice(d,1);var f=angular.copy(a.data[c]);delete f.id,delete f.teacher,h.debug(f),0==f.modules.length&&0==f.lectures.length&&0==f.quizzes.length&&0==f.customlinks.length?e.destroy({shared_item_id:a.data[c].id},function(){a.data.splice(c,1)}):e.updateSharedData({shared_item_id:a.data[c].id},{data:f})})},a.addLecture=function(b,d,f,g){c.lectureCopy({course_id:f},{lecture_id:a.data[b].lectures[d].id,module_id:g},function(c){h.debug(c),a.data[b].lectures.splice(d,1);var f=angular.copy(a.data[b]);delete f.created_at,delete f.id,delete f.teacher,0==f.modules.length&&0==f.lectures.length&&0==f.quizzes.length&&0==f.customlinks.length?e.destroy({shared_item_id:a.data[b].id},function(){a.data.splice(b,1)}):e.updateSharedData({shared_item_id:a.data[b].id},{data:f})},function(){})},a.addQuiz=function(b,c,f,g){d.quizCopy({course_id:f},{quiz_id:a.data[b].quizzes[c].id,module_id:g},function(d){h.debug(d),a.data[b].quizzes.splice(c,1);var f=angular.copy(a.data[b]);delete f.created_at,delete f.id,delete f.teacher,0==f.modules.length&&0==f.lectures.length&&0==f.quizzes.length&&0==f.customlinks.length?e.destroy({shared_item_id:a.data[b].id},function(){a.data.splice(b,1)}):e.updateSharedData({shared_item_id:a.data[b].id},{data:f})},function(){})},a.addLink=function(b,c,d,g){f.linkCopy({course_id:d},{link_id:a.data[b].customlinks[c].id,module_id:g},function(d){h.debug(d),a.data[b].customlinks.splice(c,1);var f=angular.copy(a.data[b]);delete f.created_at,delete f.id,delete f.teacher,0==f.modules.length&&0==f.lectures.length&&0==f.quizzes.length&&0==f.customlinks.length?e.destroy({shared_item_id:a.data[b].id},function(){a.data.splice(b,1)}):e.updateSharedData({shared_item_id:a.data[b].id},{data:f})},function(){})}}}}]),angular.module("scalearAngularApp").directive("moduleEdit",["$rootScope","$timeout","$state","$log","ngDialog",function(a,b,c,d,e){return{restrict:"E",replace:!0,scope:{module:"=data"},templateUrl:"/views/teacher/course_editor/module_edit.html",link:function(b){var c=function(){var a=0;b.module.items.forEach(function(b){b.duration&&(a+=parseInt(b.duration))}),b.module.total_time=a};c(),b.$on("update_module_time",function(a,d){b.module.id==d&&c()}),a.$watch("clipboard",function(){b.clipboard=a.clipboard}),b.remove=function(c){c.preventDefault(),c.stopPropagation(),b.module.items.length>0?e.open({template:'                            <div class="ngdialog-message">                                <h2><b><span translate>groups.delete_popup.warning</span>!</b></h2>                                <span>                                    <span translate>groups.delete_popup.delete_module</span>                                    <b>"'+b.module.name+'"</b>                                    <span translate>groups.delete_popup.will_delete</span>                                    <span translate>groups.delete_popup.are_you_sure</span>                                </span>                            </div>                            <div class="ngdialog-buttons">                                <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>button.cancel</button>                                <button type="button" class="ngdialog-button ngdialog-button-alert delete_confirm" ng-click="delete()" translate>button.delete</button>                            </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1,controller:["$scope",function(c){c.delete=function(){a.$broadcast("delete_module",b.module),c.closeThisDialog()}}]}):a.$broadcast("delete_module",b.module)},b.copy=function(c){d.debug("copy"),c.preventDefault(),a.$broadcast("copy_item",b.module)},b.paste=function(c){d.debug("Paste"),c.preventDefault(),a.$broadcast("paste_item",b.module.id)},b.share=function(c){d.debug("Share"),c.preventDefault(),a.$broadcast("share_copy",{module_id:b.module.id})}}}}]).directive("itemEdit",["$rootScope","$timeout","$anchorScroll","$location","$state","$log",function(a,b,c,d,e,f){return{scope:{item:"=data"},restrict:"E",templateUrl:"/views/teacher/course_editor/item_edit.html",link:function(b){a.$watch("clipboard",function(){b.clipboard=a.clipboard}),b.remove=function(c){c.stopPropagation(),c.preventDefault(),a.$broadcast("delete_item",b.item)},b.copy=function(c){f.debug("copy"),c.preventDefault(),a.$broadcast("copy_item",b.item)},b.paste=function(c){f.debug("Paste"),c.preventDefault(),a.$broadcast("paste_item",b.item.group_id)},b.share=function(c){f.debug("Share"),c.preventDefault(),a.$broadcast("share_copy",{module_id:b.item.group_id,item:b.item})}}}}]).directive("module",function(){return{replace:!0,restrict:"E",scope:{data:"&data"},templateUrl:"/views/teacher/course_editor/module.html",link:function(a){a.module=a.data();var b=function(){var b=0;a.module.items.forEach(function(a){a.duration&&(b+=parseInt(a.duration))}),a.module.total_time=b};b()}}}).directive("item",function(){return{scope:{data:"&data"},restrict:"E",templateUrl:"/views/teacher/course_editor/item.html",link:function(a){a.item=a.data()}}}).directive("buttonLink",function(){return{scope:{title:"@",action:"&"},restrict:"E",replace:!0,template:'<div ng-click="action({$event:$event})" class="btn" >{{title}}</div>'}}).directive("editableText",["$timeout",function(a){return{scope:{value:"=",save:"&",validation:"&",action:"&",elem:"="},restrict:"E",template:'<a onshow="selectField()" ng-mouseover="show_pencil = true;" blur="submit" ng-mouseleave="show_pencil = false;"  editable-text="value" e-form="textBtnForm" onbeforesave="validation()($data, elem)" onaftersave="saveData()" ng-click="action()" style="cursor:pointer;padding-right: 20px;" e-class="editable-input-large">{{ value || ("global.empty"|translate) }}<i ng-class="overclass" ></i> <span ng-show="show_pencil" class="fi-pencil size-21" style="position: absolute;" ng-click="textBtnForm.$show()"></span></a>',link:function(b,c,d){b.selectField=function(){a(function(){var a=c.find(".editable-input"),b=c.find("form.editable-wrap");b.css("width","100%"),a.select()})},b.saveData=function(){a(function(){b.save()})},b.show=function(){b.textBtnForm.$show()},d.open&&b.show()}}}]).directive("overlay",["$timeout",function(){return{transclude:!0,restrict:"E",replace:!0,template:'<div class="overlay" ng-transclude></div>',link:function(a,b){var c=b.parent();a.getHeight=function(){return c.height()}}}}]).directive("loading",function(){return{scope:{size:"@",show:"="},restrict:"E",replace:!0,templateUrl:"/views/teacher/course_editor/loading.html"}}).directive("deleteButton",["$translate",function(a){return{scope:{size:"@",action:"&",vertical:"&",text:"&",overlaymode:"&",mode:"@",moduleitem:"@",tooltiptext:"@",padded:"@"},restrict:"E",templateUrl:"/views/teacher/course_editor/delete_button.html",link:function(b){b.tooltiptext_translated=a.instant(b.tooltiptext),b.overlay=b.overlaymode()||!1,b.display_vertical=b.vertical(),b.text_mode=b.text(),b.showDeletePopup=function(a,c){b.displayDeletePopup=a,c.stopPropagation(),c.preventDefault()}}}}]).directive("moduleContentModal",["$modal",function(a){return{scope:{openModal:"="},restrict:"A",replace:!0,controller:["$scope",function(b){b.openModal=function(){a.open({templateUrl:"/views/teacher/course_editor/online_content_modal.html",controller:c})};var c=["$scope","$modalInstance","$rootScope",function(a,b,c){a.addItem=function(a){c.$broadcast("add_item",a),b.close()},a.cancel=b.dismiss}]}]}}]).directive("lectureQuestionsModal",["$modal",function(a){return{scope:{openModal:"=",data:"="},restrict:"A",replace:!0,controller:["$scope",function(b){b.openModal=function(){a.open({templateUrl:"/views/teacher/course_editor/question_types_modal.html",controller:c,windowClass:"large",scope:b})};var c=["$scope","$modalInstance","$rootScope",function(a,b,c){a.lecture=a.data,a.submitting=!1,a.addQuiz=function(d,e){a.submitting||(c.$broadcast("add_online_quiz",d,e),a.submitting=!0),b.close()},a.cancel=b.dismiss}]}]}}]),angular.module("scalearAngularApp").directive("quizList",function(){return{restrict:"E",templateUrl:"/views/teacher/course_editor/lecture.middle.quiz_list.html"}}).directive("markerList",function(){return{restrict:"E",templateUrl:"/views/teacher/course_editor/lecture.middle.marker_list.html"}}).directive("quiz",function(){return{transclude:!0,replace:!0,restrict:"E",template:'<div class="ontop" id="ontop" style="position: absolute;width:100%; height: 100%; top:0px; left: 0px;" ng-class="lecture.aspect_ratio" ng-transclude></div>'}}).directive("videoOverlay",function(){return{transclude:!0,replace:!0,restrict:"E",template:'<div style="position: absolute;width:100%; height: 100%; top:0px; left: 0px;" ng-class="lecture.aspect_ratio" ng-transclude></div>'}}).directive("quizEditPanel",["$timeout","$q","OnlineQuiz","$translate","ScalearUtils","VideoInformation",function(a,b,c,d,e,f){return{restrict:"E",templateUrl:"/views/teacher/course_editor/quiz_edit_panel.html",link:function(b,c){b.selected_quiz.has_start=b.selected_quiz.start_time!=b.selected_quiz.time,b.selected_quiz.has_end=b.selected_quiz.end_time!=b.selected_quiz.time,b.invideo_quiz_type="invideo"==b.selected_quiz.quiz_type,b.updateQuizStartTime=function(){if(b.selected_quiz.start_time=b.selected_quiz.time,b.selected_quiz.has_start){var a=f.duration,c=5,d=c*a/100;
b.selected_quiz.start_time=b.selected_quiz.start_time-d<0?0:b.selected_quiz.start_time-d}},b.updateQuizEndTime=function(){if(b.selected_quiz.end_time=b.selected_quiz.time,b.selected_quiz.has_end){var a=b.lecture_player.controls.getDuration(),c=5,d=c*a/100;b.selected_quiz.end_time=b.selected_quiz.end_time+d>a?a:b.selected_quiz.end_time+d}},a(function(){c.find(".quiz_name").focus(),document.execCommand("selectAll",!1,null)})}}}]).directive("markerEditPanel",["$timeout","$q","$translate","OnlineMarker",function(a){return{restrict:"E",template:'<div><h6 class="row no-margin color-wheat wheat"><div style="margin-top:10px;text-align:left;margin-left:0;"><div class="small-12 columns" style="margin-bottom: 5px;"><span translate>editor.title</span>:</div><div class="small-12 left columns" style="margin-bottom: 15px;"><div><rich-textarea class="marker_name" ng-model="selected_marker.title" ></div><small class="error" ng-show="marker_errors.name_error" ng-bind="marker_errors.name_error"></small></div></div><div style="margin-top:10px;text-align:left;margin-left:0;"><div class="small-12 columns" style="margin-bottom: 5px;"><span translate>editor.annotation</span>:</div><div class="small-12 left columns" style="margin-bottom: 15px;"><rich-textarea class="marker_annotation" ng-model="selected_marker.annotation" style="height: 70px;margin-bottom:0;"></div></div><div class="row" style="text-align:left;margin-left:0;"><div class="small-3 columns"><span translate>editor.note_time</span>:</div><div class="small-4 left columns no-padding" style="margin-bottom: 5px;"><input class="marker_time" type="text" ng-model="selected_marker.formatedTime" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="marker_errors.time_error" ng-bind="marker_errors.time_error"></small></div></div><div class="row" style="text-align:left;margin-left:0;"><div class="small-3 columns"><span translate>editor.note_as_slide</span>:</div><div class="small-9 left columns no-padding" style="margin-bottom: 5px;"><input class="marker_as_slide" type="checkbox" ng-model="selected_marker.as_slide" style="margin-bottom:0;"/><span translate>editor.note_as_slide_description</span><small class="error position-absolute z-one" ng-show="marker_errors.as_slide_error" ng-bind="marker_errors.as_slide_error"></small></div></div><div class="row" style="text-align:left;margin-left:0;" ng-hide="selected_marker.as_slide"><div class="small-3 columns"><span translate>editor.note_duration</span>:</div><div class="small-4 left columns no-padding" style="margin-bottom: 5px;"><input class="marker_duration" type="text" ng-model="selected_marker.duration" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="marker_errors.duration_error" ng-bind="marker_errors.duration_error"></small></div></div><delete_button id="delete_marker_button" size="big" action="deleteMarkerButton(selected_marker)" vertical="false" text="true" style="margin:10px;margin-left:0;float:right;margin-top:0;"></delete_button><button id="save_marker_button" ng-disabled="disable_save_button" class="button tiny" style="float:right" ng-click="saveMarkerBtn(selected_marker)" translate>events.done</button></h6></div>',link:function(b,c){a(function(){c.find(".marker_name").focus(),document.execCommand("selectAll",!1,null)});var d=function(a){$("div.marker_name").is(":focus")?$("div.marker_annotation").focus():$("div.marker_annotation").is(":focus")?$("input.marker_time").focus():$("input.marker_time").is(":focus")?$("#input.marker_duration").focus():$("input.marker_duration").is(":focus")?$("#save_marker_button").focus():$("#save_marker_button").is(":focus")?"enter"==a?$("#save_marker_button").click():$("#delete_marker_button").find("a").focus():$("#delete_marker_button").find("a").is(":focus")&&$("div.marker_name").focus()},e=function(){shortcut.remove("Enter"),shortcut.remove("Tab")};shortcut.add("Tab",function(){d("tab")},{disable_in_input:!1}),b.$on("$destroy",function(){e()})}}}]).directive("videoEditPanel",["$rootScope","$filter","ScalearUtils","VideoInformation",function(a,b,c){return{restrict:"E",template:'<div><h6 class="row no-margin color-wheat wheat"><div style="margin:10px">Use the handlers above to trim video</div><div><div class="small-12 columns" style="margin-bottom:10px;"><div class="small-3 columns">Start Time</div><div class="small-5 columns left size-14 text-center no-padding" style="border-radius: 3px; border: 1px darkgrey solid;"><input type="text" ng-model="selected_lecture.start_time_formated_time" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="lecture_errors.start_time" ng-bind="lecture_errors.start_time"></small></div></div><div class="small-12 columns"><div class="small-3 columns">End Time</div><div class="small-5 columns left size-14 text-center no-padding" style="border-radius: 3px; border: 1px darkgrey solid;"><input type="text" ng-model="selected_lecture.end_time_formated_time" style="height: 30px;margin-bottom:0;"><small class="error position-absolute z-one" ng-show="lecture_errors.end_time" ng-bind="lecture_errors.end_time"></small></div></div><button id="save_marker_button" ng-disabled="disable_save_button" class="button tiny" style="margin:10px;margin-left:0;float:right;margin-top:0;" ng-click="closeTrimVideo()" translate>events.done</button></h6></div>',link:function(d){d.selected_lecture={},d.lecture_errors={};var e=d.lecture.end_time;d.selected_lecture.start_time_formated_time=b("format")(d.lecture.start_time),d.selected_lecture.end_time_formated_time=b("format")(d.lecture.end_time),d.$watch("lecture.start_time",function(){d.selected_lecture.start_time_formated_time=b("format")(d.lecture.start_time)}),d.$watch("lecture.end_time",function(){d.selected_lecture.end_time_formated_time=b("format")(d.lecture.end_time)}),d.closeTrimVideo=function(){d.lecture_errors.start_time=c.validateTimeWithDurationForTrim(d.selected_lecture.start_time_formated_time,e),d.lecture_errors.end_time=c.validateTimeWithDurationForTrim(d.selected_lecture.end_time_formated_time,e,d.selected_lecture.start_time_formated_time),d.lecture_errors.start_time||d.lecture_errors.end_time||(d.lecture.start_time=c.arrayToSeconds(d.selected_lecture.start_time_formated_time.split(":")),d.lecture.end_time=c.arrayToSeconds(d.selected_lecture.end_time_formated_time.split(":")),a.$broadcast("close_trim_video"))}}}}]).directive("answervideo",function(){return{scope:{quiz:"=",data:"=",list:"=",save:"&",remove:"&"},replace:!0,restrict:"E",template:"<div ng-switch on='quiz.question_type.toUpperCase()'><answer ng-switch-when='MCQ' /><answer ng-switch-when='OCQ' /><drag ng-switch-when='DRAG' /><free_text ng-switch-when='FREE TEXT QUESTION' /></div>"}}).directive("answer",["$rootScope","$log","$timeout",function(a,b,c){return{replace:!0,restrict:"E",templateUrl:"/views/teacher/course_editor/answer.html",link:function(d,e){d.setAnswerColor=function(){d.imgName="OCQ"==d.quiz.question_type?d.data.correct?d.ocq_correct:d.ocq_incorrect:d.data.correct?d.mcq_correct:d.mcq_incorrect},d.calculatePosition=function(){var a=angular.element(".ontop");d.data.xcoor=parseFloat(e.position().left)/a.width(),d.data.ycoor=parseFloat(e.position().top)/a.height(),d.calculateSize()},d.calculateSize=function(){var a=angular.element(".ontop");d.data.width=e.width()/a.width(),d.data.height=e.height()/a.height()},d.radioChange=function(c){"OCQ"==d.quiz.question_type&&(b.debug("radioChange"),d.quiz.answers.forEach(function(a){a.correct=!1}),c.correct=!0,a.$emit("radioChange"))},d.selectField=function(){c(function(){$(".popover .answer_text").focus(),document.execCommand("selectAll",!1,null)})},d.updateValues=function(){d.values=0;for(var a in d.quiz.answers)d.quiz.answers[a].correct&&(d.values+=1)};var f=function(){$(".popover").remove()};d.$on("$destroy",function(){f()}),d.close=function(){d.save(),f()},d.delete=function(){d.remove(),f()},d.answerDragStart=function(){f()},a.$on("radioChange",function(){d.setAnswerColor()}),d.answerClass="component dropped answer_img";var g="";g="survey"==d.quiz.quiz_type?"<form name='aform'><label class='show-inline'><span translate>editor.answer</span><h6 class='no-margin-bottom'><small translate>editor.popover.shown_in_graph</small></h6></label><span class='right' tooltip-append-to-body='true' tooltip={{'editor.tooltip.click_to_delete'|translate}}><delete_button class='right' size='big' hide-confirm='false' color='dark' action='remove()'></delete_button></span><div><rich-textarea rows=3 class='must_save answer_text' ng-class='{error: aform.answer.$error.required}' type='text' ng-model='data.answer' ng-init='selectField()'  name='answer' required /></div><small class='error' ng-show='aform.answer.$error.required' style='padding-top: 5px;'><span translate>error_message.required</span>!</small><button type='button' ng-click='close()' class='button tiny success with-small-margin-top small-6 columns'><span translate>button.close</span></button>"+'<delete_button size="big" action="delete()" vertical="false" text="true" style="margin:8px 0;" class="small-6 columns no-padding"></delete_button></form>':"<form name='aform' ><label class='show-inline'><span translate>editor.correct</span> <span translate>editor.answer</span><input id='correct_checkbox' class='must_save_check' ng-change='radioChange(data);setAnswerColor();updateValues();' ng-model='data.correct' style='margin-left:10px;margin-bottom:2px' type='checkbox' ng-checked='data.correct' name='mcq'/></label><label class='with-small-margin-top'><span translate>editor.answer</span><h6 class='subheader no-margin'><small style='text-transform: initial;' translate>editor.popover.shown_in_graph</small></h6><div><rich-textarea rows=3 class='must_save answer_text' ng-model='data.answer' ng-class='{error: aform.answer.$error.required}' required ng-init='selectField($event)'/></div><small class='error' ng-show='aform.answer.$error.required' style='padding-top: 5px;'><span translate>error_message.required</span>!</small></label><label style='margin-top:10px'><span translate>editor.explanation</span><h6 class='subheader no-margin'><small style='text-transform: initial;' translate>editor.popover.shown_to_student</small></h6><rich-textarea rows=3 class='must_save' ng-model='data.explanation' /></label><button type='button' ng-click='close()' class='button tiny success with-small-margin-top small-6 columns'><span translate>button.close</span></button>"+'<delete_button size="big" action="delete()" vertical="false" text="true" style="margin:8px 0;" class="small-6 columns no-padding"></delete_button></form>',d.popover_options={content:g,html:!0,placement:function(){var a=d.data.xcoor>.5?"left":"right";return d.data.ycoor<.3?"bottom":a},container:"body"},d.data.id||(d.popover_options.instant_show="click"),d.$watch("quiz.answers",function(){d.updateValues()},!0),d.setAnswerColor()}}}]).directive("drag",["$log","$timeout",function(a,b){return{replace:!0,restrict:"E",template:"<div><div pop-over='popover_options' unique='true' class='component dropped_drag'  ng-style=\"{width: (data.width*100)+'%', height: (data.height*100)+'%', left: (data.xcoor*100)+'%', top: (data.ycoor*100)+'%'}\" data-drag='true' data-jqyoui-options=\"{containment:'.ontop'}\" jqyoui-draggable=\"{animate:true, onStop:'calculatePosition'}\" ><div ><span class='position-header error light-grey dark-text no-margin'>{{data.pos+1}} <span translate>editor.drag.end</span></span></div></div><div class='dragged handle' data-drag='true' style='height: 46px; border-radius: 10px; padding: 10px;' ng-style=\"{left: (data.sub_xcoor*100)+'%', top: (data.sub_ycoor*100)+'%'}\" data-jqyoui-options=\"{containment:'.ontop'}\" jqyoui-draggable=\"{animate:true, onStop:'calculatePosition'}\" ><span class='position-header error light-grey dark-text no-margin' style='top: 6px;left: -48px;padding: 6px;'>{{data.pos+1}} <span translate>editor.drag.start</span></span><span class='no-margin' ng-bind-html='data.answer'></span></div></div>",link:function(c,d){if(c.calculatePosition=function(){var b=angular.element(".ontop"),e=angular.element(d.children()[0]),f=angular.element(d.children()[1]);c.data.xcoor=parseFloat(e.position().left)/b.width(),c.data.ycoor=parseFloat(e.position().top)/b.height(),c.data.sub_xcoor=parseFloat(f.position().left)/b.width(),c.data.sub_ycoor=parseFloat(f.position().top)/b.height(),a.debug(c.data),c.calculateSize()},c.calculateSize=function(){var a=angular.element(".ontop"),b=angular.element(d.children()[0]);c.data.width=b.width()/a.width(),c.data.height=b.height()/a.height()},c.selectField=function(){b(function(){$(".popover .answer_text").focus(),document.execCommand("selectAll",!1,null)})},null==c.data.pos){a.debug("pos undefined");var e=Math.max.apply(Math,c.list);c.data.pos=e==-1/0?-1:e+1,c.list.push(c.data.pos)}if(c.pos=parseInt(c.data.pos),!(c.data.explanation instanceof Array)){c.data.explanation=[];for(var f in c.list)c.data.explanation[f]=""}c.quiz.answers.forEach(function(a){a.explanation[c.data.pos]||(a.explanation[c.data.pos]="")});var g=function(){$(".popover").remove()};c.$on("$destroy",function(){g()}),c.close=function(){c.save(),g()};var h='<ul class="no-margin"><label><span translate>editor.drag.instruction</span><rich-textarea rows=3 style="resize:vertical;" class="answer_text must_save" ng-model="data.answer" ng-init="selectField()"/></label><label><span translate>editor.drag.correct</span>:<rich-textarea rows=3 style="resize:vertical;" class="must_save" ng-model="data.explanation[pos]" /></label><label ng-repeat=\'num in list|filter:"!"+data.pos\' ><span translate translate-values="{num:num+1}">editor.drag.incorrect</span>:<rich-textarea rows=3 class="must_save" style="resize:vertical;" ng-model="data.explanation[num]" /></label><button type=\'button\' ng-click=\'close()\' class=\'button tiny success with-small-margin-top small-5 columns\'><span translate>button.close</span></button><delete_button size="big" action="remove()" vertical="false" text="true" style="margin:8px 0;" class="small-7 columns no-padding"></delete_button></ul>';c.popover_options={content:h,html:!0,placement:function(){var a=c.data.xcoor>.5?"left":"right";return c.data.ycoor<.3?"bottom":a},container:"body"},c.data.id||(c.popover_options.instant_show="click"),angular.element(d.children()[0]).resizable({containment:".videoborder",minHeight:40,minWidth:40,stop:c.calculateSize})}}}]).directive("freeText",["$log","$timeout",function(){return{replace:!0,restrict:"E",save:"&",remove:"&",template:"<div><div class='component dropped answer_drag' style='cursor:move;border: 1px solid #ddd;background-color:white;padding:0px;position:absolute; min-height:40px; min-width: 40px;' ng-style=\"{width: (data.width*100)+'%', height: (data.height*100)+'%', left: (data.xcoor*100)+'%', top: (data.ycoor*100)+'%'}\" data-drag='true' data-jqyoui-options=\"{containment:'.ontop'}\" jqyoui-draggable=\"{animate:true, onStop:'calculatePosition'}\"  pop-over='popover_options'><h6 class='no-margin' style='text-align:left;resize:none;padding:10px;font-size: 0.1rem' ng-bind-html='quiz.question'></h6></div></div>",link:function(a,b){a.calculatePosition=function(){var c=angular.element(".ontop"),d=angular.element(b.children()[0]);a.data.xcoor=parseFloat(d.position().left)/c.width(),a.data.ycoor=parseFloat(d.position().top)/c.height(),a.calculateSize()},a.calculateSize=function(){var c=angular.element(".ontop"),d=angular.element(b.children()[0]);a.data.width=d.width()/c.width(),a.data.height=d.height()/c.height()};var c=function(){$(".popover").remove()};a.$on("$destroy",function(){c()}),a.close=function(){a.save(),c()},a.delete=function(){a.remove()};var d="<form name='aform' ><label style='margin-top:10px'><span translate>editor.explanation</span><h6 class='subheader no-margin'><small style='text-transform: initial;' translate>editor.popover.shown_to_student</small></h6><rich-textarea rows=3 class='must_save' type='text' ng-model='data.explanation'></textarea></label><button type='button' ng-click='close()' class='button tiny success with-small-margin-top small-6 columns'><span translate>button.close</span></button></form>";a.popover_options={content:d,html:!0,placement:function(){var b=a.data.xcoor>.5?"left":"right";return a.data.ycoor<.3?"bottom":b},container:"body"},a.data.id||(a.popover_options.instant_show="click"),angular.element(b.children()[0]).resizable({containment:".videoborder",minHeight:40,minWidth:40,stop:a.calculateSize})}}}]).directive("answerform",["$log","$translate",function(a,b){return{scope:{quiz:"=",add:"&",remove:"&",removeq:"&",column:"@",columna:"@",index:"=",submitted:"=",subtype:"=",sortable:"@"},restrict:"E",templateUrl:"/views/teacher/course_editor/answer_forum.html",link:function(c,d){c.isSurvey=function(){return c.subtype&&("survey"==c.subtype.toLowerCase()||"html_survey"==c.subtype.toLowerCase())},c.isFreeText=function(){return"Free Text Question"==c.quiz.question_type},c.isNormalQuiz=function(){return"content"in c.quiz},c.removeAnswerFreeText=function(){c.isFreeText()&&c.quiz.answers.forEach(function(a,b){0==b?"Free Text"==c.quiz.match_type&&(a.content=""):c.quiz.answers.splice(b,1)})},c.quiz_types=[{value:"MCQ",text:b.instant("content.questions.quiz_types.mcq")},{value:"OCQ",text:b.instant("content.questions.quiz_types.ocq")},{value:"Free Text Question",text:b.instant("content.questions.quiz_types.text")}],c.match_types=[{value:"Free Text",text:b.instant("content.questions.quiz_types.free_text")},{value:"Match Text",text:b.instant("content.questions.quiz_types.match_text")}],a.debug(c.quiz),c.quiz.match_type||c.isSurvey()||(c.quiz.match_type="Free Text Question"==c.quiz.question_type&&c.quiz.answers&&""!=c.quiz.answers[0].content?c.match_types[1].value:c.match_types[0].value),c.isSurvey()||c.quiz_types.push({value:"drag",text:b.instant("content.questions.quiz_types.drag")}),c.addAnswer=c.add(),c.removeQuestion=c.removeq(),c.$on("$destroy",function(){shortcut.remove("Enter")}),shortcut.add("Enter",function(){if(!c.isFreeText()){var b=d.find("input");a.debug(b.length),b.each(function(b,d){a.debug(d),document.activeElement==d&&c.addAnswer("",c.quiz)}),c.$apply(),d.find("input")[b.length]&&d.find("input")[b.length].focus()}},{disable_in_input:!1,propagate:!0})}}}]).directive("htmlanswer",["$log",function(){return{restrict:"E",template:"<div ng-switch on='quiz.question_type.toUpperCase()'><div ng-switch-when='FREE TEXT QUESTION' ><div ng-switch on='quiz.match_type.toUpperCase()'><div ng-switch-when='MATCH TEXT' ><html_freetextmatch ng-repeat='answer in quiz.answers' /></div><div ng-switch-when='FREE TEXT' ><html_freetext ng-repeat='answer in quiz.answers' /></div></div></div><div ng-switch-when='MCQ' ><html_mcq  ng-repeat='answer in quiz.answers' /></div><div ng-switch-when='OCQ' ><html_ocq  ng-repeat='answer in quiz.answers' /></div><ul  ng-switch-when='DRAG' class='no-padding-top'><h5 class='no-margin-top'><small translate>editor.messages.random_answers</small></h5><span ui-sortable='answers_sortable_options' ng-model='quiz.answers'><html_drag ng-repeat='answer in quiz.answers' /></span></ul></div>",link:function(a){a.removeAnswer=a.remove(),a.updateValues=function(){a.values=0;for(var b in a.quiz.answers)a.quiz.answers[b].correct&&(a.values+=1)},a.radioChange=function(b){a.quiz.answers.forEach(function(a){a.correct=!1}),b.correct=!0,a.updateValues()},a.show=function(){return"time"in a.quiz},a.$watch("quiz.answers",function(){a.updateValues()},!0),a.answers_sortable_options={axis:"y",dropOnEmpty:!1,handle:".drag-item",cursor:"crosshair",items:".drag-answer",opacity:.4,scroll:!0}}}}]).directive("htmlFreetext",function(){return{restrict:"E",template:"<ng-form name='aform'><div class ='row collapse' ng-if='!isSurvey()' ><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding' ><rich-textarea class='no-margin explain' type='text' name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation'/></span></div></div></ng-form>"}}).directive("htmlFreetextmatch",function(){return{restrict:"E",template:"<ng-form name='aform'><div ng-if=quiz.match_type == 'Match Text'><div class='row'><div class='small-10 columns'><div><input required name='answer' type='text' placeholder='String to match' ng-model='answer[columna]' style='margin-bottom: 0;' /></div><small class='error' ng-show='submitted && aform.answer.$error.required' style='padding-top: 5px;'><span translate>error_message.required</span>!</small></div></div><div class='text-left size-12'><div><br/><span translate>editor.regex.enter_string</span><br /><br /><span translate>Examples</span>:</div><ul class='size-12'><li>Waterloo -> <span translate>editor.regex.correct_if</span> 'Waterloo'</li><li>/(Waterloo|waterloo)/ -> <span translate>editor.regex.correct_for</span> 'Waterloo' , 'waterloo'</li><li>/[0-9]/ -> <span translate>editor.regex.correct_for</span> <span translate>editor.regex.any_integer</span></li><li>/(10|14|29)/ -> <span translate>editor.regex.correct_for</span> <span translate>editor.regex.numbers</span></li></ul></div></div></div><div class ='row collapse' ><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding'><rich-textarea class='no-margin explain' type='text' name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation' /></span></div></ng-form>"}}).directive("htmlMcq",function(){return{restrict:"E",template:"<div class='small-12 no-padding columns'><delete_button class='right with-small-margin-top' size='small' mode='content_navigator' color='dark' action='removeAnswer($index, quiz)' /><ng-form name='aform'><div class='row collapse'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.answer</label></div><div class='small-7 columns left no-padding'><div><rich-textarea class='no-margin' required name='answer' placeholder={{'editor.answer'|translate}} ng-model='answer[columna]' /></div><small class='error with-tiny-margin-bottom' ng-show='submitted && aform.answer.$error.required' ><span translate>error_message.required</span>!</small></div><div class='small-2 columns' ng-if='!isSurvey()'><label><span translate>editor.correct</span></label><input class='valign-middle' ng-change='updateValues()' type='checkbox' name='mcq' ng-model='answer.correct' ng-checked='answer.correct' /></div></div><div class ='row collapse' ng-if='!isSurvey()'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding'><rich-textarea class='no-margin' class='explain'  name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation'/></span></div></div></ng-form></div><hr style='margin: 0;'/>"}}).directive("htmlOcq",function(){return{restrict:"E",template:"<div class='small-12 no-padding columns'><ng-form name='aform'><delete_button class='right with-small-margin-top' mode='content_navigator' size='small' color='dark' action='removeAnswer($index, quiz)' /><div class='row collapse'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.answer</label></div><div class='small-7 columns left no-padding'><div><rich-textarea class='no-margin' required name='answer' placeholder={{'editor.answer'|translate}} ng-model='answer[columna]'/></div><small class='error with-tiny-margin-bottom' ng-show='submitted && aform.answer.$error.required' ><span translate>error_message.required</span>!</small></div><div class='small-2 columns' ng-if='!isSurvey()'><label><span translate>editor.correct</span></label><input class='valign-middle' id='radio_correct' type='radio' ng-model='answer.correct' ng-value=true ng-click='radioChange(answer)'/></div></div><div class ='row collapse' ng-if='!isSurvey()'><div class='small-2 columns' style='padding: 10px 0;'><label class='text-left' translate>editor.explanation</label></div><div class='small-7 left columns no-padding'><rich-textarea class='no-margin' class='explain' name='explanation' placeholder={{'editor.explanation'|translate}} ng-model='answer.explanation' /></span></div></div></ng-form></div><hr style='margin: 10px 0;'/>",link:function(a){a.answer.correct&&a.radioChange(a.answer)}}}).directive("htmlDrag",function(){return{restrict:"E",replace:!0,templateUrl:"/views/teacher/course_editor/html_drag.html"}}).directive("atleastone",["$log",function(a){return{require:"ngModel",link:function(b,c,d,e){b.validate=function(){b.values<1?(a.debug("errorrr"),e.$setValidity("atleastone",!1)):e.$setValidity("atleastone",!0)},b.$watch("values",function(){b.validate()})}}}]).directive("controlsTeacher",["$window","$timeout",function(a,b){return{restrict:"E",scope:{link:"&"},template:'<div class="linkDiv" tooltip="{{\'editor.tooltip.create_link_time\'|translate}}" pop-over="link_content" unique="false" highlight="true"></div>',link:function(a,c){a.selectLink=function(){b(function(){c.find(".video_link").select()})},a.link_content={content:"<b>Student link to time {{link().time| formattime:'hh:mm:ss'}} in this video</b><hr style='margin: 5px;'/><div style='word-break: break-all;'>{{link().url}}</div>",html:!0,placement:"left"}}}}]),angular.module("scalearAngularApp").directive("detailsText",["$timeout",function(a){return{template:'<a ng-click="show()" onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'"  editable-text="value" e-form="textBtnForm" blur="submit" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ value || empty_message ||("global.empty"|translate) }} <i ng-class="overclass"></i></a>',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",open:"=",empty_message:"@emptyMessage"},link:function(b,c,d){if(b.selectField=function(){a(function(){c.find(".editable-input").select()})},b.saveData=function(){a(function(){b.save()})},b.show=function(){b.textBtnForm.$show()},d.open)var e=b.$watch("open",function(a){a===!0&&(b.show(),e())})}}}]).directive("detailsUrl",["$timeout","$translate","$filter",function(a,b,c){return{template:'<a ng-click="show()" onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'"  editable-textarea="value" e-rows="5" e-cols="100" e-form="textBtnForm" blur="submit" onbeforesave="validate()(column,$data)" onaftersave="saveData()" ng-class={"text-italic":value=="none"}>{{ text || "http://" }} <i ng-class="overclass"></i></a>',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",open:"="},link:function(d,e,f){var g=d.$watch("value",function(){d.text="none"==d.value?"("+b.instant("editor.details.add_video")+"...)":d.value,g()});if(d.selectField=function(){a(function(){e.find(".editable-input").select(),"none"==d.value&&e.find(".editable-input").val("")})},d.saveData=function(){d.value=c("formatURL")(d.value),a(function(){d.text=d.value,d.save()})},d.show=function(){d.textBtnForm.$show()},f.open)var g=d.$watch("open",function(a){a===!0&&(d.show(),g())})}}}]).directive("detailsLink",["$timeout",function(a){return{template:'<a href="#" onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'"  editable-text="value" blur="submit" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ short_url || "http://" }} <i ng-class="overclass"></i></a>',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",shorten:"="},link:function(b,c){b.selectField=function(){a(function(){c.find(".editable-input").select()})},b.$watch("value",function(){b.value&&(b.short_url=b.shorten?d(b.value,b.shorten):b.value)});var d=function(a,b){var b="undefined"!=typeof b?b:50,c=b/2;if(a.length<=b)return a;var d=e(a,c,!1),f=e(a,c,!0);return d+".."+f},e=function(a,b,c){for(var d=[" ","/","&"],e=.8*b,c="undefined"!=typeof c?c:!1,a=c?a.split("").reverse().join(""):a,f="",g=0;b-1>g&&(f+=a[g],!(g>=e&&d.indexOf(a[g])>=0));g++);return c?f.split("").reverse().join(""):f};b.saveData=function(){a(function(){b.save()})}}}}]).directive("detailsCheck",["$timeout",function(a){return{template:'<a href="#" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" editable-checkbox="checked" blur="submit" e-title="{{title}}" class="editable-checkbox" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ checked && yes || no }}<i ng-class="overclass"></i></a>',restrict:"E",scope:{checked:"=",save:"&",title:"@",yes:"@",no:"@",validate:"&",column:"@"},link:function(b){b.saveData=function(){a(function(){b.save()})}}}}]).directive("detailsDate",["$timeout",function(a){return{template:'<a onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" href="#" editable-bsdate="date" blur="submit" e-ng-change="pastTime()" e-datepicker-popup="dd-MMMM-yyyy" onbeforesave="validate()(column,$data)" onaftersave="saveData($data)">{{ (date | amDateFormat:"dddd, DD MMMM YYYY" ) || ("global.empty"|translate) }}<i ng-class="overclass"></i></a>',restrict:"E",scope:{date:"=",save:"&",validate:"&",column:"@"},link:function(b,c){b.selectField=function(){a(function(){c.find(".editable-input").select(),shortcut.add("enter",function(){c.find(".editable-input").submit(),shortcut.remove("enter")},{disable_in_input:!1})})},b.saveData=function(c){b.previousTime&&(b.date.setHours(b.previousTime.getHours()),b.date.setMinutes(b.previousTime.getMinutes()),a(function(){b.save({data:c,type:b.column})}))},b.pastTime=function(){b.previousTime=new Date(b.date)}}}}]).directive("detailsArea",["$timeout",function(a){return{template:'<a e-rich-textarea onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-textarea="value" onbeforesave="validate()(column,$data)" onaftersave="saveData()"><span ng-bind-html="value || empty_message"></span><i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",empty_message:"@emptyMessage"},link:function(b,c){b.selectField=function(){a(function(){c.find(".editable-input").select()})},b.saveData=function(){a(function(){b.save()})}}}}]).directive("bigArea",["$timeout",function(a){return{template:'<a e-rich-textarea onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-textarea="value" e-rows="5" e-cols="100" onbeforesave="validate()(column,$data)" onaftersave="saveData()"><span ng-bind-html="value || empty_message || (\'global.empty\'|translate)"></span><i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",save:"&",validate:"&",column:"@",empty_message:"@emptyMessage"},link:function(b,c){b.selectField=function(){var d=c.find(".editable-input");a(function(){d.select(),"none"==b.value&&d.val("")})},b.saveData=function(){a(function(){b.save()})}}}}]).directive("detailsNumber",["$timeout",function(a){return{template:'<a onshow="selectField();" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-number="value" e-min="min" onbeforesave="validate()(column,$data)" onaftersave="saveData()">{{ value }}<i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",save:"&",min:"@",validate:"&",column:"@"},link:function(b,c){b.selectField=function(){a(function(){c.find(".editable-input").select()})},b.saveData=function(){a(function(){b.save()})}}}}]).directive("detailsSelect",["$timeout","$filter",function(a,b){return{template:'<a href="#" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" blur="submit" editable-select="value" buttons="no" e-ng-options="s.value as (s.text|translate) for s in options" onbeforesave="validate()(column,$data)" onaftersave="saveData()" e-style="width:120px !important;height:34px">{{ showStatus() }}<i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",options:"=",save:"&",validate:"&",column:"@"},link:function(c){c.showStatus=function(){var a=b("filter")(c.options,{value:c.value});
return a.length?b("translate")(a[0].text):"Not set"},c.saveData=function(){a(function(){c.save()})}}}}]).directive("detailsTimeZone",["$timeout","$filter",function(a,b){return{template:'<a href="#" ng-mouseover="overclass = \'fi-pencil size-14\'" ng-mouseleave="overclass= \'\'" blur="submit" editable-select="value" buttons="no" e-ng-options="s.value for s in options" onbeforesave="validate()(column,$data)" onaftersave="saveData()" >{{ showStatus()}}<i ng-class="overclass"></i></a> ',restrict:"E",scope:{value:"=",options:"=",save:"&",validate:"&",column:"@"},link:function(c){c.showStatus=function(){var a=b("filter")(c.options,c.value);return a.length?a[0].value:"Not set"},c.saveData=function(){a(function(){c.save()})}}}}]).directive("detailsTime",["$timeout",function(a){return{template:'<a onshow="selectField()" ng-mouseover="overclass = \'fi-pencil size-14\'" blur="submit" ng-mouseleave="overclass= \'\'" href="#" editable-bstime="time" e-show-meridian="false" e-minute-step="15" onbeforesave="validate()(column,$data)" onaftersave="saveData($data)">{{ (time | date:"HH:mm") || ("global.empty"|translate) }}<i ng-class="overclass"></i></a><timepicker ng-hide="true" />',restrict:"E",scope:{time:"=",save:"&",validate:"&",column:"@"},link:function(b,c){b.selectField=function(){a(function(){c.find(".editable-input td.control-group:nth(0) input").select()})},b.saveData=function(c){a(function(){b.save({data:c,type:b.column})})}}}}]),angular.module("scalearAngularApp").directive("progressMatrix",function(){return{restrict:"E",scope:{columnNames:"=",students:"=",status:"=",solvedCount:"=",totalLecQuiz:"=",action:"&",show_popover:"=showPopover",remaining:"&",scrolldisabled:"=",modstatus:"=",module:"=","export":"&"},templateUrl:"/views/teacher/progress/progress_matrix.html",link:function(a){if(a.exportProgress=null,a.export()&&(a.exportProgress=a.export()),a.show_popover){var b="<div style='font-size:14px; color: black;'><input type='radio' name='stat' ng-model='student.status[module[0]]' ng-change='action({student_id:student.id, module_id:module[0], status:student.status[module[0]] , lecture_quiz:module[7]})' style='margin:0 4px 4px 4px'><span translate>progress.popover.original</span> <input type='radio' name='stat' ng-model='student.status[module[0]]' ng-change='action({student_id:student.id, module_id:module[0], status:student.status[module[0]] , lecture_quiz:module[7]})' style='margin:0 4px 4px 4px' value='Finished on Time' translate><span translate>progress.popover.on_time</span> <input type='radio' name='stat' ng-model='student.status[module[0]]' ng-change='action({student_id:student.id, module_id:module[0], status:student.status[module[0]] , lecture_quiz:module[7]})' style='margin:0 4px 4px 4px' value='Not Finished' translate><span translate>progress.popover.not_done</span></div>";a.popover_options={content:b,title:"<span style='color: black;' translate>progress.popover.change_status</span>",html:!0,placement:"top",container:"body"}}a.getImg=function(a){return a=parseInt(a),-1==a?"not_finished":0==a?"finished_on_time":"finished_not_on_time"}}}}).directive("innerTitle",function(){return{restrict:"E",scope:{time:"=",type:"=",itemtitle:"=",color:"="},template:'<span class="inner_title" ><span style="cursor:pointer"><span ng-show="::(time!=null)">{{::"["+(time|format:"mm:ss")+"]"}}</span> <span >{{::type}}</span>: <span ng-style=\'::{"color":color, "fontWeight":"normal"}\' ng-bind-html="::(itemtitle)"></span></span></span>'}}).directive("showBox",function(){return{restrict:"E",scope:{value:"=",action:"&",text:"@"},template:'<div style="margin-left:4px"><div class="left no-padding" style="margin-right:3px;margin-left:2px"><input class="show_inclass no-margin" type="checkbox" ng-model="value" ng-change="change()" /></div><div class="left size-12 no-padding" style="color:black;font-weight:normal;margin-top: 3px;" > {{::label | translate}} </div></div>',link:function(a){a.label=a.text||"progress.button.show_in_class",a.change=function(){a.action(),angular.element("input.show_inclass").blur()}}}}).directive("freeTextTable",function(){return{restrict:"E",scope:{question:"=",survey_id:"=surveyId",lecture_id:"=lectureId",related_answers:"=relatedAnswers",display_only:"=displayOnly",graded:"@"},templateUrl:"/views/teacher/progress/free_text_table.html",controller:"freeTextTableCtrl"}}).directive("inclassEstimate",["$log",function(a){return{restrict:"E",scope:{time_quiz:"=timeQuiz",time_question:"=timeQuestion",video_quiz_count:"=videoQuizCount",quiz_count:"=quizCount",question_count:"=questionCount",survey_count:"=surveyCount",inclass_quiz_time:"=inclassQuizTime",inclass_quiz_count:"=inclassQuizCount"},templateUrl:"/views/teacher/in_class/inclass_time_estimate.html",link:function(b){b.numbers=[];for(var c=0;6>=c;c++)b.numbers.push(c);var d="<div style='min-width: 235px;'><label class='small-12 columns no-padding'><span translate>inclass.time_per_quiz</span><select style='height: 20px;font-size: 12px;padding: 0 18px;margin: 0;margin-left: 10px;width: 25%;float: right;' ng-model='time_quiz' ng-options='i for i in numbers'></select></label><label class='small-12 columns no-padding with-small-margin-bottom'><span translate>inclass.time_per_question</span><select style='height: 20px;font-size: 12px;padding: 0 18px;margin: 0;margin-left: 10px;width: 25%;float: right;' ng-model='time_question' ng-options='i for i in numbers'></select></label></div>";b.popover_options={content:d,html:!0,placement:"bottom"};var e=function(){return b.video_quiz_count*b.time_quiz+b.question_count*b.time_question+b.survey_count*b.time_question+b.quiz_count*b.time_quiz},f=function(){return Math.round(b.inclass_quiz_time)||0},g=function(b){return a.debug(b),b>12?"red":b>8?"orange":"black"};b.$watchCollection("[time_quiz, time_question, video_quiz_count, quiz_count, question_count, survey_count, inclass_quiz_time]",function(){b.review_estimate=e(),b.inclass_estimate=f(),b.total_inclass_estimate=b.review_estimate+b.inclass_estimate,b.review_estimate_color=g(b.review_estimate)})}}}]),angular.module("scalearAngularApp").directive("moduleProgressCheck",function(){return{restrict:"E",scope:{module:"&"},templateUrl:"/views/student/lectures/module_progress_check.html",link:function(a){var b=a.module().items.filter(function(a){return a.graded}).length,c=0==b;c&&(b=a.module().items.filter(function(a){return"customlink"!=a.class_name}).length);var d=a.$watch("module().items",function(){a.module_done=e()==b},!0),e=function(){if(c)var b=function(a){return a.done&&"customlink"!=a.class_name};else var b=function(a){return a.done&&a.graded};return a.module().items.filter(b).length};a.$on("$destroy",function(){d()})}}}),angular.module("scalearAngularApp").directive("studentQuiz",["Lecture","$stateParams","$log","$rootScope",function(a,b,c,d){return{scope:{quiz:"=",studentAnswers:"=",submitted:"=",correct:"=",explanation:"="},restrict:"E",templateUrl:"/views/student/lectures/student_quiz.html",link:function(a){function b(){a.quiz.questions.forEach(function(b){"DRAG"!==b.question_type.toUpperCase()?b.answers.forEach(function(b){b.options=a.getExplanationPop(b.id)}):a.studentAnswers[b.id].forEach(function(c,d){a.drag_explanation[d]=a.getExplanationPop(b.answers[0].id,d)})})}a.index=0,a.drag_explanation={},a.getIndex=function(){return++a.index},a.updateValues=function(b){if(a.values=0,""==a.studentAnswers[b]&&null==a.studentAnswers[b])a.values=0;else if("number"==typeof a.studentAnswers[b]||"string"==typeof a.studentAnswers[b]&&a.studentAnswers[b].length>0)a.values=1;else for(var c in a.studentAnswers[b])1==a.studentAnswers[b][c]&&(a.values=1);return a.values},a.valid=function(b){return 0!=a.updateValues(b)},a.getExplanationPop=function(a,b){return{content:'<div ng-bind-html="explanation['+a+"]"+(null!=b?"["+b+"]":"")+'"></div>',html:!0,trigger:d.is_mobile?"click":"hover",placement:"left"}},a.$watch("explanation",function(c){c&&Object.keys(a.explanation).length&&b()})}}}]),angular.module("scalearAngularApp").directive("notification",["$translate","$log",function(a){return{restrict:"E",scope:{message:"=",submessage:"=",middleMessage:"="},templateUrl:"/views/student/lectures/notification.html",link:function(b){b.correct_notify=a.instant("lectures.correct"),b.incorrect_notify=a.instant("lectures.incorrect")}}}]).directive("reviewInclass",["$translate","$log",function(){return{restrict:"E",scope:{vote:"&",close:"&",retry:"&"},templateUrl:"/views/student/lectures/review_inclass.html",link:function(){}}}]).directive("checkAnswer",["$log",function(){return{restrict:"E",replace:!0,scope:{action:"&"},template:'<button type="button" class="tiny success button with-small-padding no-margin" ng-click="action()">{{"lectures.button.check_answer" | translate}}</button>',link:function(){}}}]).directive("studentAnswerForm",["Lecture","$stateParams","$log",function(){return{scope:{quiz:"=",studentAnswers:"=",submitted:"=",explanation:"="},restrict:"E",template:"<ng-form name='qform'><div style='text-align:left;margin:10px;'><label style='font-size: 15px;padding-bottom: 10px;' ng-bind-html='quiz.question'>:</label><div class='answer_div'><div class='answer_div_before'>{{quiz.question_type.toUpperCase() == 'FREE TEXT QUESTION'? 'lectures.answer' : 'lectures.choices' | translate}}</div><student-html-answer /></div></div></ng-form>",link:function(a){a.studentAnswers=a.studentAnswers||{}}}}]).directive("studentHtmlAnswer",["$log",function(){return{restrict:"E",template:"<div ng-switch on='quiz.question_type.toUpperCase()' ><div ng-switch-when='MCQ' ><student-html-mcq  ng-repeat='answer in quiz.online_answers' /></div><div ng-switch-when='OCQ' ><student-html-ocq  ng-repeat='answer in quiz.online_answers' /></div><div ng-switch-when='FREE TEXT QUESTION'><student-html-free /></div><ul  ng-switch-when='DRAG' class='drag-sort sortable' ui-sortable ng-model='studentAnswers[quiz.id]'><student-html-drag ng-repeat='answer in studentAnswers[quiz.id]' /></ul></div>",link:function(a){a.updateValues=function(){if(a.values=0,"html"!=a.quiz.quiz_type&&"html_survey"!=a.quiz.quiz_type||"OCQ"!=a.quiz.question_type)for(var b in a.studentAnswers[a.quiz.id])1==a.studentAnswers[a.quiz.id][b]&&(a.values+=1);else"string"==typeof a.studentAnswers[a.quiz.id]&&(a.values+=1)},a.$watch("quiz.question",function(){a.updateValues()})}}}]).directive("studentHtmlMcq",["$translate","$log",function(){return{restrict:"E",template:"<ng-form name='aform' ><input atleastone ng-model='studentAnswers[quiz.id][answer.id]' name='mcq_{{quiz.id}}' type='checkbox' ng-change='updateValues({{quiz.id}})' pop-over='mypop' /><p style='display:inline;margin-left:10px' ng-bind-html='answer.answer'></p><br/><span class='errormessage' ng-show='submitted && aform.$error.atleastone' translate='lectures.messages.please_choose_one_answer'></span><br/></ng-form>",link:function(a){a.$watch("explanation[answer.id]",function(){a.explanation&&a.explanation[a.answer.id]&&(a.mypop={title:'<b ng-class="{\'green_notification\':explanation[answer.id][0]==true, \'red_notification\':explanation[answer.id][0]==false}">{{explanation[answer.id][0]==true?("lectures.correct"|translate) : ("lectures.incorrect"| translate)}}</b>',content:'<div ng-bind-html="explanation[answer.id][1]"></div>',html:!0,trigger:"hover",instant_show:"mouseover"})}),a.$on("$destroy",function(){a.explanation[a.answer.id]=null})}}}]).directive("studentHtmlOcq",["$translate","$log",function(a,b){return{restrict:"E",template:"<ng-form name='aform'><input atleastone ng-model='studentAnswers[quiz.id]' value='{{answer.id}}'  name='ocq_{{quiz.id}}' type='radio' ng-change='updateValues({{quiz.id}})' pop-over='mypop'/><p style='display:inline;margin-left:10px' ng-bind-html='answer.answer'></p><br/><span class='errormessage' ng-show='submitted && aform.$error.atleastone' translate='lectures.messages.please_choose_one_answer'></span><br/></ng-form>",link:function(a){a.$watch("explanation[answer.id]",function(){a.explanation&&a.explanation[a.answer.id]&&(b.debug("exp changed!!!"),a.mypop={title:'<b ng-class="{\'green_notification\':explanation[answer.id][0]==true, \'red_notification\':explanation[answer.id][0]==false}">{{explanation[answer.id][0]==true?("lectures.correct"|translate) : ("lectures.incorrect"| translate)}}</b>',content:'<div ng-bind-html="explanation[answer.id][1]"></div>',html:!0,trigger:"hover",instant_show:"mouseover"})}),a.$on("$destroy",function(){a.explanation&&a.explanation[a.answer.id]&&(a.explanation[a.answer.id]=null)})}}}]).directive("studentHtmlDrag",function(){return{restrict:"E",replace:!0,templateUrl:"/views/student/lectures/html_drag.html",link:function(a){a.$watch("explanation[quiz.id]",function(){a.explanation&&a.explanation[a.quiz.id]&&(a.mypop={content:'<div ng-bind-html="explanation[quiz.id][answer]"></div>',html:!0,trigger:"hover",container:"body"})}),a.$on("$destroy",function(){a.explanation[a.quiz.id]=null})}}}).directive("studentHtmlFree",["$translate","$log","$timeout",function(a,b,c){return{restrict:"E",template:"<ng-form name='aform'><textarea ng-click='studentHtmlFreeInputClick($event)' ng-model='studentAnswers[quiz.id]' style='width:500px;height:100px;' required></textarea><span class='errormessage' ng-show='submitted && aform.$error.required' translate='error_message.required'></span><br/></ng-form><div ng-bind-html='explanation[quiz.id]'></div>",link:function(a,b){a.$on("$destroy",function(){a.explanation[a.quiz.id]=null}),a.studentHtmlFreeInputClick=function(a){c(function(){angular.element(b).find("textarea").focus(),a.stopPropagation()})}}}}]).directive("studentAnswerVideo",["$log",function(){return{restrict:"E",scope:{quiz:"=",data:"=",explanation:"=",studentAnswers:"="},template:"<div ng-switch on='quiz.question_type.toUpperCase()'><div ng-switch-when='MCQ'><student-answer /></div><div ng-switch-when='OCQ'><student-answer /></div><div ng-switch-when='DRAG'><student-drag /></div><div ng-switch-when='FREE TEXT QUESTION'><student-free-text /></div></div>"}}]).directive("studentAnswer",["$rootScope","$translate","$log","$timeout",function(a,b,c,d){return{replace:!0,restrict:"E",templateUrl:"/views/student/lectures/answer.html",link:function(b,e){var f=function(){b.explanation_pop={};var a="MCQ"==b.quiz.question_type?"checkbox":"radio";e.attr("type",a)};b.radioChange=function(a){"OCQ"==b.quiz.question_type&&(c.debug("radioChange"),b.quiz.online_answers.forEach(function(a){a.selected=!1}),a.selected=!0)},b.$watch("explanation[data.id]",function(){b.explanation&&b.explanation[b.data.id]&&(b.explanation[b.data.id][0]?(b.title_class="green_notification",b.exp_title="lectures.correct",b.show_sub_title="MCQ"==b.quiz.question_type):(b.title_class="red_notification",b.exp_title="lectures.incorrect"),b.explanation_pop={title:"<b ng-class='title_class'>{{(exp_title|translate)}}</b><h6 class='subheader no-margin' style='font-size:12px' ng-show='show_sub_title' translate>lectures.other_correct_answers</h6>",content:"<div ng-bind-html='explanation[data.id][1]'></div>",html:!0,trigger:a.is_mobile?"click":"hover",placement:b.data.xcoor>.5?"left":"right",instant_show:"mouseover"},d(function(){b.explanation[b.data.id][0]&&e.siblings().css("z-index",1e4)},300))}),b.$on("$destroy",function(){b.explanation&&(b.explanation[b.data.id]=null)}),f()}}}]).directive("studentDrag",["$rootScope","$translate","$log","ScalearUtils",function(a,b,c,d){return{restrict:"E",templateUrl:"/views/student/lectures/answer_drag.html",link:function(b,c){var e=function(){var a=angular.element("#"+b.data.id);i(a),b.explanation_pop={},b.explanation[b.data.id]=null};b.formatDrag=function(a,b){var c=angular.element(b.helper[0]);g(c)},b.convertPositionToPercent=function(a,b){var c=angular.element(b.helper[0]),d=angular.element(".ontop"),e=c.position().left,f=c.position().top;c.css({left:100*(e/d.width())+"%",top:100*(f/d.height())+"%"})},b.adjustDrag=function(a,b){var c=angular.element(b.helper[0]),d=angular.element(".ontop"),e=a.pageX-d.offset().left,f=a.pageY-d.offset().top;b.position.left=a.pageX-c.width()<d.offset().left?0:e>d.width()?d.width()-c.width():e-c.width()/2,b.position.top=a.pageY-c.height()<d.offset().top?0:f>d.height()?d.height()-c.height():f-c.height()},b.formatDropped=function(a,c){b.studentAnswers[b.quiz.id][b.data.id]?c.draggable.css("background-color","orange"):c.draggable.css("background-color","lightblue")},b.setDropped=function(a,c){if(b.studentAnswers[b.quiz.id][b.data.id]){var e=angular.element("#"+b.data.id);g(e),h(e),f(e),b.setDropped(a,c)}else{c.draggable.css("background-color","lightblue"),c.draggable.css("width",100*b.data.width+"%"),c.draggable.css("height",100*b.data.height+"%"),c.draggable.css("word-wrap","break-word"),c.draggable.css("overflow","hidden");var i=angular.element("#ontop").width(),j=angular.element("#ontop").height(),k=b.data.width*i,l=b.data.height*j,m=l*k/c.draggable.text().length;m=Math.min(Math.sqrt(m),15),c.draggable.css("font-size",m+"px"),c.draggable.css("left",100*b.data.xcoor+"%"),c.draggable.css("top",100*b.data.ycoor+"%"),c.draggable.addClass("dropped"),b.studentAnswers[b.quiz.id][b.data.id]=c.draggable.html(),c.draggable.attr("id",b.data.id),d.safeApply()}},b.clearDropped=function(a,b){i(b.draggable),f(b.draggable),b.draggable.css("font-size","15px")};var f=function(a){a.attr("id")==b.data.id&&(b.studentAnswers[b.quiz.id][b.data.id]="",d.safeApply()),a.css("background-color",""),a.attr("id","")},g=function(a){a.removeClass("dropped"),a.width(""),a.height("")},h=function(a){a.css("left",100*b.data.sub_xcoor+"%"),a.css("top",100*b.data.sub_ycoor+"%")},i=function(a){b.explanation_pop&&a.popover("destroy")};b.$watch("explanation[data.id]",function(){if(b.explanation&&b.explanation[b.data.id]){b.selected_id=angular.element(c.children()[1]).attr("id");var d=angular.element(".ontop");b.explanation_pop={title:"<b ng-class='{green_notification: explanation[selected_id][0], red_notification: !explanation[selected_id][0]}'>{{explanation[selected_id][0]?('lectures.correct'|translate):('lectures.incorrect'|translate)}}</b>",content:"<div ng-bind-html='explanation[selected_id][1]'></div>",html:!0,trigger:a.is_mobile?"click":"hover",placement:angular.element(c.children()[1]).position().left>d.width()/2?"left":"right"};var e=b.explanation[b.data.id][0]?"darkseagreen":"orangered";angular.element("#"+b.data.id).css("background-color",e)}}),b.$on("$destroy",function(){b.explanation[b.data.id]=null}),e()}}}]).directive("studentFreeText",["$rootScope","$translate","$log","$timeout",function(a,b,c,d){return{restrict:"E",template:'<textarea ng-click="freeTextInputClick($event)" placeholder="Write your answer here..." pop-over="explanation_pop" ng-model="studentAnswers[quiz.id]" ng-style="{left: (data.xcoor*100)+\'%\', top: (data.ycoor*100)+\'%\', width:(data.width*100)+\'%\', height:(data.height*100)+\'%\'}"  style="resize:none;position:absolute;font-size: 14px;"></textarea>',link:function(b,c){var e=function(){b.explanation_pop={},b.explanation[b.data.id]=null};b.$watch("explanation[quiz.id]",function(){b.explanation&&b.explanation[b.quiz.id]&&(b.explanation_pop={title:"<b ng-class='title_class'>{{(exp_title|translate)}}</b><h6 class='subheader no-margin' style='font-size:12px' ng-show='show_sub_title' translate>lectures.other_correct_answers</h6>",content:"<div ng-bind-html='explanation[quiz.id]'></div>",html:!0,trigger:a.is_mobile?"click":"hover",placement:b.data.xcoor>.5?"left":"right",container:"body"})}),b.freeTextInputClick=function(a){d(function(){angular.element(c).find("textarea").focus(),a.stopPropagation()})},b.$on("$destroy",function(){b.explanation[b.quiz.id]=null}),e()}}}]).directive("studentTimeline",["$timeout","ContentNavigator","TimelineFilter",function(a,b,c){return{replace:!0,restrict:"E",scope:{timeline:"=",items:"=",lecture:"=current",seek:"&",open_timeline:"=open",totalduration:"="},templateUrl:"/views/student/lectures/student_timeline.html",link:function(d){d.ContentNavigator=b,d.$watch("open_timeline",function(b){b?a(function(){d.delayed_timeline_open=!0},300):d.delayed_timeline_open=b}),d.checkEmpty=function(a){return""!=a.type},d.filterType=function(a){return c.get(a.type)}}}}]).directive("confusedTimeline",["Lecture","$filter",function(a,b){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/confused_timeline.html",link:function(c){c.item=c.data(),c.formattedTime=b("format","hh:mm:ss")(c.item.time),c.deleteConfused=function(b){a.deleteConfused({course_id:b.data.course_id,lecture_id:b.data.lecture_id,confused_id:b.data.id},function(){c.$emit("remove_from_timeline",b)})}}}}]).directive("quizTimeline",["OnlineQuiz","$filter","$rootScope","$translate","$log",function(a,b,c,d,e){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/quiz_timeline.html",link:function(f){f.item=f.data(),f.preview_as_student=c.preview_as_student,f.formattedTime=b("format","hh:mm:ss")(f.item.time),f.unsolved_msg=d.instant("lectures.tooltip.unsolved_quiz"),f.voteForReview=function(){e.debug("vote review"),a.voteForReview({online_quizzes_id:f.item.data.id},{},function(a){a.done&&(f.item.data.reviewed||(f.item.data.reviewed=!0,f.item.data.votes_count++))})},f.unvoteForReview=function(){e.debug("unvote review"),a.unvoteForReview({online_quizzes_id:f.item.data.id},{},function(a){a.done&&f.item.data.reviewed&&(f.item.data.reviewed=!1,f.item.data.votes_count--)})}}}}]).directive("notesTimeline",["$log","Lecture","$state","$filter",function(a,b,c,d){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/notes_timeline.html",link:function(e){e.item=e.data(),e.formattedTime=d("format","hh:mm:ss")(e.item.time),e.deleteNote=function(){e.item.data&&e.item.data.id?b.deleteNote({course_id:c.params.course_id,lecture_id:e.item.data.lecture_id||c.params.lecture_id,note_id:e.item.data.id},function(){e.$emit("remove_from_timeline",e.item)}):e.$emit("remove_from_timeline",e.item)},e.saveNote=function(d){a.debug(e.item),b.saveNote({course_id:c.params.course_id,lecture_id:e.item.data.lecture_id||c.params.lecture_id,note_id:e.item.data.id||null},{data:d,time:e.item.time},function(a){e.item.data=a.note})}}}}]).directive("notesArea",["$timeout",function(a){return{template:'<div   e-rich-textarea onshow="moveCursorToEnd()" e-rows="3" e-cols="100" blur="submit" editable-textarea="value" e-form="myform" buttons="no" onaftersave="saveData()" e-placeholder="Note..." ng-click="show()" e-style="width:95% !important; font-size: 13px;color: teal; height:80px" style="padding:0 9px"><div class="note" style="word-break: break-word; margin: 0px;cursor: text;float:left"><span ng-bind-html="value"></span></div><div style="font-size: 10px; float: right; display: inline-block;"><delete_button size="small" action="delete()" vertical="false" text="false" ></delete_button></div></div>',restrict:"E",scope:{value:"=",save:"&","delete":"&"},link:function(b){b.$on("$destroy",function(){shortcut.remove("enter"),shortcut.remove("esc")}),b.moveCursorToEnd=function(){shortcut.add("enter",function(){$("form.editable-textarea").submit()},{disable_in_input:!1}),shortcut.add("esc",function(){$("form.editable-textarea").submit()},{disable_in_input:!1})},b.show=function(){b.myform.$show(),$(".medium-editor-textarea").focus()},b.value||b.show(),b.saveData=function(){b.$emit("note_updated"),b.value?a(function(){b.save()(b.value)}):b.delete()}}}}]).directive("markersTimeline",["$filter",function(a){return{restrict:"A",scope:{data:"&",seek:"&"},templateUrl:"/views/student/lectures/markers_timeline.html",link:function(b){b.item=b.data(),b.formattedTime=a("format","hh:mm:ss")(b.item.time)}}}]).directive("annotation",["$filter",function(){return{restrict:"E",scope:{annotation:"=text",close:"&",action:"&"},templateUrl:"/views/student/lectures/annotation.html",link:function(a){a.closeBtn=a.close(),a.actionBtn=a.action()}}}]).directive("dynmaicAnnotation",["$filter","$rootScope","CourseModel","$timeout",function(a,b,c){return{restrict:"E",scope:{data:"=",close:"&",action:"&"},templateUrl:"/views/student/lectures/dynmaic_annotation.html",link:function(a,b){a.closeBtn=a.close(),a.actionBtn=a.action(),a.calculatePosition=function(){var c=angular.element(".ontop"),d=angular.element(b.children()[0]);a.data.xcoor=parseFloat(d.position().left)/c.width(),a.data.ycoor=parseFloat(d.position().top)/c.height(),a.calculateSize()},a.calculateSize=function(c,d){var e=angular.element(".ontop"),f=angular.element(b.children()[0]),g=angular.element(f[0].querySelector(".medium-editor-p"))[0];d&&f[0].offsetWidth<g.offsetWidth?(d.size.width=g.offsetWidth+10,a.data.width=d.size.width/e.width()):a.data.width=f[0].offsetWidth/e.width(),d&&f[0].offsetHeight<g.offsetHeight?(d.size.height=g.offsetHeight+10,a.data.height=a.data.height/e.height()):a.data.height=f[0].offsetHeight/e.height()},c.isStudent()||angular.element(b.children()[0]).resizable({containment:".videoborder",stop:a.calculateSize,resize:a.calculateSize})}}}]).directive("dynmaicAnnotationStudent",["$filter","$rootScope","CourseModel","$timeout",function(){return{restrict:"E",scope:{data:"=",close:"&",action:"&"},templateUrl:"/views/student/lectures/dynmaic_annotation_student.html",link:function(a){a.closeBtn=a.close(),a.actionBtn=a.action()}}}]).directive("slideNote",["$filter","$rootScope","CourseModel","$timeout",function(){return{restrict:"E",scope:{data:"=",close:"&",action:"&"},templateUrl:"/views/student/lectures/slide_note.html",link:function(a){a.closeBtn=a.close(),a.actionBtn=a.action()}}}]),angular.module("scalearAngularApp").directive("eventItem",["$filter",function(){return{replace:!0,restrict:"E",scope:{event:"=",role:"="},templateUrl:"/views/student/news_feed/event_item.html"}}]),angular.module("scalearAngularApp").directive("questionBlock",["$log","$translate","Forum","$state","$rootScope","User","$filter","ScalearUtils","VideoInformation","UserSession","$timeout","MobileDetector",function(a,b,c,d,e,f,g,h,i,j,k,l){return{restrict:"E",templateUrl:"/views/forum/question_block.html",scope:{item:"=",pref:"="},link:function(m){function n(){m.preview_as_student=e.preview_as_student,m.ask_button_clicked=!1,m.choices=[{text:b.instant("discussion.private_discussion"),value:0},{text:b.instant("discussion.public_discussion"),value:1}],m.privacy=m.choices[m.current_user.discussion_pref],"number"==typeof m.item.time&&(m.item.time=g("format","hh:mm:ss")(m.item.time)),l.isPhone()||k(function(){$(".text_block").focus()}),m.item.data&&m.item.data.isEdit&&(m.privacy=0==m.item.data.privacy?m.choices[0]:m.choices[1],m.current_question=m.item.data.content)}j.getCurrentUser().then(function(a){m.current_user=a,n()}),m.postQuestion=function(b){m.current_question&&m.current_question.length&&""!=m.current_question.trim()?(m.current_user.discussion_pref!=m.privacy.value&&(m.current_user.discussion_pref=m.privacy.value,f.alterPref({},{privacy:m.privacy.value})),m.time_error=h.validateTimeWithDuration(b.time,i.duration),m.time_error||(m.ask_button_clicked=!0,b.time=h.arrayToSeconds(b.time.split(":")),c.createPost({post:{content:m.current_question,time:b.time,lecture_id:d.params.lecture_id,privacy:m.privacy.value}},function(c){a.debug("success"),b.data=c.post,m.error_message=null,m.current_question=""},function(){a.debug("failure")}),m.$emit("discussion_updated"))):m.$emit("remove_from_timeline",b)},m.updateQuestion=function(a){m.current_question&&m.current_question.length&&""!=m.current_question.trim()?(m.time_error=h.validateTimeWithDuration(a.time,i.duration),m.time_error||(m.ask_button_clicked=!0,a.time=h.arrayToSeconds(a.time.split(":")),c.updatePost({post_id:a.data.id},{content:m.current_question,time:a.time},function(){a.data.content=m.current_question,a.data.updated_at=new Date,a.data.edited=!0,a.data.isEdit=!1,m.error_message=null,m.current_question=""}))):a.data.isEdit=!1},m.cancelQuestion=function(a){m.$emit("discussion_updated"),m.$emit("remove_from_timeline",a)},m.$on("post_question",function(a,b){b.data&&b.data.isEdit?m.updateQuestion(b.data):m.postQuestion(b)}),shortcut.add("enter",function(){m.item.data&&m.item.data.isEdit?m.updateQuestion(m.item.data):m.postQuestion(m.item),m.$apply()},{disable_in_input:!1}),m.$on("$destroy",function(){shortcut.remove("enter")})}}}]).directive("discussionTimeline",["Forum","Timeline","$translate","$rootScope","$filter","$log","$window","MobileDetector","UserSession",function(a,b,c,d,e,f,g,h,i){return{restrict:"A",scope:{seek:"&",data:"&"},templateUrl:"/views/forum/discussion_timeline.html",link:function(b){i.getCurrentUser().then(function(a){b.current_user=a}),b.turncatingcount=30,h.isiPad()&&(b.turncatingcount=15),b.item=b.data(),b.preview_as_student=d.preview_as_student,b.formattedTime=e("format","hh:mm:ss")(b.item.time),b.private_text=c.instant("discussion.private_post"),b.public_text=c.instant("discussion.public_post"),b.deleteDiscussion=function(c){a.deletePost({post_id:c.data.id},function(){b.error_message=null,b.$emit("remove_from_timeline",c)},function(){})},b.flagPost=function(){a.flagPost({post_id:b.item.data.id},function(){b.item.data.user_flag=1,b.item.data.flags_count++})},b.unflagPost=function(){a.flagPost({post_id:b.item.data.id},function(){b.item.data.user_flag=0,b.item.data.flags_count--})},b.upvotePost=function(){a.votePost({vote:parseInt(b.item.data.user_vote)+1,post_id:b.item.data.id},function(){b.item.data.user_vote=1,b.item.data.votes_count++})},b.downvotePost=function(){a.votePost({vote:parseInt(b.item.data.user_vote)-1,post_id:b.item.data.id},function(){b.item.data.user_vote=0,b.item.data.votes_count--})},b.deleteComment=function(c){a.deleteComment({comment_id:c.id,post_id:b.item.data.id},function(){var a=b.item.data.comments.indexOf(c);b.item.data.comments.splice(a,1),b.error_message=null})},b.reply=function(d,e){e&&e.length&&""!=e.trim()?(b.error_message=null,f.debug("discussion",d),a.createComment({comment:{content:e,post_id:d.data.id,lecture_id:d.data.lecture_id}},function(a){d.data.comments?d.data.comments.push(a.comment):d.data.comments=[a.comment],e=""},function(){})):b.error_message=c.instant("discussion.cannot_be_empty"),angular.element(".btn").blur()}}}}]).directive("discussionComment",["Forum","Timeline","$translate","$rootScope","$log","UserSession",function(a,b,c,d,e,f){return{restrict:"E",scope:{comment:"=","delete":"&"},templateUrl:"/views/forum/discussion_comment.html",link:function(b){f.getCurrentUser().then(function(a){b.current_user=a}),b.preview_as_student=d.preview_as_student,b.flagComment=function(){a.flagComment({comment_flag:{comment_id:b.comment.id}},function(){b.comment.user_flag=1,b.comment.flags_count++})},b.unflagComment=function(){a.flagComment({comment_flag:{comment_id:b.comment.id}},function(){b.comment.user_flag=0,b.comment.flags_count--})},b.upvoteComment=function(){a.voteComment({comment_vote:{vote:parseInt(b.comment.user_vote)+1,comment_id:b.comment.id}},function(){b.comment.user_vote=1,b.comment.votes_count++})},b.downvoteComment=function(){a.voteComment({comment_vote:{vote:parseInt(b.comment.user_vote)-1,comment_id:b.comment.id}},function(){b.comment.user_vote=0,b.comment.votes_count--})}}}}]).directive("votingButton",["$translate","$log",function(a){return{restrict:"E",scope:{votes_count:"=votesCount",voted:"=",up:"&",down:"&",direction:"@"},templateUrl:"/views/forum/like_button.html",link:function(b,c){b.like_text=a.instant("discussion.like"),b.unlike_text=a.instant("discussion.unlike"),angular.element(c.find(".looks-like-a-link")).css("display","horizontal"==b.direction?"inline-block":"block")}}}]).directive("flagButton",["$translate","$log",function(a){return{restrict:"E",scope:{flagged:"=",flag:"&",unflag:"&"},templateUrl:"/views/forum/flag_button.html",link:function(b){b.flag_text=a.instant("discussion.flag_post"),b.unflag_text=a.instant("discussion.unflag_post")}}}]).directive("commentBox",["$log",function(a){return{restrict:"E",scope:{discussion:"&",submit:"&"},templateUrl:"/views/forum/comment_box.html",link:function(b){b.showfield=!1,b.submitComment=function(){b.submit()(b.discussion(),b.comment),b.comment=null,b.hideField(),a.debug(b.showfield)
},b.toggleField=function(){b.showfield=!b.showfield},b.hideField=function(){!b.comment&&b.showfield&&b.toggleField()}}}}]),angular.module("scalearAngularApp").factory("Course",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/courses/:course_id/:action",{course_id:c.course_id,lang:g.use()},{create:{method:"POST",headers:e,params:{course_id:null}},index:{method:"GET",ignoreLoadingBar:!0,headers:e,params:{course_id:null}},update:{method:"PUT",headers:e},validateCourse:{method:"PUT",params:{action:"validate_course_angular"},headers:e},send_batch_email_through:{method:"POST",params:{action:"send_batch_email_through"},headers:e},removeStudent:{method:"POST",params:{action:"remove_student"},headers:e},unenroll:{method:"POST",params:{action:"unenroll"},headers:e},destroy:{method:"DELETE",headers:e},show:{method:"GET",headers:e},saveTeacher:{method:"POST",params:{action:"save_teachers"},headers:e},updateTeacher:{method:"POST",params:{action:"update_teacher"},headers:e},updateStudentDueDateEmail:{method:"POST",params:{action:"update_student_duedate_email"},headers:e},updateTeacherDiscussionEmail:{method:"POST",params:{action:"update_teacher_discussion_email"},headers:e},getStudentDueDateEmail:{method:"GET",params:{action:"get_student_duedate_email"},headers:e},deleteTeacher:{method:"DELETE",params:{action:"delete_teacher"},headers:e},getCalendarEvents:{method:"GET",params:{action:"events"},headers:e},getAnnouncements:{method:"GET",isArray:!0,params:{action:"announcements"},headers:e},newCourse:{method:"GET",headers:e,params:{action:"new",course_id:null}},getCourseEditor:{method:"GET",params:{action:"course_editor_angular"},headers:e},getTeachers:{method:"GET",params:{action:"teachers"},headers:e},getSelectedSubdomains:{method:"GET",params:{action:"get_selected_subdomains"},headers:e},setSelectedSubdomains:{method:"POST",params:{action:"set_selected_subdomains"},headers:e},enroll:{method:"POST",params:{action:"enroll_to_course",course_id:null},headers:e},getModuleProgress:{method:"GET",ignoreLoadingBar:!0,params:{action:"module_progress_angular"},headers:e},getTotalChart:{method:"GET",params:{action:"get_total_chart_angular"},headers:e},getCourseware:{method:"GET",params:{action:"courseware_angular"},headers:e},getEnrolledStudents:{method:"GET",params:{action:"enrolled_students"},headers:e,isArray:!0},exportCsv:{method:"GET",params:{action:"export_csv"},headers:e},exportStudentCsv:{method:"GET",params:{action:"export_student_csv"},headers:e},currentCourses:{method:"GET",isArray:!1,headers:e,params:{action:"current_courses"}},exportModuleProgress:{method:"GET",headers:e,params:{action:"export_modules_progress"}},systemWideEmail:{method:"POST",params:{action:"send_system_announcement"},headers:e},getRole:{method:"GET",headers:e,params:{action:"get_role"}}})}]).factory("CourseModel",["Course","$rootScope","$q","UserSession","$cookieStore","ScalearUtils",function(a,b,c,d,e){function f(b){return x||(x=c.defer(),a.getRole({course_id:b}).$promise.then(function(a){h(a.role),x.resolve(a.role)}).catch(function(){i()})),x.promise}function g(){return a.currentCourses({}).$promise}function h(a){v=a}function i(){x=null,v=null}function j(){return 2==v||7==v}function k(){return 1==v}function l(a){return d.getCurrentUser().then(function(b){return b&&b.roles?(i(),f(a)):void 0}).then(function(){return k()?m(a):j()?n(a):void 0}).then(function(a){var c=u(a);return o(c),b.$broadcast("Course:ready",c),c})}function m(c){return e.remove("preview_as_student"),e.remove("old_user_id"),e.remove("new_user_id"),e.remove("course_id"),a.getCourseEditor({course_id:c}).$promise.then(function(a){return b.$broadcast("Course:set_modules",a.groups),a.course})}function n(c){return a.getCourseware({course_id:c}).$promise.then(function(a){return a.course.next_item=a.next_item,b.$broadcast("Course:set_modules",a.groups),a.course})}function o(a){w=a}function p(){return w}function q(){w=null}function r(){return a.newCourse().$promise}function s(c,d){var e=c.selected_subdomain,f=c.email_discussion;delete c.selected_subdomain,delete c.email_discussion;var g=angular.copy(c),h=new Date;return g.start_date.setMinutes(g.start_date.getMinutes()-h.getTimezoneOffset()),g.time_zone=c.time_zone.name,a.create({course:g,"import":d,subdomains:e,email_discussion:f}).$promise.then(function(a){return b.$broadcast("Course:get_current_courses"),a})}function t(a){return a.instanceType&&"Course"==a.instanceType()}function u(b){function c(){return"Course"}function d(){var c=angular.copy(b);return c.time_zone=b.time_zone.name,delete c.id,delete c.created_at,delete c.updated_at,delete c.unique_identifier,delete c.duration,delete c.guest_unique_identifier,a.update({course_id:b.id},{course:c}).$promise}function e(){return a.validateCourse({course_id:b.id},b).$promise.catch(function(a){return 422==a.status?a.data.errors.join():"Server Error"})}function f(){return a.exportCsv({course_id:b.id}).$promise}function g(){return a.getAnnouncements({course_id:b.id}).$promise}function h(){return a.getStudentDueDateEmail({course_id:b.id}).$promise}function i(c){a.updateStudentDueDateEmail({course_id:b.id},{email_due_date:c})}function j(c){a.updateTeacherDiscussionEmail({course_id:b.id},{email_discussion:c})}return t(b)?b:angular.extend(b,{instanceType:c,update:d,validate:e,exportCourse:f,getAnnouncements:g,getStudentDueDateEmail:h,updateStudentDueDateEmail:i,updateTeacherDiscussionEmail:j})}var v,w,x=null;return{getCourseRole:f,removeCourseRole:i,removeSelectedCourse:q,getData:l,getSelectedCourse:p,isStudent:j,isTeacher:k,createInstance:u,isInstance:t,currentCourses:g,getUserOtherCourses:r,create:s}}]),angular.module("scalearAngularApp").factory("TeacherModel",["Course","CourseModel",function(a,b){function c(){return a.getTeachers({course_id:b.getSelectedCourse().id}).$promise}function d(){return a.getSelectedSubdomains({course_id:b.getSelectedCourse().id}).$promise}function e(c){return a.setSelectedSubdomains({course_id:b.getSelectedCourse().id},{selected_subdomains:c}).$promise}function f(c){return a.updateTeacher({course_id:b.getSelectedCourse().id},c).$promise}function g(c){return a.saveTeacher({course_id:b.getSelectedCourse().id},{new_teacher:c}).$promise}function h(c){return a.deleteTeacher({course_id:b.getSelectedCourse().id,email:c.email}).$promise}return{getTeachers:c,getSelectedSubdomains:d,setSelectedSubdomains:e,updateTeacher:f,deleteTeacher:h,saveNewTeacher:g}}]),angular.module("scalearAngularApp").factory("Module",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/courses/:course_id/groups/:module_id/:action",{course_id:c.course_id,lang:g.use()},{update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},newModule:{method:"POST",params:{action:"new_module_angular"},headers:e},newCustomLink:{method:"POST",params:{action:"new_link_angular"},headers:e},saveSort:{method:"POST",params:{action:"sort"},headers:e},getModuleStatistics:{method:"GET",params:{action:"get_group_statistics"},headers:e},validateModule:{method:"PUT",params:{action:"validate_group_angular"},headers:e},getAllItemsProgress:{method:"GET",ignoreLoadingBar:!0,params:{action:"get_all_items_progress_angular"},headers:e},getStudentStatistics:{method:"GET",params:{action:"get_student_statistics_angular"},headers:e},changeModuleStatus:{method:"POST",ignoreLoadingBar:!0,params:{action:"change_status_angular"},headers:e},hideQuiz:{method:"POST",params:{action:"hide_invideo_quiz"},headers:e},getStudentModule:{method:"GET",params:{action:"get_module_data_angular"},headers:e},moduleCopy:{method:"POST",params:{action:"module_copy"},headers:e},getModuleProgress:{method:"GET",params:{action:"get_module_progress"},headers:e},getModuleInclass:{method:"GET",params:{action:"get_module_inclass"},headers:e},getQuizCharts:{method:"GET",params:{action:"get_quiz_charts"},headers:e},getQuizChartsInclass:{method:"GET",params:{action:"get_quiz_charts_inclass"},headers:e},getSurveyCharts:{method:"GET",params:{action:"get_survey_charts"},headers:e},getInclassStudentStatus:{method:"GET",ignoreLoadingBar:!0,headers:e,params:{action:"get_inclass_student_status"}},getModuleSummary:{method:"GET",ignoreLoadingBar:!0,headers:e,params:{action:"get_module_summary"}},getOnlineQuizSummary:{method:"GET",ignoreLoadingBar:!0,headers:e,params:{action:"get_online_quiz_summary"}},getDiscussionSummary:{method:"GET",ignoreLoadingBar:!0,headers:e,params:{action:"get_discussion_summary"}},updateAllInclassSessions:{method:"POST",ignoreLoadingBar:!0,headers:e,params:{action:"update_all_inclass_sessions"}}})}]).factory("ModuleModel",["Module","$rootScope",function(a,b){function c(a){q=a}function d(){return q}function e(){q=null}function f(a){g(),a.forEach(function(a){i(p(a))}),b.$broadcast("Module:ready",r)}function g(){r=[],s={}}function h(){return a.newModule({course_id:t.id},{}).$promise.then(function(a){var c=p(a.group);return c.items=[],i(c),b.$broadcast("Module:added",c),c})}function i(a){r.push(a),s[a.id]=a,b.$broadcast("Module:set_items",a.items)}function j(a){r.splice(r.indexOf(a),1),delete s[a.id]}function k(a){s[a.group_id].items.push(a)}function l(a){var b=s[a.group_id].items;b.splice(b.indexOf(a),1)}function m(a){return s[a]}function n(a){return a.instanceType&&"Module"==a.instanceType()}function o(b){return a.moduleCopy({course_id:t.id},{module_id:b.id}).$promise.then(function(a){var b=p(a.group);i(b)})}function p(c){function d(){return"Module"}function e(){return a.destroy({course_id:c.course_id,module_id:c.id},{}).$promise.then(function(){j(c)})}function f(){return a.validateModule({course_id:c.course_id,module_id:c.id},c).$promise.catch(function(a){return 422==a.status?a.data.errors[0]:"Server Error"})}function g(){var d=angular.copy(c);return delete d.id,delete d.items,delete d.created_at,delete d.updated_at,delete d.total_time,a.update({course_id:c.course_id,module_id:c.id},{group:d}).$promise.then(function(){b.$broadcast("Module:"+c.id+":updated",c)})}function h(){return a.getModuleStatistics({course_id:c.course_id,module_id:c.id}).$promise}function i(){return new Date(c.appearance_time)<=new Date}return n(c)?c:angular.extend(c,{instanceType:d,remove:e,validate:f,update:g,getStatistics:h,isVisible:i})}var q=null,r=[],s={},t=null;return b.$on("Course:ready",function(a,b){t=b}),b.$on("Course:set_modules",function(a,b){f(b)}),b.$on("Item:added",function(a,b){k(b)}),b.$on("Item:removed",function(a,b){l(b)}),{setSelectedModule:c,getSelectedModule:d,clearSelectedModule:e,getById:m,create:h,createInstance:p,paste:o}}]),angular.module("scalearAngularApp").factory("ItemsModel",["LectureModel","QuizModel","LinkModel","$rootScope","$state","ErrorHandler",function(a,b,c,d,e,f){function g(a){a.forEach(function(a){h(a)}),d.$broadcast("Item:ready",a)}function h(e){var f=null;f="lecture"==e.class_name?a.createInstance(e):"quiz"==e.class_name?b.createInstance(e):c.createInstance(e),q[e.class_name][e.id]=f,d.$broadcast("update_module_time",e.group_id)}function i(a){delete q[a.class_name][a.id],d.$broadcast("update_module_statistics"),"lecture"==a.class_name&&d.$broadcast("update_module_time",a.group_id)}function j(a){return m(a,"lecture")}function k(a){return m(a,"quiz")}function l(a){return m(a,"customlink")}function m(a,b){return q[b][a]?q[b][a]:(e.go("course_list"),f.showMessage("Error: "+b+" not found.","errorMessage",4e3,"error"),void 0)}function n(){return a.getSelectedLecture()||b.getSelectedQuiz()||c.getSelectedLink()}function o(d){p(),"lecture"==d.class_name?a.setSelectedLecture(d):"quiz"==d.class_name?b.setSelectedQuiz(d):c.setSelectedLink(d)}function p(){a.clearSelectedLecture(),b.clearSelectedQuiz(),c.getSelectedLink()}var q={lecture:{},quiz:{},customlink:{}};return d.$on("Module:set_items",function(a,b){g(b)}),d.$on("Item:added",function(a,b){h(b)}),d.$on("Item:removed",function(a,b){i(b)}),{getLecture:j,getQuiz:k,getLink:l,getSelectedItem:n,setSelectedItem:o,clearAllSelected:p,getById:m}}]),angular.module("scalearAngularApp").factory("Lecture",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/courses/:course_id/lectures/:lecture_id/:action",{course_id:c.course_id,lecture_id:"@id",lang:g.use()},{update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},newLecture:{method:"GET",params:{action:"new_lecture_angular"},headers:e},getQuizData:{method:"GET",params:{action:"get_old_data_angular"},headers:e},getHtmlData:{method:"GET",params:{action:"get_html_data_angular"},headers:e},newQuiz:{method:"GET",params:{action:"new_quiz_angular"},headers:e},newMarker:{method:"POST",params:{action:"new_marker"},headers:e},updateAnswers:{method:"POST",params:{action:"save_answers_angular"},headers:e},saveSort:{method:"POST",ignoreLoadingBar:!0,params:{action:"sort"},headers:e},validateLecture:{method:"PUT",params:{action:"validate_lecture_angular"},headers:e},getLectureStudent:{method:"GET",params:{action:"get_lecture_data_angular"},headers:e},confused:{method:"POST",params:{action:"confused"},headers:e},saveOnline:{method:"POST",params:{action:"save_online"},headers:e},saveHtml:{method:"POST",params:{action:"save_html"},headers:e},deleteConfused:{method:"DELETE",params:{action:"delete_confused"},headers:e},saveNote:{method:"POST",params:{action:"save_note"},headers:e},deleteNote:{method:"DELETE",params:{action:"delete_note"},headers:e},lectureCopy:{method:"POST",params:{action:"lecture_copy"},headers:e},exportNotes:{method:"GET",params:{action:"export_notes"},headers:e},changeLectureStatus:{method:"POST",ignoreLoadingBar:!0,params:{action:"change_status_angular"},headers:e},updatePercentView:{method:"POST",ignoreLoadingBar:!0,params:{action:"update_percent_view"},headers:e},confusedShowInclass:{method:"POST",ignoreLoadingBar:!0,params:{action:"confused_show_inclass"},headers:e},logVideoEvent:{method:"POST",ignoreLoadingBar:!0,params:{action:"log_video_event"},headers:e},checkIfInvited:{method:"GET",ignoreLoadingBar:!1,params:{action:"check_if_invited_distance_peer"},headers:e},invitedStudent:{method:"GET",ignoreLoadingBar:!0,params:{action:"invite_student_distance_peer"},headers:e},checkInvitedStudentAccepted:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_invited_student_accepted_distance_peer"},headers:e},acceptInvation:{method:"GET",ignoreLoadingBar:!0,params:{action:"accept_invation_distance_peer"},headers:e},caneclDistancePeerSession:{method:"GET",ignoreLoadingBar:!0,params:{action:"cancel_session_distance_peer"},headers:e},checkIfInDistancePeerSession:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_if_in_distance_peer_session"},headers:e},changeStatusDistancePeer:{method:"GET",ignoreLoadingBar:!0,params:{action:"change_status_distance_peer"},headers:e},checkIfDistancePeerStatusIsSync:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_if_distance_peer_status_is_sync"},headers:e},checkIfDistancePeerIsAlive:{method:"GET",ignoreLoadingBar:!0,params:{action:"check_if_distance_peer_is_alive"},headers:e}})}]).factory("LectureModel",["Lecture","$rootScope","VideoInformation","$translate","Timeline","ScalearUtils","$q","ModuleModel",function(a,b,c,d,e,f,g,h){function i(a){return p=a,j()}function j(){return p}function k(){p&&p.destroy(),p=null}function l(a){return a.instanceType&&"Lecture"==a.instanceType()}function m(c){var d=!1,e=!1;1==c&&(d=!0),2==c&&(e=!0);var f=h.getSelectedModule();return a.newLecture({course_id:f.course_id,group:f.id,inclass:d,distance_peer:e}).$promise.then(function(a){a.lecture.class_name="lecture";var c=o(a.lecture);return b.$broadcast("Item:added",c),c})}function n(c,d){var e=h.getById(d);a.lectureCopy({course_id:e.course_id},{lecture_id:c.id,module_id:e.id}).$promise.then(function(a){a.lecture.class_name="lecture";var c=o(a.lecture);return b.$broadcast("Item:added",c),b.$broadcast("update_module_statistics"),c})}function o(j){function k(){var b=angular.copy(j);return delete b.id,delete b.created_at,delete b.updated_at,delete b.class_name,delete b.className,delete b.timeline,delete b.selected,a.update({course_id:j.course_id,lecture_id:j.id},{lecture:b}).$promise.then(function(a){angular.extend(j,a.lecture)})}function m(){var a=g.defer();return c.invalidUrl(j.url)?a.reject(d.instant("editor.details.incompatible_video_link")):n().then(function(){var b=c.isYoutube(j.url);if(b){var e=b[1];c.emptyCachedInfo(),c.requestInfoFromYoutube(e).then(function(b){b.items.length>0?"processed"===b.items[0].status.uploadStatus?a.resolve():a.reject(d.instant("editor.details.vidoe_not_exist")):a.reject(d.instant("editor.details.vidoe_not_exist"))}).catch(function(){return a.reject(d.instant("editor.details.vidoe_not_exist")),a.promise})}else a.resolve()}).catch(function(b){a.reject(b)}),a.promise}function n(){return a.validateLecture({course_id:j.course_id,lecture_id:j.id},j).$promise.catch(function(a){return 422==a.status?a.data.errors.join():"Server Error"})}function o(){c.resetValues();var a=g.defer();if(j.aspect_ratio="widescreen",j.url=j.url.trim(),j.url&&"none"!=j.url&&"http://"!=j.url){var d=c.isYoutube(j.url);if(d){var e=d[1];c.isFinalUrl(j.url)||(j.url=c.getFinalUrl(e)),c.requestInfoFromYoutube(e).then(function(c){var d=f.parseDuration(c.items[0].contentDetails.duration);j.duration=3600*d.hour+60*d.minute+d.second,j.start_time=0,j.end_time=j.duration,k().then(function(){a.resolve(!0)}),b.$broadcast("update_module_time",j.group_id)})}else if(c.isMP4(j.url)){var h=$("video");h.bind("loadeddata",function(c){j.start_time=0,j.end_time=c.target.duration||0,k().then(function(){a.resolve(!1)}),b.$broadcast("update_module_time",j.group_id)})}else c.isMediaSite(j.url)&&c.waitForDurationSetup().then(function(c){j.duration=c,j.start_time=0,j.end_time=j.duration,k().then(function(){a.resolve(!1)}),b.$broadcast("update_module_time",j.group_id)})}else j.url="none",a.reject();return a.promise}function p(){return a.destroy({course_id:j.course_id,lecture_id:j.id},{}).$promise.then(function(){b.$broadcast("Item:removed",j)})}function q(b){return a.updatePercentView({course_id:j.course_id,lecture_id:j.id},{percent:b}).$promise}function r(a,b,c){j.timeline.add(a,b,c)}function s(a,b){j.timeline.items.splice(j.timeline.getIndexById(a.id,b),1)}function t(){return h.getById(j.group_id)}function u(){return i(j)}function v(){b.$broadcast("item_done",j)}function w(){return"Lecture"}function x(){j.timeline=new e}function y(){x()}return l(j)?j:(j.timeline=new e,b.$on("Module:"+j.group_id+":updated",function(a,b){j.appearance_time_module&&(j.appearance_time=b.appearance_time),j.due_date_module&&(j.due_date=b.due_date),j.required_module&&(j.required=b.required),j.graded_module&&(j.graded=b.graded),j.skip_ahead_module&&(j.skip_ahead=b.skip_ahead)}),b.$on("Lecture:"+j.id+":add_to_timeline",function(a,b,c,d){r(b,c,d)}),b.$on("Lecture:"+j.id+":remove_from_timeline",function(a,b,c){s(b,c)}),angular.extend(j,{update:k,validateUrl:m,validate:n,updateUrl:o,addToTimeline:r,removeFromTimeline:s,instanceType:w,remove:p,updateViewPercentage:q,module:t,setAsSelected:u,markDone:v,destroy:y}))}var p=null;return{createInstance:o,isInstance:l,clearSelectedLecture:k,getSelectedLecture:j,setSelectedLecture:i,create:m,paste:n}}]),angular.module("scalearAngularApp").factory("OnlineQuiz",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/online_quizzes/:online_quizzes_id/:action",{lang:g.use()},{update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},getQuizList:{method:"GET",params:{action:"get_quiz_list_angular"},headers:e},validateName:{method:"PUT",params:{action:"validate_name"},headers:e},voteForReview:{method:"POST",params:{action:"vote_for_review"},headers:e},unvoteForReview:{method:"POST",params:{action:"unvote_for_review"},headers:e},hideResponses:{method:"POST",params:{action:"hide_responses"},headers:e},updateInclassSession:{method:"POST",ignoreLoadingBar:!0,params:{action:"update_inclass_session"},headers:e},getChartData:{method:"GET",ignoreLoadingBar:!0,params:{action:"get_chart_data"},headers:e},getInclassSessionVotes:{method:"GET",ignoreLoadingBar:!0,params:{action:"get_inclass_session_votes"},headers:e},updateGrade:{method:"POST",params:{action:"update_grade"},headers:e}})}]).factory("VideoQuizModel",["OnlineQuiz","$rootScope","ItemsModel","$q","VideoInformation","Lecture","CourseEditor","ErrorHandler","$filter","ScalearUtils","$translate",function(a,b,c,d,e,f,g,h,i,j,k){function l(){var d=c.getSelectedItem();return a.getQuizList({lecture_id:d.id}).$promise.then(function(a){var c=[];return a.quizList.forEach(function(a){var e=s(a);c.push(e),b.$broadcast("Lecture:"+d.id+":add_to_timeline",e.time,"quiz",e)}),c})}function m(a,b){var c=parseInt(a);return b.timeline.items.forEach(function(a){if("quiz"==a.type){var b=parseInt(a.data.time);b==c+1?c+=2:b==c&&(c+=1)}}),c}function n(a,d,g){var h=c.getSelectedItem(),i=e.duration;1>a&&(a=1),a=m(a,h),a>=i&&(a=i-2);var j=a,k=a;if(h.inclass||h.distance_peer){var l=5,n=l*i/100;j=0>j-n?0:j-n,k=k+n>i-1?i-1:k+n}return f.newQuiz({course_id:h.course_id,lecture_id:h.id,time:a,start_time:j,end_time:k,quiz_type:d,ques_type:g,inclass:h.inclass}).$promise.then(function(a){var c=s(a.quiz);return b.$broadcast("Lecture:"+h.id+":add_to_timeline",c.time,"quiz",c),c})}function o(a){return a.instanceType&&"VideoQuiz"==a.instanceType()}function p(a){return a.formatedTime=i("format")(a.time),a.start_formatedTime=i("format")(a.start_time),a.end_formatedTime=i("format")(a.end_time),a.inclass&&a.inclass_session||(a.inclass_session={intro:120,self:120,in_group:120,discussion:120}),a.intro_formatedTime=i("format")(a.intro),a.self_formatedTime=i("format")(a.self),a.group_formatedTime=i("format")(a.in_group),a.discussion_formatedTime=i("format")(a.discussion),t=a,q()}function q(){return t}function r(){t=null}function s(i){function l(a,b,c,d,e){var f=g.newAnswer(a,b,c,d,e,"lecture",i.id);if(i.answers.push(f),"drag"==i.question_type.toLowerCase()){var h=Math.max.apply(Math,i.allPos);f.pos=h==-1/0?0:h+1,i.allPos=s(i.answers)}}function m(a){i.answers.splice(a,1),"drag"==i.question_type.toLowerCase()&&(i.allPos=s(i.answers))}function n(){var a=250,b=100,c=angular.element("#ontop"),d=c.height()/3,e=c.width()/4,f=d/c.height(),g=e/c.width(),h=a/c.width(),i=b/c.height();l("",i,h,g,f)}function q(a){var b=g.newAnswer(a,"","","","","lecture",i.id);i.answers.push(b)}function r(a){i.answers.length<=1?h.showMessage("Error : "+k.instant("editor.cannot_delete_alteast_one_answer"),"errorMessage",4e3,"error"):i.answers.splice(a,1)}function s(a){var b=[];return a.forEach(function(a,c){a.pos=c,b.push(parseInt(a.pos))}),b}function t(){var a=i.answers;if(L()){var b=g.mergeDragAnswers(i.answers,"lecture",i.id);i.answers.forEach(function(a){return a.id&&null==b.id?(b.id=a.id,void 0):void 0}),a=[b]}return f.updateAnswers({course_id:i.course_id,lecture_id:i.lecture_id,online_quiz_id:i.id},{answer:a,quiz_title:i.question,match_type:i.match_type}).$promise}function u(){return F()?v():w()}function v(){return f.getQuizData({course_id:i.course_id,lecture_id:i.lecture_id,quiz:i.id}).$promise.then(function(a){i.answers=a.answers,"drag"==i.question_type.toLowerCase()&&(i.allPos=s(a.answers)),"free text question"==i.question_type.toLowerCase()&&0==i.answers.length&&n(i)})}function w(){return f.getHtmlData({course_id:i.course_id,lecture_id:i.lecture_id,quiz:i.id}).$promise.then(function(a){"drag"==i.question_type.toLowerCase()?(i.answers=[],a.answers.length?i.answers=g.expandDragAnswers(a.answers[0].id,a.answers[0].answer,"lecture",i.id,a.answers[0].explanation):q()):(i.answers=a.answers,i.answers.length||q())})}function x(){return a.destroy({online_quizzes_id:i.id},{}).$promise.then(function(){b.$broadcast("Lecture:"+i.lecture_id+":remove_from_timeline",i,"quiz")})}function y(){var b=c.getSelectedItem();(b.inclass||b.distance_peer)&&(i.intro=j.arrayToSeconds(i.intro_formatedTime.split(":")),i.self=j.arrayToSeconds(i.self_formatedTime.split(":")),i.in_group=j.arrayToSeconds(i.group_formatedTime.split(":")),i.discussion=j.arrayToSeconds(i.discussion_formatedTime.split(":")));var d=i.time%1,e=j.arrayToSeconds(i.formatedTime.split(":"));return i.time!=e+d&&(i.time=e,b.inclass||b.distance_peer||(i.start_time=i.end_time=e)),a.update({online_quizzes_id:i.id},{online_quiz:{time:i.time,start_time:i.start_time,end_time:i.end_time,question:i.question,inclass:i.inclass,graded:i.graded,intro:i.intro,self:i.self,in_group:i.in_group,discussion:i.discussion,display_text:i.display_text}}).$promise}function z(){var b={};return b.question=i.question,a.validateName({online_quizzes_id:i.id},b).$promise.catch(function(a){var b={};return b.name_error=422==a.status?a.data.errors.join():"Server Error",b})}function A(){var a=c.getSelectedItem(),b=d.defer(),f={};return f.time_error=j.validateTimeWithDuration(i.formatedTime,e.duration),(a.inclass||a.distance_peer)&&(f.intro_timer_error=j.validateTimeWithoutDuration(i.intro_formatedTime,e.duration),f.self_timer_error=j.validateTimeWithoutDuration(i.self_formatedTime,e.duration),f.group_timer_error=j.validateTimeWithoutDuration(i.group_formatedTime,e.duration),f.discussion_timer_error=j.validateTimeWithoutDuration(i.discussion_formatedTime,e.duration)),f.time_error||f.intro_timer_error||f.self_timer_error||f.group_timer_error||f.discussion_timer_error?b.reject(f):b.resolve(),b.promise}function B(){return z().then(function(a){return a.name_error?{errors:a}:A().catch(function(a){return{errors:a}})})}function C(){return"VideoQuiz"}function D(){return p(i)}function E(){return"html"==i.quiz_type}function F(){return"invideo"==i.quiz_type}function G(){return E()||K()}function H(){return"free text question"==i.question_type.toLowerCase()}function I(){return"drag"==i.question_type.toLowerCase()}function J(){return"survey"==i.quiz_type}function K(){return"html_survey"==i.quiz_type}function L(){return I()&&E()}return o(i)?i:angular.extend(i,{getInVideoQuizAnswers:v,getTextQuizAnswers:w,getQuizAnswers:u,addFreeTextAnswer:n,addAnswer:l,removeAnswer:m,addHtmlAnswer:q,removeHtmlAnswer:r,updateAnswers:t,instanceType:C,setAsSelected:D,isTextVideoQuiz:E,isFreeTextVideoQuiz:H,isDragQuiz:I,isTextQuiz:G,isSurvey:J,isTextSurvey:K,deleteQuiz:x,isDragTextQuiz:L,validate:B,update:y})}var t=null;return{getQuizzes:l,addVideoQuiz:n,createInstance:s,setSelectedVideoQuiz:p,getSelectedVideoQuiz:q,clearSelectedVideoQuiz:r}}]),angular.module("scalearAngularApp").factory("OnlineMarker",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/online_markers/:online_markers_id/:action",{lang:g.use()},{update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},getMarkerList:{method:"GET",params:{action:"get_marker_list"},headers:e},validateName:{method:"PUT",params:{action:"validate_name"},headers:e},updateHide:{method:"POST",params:{action:"update_hide"},headers:e}})}]).factory("MarkerModel",["OnlineMarker","$rootScope","ItemsModel","$q","$filter","VideoInformation","Lecture","ScalearUtils",function(a,b,c,d,e,f,g,h){function i(){var d=c.getSelectedItem();return a.getMarkerList({lecture_id:d.id}).$promise.then(function(a){var c=[];return a.markerList.forEach(function(a){var e=o(a);c.push(e),b.$broadcast("Lecture:"+d.id+":add_to_timeline",e.time,"marker",e)}),c})}function j(a,e,h,i,j){var k=d.defer(),l=c.getSelectedItem(),m=f.duration;1>a&&(a=1),a>=m&&(a=m-2);var n=l.timeline.getItemsBetweenTimeByType(a,a,"marker");if(n.length>0)k.resolve(n[0].data);else{var p={height:e||0,width:h||0,xcoor:i||0,ycoor:j||0,time:a};g.newMarker({course_id:l.course_id,lecture_id:l.id},{marker:p}).$promise.then(function(a){var c=o(a.marker);b.$broadcast("Lecture:"+l.id+":add_to_timeline",c.time,"marker",c),k.resolve(c)})}return k.promise}function k(a){return a.formatedTime=e("format")(a.time),p=a,l()}function l(){return p}function m(){p=null}function n(a){return a.instanceType&&"Marker"==a.instanceType()}function o(c){function e(){return"Marker"}function g(){return k(c)}function i(){var b=c.time%1,d=h.arrayToSeconds(c.formatedTime.split(":"));return c.time!=d+b&&(c.time=d),a.update({online_markers_id:c.id},{online_marker:{time:c.time,title:c.title,annotation:c.annotation,duration:c.duration,xcoor:c.xcoor,ycoor:c.ycoor,width:c.width,height:c.height,as_slide:c.as_slide}}).$promise}function j(){return a.destroy({online_markers_id:c.id},{}).$promise.then(function(){b.$broadcast("Lecture:"+c.lecture_id+":remove_from_timeline",c,"marker")})}function l(){var b={};return b.title=c.title,a.validateName({online_markers_id:c.id},{online_marker:b}).$promise.catch(function(a){var b={};return b.name_error=422==a.status?a.data.errors.join():"Server Error",b})}function m(){var a=d.defer(),b={};return b.time_error=h.validateTimeWithDuration(c.formatedTime,f.duration),b.time_error?a.reject(b):a.resolve(),a.promise}function o(){return l().then(function(){return m()})}return n(c)?c:angular.extend(c,{setAsSelected:g,instanceType:e,update:i,deleteMarker:j,validate:o})}var p=null;return{getMarkers:i,addMarker:j,createInstance:o,setSelectedMarker:k,getSelectedMarker:l,clearSelectedMarker:m}}]),angular.module("scalearAngularApp").factory("Quiz",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/courses/:course_id/quizzes/:quiz_id/:action",{course_id:c.course_id,lang:g.use()},{newQuiz:{method:"POST",params:{action:"new_or_edit"},headers:e},update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},getQuestions:{method:"GET",params:{action:"get_questions_angular"},headers:e},updateQuestions:{method:"PUT",params:{action:"update_questions_angular"},headers:e},validateQuiz:{method:"PUT",params:{action:"validate_quiz_angular"},headers:e},makeVisible:{method:"POST",params:{action:"make_visible"},headers:e},hideResponses:{method:"POST",params:{action:"hide_responses"},headers:e},hideResponseStudent:{method:"POST",params:{action:"hide_response_student"},headers:e},sendFeedback:{method:"POST",params:{action:"create_or_update_survey_responses"},headers:e},deleteFeedback:{method:"POST",params:{action:"delete_response"},headers:e},showInclass:{method:"POST",params:{action:"show_question_inclass"},headers:e},showStudent:{method:"POST",params:{action:"show_question_student"},headers:e},saveStudentQuiz:{method:"POST",params:{action:"save_student_quiz_angular"},headers:e},quizCopy:{method:"POST",params:{action:"quiz_copy"},headers:e},changeQuizStatus:{method:"POST",ignoreLoadingBar:!0,params:{action:"change_status_angular"},headers:e},updateGrade:{method:"POST",params:{action:"update_grade"},headers:e}})}]).factory("QuizModel",["Quiz","ModuleModel","$rootScope",function(a,b,c){function d(a){return k=a,e()}function e(){return k}function f(){k=null}function g(d){var e=b.getSelectedModule();return a.newQuiz({course_id:e.course_id,group:e.id,type:d},{}).$promise.then(function(a){a.quiz.class_name="quiz";var b=j(a.quiz);return c.$broadcast("Item:added",b),b})}function h(d,e){var f=b.getById(e);return a.quizCopy({course_id:f.course_id},{quiz_id:d.id,module_id:f.id}).$promise.then(function(a){a.quiz.class_name="quiz";var b=j(a.quiz);return c.$broadcast("Item:added",b),c.$broadcast("update_module_statistics"),b})}function i(a){return a.instanceType&&"Quiz"==a.instanceType()}function j(e){function f(){return"Quiz"}function g(){return b.getById(e.group_id)}function h(){return a.validateQuiz({course_id:e.course_id,quiz_id:e.id},e).$promise.catch(function(a){return 422==a.status&&a.data.errors?a.data.errors.join():"Server Error"})}function j(){var b=angular.copy(e);return delete b.created_at,delete b.updated_at,delete b.class_name,delete b.id,a.update({course_id:e.course_id,quiz_id:e.id},{quiz:b}).$promise.then(function(a){return angular.extend(e,a.quiz),e
})}function k(){return a.destroy({course_id:e.course_id,quiz_id:e.id},{}).$promise.then(function(){c.$broadcast("Item:removed",e)})}function l(){return d(e)}function m(){c.$broadcast("item_done",e)}function n(b,c){return a.saveStudentQuiz({quiz_id:e.id,course_id:e.course_id},{student_quiz:b,commit:c}).$promise}function o(){return new Date(e.appearance_time)<=new Date}return i(e)?e:(c.$on("Module:"+e.group_id+":updated",function(a,b){e.required_module&&(e.required=b.required),e.graded_module&&(e.graded=b.graded),e.due_date_module&&(e.due_date=b.due_date)}),angular.extend(e,{instanceType:f,module:g,validate:h,update:j,remove:k,setAsSelected:l,markDone:m,studentSolve:n,isVisible:o}))}var k=null;return{setSelectedQuiz:d,getSelectedQuiz:e,clearSelectedQuiz:f,isInstance:i,createInstance:j,paste:h,create:g}}]),angular.module("scalearAngularApp").factory("QuestionModel",["Quiz","CourseEditor","ErrorHandler","ItemsModel","$translate",function(a,b,c,d,e){function f(){var b=d.getSelectedItem();return a.getQuestions({course_id:b.course_id,quiz_id:b.id}).$promise}function g(){return f().then(function(a){return p=a.questions,p.forEach(function(c,d){"DRAG"==c.question_type.toUpperCase()?(c.answers=[],a.answers[d].length?c.answers=b.expandDragAnswers(a.answers[d][0].id,a.answers[d][0].content,"quiz",c.id,a.explanation[a.answers[d][0].id]):k("",c)):(c.answers=a.answers[d],a.answers[d].length||"Free Text Question"==c.question_type||k("",c))}),p})}function h(){return f().then(function(a){return p=a.questions,a})}function i(){var a=d.getSelectedItem(),b={quiz_id:a.id,content:"",question_type:"MCQ"};b.answers=[],p.push(b),k("",b)}function j(){var c=d.getSelectedItem(),e=[];for(var f in p)if("DRAG"==p[f].question_type.toUpperCase()){var g=b.mergeDragAnswers(p[f].answers,"quiz",p[f].id);p[f].answers.forEach(function(a){return a.id&&null==g.id?(g.id=a.id,void 0):void 0});var h=angular.copy(p[f]);h.answers=[g],e[f]=h}else e[f]=p[f];return a.updateQuestions({course_id:c.course_id,quiz_id:c.id},{questions:e}).$promise}function k(a,c){var d=b.newAnswer(a,"","","","","quiz",c.id);c.answers.push(d)}function l(a,b){b.answers.length>1?b.answers.splice(a,1):c.showMessage("Error : "+e.instant("editor.cannot_delete_alteast_one_answer"),"errorMessage",4e3,"error")}function m(a){p.splice(a,1)}function n(){var a=d.getSelectedItem(),b={quiz_id:a.id,content:"",question_type:"header"};p.push(b)}function o(a){m(a)}var p=[];return{getQuestions:f,getEditableQuestions:g,getSolvableQuestions:h,addQuestion:i,removeQuestion:m,updateQuestions:j,addAnswer:k,removeAnswer:l,addHeader:n,removeHeader:o}}]),angular.module("scalearAngularApp").factory("CustomLink",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/custom_links/:link_id/:action",{lang:g.use()},{update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},validate:{method:"PUT",headers:e,params:{action:"validate_custom_link"}},linkCopy:{method:"POST",params:{action:"link_copy"},headers:e}})}]).factory("LinkModel",["CustomLink","Module","ModuleModel","$filter","$rootScope",function(a,b,c,d,e){function f(a){return m=a,g()}function g(){return m}function h(){m=null}function i(){var a=c.getSelectedModule();return b.newCustomLink({course_id:a.course_id,module_id:a.id},{}).$promise.then(function(a){a.link.url="http://",a.link.class_name="customlink";var b=l(a.link);return e.$broadcast("Item:added",b),e.$broadcast("update_module_statistics"),b})}function j(b,d){var f=c.getById(d);a.linkCopy({link_id:b.id,course_id:f.course_id,module_id:f.id},{}).$promise.then(function(a){a.link.class_name="customlink";var b=l(a.link);return e.$broadcast("Item:added",b),b})}function k(a){return a.instanceType&&"Link"==a.instanceType()}function l(b){function g(){return a.destroy({course_id:b.course_id,link_id:b.id},{}).$promise.then(function(){e.$broadcast("Item:removed",b)})}function h(){return c.getById(b.group_id)}function i(){return"Link"}function j(){return a.validate({link_id:b.id},{link:b,course_id:b.course_id}).$promise.catch(function(a){return 422==a.status?a.data.errors[0]:"Server Error"})}function l(){return b.url=d("formatURL")(b.url),a.update({link_id:b.id},{link:{url:b.url,name:b.name}}).$promise}function m(){return f(b)}return k(b)?b:angular.extend(b,{instanceType:i,module:h,remove:g,validate:j,update:l,setAsSelected:m})}var m=null;return{isInstance:k,createInstance:l,setSelectedLink:f,getSelectedLink:g,clearSelectedLink:h,create:i,paste:j}}]),angular.module("scalearAngularApp").factory("CourseEditor",["$window",function(){var a={capitalize:function(a){return a[0].toUpperCase()+a.slice(1)},expandDragAnswers:function(b,c,d,e,f){var g=[];c instanceof Array||(c=[c]);for(var h in c){var i=a.newAnswer(c[h],"","","","",d,e,f[h]);0==h&&(i.id=b),g.push(i)}return g},mergeDragAnswers:function(b,c,d){var e=[],f=[];return b.forEach(function(a){"quiz"==c?(e.push(a.content),f.push(a.explanation||"")):(e.push(a.answer),f.push(a.explanation||""))}),a.newAnswer(e,"","","","",c,d,f)},mergeDragPos:function(a){var b=[];return a.forEach(function(a){b.push(parseInt(a.pos))}),b},newAnswer:function(a,b,c,d,e,f,g,h){if("quiz"!=f)var i={answer:a||"",correct:!1,explanation:h||"",online_quiz_id:g,height:b||0,width:c||0,xcoor:d||0,ycoor:e||0,sub_xcoor:d||0,sub_ycoor:e-.09||0};else var i={content:a||"",correct:!1,question_id:g,explanation:h||""};return i},isDueDateDisabled:function(a){var b=new Date(a),c=new Date;return b.getFullYear()>c.getFullYear()+100}};return a}]),angular.module("scalearAngularApp").factory("Announcement",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/courses/:course_id/announcements/:announcement_id/:action",{course_id:c.course_id,lang:g.use()},{index:{method:"GET",isArray:!0,headers:e},create:{method:"POST",headers:e},update:{method:"PUT",headers:e},destroy:{method:"DELETE",headers:e},show:{method:"GET",headers:e}})}]),angular.module("scalearAngularApp").factory("Kpi",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/kpis/:document_id/:action",{lang:g.use()},{readData:{method:"GET",headers:e,params:{action:"read_data"}},readTotals:{method:"GET",headers:e,params:{action:"read_totals"}},readSeries:{method:"GET",headers:e,params:{action:"read_series"}},readTotalsForDuration:{method:"GET",headers:e,params:{action:"read_totals_for_duration"}},getReportDataCourseDuration:{method:"POST",headers:e,params:{action:"get_report_data_course_duration"}},exportSchoolStatistics:{method:"GET",headers:e,params:{action:"export_school_statistics"}}})}]),angular.module("scalearAngularApp").factory("SharedItem",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/shared_items/:shared_item_id/:action",{lang:g.use()},{create:{method:"POST",headers:e},destroy:{method:"DELETE",headers:e},showShared:{method:"GET",headers:e,params:{action:"show_shared"}},accpetShared:{method:"POST",headers:e,params:{action:"accept_shared"}},rejectShared:{method:"POST",headers:e,params:{action:"reject_shared"}},updateSharedData:{method:"POST",headers:e,params:{action:"update_shared_data"}}})}]),angular.module("scalearAngularApp").factory("NewsFeed",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/news_feed/:action",{lang:g.use()},{index:{method:"GET",isArray:!1,headers:e}})}]),angular.module("scalearAngularApp").factory("ServerInterceptor",["$rootScope","$q","$timeout","$interval","ErrorHandler","$injector","scalear_api","headers","$log","$translate","$cookieStore","$location","URLInformation","Token",function(a,b,c,d,e,f,g,h,i,j,k){return{request:function(a){var c=new RegExp(g.host+"(/en/|/sv/)");return a.url=a.url.replace(c,g.host+"/"+j.use()+"/"),a||b.when(a)},requestError:function(a){return canRecover(a)?responseOrNewPromise:b.reject(a)},response:function(c){var f=new RegExp("^"+g.host);return 1==a.server_error&&-1!=c.config.url.search(f)&&(angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage(j.instant("error_message.connected"),"errorMessage",4e3,"success")),c||b.when(c)},responseError:function(l){if(i.debug(l),(l.headers()["x-flash-error"]||l.headers()["x-flash-warning"]&&-1!=l.config.url.search(n))&&(angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage(l.headers()["x-flash-error"]||l.headers()["x-flash-warning"],"errorMessage",4e3,"error")),400==l.status&&-1!=l.config.url.search(n)&&(angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage("Error : "+l.data.errors,"errorMessage",4e3,"error")),404==l.status&&-1!=l.config.url.search(n)){var m=f.get("$state");a.current_user?m.go("course_list"):m.go("login"),angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage("Error : "+l.data.errors,"errorMessage",4e3,"error")}if(403==l.status&&-1!=l.config.url.search(n)){var m=f.get("$state");a.current_user?m.go("course_list"):m.go("login"),angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage("Error : "+l.data.errors,"errorMessage",4e3,"error")}if(500==l.status&&-1!=l.config.url.search(n)){var m=f.get("$state");a.current_user?m.go("course_list"):m.go("login"),angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage("A server error occurred. If this continues, please use the Support link in the Help menu to contact technical support.","errorMessage",4e3,"error")}if(401==l.status&&-1!=l.config.url.search(n)){var m=f.get("$state");k.get("preview_as_student")&&(i.debug("preview_as_student"),k.remove("preview_as_student"),k.remove("old_user_id"),k.remove("new_user_id"),k.remove("params"),k.remove("state"),a.preview_as_student=!1),angular.isDefined(a.stop)&&(d.cancel(a.stop),a.stop=void 0),e.showMessage("Error : "+("undefined"==typeof l.data.errors?l.data.error:l.data.errors),"errorMessage",4e3,"error"),m.go("login")}var n=new RegExp("^"+g.host);if(0==l.status&&-1!=l.config.url.search(n)&&1!=a.unload){1!=a.server_error&&(a.server_error=!0,""==l.data?e.showMessage("Error "+l.status+": "+j.instant("error_message.cant_connect_to_server"),"errorMessage",8e3,"error"):e.showMessage("Error : "+l.data,"errorMessage",1e4,"error"));var o=f.get("$http");c(function(){return o({method:"GET",headers:h,url:g.host+"/en/home/test"})},1e4)}return b.reject(l)}}}]),angular.module("scalearAngularApp").factory("TokenServerInterceptor",["Token",function(a){return{request:function(b){var c=a.getToken();return c&&(b.headers["access-token"]=c["access-token"],b.headers.client=c.client,b.headers.expiry=c.expiry,b.headers.uid=c.uid,b.headers["token-type"]=c["token-type"],b.headers["cache-control"]=c["cache-control"]),b}}}]),angular.module("scalearAngularApp").factory("ValidateTime",["$rootScope","$translate",function(a,b){return function(a,c,d){var e=/^\d\d:\d\d:\d\d$/;if(!e.test(a))return b.instant("editor.incorrect_format_time");var f=a.split(":"),g=parseInt(f[0]),h=parseInt(f[1]),i=parseInt(f[2]),j=60*60*g+60*h+i;return 0>g||g>24||0>h||h>59||0>i||i>59?b.instant("editor.incorrect_format_time"):c&&j>=d||0>=j?b.instant("editor.time_outside_range"):void 0}}]),angular.module("scalearAngularApp").factory("ErrorHandler",["$log","$rootScope","$interval",function(a,b,c){function d(a,d,e,g){b.$broadcast("ErrorMessage:show",g),angular.element(".message").remove(),$("<div/>").addClass("message").addClass("valign-super").addClass(d).hide().fadeIn("fast").appendTo(f).text(a),e&&c(function(){b.$broadcast("ErrorMessage:hide")},e,1)}function e(a){f.push(a)}var f=$();return{showMessage:d,addToElementList:e}}]),angular.module("scalearAngularApp").factory("User",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$log","$translate",function(a,b,c,d,e,f,g,h){return b.defaults.useXDomain=!0,a(d.host+"/:lang/users/:id/:action",{lang:h.use()},{getCurrentUser:{method:"GET",headers:e,ignoreLoadingBar:!0,params:{action:"get_current_user"}},signIn:{method:"POST",headers:e,params:{action:"sign_in"}},signOut:{method:"DELETE",headers:e,params:{action:"sign_out"}},signUp:{method:"POST",headers:e},reset_password:{method:"POST",headers:e,params:{action:"password"}},change_password:{method:"PUT",headers:e,params:{action:"password"}},resend_confirmation:{method:"POST",headers:e,params:{action:"confirmation"}},show_confirmation:{method:"GET",headers:e,params:{action:"confirmation"}},update_account:{method:"PUT",headers:e},delete_account:{method:"delete",headers:e},alterPref:{method:"POST",params:{action:"alter_pref"},headers:e},updateCompletionWizard:{method:"POST",params:{action:"update_completion_wizard"},headers:e},samlSignup:{method:"POST",headers:e,params:{action:"saml_signup"}},userExist:{method:"GET",headers:e,params:{action:"user_exist"}},getSubdomains:{method:"GET",headers:e,params:{action:"get_subdomains"}},getWelcomeMessage:{method:"GET",headers:e,params:{action:"get_welcome_message"}},submitWelcomeMessage:{method:"POST",headers:e,params:{action:"submit_welcome_message"}}})}]),angular.module("scalearAngularApp").factory("UserSession",["$rootScope","User","Home","$q","$log","$translate","Token",function(a,b,c,d,e,f,g){function h(){return q||(q=d.defer(),b.getCurrentUser().$promise.then(function(a){if(console.log(a),a.signed_in){console.log("user signed in");var b=JSON.parse(a.user);return b.last_name||(b.last_name=""),b.roles=b.roles.map(function(a){return a.id}),b.profile_image=a.profile_image,b.invitations=a.invitations,b.shared=a.shared,b.accepted_shared=a.accepted_shared,k(b),q.resolve(p),j()}console.log("not signed in"),q.reject(),l()}).then(function(a){a&&(p.invitation_items=a.invitations,p.shared_items=a.shared_items)}).catch(function(){l()})),q.promise}function i(a){var c=d.defer();return b.signIn({},a,function(a,b){console.log(a),console.log(b()),g.setToken(b()),c.resolve({user:a,token:b()})}),c.promise}function j(){return c.getNotifications().$promise}function k(b){console.log(b),p=b,a.current_user=b}function l(){p=null,q=null,a.current_user=null}function m(){q=null}function n(){return b.signOut({},function(){l()}).$promise}function o(a){return b.delete_account({password:a},{}).$promise.then(function(){l()})}var p=null,q=null;return{getCurrentUser:h,logout:n,allowRefetchOfUser:m,deleteUser:o,signIn:i}}]),angular.module("scalearAngularApp").factory("batchEmailService",function(){var a={value:[],getEmails:function(){return a.value},setEmails:function(b){a.value=b}};return a}),angular.module("scalearAngularApp").factory("Home",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/home/:action",{lang:g.use()},{contactUs:{method:"GET",params:{action:"contact_us"},headers:e},technicalProblem:{method:"GET",params:{action:"technical_problem"},headers:e},getNotifications:{method:"GET",ignoreLoadingBar:!0,params:{action:"notifications"},headers:e},acceptCourse:{method:"POST",params:{action:"accept_course"},headers:e},rejectCourse:{method:"POST",params:{action:"reject_course"},headers:e}})}]),angular.module("scalearAngularApp").factory("Saml",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/saml/:action",{lang:g.use()},{Login:{method:"GET",params:{action:"saml_signin"},headers:e},getDomain:{method:"GET",params:{action:"get_domain"},headers:e}})}]).factory("SWAMID",["Saml","$rootScope",function(a){function b(){var b={descr:"The University of Gävle Identity Provider is used by employees and students at the university.",icon:"https://webkonto.student.hig.se/head/loggaengelska.png",icon_height:"94",icon_width:"83",title:"Utrecht University",hidden:"false",title_order:"Utrecht University",entityID:"https://namidp.services.uu.nl/nidp/saml2/metadata"};return a.getDomain().$promise.then(function(a){return a.domains.forEach(function(a){a.title_order=a.title,"KTH Royal Institute of Technology"==a.title?a.title_order="1 "+a.title:"Uppsala University"==a.title&&(a.title_order="2 "+a.title)}),a.domains.push(b),a.domains}).catch(function(){return[]})}return{list:b}}]),angular.module("scalearAngularApp").factory("Lti",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/lti/:action",{lang:g.use()},{embedCourseList:{method:"GET",params:{action:"embed_course_list"},headers:e},sendURLtoToolConsumer:{method:"GET",params:{action:"send_url_to_tool_consumer"},headers:e},getLtiCustomSharedKey:{method:"GET",params:{action:"get_lti_custom_shared_key"},headers:e},generateNewLtiKeys:{method:"GET",params:{action:"generate_new_lti_keys"},headers:e},ltiToolRedirectSaveData:{method:"GET",params:{action:"lti_tool_redirect_save_data"},headers:e}})}]),angular.module("scalearAngularApp").factory("Forum",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/discussions/:action",{lang:g.use()},{createPost:{method:"POST",params:{action:"create_post"},headers:e},votePost:{method:"POST",params:{action:"vote"},headers:e},flagPost:{method:"POST",params:{action:"flag"},headers:e},createComment:{method:"POST",params:{action:"create_comment"},headers:e},deletePost:{method:"DELETE",params:{action:"delete_post"},headers:e},deleteComment:{method:"DELETE",params:{action:"delete_comment"},headers:e},voteComment:{method:"POST",params:{action:"vote_comment"},headers:e},flagComment:{method:"POST",params:{action:"flag_comment"},headers:e},removeAllFlags:{method:"DELETE",params:{action:"remove_all_flags"},headers:e},removeAllCommentFlags:{method:"DELETE",params:{action:"remove_all_comment_flags"},headers:e},hideDiscussion:{method:"POST",params:{action:"hide_post"},headers:e},hideComment:{method:"POST",params:{action:"hide_comment"},headers:e},updatePost:{method:"POST",params:{action:"update_post"},headers:e}})}]),angular.module("scalearAngularApp").factory("TimeItem",function(){return function(a,b,c){this.time=a||0,this.type=b||"",this.data=c||null}}).factory("Timeline",["TimeItem",function(a){return function(){this.items=[],this.items.push(new a),this.add=function(b,c,d){for(var e=this.items.length-1,f=new a(b,c,d);e>=0;e--)if(f.time>=this.items[e].time){this.items.splice(e+1,0,f);break}return e+1},this.getIndexById=function(a,b){for(var c=this.items.length-1;c>=0;c--)if(this.items[c].data.id==a&&this.items[c].type==b)return c},this.removeById=function(a,b){this.items.splice(this.getIndexById(a,b),1)},this.getNearestEvent=function(a){for(var b=this.items[this.items.length-1].time,c=this.items[this.items.length-1],d=this.items.length-1;d>=0;d--){var e=Math.abs(a-this.items[d].time);Math.abs(a-this.items[d].time)<b&&(b=e,c=this.items[d])}return c},this.filterByType=function(a){return this.items.filter(function(b){return b.type==a})},this.filterByNotType=function(a){return this.items.filter(function(b){return b.type!=a})},this.getNextItem=function(a){return this.items[this.items.indexOf(a)+1]},this.getPrevItem=function(a){return this.items[this.items.indexOf(a)-1]},this.getNextByType=function(a){var b=this.filterByType(a.type);return b[b.indexOf(a)+1]},this.getPrevByType=function(a){var b=this.filterByType(a.type);return b[b.indexOf(a)-1]},this.getItemsBetweenTime=function(a,b){return this.items.filter(function(c,d){return c.time>=a&&c.time<=b&&d>0}).sort(function(a,b){return a.time-b.time})},this.getItemsBetweenTimeByType=function(a,b,c){return this.filterByType(c).filter(function(c){return c.time>=a&&c.time<=b}).sort(function(a,b){return a.time-b.time})},this.removeAllByType=function(a){this.items=this.filterByNotType(a)}}}]),angular.module("scalearAngularApp").factory("VideoInformation",["$http","$q","$interval",function(a,b,c){function d(a){return"https://www.googleapis.com/youtube/v3/videos?id="+a+"&key=AIzaSyAztqrTO5FZE2xPI4XDYbLeOXE0vtWoTMk&callback=JSON_CALLBACK&part=status,contentDetails,snippet"}var e={youtube_video_information:{},duration:0,current_time:0,volume:.8,speed:1,quality:"720p"};return e.requestInfoFromYoutube=function(c){var f=b.defer(),g=d(c);return e.youtube_video_information[g]?f.resolve(e.youtube_video_information[g]):a.jsonp(g).then(function(a){e.youtube_video_information[g]=a.data,f.resolve(e.youtube_video_information[g])}).catch(function(a){emptyCachedInfo(),f.reject(a)}),f.promise},e.emptyCachedInfo=function(){e.youtube_video_information={}},e.isYoutube=function(a){var b=a.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)([^\s&]{11})/);return b?b:a.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)?([^\s&]{11})/)},e.isFinalUrl=function(a){return a.match(/^(http|https):\/\/www\.youtube\.com\/watch\?v=[^\s]{11}[\W\w]*$/)},e.isMP4=function(a){return a.match(/(.*mp4$)/)},e.isMediaSite=function(a){return a.match(/^(http|https):\/\/.*(\/Play\/)/)},e.invalidUrl=function(a){return a.trim().length<=0||!e.isMP4(a)&&!e.isYoutube(a)&&!e.isMediaSite(a)},e.setDuration=function(a){e.duration=a},e.waitForDurationSetup=function(){var a=b.defer(),d=c(function(){e.duration&&(a.resolve(e.duration),c.cancel(d))},500);return a.promise},e.resetValues=function(){e.duration=0,e.current_time=0,e.volume=.8,e.speed=1,e.quality="720p"},e}]),angular.module("scalearAngularApp").factory("URLInformation",["$cookieStore",function(a){function b(){return!!l}function c(){return l}function d(a){return l=a,c()}function e(){l=null}function f(a){n.push(a)}function g(){return n.pop()}function h(b){return m=b,a.put("enroll_link",b),i()}function i(){return m||a.get("enroll_link")}function j(){m=null,a.remove("enroll_link")}function k(){return!!i()}var l=null,m=null,n=[];return{shouldRedirect:b,getRedirectLink:c,setRedirectLink:d,clearRedirectLink:e,addToHistory:f,getHistory:g,setEnrollLink:h,getEnrollLink:i,clearEnrollLink:j,hasEnroll:k}}]),angular.module("scalearAngularApp").factory("Page",["$rootScope","$filter","$log",function(a,b,c){var d="Home",e="home";return{title:function(){return d},pageName:function(){return e.replace(".","_")},setTitle:function(f,g){e=f,d=b("translate")(f),g&&(d+=g),a.current=f,c.debug(a.current)},startTour:function(){}}}]),angular.module("scalearAngularApp").factory("ScalTour",["$rootScope","$filter","$tour","Page","User",function(a,b,c,d,e){a.$on("tour_ended",function(){var b=a.$watch("current_user",function(){if(a.current_user){var c=a.current_user.completion_wizard;1==c.intro_watched&&(c[d.pageName()]=!0,$log.debug(c),e.updateCompletionWizard({id:a.current_user.id},{completion_wizard:c},function(){a.current_user.completion_wizard[d.pageName()]=!0,b()},function(){b()}))}})})}]),angular.module("scalearAngularApp").service("ScalearUtils",["$rootScope","$translate",function(a,b){var c=function(a,c,d){var e=/^\d\d:\d\d:\d\d$/;if(!e.test(a))return b.instant("editor.incorrect_format_time");var f=a.split(":"),g=parseInt(f[0]),h=parseInt(f[1]),i=parseInt(f[2]),j=60*60*g+60*h+i;return 0>g||g>24||0>h||h>59||0>i||i>59?b.instant("editor.incorrect_format_time"):d&&(j>=c||0>=j)?b.instant("editor.time_outside_range"):void 0},d=function(a,c,d,e){var f=/^\d\d:\d\d:\d\d$/;if(!f.test(a))return b.instant("editor.incorrect_format_time");var g=a.split(":"),h=parseInt(g[0]),i=parseInt(g[1]),j=parseInt(g[2]),k=60*60*h+60*i+j;if(0>h||h>24||0>i||i>59||0>j||j>59)return b.instant("editor.incorrect_format_time");if(d&&(k>c||0>k))return b.instant("editor.time_outside_range");if(e&&f.test(e)){var l=e.split(":"),m=parseInt(l[0]),n=parseInt(l[1]),o=parseInt(l[2]),p=60*60*m+60*n+o;if(p>=k)return b.instant("editor.start_time_bigger_than_end_time")}};return{getKeys:function(a){return Object.keys?Object.keys(a):function(a){var b,c=[];for(b in a)hasOwn.call(a,b)&&c.push(b);return c}(a)},safeApply:function(b){var c=a.$root.$$phase;"$apply"==c||"$digest"==c?b&&"function"==typeof b&&b():a.$apply(b)},parseDuration:function(a){var b=a.match(/^P([0-9]+Y|)?([0-9]+M|)?([0-9]+D|)?T?([0-9]+H|)?([0-9]+M|)?([0-9]+S|)?$/),c={};return b?(c.year=parseInt(b[1])||0,c.month=parseInt(b[2])||0,c.day=parseInt(b[3])||0,c.hour=parseInt(b[4])||0,c.minute=parseInt(b[5])||0,c.second=parseInt(b[6])||0,c.toString=function(){var a="";return this.year&&(a+=this.year+" Year"+(1==this.year?"":"s")+" "),this.month&&(a+=this.month+" Month"+(1==this.month?"":"s")+" "),this.day&&(a+=this.day+" Day"+(1==this.day?"":"s")+" "),this.hour&&(a+=this.hour+" Hour"+(1==this.hour?"":"s")+" "),this.minute&&(a+=this.minute+" Minute"+(1==this.minute?"":"s")+" "),this.second&&(a+=this.second+" Second"+(1==this.second?"":"s")+" "),a},c):!1},hour12:function(a){var b=a%24,c="AM";return 0==b?b=12:b>12&&(b%=12,c="PM"),b+" "+c},toHourMin:function(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60);return 10>b&&(b="0"+b),10>c&&(c="0"+c),b+":"+c},toObjectById:function(a){var b={};return a instanceof Array&&a.forEach(function(a){b[a.id]=a}),b},urlWithProtocol:function(a){return a?a.match(/^http/)?a:"http://"+a:a},shorten:function(a,b){var c="undefined"!=typeof b?b:50,d=a.replace("http://","").replace("https://","");if(d.length<=c)return d;var e=c/2,f=this.shortString(d,e,!1),g=this.shortString(d,e,!0);return f+".."+g},shortString:function(a,b,c){for(var d=[" ","/","&"],e=.8*b,f=c?a.split("").reverse().join(""):a,g="",h=0;b-1>h&&(g+=f[h],!(h>=e&&d.indexOf(a[h])>=0));h++);return c?g.split("").reverse().join(""):g},getIndexById:function(a,b){for(var c in a)if(a[c].id==b)return c;return-1},isHtml:function(a){return"string"==typeof a&&/<[a-z][\s\S]*>/i.test(a)},getHtmlText:function(a){if(this.isHtml(a)){var b=$(a);return b.find(".MathJax_Preview").remove(),b.text()}return a},getShortAnswerText:function(a,b){var c=window.innerWidth/window.innerHeight;return c>1.7&&window.innerWidth>1280?b>=5&&a.length>20?a.substring(0,20)+"..":a:a.length>=20?b>=5&&a.length>=10?a.substring(0,10)+"..":a.substring(0,20)+"..":a},capitalize:function(a){return a[0].toUpperCase()+a.slice(1)},gcd:function(a,b){return 0==b?a:this.gcd(b,a%b)},calculateScreenRatio:function(){var a=screen.width,b=screen.height,c=this.gcd(a,b);return a/c+":"+b/c},validateTimeWithDuration:function(a,b){return c(a,b,!0)},validateTimeWithoutDuration:function(a,b){return c(a,b,!1)},validateTimeWithDurationForTrim:function(a,b,c){return d(a,b,!0,c)},arrayToSeconds:function(a){return 60*60*+a[0]+60*+a[1]+ +a[2]},listTimezones:function(){return[{name:"American Samoa",offset:-11,value:"(GMT-11:00) American Samoa"},{name:"Hawaii",offset:-10,value:"(GMT-10:00) Hawaii"},{name:"Alaska",offset:-9,value:"(GMT-09:00) Alaska"},{name:"Pacific Time (US & Canada)",offset:-8,value:"(GMT-08:00) Pacific Time (US & Canada)"},{name:"Mountain Time (US & Canada)",offset:-7,value:"(GMT-07:00) Mountain Time (US & Canada)"},{name:"Central Time (US & Canada)",offset:-6,value:"(GMT-06:00) Central Time (US & Canada)"},{name:"Eastern Time (US & Canada)",offset:-5,value:"(GMT-05:00) Eastern Time (US & Canada)"},{name:"Atlantic Time (Canada)",offset:-4,value:"(GMT-04:00) Atlantic Time (Canada)"},{name:"Greenland",offset:-3,value:"(GMT-03:00) Greenland"},{name:"Mid-Atlantic",offset:-2,value:"(GMT-02:00) Mid-Atlantic"},{name:"Azores",offset:-1,value:"(GMT-01:00) Azores"},{name:"UTC",offset:0,value:"(GMT+00:00) UTC"},{name:"Stockholm",offset:1,value:"(GMT+01:00) Stockholm"},{name:"Cairo",offset:2,value:"(GMT+02:00) Cairo"},{name:"Kuwait",offset:3,value:"(GMT+03:00) Kuwait"},{name:"Abu Dhabi",offset:4,value:"(GMT+04:00) Abu Dhabi"},{name:"Mumbai",offset:5,value:"(GMT+05:30) Mumbai"},{name:"Dhaka",offset:6,value:"(GMT+06:00) Dhaka"},{name:"Bangkok",offset:7,value:"(GMT+07:00) Bangkok"},{name:"Hong Kong",offset:8,value:"(GMT+08:00) Hong Kong"},{name:"Tokyo",offset:9,value:"(GMT+09:00) Tokyo"},{name:"Sydney",offset:10,value:"(GMT+10:00) Sydney"},{name:"New Caledonia",offset:11,value:"(GMT+11:00) New Caledonia"},{name:"Fiji",offset:12,value:"(GMT+12:00) Fiji"}]}}}]),angular.module("scalearAngularApp").factory("MobileDetector",function(){var a=/iPhone/i,b=/iPod/i,c=/iPad/i,d=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,e=/Android/i,f=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,g=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,h=/IEMobile/i,i=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,j=/BlackBerry/i,k=/BB10/i,l=/Opera Mini/i,m=/(CriOS|Chrome)(?=.*\bMobile\b)/i,n=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,o=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),p=function(a,b){return a.test(b)},q=function(q){var r=q||navigator.userAgent,s=r.split("[FBAN");return"undefined"!=typeof s[1]&&(r=s[0]),this.apple={phone:p(a,r),ipod:p(b,r),tablet:!p(a,r)&&p(c,r),device:p(a,r)||p(b,r)||p(c,r)},this.amazon={phone:p(f,r),tablet:!p(f,r)&&p(g,r),device:p(f,r)||p(g,r)},this.android={phone:p(f,r)||p(d,r),tablet:!p(f,r)&&!p(d,r)&&(p(g,r)||p(e,r)),device:p(f,r)||p(g,r)||p(d,r)||p(e,r)},this.windows={phone:p(h,r),tablet:p(i,r),device:p(h,r)||p(i,r)},this.other={blackberry:p(j,r),blackberry10:p(k,r),opera:p(l,r),firefox:p(n,r),chrome:p(m,r),device:p(j,r)||p(k,r)||p(l,r)||p(n,r)||p(m,r)},this.seven_inch=p(o,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,this},r=new q;return{devices:r,isMobile:function(){return r.any},isPhone:function(){return r.phone},isTablet:function(){return r.tablet},isiPhone:function(){return r.apple.iphone||r.apple.ipod},isiPad:function(){return r.apple.tablet},isAndroidPhone:function(){return r.android.phone},isAndroidTablet:function(){return r.android.tablet},isAndroid:function(){return r.android.phone||r.android.tablet}}}),angular.module("scalearAngularApp").factory("Impersonate",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e){return b.defaults.useXDomain=!0,a(d.host+"/en/impressionate/:action",{},{create:{method:"POST",headers:e},destroy:{method:"DELETE",headers:e}})}]).factory("Preview",["Impersonate","$state","$cookieStore","ContentNavigator","$rootScope","$log","UserSession","Token",function(a,b,c,d,e,f,g,h){function i(a){var b={course_id:a.params.course_id};if(a.params.module_id){var c="course.module.courseware";return c+=a.params.lecture_id?".lecture":a.params.quiz_id?".quiz":".overview",{name:c,params:a.params,prev:c.replace("courseware","course_editor")}}return a.includes("course.edit_course_information")?{name:"course.course_information",params:b}:{name:"course",params:b}}function j(){(!b.params||b.params&&!b.params.course_id)&&(b.params=c.get("params"),b.current.name=c.get("state"),l.id=c.get("old_user_id"));var j=i(b),k=j.prev,n=b.params;c.put("old_user_id",l.id),c.put("state",k),c.put("params",n),d.close(),a.create({},{course_id:b.params.course_id},function(a){b.go(j.name,j.params,{notify:!1,reload:!1,location:"replace",inherit:!1}),g.allowRefetchOfUser(),c.put("preview_as_student",!0),c.put("new_user_id",a.user.id),h.setToken(a.token),e.preview_as_student=!0,l=null,b.go(j.name,j.params,{reload:!0}),e.$broadcast("Course:get_current_courses")},function(){f.debug("Failed to Start Preview"),m()})}function k(){var i=b.current.name,j=b.params;if(c.get("preview_as_student")){var k=c.get("params"),n=c.get("state");d.close(),e.$broadcast("exit_preview"),n&&b.go(n,k,{notify:!1,reload:!1,location:"replace",inherit:!0}),a.destroy({old_user_id:c.get("old_user_id"),new_user_id:c.get("new_user_id")},function(a){g.allowRefetchOfUser(),h.setToken(a.token),m(),e.preview_as_student=!1,l=null,b.go(n,k,{reload:!0}),e.$broadcast("Course:get_current_courses")
},function(){e.preview_as_student=!0,b.go(i,j,{notify:!1,reload:!1,location:"replace",inherit:!0}),f.debug("Failed Closing Preview"),m()})}}var l=null,m=function(){c.remove("preview_as_student"),c.remove("old_user_id"),c.remove("new_user_id"),c.remove("params"),c.remove("state")};return{start:function(){g.getCurrentUser().then(function(a){l=a,j()})},stop:k}}]),angular.module("scalearAngularApp").factory("Dashboard",["$resource","$http","$stateParams","scalear_api","headers","$rootScope","$translate",function(a,b,c,d,e,f,g){return b.defaults.useXDomain=!0,a(d.host+"/:lang/dashboard/:action",{lang:g.use()},{getDashboard:{method:"GET",params:{action:"get_dashboard"},headers:e}})}]),angular.module("scalearAngularApp").factory("ContentNavigator",["$rootScope",function(a){return{status:!1,getStatus:function(){return this.status},setStatus:function(b){this.status=b,a.$broadcast("content_navigator_change",this.status)},open:function(){this.setStatus(!0)},close:function(){this.setStatus(!1)}}}]),angular.module("scalearAngularApp").factory("TimelineNavigator",["$rootScope",function(a){return{status:!1,getStatus:function(){return this.status},setStatus:function(b){this.status=b,a.$broadcast("timeline_navigator_change",this.status)},open:function(){this.setStatus(!0)},close:function(){this.setStatus(!1)}}}]).factory("TimelineFilter",["$rootScope",function(a){var b={};return b=a.preview_as_student?{quiz:!0,confused:!1,discussion:!1,note:!1,marker:!0}:{quiz:!0,confused:!0,discussion:!0,note:!0,marker:!0},{get:function(a){return b[a]},set:function(a,c){b[a]=c},toggle:function(a){b[a]=!b[a]},get_filter:function(){return b}}}]),angular.module("scalearAngularApp").factory("DetailsNavigator",["$rootScope","$timeout",function(a){var b={module:!0,settings:!1},c={video:!0,settings:!1,quizzes:!1,markers:!1};return{status:!1,getStatus:function(){return this.status},setStatus:function(b){this.status=b,a.$broadcast("details_navigator_change",b)},open:function(){this.setStatus(!0)},close:function(){this.setStatus(!1)},module_details_groups:b,lecture_details_groups:c}}]),angular.module("scalearAngularApp").factory("VideoEventLogger",["$q","Lecture","$log",function(a,b,c){function d(d,e,f,g,h,i,j,k,l){var m=a.defer();return null!=g&&g>=0?(c.debug("log video event",f),b.logVideoEvent({course_id:d,lecture_id:e},{event:f,from_time:g,to_time:h,in_quiz:i,speed:j,volume:k,fullscreen:l}).$promise.then(function(a){c.debug("event successfully logged"),m.resolve(a)}).catch(function(a){m.reject(a)})):m.reject(),m.promise}return{log:d}}]),angular.module("scalearAngularApp").factory("Token",["$cookieStore",function(a){function b(b){console.log(b),d=b,a.put("token",b)}function c(){return d?d:a.get("token")?(console.log("using cookie"),d=a.get("token")):!1}var d=null;return{getToken:c,setToken:b}}]),angular.module("scalearAngularApp").controller("MainCtrl",["$scope","$log","Page","$rootScope","Home","$state","$location","scalear_api","ngDialog",function(a,b,c,d,e,f,g,h,i){c.setTitle("ScalableLearning: Active in-class and online learning for teachers, students, and flipped classroom teaching."),a.play_teacher=!1,a.play_student=!1,a.beta=h.beta,a.teacher_welcome_video=h.teacher_welcome_video,a.instruction_manual=h.instruction_manual,a.flipped_manual=h.flipped_manual,a.teacher_forum_link=h.teacher_forum_link,a.student_welcom_video=h.student_welcom_video,$("a.page-scroll").bind("click",function(a){$("html, body").stop().animate({scrollTop:$($(this).attr("href")).offset().top},1500,"easeInOutExpo"),a.preventDefault()}),$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()}),$("body").scrollspy({target:".navbar-fixed-top"}),a.goTo=function(a){f.go(a)},a.playerTeacher=function(){a.play_teacher=!0,i.open({template:"teacherIntro",className:"ngdialog-theme-default ngdialog-theme-custom ngdialog-theme-custom-video",scope:a})},a.playerStudent=function(){a.play_student=!0,i.open({template:"studentIntro",className:"ngdialog-theme-default ngdialog-theme-custom ngdialog-theme-custom-video",scope:a})},a.sendTechnical=function(){a.submitted=!0,a.user&&a.user.name&&a.user.email&&a.comment_data&&(a.sending_technical=!0,e.contactUs({name:a.user.name,email:a.user.email,url:g.url(),comment:a.comment_data,agent:navigator.userAgent},function(){a.user={},a.comment_data=null,a.sending_technical=!1,a.show_thanks=!0,a.submitted=!1}))}}]),angular.module("scalearAngularApp").controller("HomeCtrl",["$scope","$log","Page","$rootScope","$state",function(){}]),angular.module("scalearAngularApp").controller("AboutCtrl",["$scope","Page","$rootScope","$translate",function(a,b,c,d){b.setTitle("footer.about"),c.subheader_message=d.instant("footer.about")}]),angular.module("scalearAngularApp").controller("indexCtrl",["$scope","$timeout","$rootScope","$translate","$window","$log","Page","$cookieStore","ContentNavigator","scalear_api","MobileDetector","CourseModel","UserSession",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){a.current_teacher_courses=null,a.current_student_courses=null,l.currentCourses().then(function(b){a.current_teacher_courses=b.teacher_courses,a.current_student_courses=b.student_courses})}FastClick.attach(document.body),a.Page=g,c.preview_as_student=h.get("preview_as_student"),a.ContentNavigator=i,a.isTeacher=l.isTeacher,a.isStudent=l.isStudent,a.ContentNavigator.delayed_navigator_open=a.ContentNavigator.status,c.is_mobile=k.isMobile(),a.$on("content_navigator_change",function(c,d){d?(a.cancelDelay&&b.cancel(a.cancelDelay),a.ContentNavigator.delayed_navigator_open=!0):a.cancelDelay=b(function(){a.ContentNavigator.delayed_navigator_open=!1},300)}),m.getCurrentUser().then(function(a){console.log(a),n()}),c.$on("Course:get_current_courses",function(){n()}),a.changeLanguage=function(a){d.use(a),c.current_lang=a,e.moment.locale(a)},a.changeLanguage(d.use()),ga("create",j.ga_token),ga("send","pageview")}]),angular.module("scalearAngularApp").controller("LoginCtrl",["$state","$scope","$rootScope","scalear_api","$window","$log","$translate","User","Page","ErrorHandler","ngDialog","MobileDetector","Saml","$location","SWAMID","$cookieStore","$timeout","URLInformation","UserSession","$http",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.user={},b.user.email=a.params.email||"",i.setTitle("navigation.login"),$("#user_email").select(),o.list().then(function(a){b.swamid_list=a}),b.previous_provider=p.get("login_provider"),b.toggleProviders=function(){b.show_providers?b.hideProviders():b.showProviders()},b.showProviders=function(){b.show_providers=!0,q(function(){$("#search").select()}),shortcut.add("Enter",function(){b.swamid[0]&&b.samlLogin(b.swamid[0])})},b.hideProviders=function(){b.show_providers=!1,shortcut.remove("Enter",function(){b.samlLogin(b.swamid[0])})},b.showLoginForm=function(){b.show_scalable_login=!b.show_scalable_login,b.hideProviders()},b.login=function(){console.log(b.user),b.sending=!0,s.allowRefetchOfUser(),s.signIn(b.user).then(function(a){p.put("login_provider","scalablelearning"),f.debug("login success"),b.sending=!1,c.$broadcast("Course:get_current_courses"),b.is_mobile=l.isMobile(),b.is_mobile&&(l.isTablet()||l.isPhone())?t(function(){u(a.user.data)}):u(a.user.data)})},b.join=function(){h.userExist({email:b.user.email},function(){a.go("signup",{input1:b.user.email,input2:b.user.password})})};var t=function(a){k.open({template:"mobileSupport",className:"ngdialog-theme-default ngdialog-theme-custom",preCloseCallback:a})},u=function(b){console.log(b),b.info_complete?r.hasEnroll()?(console.log("2"),e.location.href=r.getEnrollLink(),r.clearEnrollLink()):r.shouldRedirect()?(console.log("3"),e.location.href=r.getRedirectLink(),r.clearRedirectLink()):(console.log("4"),a.go("dashboard")):(console.log("1"),a.go("edit_account"),j.showMessage(g.instant("error_message.update_account_information"),"errorMessage",null,"error"))},v=function(a){"POST"==a.action?$(a.saml_url).appendTo("body").submit():window.location=a.saml_url};b.samlLogin=function(a){p.put("login_provider",a),c.busy_loading=!0,m.Login({idp:a.entityID},function(a){b.is_mobile=l.isMobile(),b.is_mobile&&(l.isTablet()||l.isPhone())?(c.busy_loading=!1,t(function(){c.busy_loading=!0,v(a)})):v(a)},function(){c.busy_loading=!1,j.showMessage("Could not reach provider","errorMessage",4e3,"error")})}}]),angular.module("scalearAngularApp").controller("PrivacyCtrl",["$scope","Page","$rootScope","$translate",function(a,b,c,d){b.setTitle("privacy.policy"),c.subheader_message="ScalableLearning "+d.instant("privacy.policy")}]),angular.module("scalearAngularApp").controller("FaqCtrl",["$scope","Page","$rootScope","$translate",function(a,b,c,d){b.setTitle("faq"),c.subheader_message=d.instant("faq"),a.questions_count=new Array(6)}]),angular.module("scalearAngularApp").controller("courseCtrl",["$rootScope","$stateParams","$scope","Course","$log","$cookieStore","ScalearUtils","CourseData","$state","ContentNavigator","$window","MobileDetector","CourseModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m){if(i.includes("**.course"))if(m.isStudent())if(l.isPhone()&&angular.element(k).width()<700)i.go("course.content_selector",{course_id:h.id});else if(-1!=h.next_item.module){var n={module_id:h.next_item.module};n[h.next_item.item.class_name+"_id"]=h.next_item.item.id,i.go("course.module.courseware."+h.next_item.item.class_name,n)}else i.go("course.course_information",{course_id:h.id});else i.go("course.edit_course_information",{course_id:h.id});c.$on("$destroy",function(){j.close(),i.includes("**.course.**")||(m.removeSelectedCourse(),m.removeCourseRole())})}]),angular.module("scalearAngularApp").controller("moduleCtrl",["$scope","$state","ModuleModel","ErrorHandler",function(a,b,c,d){var e=c.getById(b.params.module_id);e?c.setSelectedModule(e):(b.go("course_list"),d.showMessage("Model is not publised .","errorMessage",4e3,"error")),a.$on("$destroy",function(){c.clearSelectedModule()})}]),angular.module("scalearAngularApp").controller("sharedCtrl",["$scope","Page","SharedItem","Module","Lecture","Quiz","$rootScope","$translate","$log",function(a,b,c,d,e,f,g,h,i){b.setTitle("sharing.view"),g.subheader_message=h.instant("sharing.manage");var j=function(){c.showShared({},function(b){i.debug(b),a.shared_items=b.all_shared,a.courses=b.courses},function(){})};j()}]),angular.module("scalearAngularApp").controller("ReportTechnicalCtrl",["$scope","$modalInstance","$log","$rootScope","Home","$translate","$stateParams","$location","$interval","$state","UserSession","scalear_api",function(a,b,c,d,e,f,g,h,i,j,k,l){a.issue_types=[{value:"system",text:f.instant("feedback.system")}],j.includes("course")&&a.issue_types.push({value:"content",text:f.instant("feedback.course_content")}),a.selected_type=a.issue_types[0],k.getCurrentUser().then(function(b){a.current_user=b}),a.issue_scalable_website_types=[{value:"none",text:f.instant("feedback.none")},{value:"no_access",text:f.instant("feedback.no_access")},{value:"question_before_sign",text:f.instant("feedback.question_before_sign")},{value:"request_feature",text:f.instant("feedback.request_feature")},{value:"no_email",text:f.instant("feedback.no_email")},{value:"confused",text:f.instant("feedback.confused")},{value:"bug",text:f.instant("feedback.bug")},{value:"other",text:f.instant("feedback.other")}],a.selected_scalable_website_type=a.issue_scalable_website_types[0],a.hide_issue_scalable_website_types=!1,a.hide_content=!1,a.selectedScalableWebsiteTypeEnable=function(b){a.hide_issue_scalable_website_types=!("system"==b.value)},a.sendTechnical=function(j,k,m,n){if(n||(n={name:a.current_user.full_name,email:a.current_user.email}),a.current_user||n&&n.name&&n.email)if(a.no_text=null,m){a.no_text=null,a.sending_technical=!0,c.debug(a.selected_type.value),c.debug(a.technical_data);var o=navigator.userAgent.split(";").join(",");e.technicalProblem({name:n.name,email:n.email,issue_type:j.value,issue_website_type:k.text,course:g.course_id||-1,module:g.module_id||-1,lecture:g.lecture_id||-1,quiz:g.quiz_id||-1,url:h.url(),problem:m,lang:d.current_lang,agent:o,version:l.version},function(){angular.element(".reveal-modal").css("height","auto"),a.hide_content=!0,a.technical_data=null,i(function(){b.close()},3e3,1)})}else a.no_text=f.instant("feedback.provide_desciption");else a.no_text=f.instant("feedback.provide_email_name")},a.cancel=function(){a.selected_type=a.issue_types[0],a.selected_scalable_website_type=a.issue_scalable_website_types[0],a.technical_data=null,a.no_text=null,b.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("announcementsCtrl",["$scope","Announcement","$stateParams","$translate","$log","$window","Page","ContentNavigator",function(a,b,c,d,e,f,g,h){h.close(),g.setTitle("navigation.announcements"),a.disable_new=!1;var i=function(){b.index({course_id:c.course_id},function(b){a.announcements=b,a.show_button=!0,(c.show=!0)&&a.createAnnouncement()})};a.deleteAnnouncement=function(d){d.id&&b.destroy({course_id:c.course_id,announcement_id:d.id},{}),a.announcements.splice(a.announcements.indexOf(d),1),a.disable_new=!1},a.createAnnouncement=function(){a.disable_new=!0;for(var b in a.announcements)a.announcements[b].show&&a.hideAnnouncement(b);a.newAnnouncement={announcement:"",created_at:new Date,show:!0},a.announcements instanceof Array||(a.announcements=[]),a.announcements.push(a.newAnnouncement)},a.hideAnnouncement=function(d){"string"!=typeof d&&(a.disable_new=!1,a.saving=!1,d.show=!1,d.id?b.show({course_id:c.course_id,announcement_id:d.id},function(a){d=a}):a.announcements.splice(a.announcements.indexOf(d),1))},a.showAnnouncement=function(b){for(var c in a.announcements)a.announcements[c].show&&a.hideAnnouncement(c);a.disable_new=!0,b.show=!0,b.overclass=""},a.saveAnnouncement=function(d){a.saving=!0;var e=document.createElement("DIV");e.innerHTML=d.announcement;var f=e.textContent||e.innerText||"";f=f.replace(/\s/g,""),f.length||(d.announcement=f),d.id?b.update({course_id:c.course_id,announcement_id:d.id},{announcement:{announcement:d.announcement}},function(b){a.announcements[a.announcements.indexOf(d)]=b.announcement,a.disable_new=!1,a.saving=!1},function(b){d.errors=b.data.errors,a.saving=!1}):b.create({course_id:c.course_id},{announcement:{announcement:d.announcement,course_id:c.course_id}},function(b){a.announcements[a.announcements.length-1]=b.announcement,a.disable_new=!1,a.saving=!1},function(b){d.errors=b.data.errors,a.saving=!1})},i()}]),angular.module("scalearAngularApp").controller("courseListCtrl",["$scope","Course","$stateParams","$translate","$log","$window","Page","$rootScope","ngDialog","$timeout","UserSession",function(a,b,c,d,e,f,g,h,i,j,k){g.setTitle("navigation.courses"),g.startTour(),h.subheader_message=d.instant("navigation.courses"),a.column="start_date",a.is_reverse=!0,a.course_filter="!!",a.teacher_courses=[],a.student_courses=[],a.course_loading=!1,k.getCurrentUser().then(function(b){a.current_user=b});var l=function(c,d){var e=c,f=d;b.index({offset:e,limit:f},function(b){a.teacher_courses=a.teacher_courses.concat(b.teacher_courses),a.student_courses=a.student_courses.concat(b.student_courses),e+=f,e<b.total?l(e,f):a.course_loading=!0})},m=function(b,c){var d=c+"_courses",e="current_"+d;a[d].splice(a[d].indexOf(b),1);var f=a[e].map(function(a){return a.id}).indexOf(b.id);f>-1&&a[e].splice(f,1)};a.deleteCourse=function(a){i.open({template:'              <div class="ngdialog-message">                  <h2><b><span translate>courses.list.delete_popup.warning</span>!</b></h2>                  <span>                    <span>                      <span translate>courses.list.delete_popup.delete_course</span>                      <b> "'+a.short_name+" | "+a.name+'" </b>                      <span translate>courses.list.delete_popup.will_delete</span></span>                    <ul>                      <li translate>courses.list.delete_popup.all_modules</li>                      <li translate>courses.list.delete_popup.all_items</li>                      <li translate>courses.list.delete_popup.all_progress</li>                    </ul>                    <span translate>courses.list.delete_popup.are_you_sure</span>                    <span translate>courses.list.delete_popup.cannot_undo</span>                  </span>              </div>              <div class="ngdialog-buttons">                  <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>button.cancel</button>                  <button type="button" class="ngdialog-button ngdialog-button-alert delete_confirm" ng-click="delete()" translate>button.delete</button>              </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1,controller:["$scope",function(c){c.delete=function(){b.destroy({course_id:a.id},{},function(){m(a,"teacher")}),c.closeThisDialog()}}]})},a.unenrollCourse=function(a){b.unenroll({course_id:a.id},{},function(){m(a,"student")},function(){})},a.filterTeacher=function(b,c){a.filtered_teacher_name=b,a.filtered_teacher=c},a.filterCourse=function(b){a.course_filter=b},a.removeFilter=function(){a.filtered_teacher=""},a.order=function(b){a.column=b,a.is_reverse=!a.is_reverse},l(0,10)}]),angular.module("scalearAngularApp").controller("newCourseCtrl",["$rootScope","$scope","Course","$state","$window","$log","Page","ScalearUtils","$translate","$filter","CourseModel","$q","$modal","UserSession","User",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){var a=l.defer(),c={},d=!0;return("Invalid Date"==b.course.start_date||null==b.course.start_date)&&(c.start_date=["not a Date"],a.reject(c),d=!1),("Invalid Date"==b.course.end_date||null==b.course.end_date)&&(c.end_date=["not a Date"],a.reject(c),d=!1),d&&(b.course.start_date<b.course.end_date?(c.start_date=[],c.end_date=[],a.resolve(c)):(c.start_date=["must be before end date"],a.reject(c))),a.promise}e.scrollTo(0,0),g.setTitle("navigation.new_course"),a.subheader_message=i.instant("navigation.new_course"),b.submitting=!1,b.course={},b.welcome_message=null,b.course.selected_subdomain={All:!0},b.course.email_discussion=!1,k.getUserOtherCourses().then(function(a){b.importing=a.importing,b.subdomains=a.subdomains}),b.timezones=h.listTimezones(),b.course.time_zone=b.timezones[11],b.course.start_date=new Date,b.course.end_date=new Date;var q=7,r=10;b.course.end_date.setDate(b.course.start_date.getDate()+q*r),b.import_from=null,n.getCurrentUser().then(function(a){b.current_user=a,o.getWelcomeMessage({id:a.id},function(a){a&&(b.welcome_message=a.welcome_message)})}),b.addImportInformation=function(){var a="["+i.instant("navigation.copied_from"),c="",d="",e="",f="",g="",h=b.import_from;if(h){var j="\n"+a+" "+h.name+" :]\n";h.description&&(c=j+h.description),e=h.description,h.prerequisites&&(d=j+h.prerequisites),f=h.prerequisites,g=h.image_url}b.course.description=b.course.description?b.course.description.split(a)[0].trim()+c:e,b.course.prerequisites=b.course.prerequisites?b.course.prerequisites.split(a)[0].trim()+d:f,b.course.image_url||(b.course.image_url=g)},b.unselectCourse=function(){b.import_from=null,b.addImportInformation()},b.toggleRegistration=function(){b.course.disable_registration=b.disable_registration_checked?b.course.end_date:null},b.toggleDomain=function(a){a.stopPropagation(),m.open({templateUrl:"/views/teacher/course_list/school_registration_modal.html",plain:!0,scope:b,controller:["$scope","$modalInstance",function(a,b){a.subdomain={},a.course_domain={},a.course_domain.selected_subdomain={},a.subdomain.boolean="all",a.course.selected_subdomain.All||(a.subdomain.boolean="custom"),a.close=function(){b.dismiss()},a.updateDomainList=function(){a.course.selected_subdomain=a.course_domain.selected_subdomain},a.setBooleanDomain=function(){"all"==a.subdomain.boolean?a.course.selected_subdomain={All:!0}:delete a.course.selected_subdomain.All}}]}).result.finally(function(){-1==Object.keys(b.course.selected_subdomain).map(function(a){return b.course.selected_subdomain[a]}).indexOf(!0)&&(b.course.selected_subdomain={All:!0})})},b.createCourse=function(){b.submitting=!0,p().then(function(){var a=b.import_from?b.import_from.id:null,c=b.course.selected_subdomain,e=b.course.email_discussion;k.create(b.course,a).then(function(a){b.submitting=!1,a.importing?d.go("course_list"):d.go("course.course_editor",{course_id:a.course.id,new_course:!0})}).catch(function(a){b.submitting=!1,b.server_errors=a.data.errors,b.course.selected_subdomain=c,b.course.email_discussion=e})}).catch(function(a){b.server_errors=a,b.submitting=!1})}}]),angular.module("scalearAngularApp").controller("ltiCourseListCtrl",["$rootScope","$scope","Lti","$state","$window","$location","Page","$stateParams","User","$translate",function(a,b,c,d,e,f,g,h,i,j){b.return_url=h.return_url,b.full_name=h.full_name,b.email=h.email,b.first_name=h.first_name,b.last_name=h.last_name,a.subheader_message=j.instant("global.courses_list"),b.loading_lti=!0,b.selected_lauch_url=!1,b.create_new_account=!1,b.no_common_courses=!1,b.selected_resource=!1,e.scrollTo(0,0),g.setTitle("lti.lti"),f.absUrl(),b.location_state=f.path().split("/").pop(),"lti_course_list"==b.location_state&&"lti_tool_redirect"==h.return_url&&(b.location_state="lti_tool_redirect"),i.getCurrentUser().$promise.then(function(a){"null"==a.user?(b.create_new_account=!0,b.loading_lti=!1):c.embedCourseList({consumer_key:h.consumer_key}).$promise.then(function(a){b.no_common_courses=0==a.courses_common,b.loading_lti=!1,b.courses=a.courses})}),b.embed=function(a,c,d,e){d&&(d.preventDefault(),d.stopPropagation());var f=location.protocol+"//"+location.host+"/en/lti/lti_launch_use?sl_type_id="+c+"%26sl_type="+a,g=b.return_url+"?return_type=lti_launch_url&url="+f+"&text="+e+"&title="+e;window.location.href=g},b.join=function(){var a=f.absUrl().split("lti")[0]+"users/login";window.open(a,"_blank")},b.choose_item=function(a,c,d){d&&(d.preventDefault(),d.stopPropagation()),b.selected_lauch_url=!0,b.sl_url=location.protocol+"//"+location.host+"/en/lti/lti_launch_use?sl_type_id="+c+"%26sl_type="+a},b.lti_tool_redirect=function(a,d,e){e&&(e.preventDefault(),e.stopPropagation()),c.ltiToolRedirectSaveData({consumer_key:h.consumer_key,resource_context_id:h.resource_context_id,type:a,type_id:d}).$promise.then(function(){b.selected_resource=!0})}}]),angular.module("scalearAngularApp").controller("courseEditorCtrl",["$rootScope","$scope","$state","$translate","$log","Page","$modal","$timeout","ContentNavigator","DetailsNavigator","Preview","ScalearUtils","CourseModel","ModuleModel","ItemsModel","LectureModel","QuizModel","LinkModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(a,d){"video"==a?b.addLecture(0):"inclass_video"==a?b.addLecture(1):"distance_peer"==a?b.addLecture(2):"link"==a?b.addCustomLink(d||c.params.module_id):b.addQuiz(a)}b.course=m.getSelectedCourse(),f.setTitle(d.instant("navigation.content")+": "+b.course.name),i.open(),j.open(),b.DetailsNavigator=j,b.ContentNavigator=i,b.delayed_details_status=j.getStatus(),b.delayed_details_status2=j.getStatus(),b.$on("details_navigator_change",function(a,c){e.debug("datails status event",c),c?(b.delayed_details_status=!0,h(function(){b.delayed_details_status2=!0},350)):(b.delayed_details_status2=!1,h(function(){b.delayed_details_status=!1},350))}),b.$on("share_copy",function(a,b){u(b)}),b.$on("add_module",function(){b.addModule()}),b.$on("add_item",function(a,d){c.params.module_id?s(d):b.addModule(function(a){h(function(){s(d,a)})}),i.open()}),b.$on("delete_module",function(a,c){b.removeModule(c)}),b.$on("delete_item",function(a,c){"lecture"==c.class_name?b.removeLecture(c):"customlink"==c.class_name?b.removeCustomLink(c):b.removeQuiz(c)}),b.$on("copy_item",function(a,c){b.copy(c)}),b.$on("paste_item",function(a,c){b.paste(c)}),c.params.new_course&&g.open({templateUrl:"/views/teacher/course_list/email_student_answers_modal.html",scope:b,controller:["$modalInstance",function(a){b.updateEmailDiscussion=function(c){b.course.updateTeacherDiscussionEmail(c),a.dismiss("cancel")}}]}),b.capitalize=function(a){return l.capitalize(a)},b.addModule=function(a){n.create().then(function(b){c.go("course.module.course_editor.overview",{module_id:b.id}),i.open(),a&&a(b.id)})},b.removeModule=function(a){a.remove().then(function(){t();var b=n.getSelectedModule();b&&b.id==a.id&&c.go("course.course_editor")})},b.addLecture=function(a){p.create(a).then(function(a){t(),c.go("course.module.course_editor.lecture",{lecture_id:a.id})})},b.removeLecture=function(a){a.remove().then(function(){t(),c.params.lecture_id==a.id&&c.go("course.module.course_editor.overview")})},b.addQuiz=function(a){q.create(a).then(function(a){t(),c.go("course.module.course_editor.quiz",{quiz_id:a.id})})},b.removeQuiz=function(a){a.remove().then(function(){t(),c.params.quiz_id==a.id&&c.go("course.module.course_editor.overview")})},b.addCustomLink=function(){r.create().then(function(a){c.go("course.module.course_editor.customlink",{customlink_id:a.id})})},b.removeCustomLink=function(a){a.remove().then(function(){t(),c.params.customlink_id==a.id&&c.go("course.module.course_editor.overview")})},b.previewStudent=function(){k.start()},b.copy=function(b){a.clipboard={id:b.id,name:b.name,type:b.class_name||"module",show_msg:!0}};var t=function(){a.clipboard=null};b.paste=function(b){var c=a.clipboard;"module"==c.type?n.paste(c):"lecture"==c.type?p.paste(c,b):"quiz"==c.type?q.paste(c,b):"customlink"==c.type&&r.paste(c,b)};var u=function(a){g.open({templateUrl:"/views/teacher/course_editor/sharing_modal.html",controller:"sharingModalCtrl",resolve:{selected_module:function(){return n.getById(a.module_id)},selected_item:function(){return a.item?o.getById(a.item.id,a.item.class_name):void 0}}})}}]),angular.module("scalearAngularApp").controller("moduleMiddleCtrl",["$scope","$state","Module","CustomLink","$stateParams","$translate","ModuleModel",function(a,b,c,d,e,f,g){function h(){a.module.getStatistics().then(function(b){a.module_statistics=b})}!function(){a.module=g.getSelectedModule(),h()}(),a.$on("update_module_statistics",function(){h()})}]),angular.module("scalearAngularApp").controller("moduleDetailsCtrl",["$scope","$state","$q","$log","ModuleModel","DetailsNavigator","CourseEditor",function(a,b,c,d,e,f,g){!function(){a.module=e.getSelectedModule(),a.link_url=b.href("course.module.courseware",{module_id:a.module.id},{absolute:!0}),a.module.due_date&&(a.due_date_enabled=!g.isDueDateDisabled(a.module.due_date)),a.module_details_groups=f.module_details_groups}(),a.validateModule=function(b,c){var d={id:a.module.id,course_id:a.module.course_id};d[b]=c;var f=e.createInstance(d);return f.validate()},a.updateModule=function(){a.module.update()},a.updateDueDate=function(){var b=new Date(a.module.due_date),c=7;if(g.isDueDateDisabled(a.module.due_date)&&!a.due_date_enabled)var d=-200;else if(!g.isDueDateDisabled(a.module.due_date)&&a.due_date_enabled)var d=200;else var d=0;b.setFullYear(b.getFullYear()+d);var e=new Date(a.module.appearance_time);e>=b&&(b=e,b.setDate(e.getDate()+c)),a.module.due_date=b,a.due_date_enabled=!g.isDueDateDisabled(a.module.due_date)}}]),angular.module("scalearAngularApp").controller("lectureDetailsCtrl",["$stateParams","$scope","$state","$log","$rootScope","$modal","$filter","ItemsModel","DetailsNavigator","CourseEditor","LectureModel","VideoQuizModel","MarkerModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){f.open({templateUrl:"/views/teacher/course_editor/trim_modal.html",controller:["$scope","$rootScope","$modalInstance",function(a,b,c){a.trim=function(){b.$broadcast("start_trim_video"),c.close()},a.cancel=function(){c.dismiss("cancel")}}]})}b.lecture=h.getLecture(a.lecture_id),b.video={},b.video.type=b.lecture.inclass?1:b.lecture.distance_peer?2:0,h.setSelectedItem(b.lecture);var o=b.lecture.module();b.setting={},b.setting.due_date_enabled=!j.isDueDateDisabled(b.lecture.due_date),b.disable_module_due_controls=j.isDueDateDisabled(o.due_date),b.link_url=c.href("course.module.courseware.lecture",{module_id:o.id,lecture_id:b.lecture.id},{absolute:!0}),b.lecture_details_groups=i.lecture_details_groups,b.getSelectedVideoQuiz=l.getSelectedVideoQuiz,b.getSelectedMarker=m.getSelectedMarker,l.getQuizzes(),m.getMarkers(),b.validateLecture=function(a,c){var d={id:b.lecture.id,course_id:b.lecture.course_id,group_id:b.lecture.group_id};d[a]=c;var e=k.createInstance(d);return"url"==a?(e.url=g("formatURL")(e.url),e.validateUrl()):e.validate()},b.updateLecture=function(){b.lecture.update()},b.setVideoType=function(){b.lecture.inclass=!1,b.lecture.distance_peer=!1,1==b.video.type&&(b.lecture.inclass=!0),2==b.video.type&&(b.lecture.distance_peer=!0),b.updateLecture()},b.updateDueDate=function(){var a=200,c=b.setting.due_date_enabled,d=new Date(b.lecture.due_date),e=7,f=0;j.isDueDateDisabled(b.lecture.due_date)&&c?f=-a:j.isDueDateDisabled(b.lecture.due_date)||c||(f=a),d.setFullYear(d.getFullYear()+f);var g=new Date(b.lecture.appearance_time);g>=d&&(d=g,d.setDate(g.getDate()+e)),b.lecture.due_date=d,b.setting.due_date_enabled=!j.isDueDateDisabled(b.lecture.due_date),b.lecture.due_date_module=!b.disable_module_due_controls&&b.setting.due_date_enabled},b.visible=function(a){return new Date(a)<=new Date},b.updateLectureUrl=function(){b.lecture.updateUrl().then(function(a){a&&n()})},b.showQuiz=function(a){e.$broadcast("show_online_quiz",a)},b.deleteQuiz=function(a){e.$broadcast("delete_online_quiz",a)},b.showMarker=function(a){e.$broadcast("show_online_marker",a)},b.deleteMarker=function(a){e.$broadcast("delete_online_marker",a)}}]),angular.module("scalearAngularApp").controller("lectureMiddleCtrl",["$state","$stateParams","$scope","$translate","$log","$rootScope","$timeout","$q","DetailsNavigator","ngDialog","ItemsModel","VideoQuizModel","ScalearUtils","MarkerModel","$urlRouter","VideoInformation",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){f.$broadcast("show_online_marker",a)}function r(a,b){a.cue=c.lecture_player.controls.cue(c.lecture.start_time+(a.time-.1),function(){c.lecture_player.controls.paused()||g(function(){"quiz"==b?(c.lecture_player.controls.seek_and_pause(a.time),c.showOnlineQuiz(a)):a.as_slide?q(a):c.showAnnotation(a)})})}function s(a){a.cue&&c.lecture_player.controls.removeTrackEvent(a.cue.id)}function t(a){a.isTextQuiz()&&(c.quiz_layer.backgroundColor="white",c.quiz_layer.overflowX="hidden",c.quiz_layer.overflowY="auto")}function u(){c.quiz_layer.backgroundColor="transparent",c.quiz_layer.overflowX="",c.quiz_layer.overflowY=""}function v(){var a=0;if(!c.selected_quiz.isFreeTextVideoQuiz()){for(var b in c.selected_quiz.answers){if(!c.selected_quiz.answers[b].answer||""==c.selected_quiz.answers[b].answer.trim())return c.alert.msg="editor.messages.provide_answer",!1;a=c.selected_quiz.isDragQuiz()?1:c.selected_quiz.answers[b].correct||a}if(!a&&!c.selected_quiz.isSurvey()&&!c.selected_quiz.isTextSurvey())return c.alert.msg="editor.messages.quiz_no_answer",!1}return!0}function w(a){return(c.answer_form.$valid&&c.selected_quiz.isTextVideoQuiz()||(!c.selected_quiz.isTextVideoQuiz()||c.selected_quiz.isTextSurvey())&&v())&&c.selected_quiz.answers.length?(c.submitted=!1,c.hide_alerts=!0,c.quiz_deletable=!1,c.selected_quiz.updateAnswers().then(function(){a&&a.exit||c.selected_quiz.getQuizAnswers()}),a&&a.exit&&c.exitQuizBtn(),!1):(c.selected_quiz.isTextVideoQuiz()&&(c.alert.msg=c.answer_form.$error.atleastone?"editor.messages.quiz_no_answer":"editor.messages.provide_answer"),c.submitted=!0,c.hide_alerts=!1,c.lecture_player.controls.seek_and_pause(c.selected_quiz.time),c.selected_quiz.hide_quiz_answers=!1,t(c.selected_quiz),!0)}function x(){C(),c.submitted=!1,c.quiz_layer.backgroundColor="",y(),D()}function y(){c.selected_quiz&&(c.selected_quiz.selected=!1),c.selected_quiz=null,c.quiz_errors={},c.quiz_deletable=!1,l.clearSelectedVideoQuiz()}function z(){var a=h.defer(),b=h.when(!1);return c.editing_mode&&(c.selected_marker?b=c.saveMarkerBtn(c.selected_marker,{exit:!0}):c.selected_quiz&&(b=c.saveQuizBtn({exit:!0}))),b.then(function(b){b?a.reject():a.resolve()}),a.promise
}function A(){C(),B()}function B(){c.dismissMarkerAnnotation(),c.marker_errors={},n.clearSelectedMarker()}function C(){c.editing_mode=!1,c.hide_alerts=!0,c.editing_type=null}function D(){c.filtered_timeline_items=null,c.selected_inclass_item=null}function E(){c.filtered_timeline_items=angular.copy(c.lecture.timeline.getItemsBetweenTime(c.selected_quiz.start_time,c.selected_quiz.end_time));for(var a=0;a<c.filtered_timeline_items.length;a++){var b=c.filtered_timeline_items[a];if(b.data.background="lightgrey",b.data.color="black","quiz"!=b.type);else{b.data.inclass_title=d.instant("inclass.self_stage"),b.data.background="#008CBA",b.data.color="white";var e={time:b.data.start_time,type:"marker",data:{time:b.data.start_time}};c.filtered_timeline_items.splice(0,0,e),a++;var f=angular.copy(b);f.data.inclass_title=d.instant("inclass.group_stage"),f.data.background="#43AC6A",c.filtered_timeline_items.splice(++a,0,f);var g=angular.copy(b);if(g.data.inclass_title=d.instant("inclass.discussion_stage"),g.data.background="darkorange",g.data.color="white",c.filtered_timeline_items.splice(++a,0,g),b.data.time<b.data.end_time){var h={time:b.data.end_time,type:"marker",data:{time:b.data.end_time}};c.filtered_timeline_items.splice(c.filtered_timeline_items.length,0,h)}}}c.filtered_timeline_items[0].data.inclass_title=d.instant("inclass.intro_stage"),c.filtered_timeline_items[0].data.background="lightgrey",c.filtered_timeline_items[0].data.color="black",c.goToInclassItem(c.filtered_timeline_items[0])}function F(){c.editing_mode=!0,c.editing_type="video"}function G(){c.lecture.start_time=Math.floor(c.lecture.start_time),c.lecture.end_time=Math.floor(c.lecture.end_time),C(),c.refreshVideo()}function H(){shortcut.add("i",function(){c.addQuestion()},{disable_in_input:!0,propagate:!1}),shortcut.add("n",function(){c.addOnlineMarker(!0)},{disable_in_input:!0,propagate:!1}),shortcut.add("Shift+n",function(){c.addOnlineMarker(!1)},{disable_in_input:!0,propagate:!1})}function I(){shortcut.remove("i"),shortcut.remove("n"),shortcut.remove("Shift+n")}function J(){c.$on("show_online_quiz",function(a,b){c.showOnlineQuiz(b)}),c.$on("delete_online_quiz",function(a,b){c.deleteQuizButton(b)}),c.$on("show_online_marker",function(a,b){c.showOnlineMarker(b)}),c.$on("delete_online_marker",function(a,b){c.deleteMarkerButton(b)}),c.$on("add_online_quiz",function(a,b,d){c.insertQuiz(b,d)}),c.$on("start_trim_video",function(){F()}),c.$on("close_trim_video",function(){G()}),c.$on("show_quiz_background",function(a,b){t(b)}),c.$on("hide_quiz_background",function(){u()})}function K(){return j.openConfirm({template:'<div class="ngdialog-message">                  <h2><b><span translate>lectures.messages.change_lost</span></b></h2>                  <span translate>lectures.messages.navigate_away</span>                  </div>                  <div class="ngdialog-buttons">                      <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>global.leave</button>                      <button type="button" class="ngdialog-button ngdialog-button-primary"  ng-click="confirm(1)"translate>global.stay</button>                  </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1})}function L(b,d,e){c.leave_state=!0,a.go(b,d,e),N()}function M(){c.selected_marker?A():c.selected_quiz&&c.exitQuizBtn()}c.lecture=k.getLecture(b.lecture_id),k.setSelectedItem(c.lecture),c.quiz_layer={},c.lecture_player={},c.lecture_player.events={},c.marker_errors={},c.quiz_errors={},c.alert={type:"alert",msg:"error_message.got_some_errors"},c.hide_alerts=!0,H(),J(),c.lecture_player.events.onMeta=function(){var a=c.lecture_player.controls.getDuration();Math.ceil(c.lecture.duration)!=Math.ceil(a)&&(c.lecture.duration=a,c.lecture.update(),f.$broadcast("update_module_time",c.lecture.group_id)),c.slow=!1,c.video_ready=!1},c.lecture_player.events.onReady=function(){p.waitForDurationSetup().then(function(){c.video_ready=!0;var b=a.params.time;b?g(function(){c.seek(b-.2)}):f.is_mobile||c.lecture_player.controls.seek_and_pause(0),c.lecture.timeline.items.forEach(function(a){a.data&&r(a.data,a.type)})})},c.lecture_player.events.onPlay=function(){c.slow=!1,c.selected_quiz&&(c.selected_quiz.hide_quiz_answers=!0,u())},c.lecture_player.events.onSlow=function(a){c.is_youtube=a,c.slow=!0},c.closeAlerts=function(){c.hide_alerts=!0},c.refreshVideo=function(){c.slow=!1,c.video_ready=!1;var a=c.lecture.url;c.lecture.url="",g(function(){c.lecture.url=a})},c.seek=function(a){c.lecture_player.controls.seek(a),c.editing_mode||c.dismissMarkerAnnotation()},c.addQuestion=function(){c.lecture_player.controls.pause(),c.openQuestionsModal()},c.insertQuiz=function(a,b){var d=c.lecture_player.controls.getTime();l.addVideoQuiz(d,a,b).then(function(a){c.lecture_player.controls.seek_and_pause(a.time),c.editing_mode=!1,c.quiz_deletable=!0,c.showOnlineQuiz(a),r(a,"quiz"),i.open()})},c.showOnlineQuiz=function(a){c.selected_quiz=l.getSelectedVideoQuiz(),c.last_details_state=i.getStatus(),c.selected_quiz!=a&&z().then(function(){c.hide_alerts=!0,c.submitted=!1,c.editing_mode=!1,g(function(){c.editing_mode=!0}),c.selected_quiz=l.createInstance(a).setAsSelected(),c.selected_quiz.selected=!0,c.selected_quiz.hide_quiz_answers=!1,c.editing_type="quiz",c.lecture_player.controls.seek_and_pause(a.time),c.selected_quiz.isTextQuiz()?(c.selected_quiz.getTextQuizAnswers(),c.double_click_msg="",t(c.selected_quiz)):(c.selected_quiz.getInVideoQuizAnswers(),c.double_click_msg="editor.messages.double_click_new_answer",u())})},c.addDoubleClickBind=function(a){if(c.editing_mode&&"quiz"==c.editing_type&&!c.selected_quiz.hide_quiz_answers&&!c.selected_quiz.isFreeTextVideoQuiz()){var b,d,e="Answer "+(c.selected_quiz.answers.length+1);c.selected_quiz.isDragQuiz()?(b=150,d=40):(b=13,d=13);var f=angular.element(a.target);if("ontop"==f.attr("id")){var g=a.pageX-f.offset().left-6,h=a.pageY-f.offset().top-6,i=h/f.height(),j=g/f.width(),k=b/f.width(),l=d/f.height();c.selected_quiz.addAnswer(e,l,k,j,i),window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}}},c.saveQuizBtn=function(a){return c.quiz_errors={},c.selected_quiz.validate().then(function(b){return b&&b.errors?(angular.extend(c.quiz_errors,b.errors),!0):(s(c.selected_quiz),r(c.selected_quiz,"quiz"),c.selected_quiz.update(),w(a))})},c.exitQuizBtn=function(){c.quiz_deletable&&c.selected_quiz.deleteQuiz(),x(),c.last_details_state||i.close()},c.deleteQuizButton=function(a){c.selected_quiz==a&&x(),a.deleteQuiz().then(function(){s(a)})},c.createVideoLink=function(){var b=Math.floor(c.lecture_player.controls.getTime());return{url:a.href("course.module.courseware.lecture",{module_id:c.lecture.group_id,lecture_id:c.lecture.id,time:b},{absolute:!0}),time:b}},c.openQuizList=function(a){i.open(),angular.element(a.target).blur();var b={};c.lecture.addToTimeline(0,"quiz",b),g(function(){c.lecture.removeFromTimeline(b,"quiz")})},c.addOnlineMarker=function(a){var b=c.lecture_player.controls.getTime(),d=(angular.element("#ontop"),.9),e=0,f=.5,g=.1;n.addMarker(b,g,f,e,d).then(function(d){r(d,"marker"),a&&(c.lecture_player.controls.seek_and_pause(b),i.open(),(!c.editing_mode||c.editing_mode&&"quiz"!=c.editing_type)&&c.showOnlineMarker(d))})},c.showOnlineMarker=function(a){c.selected_marker=n.getSelectedMarker(),c.selected_marker!=a&&z().then(function(){c.editing_mode=!1,g(function(){c.editing_mode=!0}),c.selected_marker=n.createInstance(a).setAsSelected(),c.editing_type="marker",c.lecture_player.controls.seek_and_pause(a.time)})},c.showAnnotation=function(a){c.selected_marker=a,c.lecture_player.controls.cue(c.lecture.start_time+(a.time-.1+a.duration),function(){c.dismissMarkerAnnotation()})},c.dismissMarkerAnnotation=function(){c.selected_marker=null},c.deleteMarkerButton=function(a){c.selected_marker==a&&A(),a.deleteMarker().then(function(){s(a)})},c.saveMarkerBtn=function(a){return a.validate().then(function(){var b=c.lecture.timeline.getItemsBetweenTimeByType(a.time,a.time,"marker");return b.length>0&&b[0].data.id!=a.id?(c.alert.msg="error_message.another_marker",c.hide_alerts=!1,!0):(s(a),r(a,"marker"),a.update(),A(),!1)}).catch(function(a){return angular.extend(c.marker_errors,a),!0})},c.togglePreviewInclass=function(){c.filtered_timeline_items?D():E()},c.goToInclassItem=function(a){c.selected_inclass_item=a,c.lecture_player.controls.seek_and_pause(c.selected_inclass_item.data.time),c.selected_quiz.hide_quiz_answers="quiz"!=c.selected_inclass_item.type,"quiz"==c.selected_inclass_item.type?(c.selected_quiz.hide_quiz_answers=!1,t(c.selected_quiz)):(c.selected_quiz.hide_quiz_answers=!0,u())},c.inclassNextItem=function(){var a=c.filtered_timeline_items.indexOf(c.selected_inclass_item)+1;a<c.filtered_timeline_items.length&&c.goToInclassItem(c.filtered_timeline_items[a])},c.inclassPrevItem=function(){var a=c.filtered_timeline_items.indexOf(c.selected_inclass_item)-1;a>=0&&c.goToInclassItem(c.filtered_timeline_items[a])};var N=f.$on("$stateChangeStart",function(a,b,c){a.preventDefault(),z().then(function(){L(b,c,{})},function(){K().catch(function(){M(),L(b,c,{})})})});c.$on("$destroy",function(){I()})}]),angular.module("scalearAngularApp").controller("quizDetailsCtrl",["$stateParams","$scope","$log","$state","ItemsModel","QuizModel","CourseEditor",function(a,b,c,d,e,f,g){b.quiz=e.getQuiz(a.quiz_id),e.setSelectedItem(b.quiz);var h=b.quiz.module();b.due_date_enabled=!g.isDueDateDisabled(b.quiz.due_date),b.disable_module_due_controls=g.isDueDateDisabled(h.due_date),b.link_url=d.href("course.module.courseware.quiz",{module_id:b.quiz.group_id,quiz_id:b.quiz.id},{absolute:!0}),b.updateQuiz=function(){b.quiz.update()},b.updateDueDate=function(){var a=b.due_date_enabled,c=new Date(b.quiz.due_date);if(g.isDueDateDisabled(b.quiz.due_date)&&a)var d=-200;else if(g.isDueDateDisabled(b.quiz.due_date)||a)var d=0;else var d=200;c.setFullYear(c.getFullYear()+d);var e=new Date(h.due_date);a&&c>e&&c.setDate(e.getDate()),b.quiz.due_date=c,b.due_date_enabled=!g.isDueDateDisabled(b.quiz.due_date),b.quiz.due_date_module=!b.disable_module_due_controls&&b.due_date_enabled},b.visible=function(a){return new Date(a)<=new Date},b.validateQuiz=function(a,c){var d={id:b.quiz.id,course_id:b.quiz.course_id,group_id:b.quiz.group_id};d[a]=c;var e=f.createInstance(d);return e.validate()}}]),angular.module("scalearAngularApp").controller("quizMiddleCtrl",["$stateParams","$scope","Quiz","CourseEditor","$translate","$log","$rootScope","ErrorHandler","$timeout","$state","$q","ItemsModel","QuizModel","QuestionModel","CourseModel","ModuleModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){b.saveQuestions();var c=new Date(b.module.appearance_time);a||c.setFullYear(c.getFullYear()+200),b.quiz.appearance_time=c,b.quiz.appearance_time_module=!1,b.publish_state_visible=b.quiz.isVisible(),b.quiz.update()}function r(){shortcut.add("Enter",function(){var a=angular.element(document.activeElement).attr("name");"qlabel"==a&&n.addQuestion(),b.$apply()},{disable_in_input:!1,propagate:!0})}b.quiz=l.getQuiz(a.quiz_id),l.setSelectedItem(b.quiz),b.course=o.getSelectedCourse(),b.module=p.getSelectedModule(),b.publish_state_visible=b.quiz.isVisible(),b.module_visible=b.module.isVisible(),b.alert={type:"alert",msg:"error_message.got_some_errors"},b.quizSortableOptions={axis:"y",dropOnEmpty:!1,handle:".handle",cursor:"crosshair",items:".quiz_sort",opacity:.4,scroll:!0},angular.extend(b,n),r(),b.getEditableQuestions().then(function(a){b.questions=a}),b.$on("$destroy",function(){shortcut.remove("Enter")}),b.closeAlerts=function(){b.hide_alerts=!0},b.saveQuestions=function(){b.tform.$valid?(b.submitted=!1,b.hide_alerts=!0,n.updateQuestions()):(b.submitted=!0,b.hide_alerts=!1)},b.publish=function(){q(!0)},b.unpublish=function(){q(!1)},b.validateQuiz=function(a,c){var d={id:b.quiz.id,course_id:b.quiz.course_id,group_id:b.quiz.group_id};d[a]=c;var e=m.createInstance(d);return e.validate()}}]),angular.module("scalearAngularApp").controller("customLinkDetailsCtrl",["$stateParams","$scope","$q","$filter","CustomLink","$log","ItemsModel","LinkModel",function(a,b,c,d,e,f,g,h){b.link=g.getLink(a.customlink_id),g.setSelectedItem(b.link),b.validateLink=function(a,c){var d={id:b.link.id};d[a]=c;var e=h.createInstance(d);return e.validate()},b.updateLink=function(){b.link.update().then(function(){b.link.errors=""}).catch(function(a){b.link.errors=a.data.errors})}}]),angular.module("scalearAngularApp").controller("customLinkMiddleCtrl",["$stateParams","$scope","ItemsModel",function(a,b,c){b.link=c.getLink(a.customlink_id),c.setSelectedItem(b.link)}]),angular.module("scalearAngularApp").controller("sharingModalCtrl",["$scope","$rootScope","$timeout","$window","$log","Module","$stateParams","Course","SharedItem","$modalInstance","$translate","selected_module","selected_item",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=function(){a.selected_module=l,a.selected_item=m,a.selected_teacher={},a.deSelectAll(a.selected_module),a.selected_item?a.selectItem(a.selected_module,a.selected_item,null):a.selectAll(a.selected_module)};a.shareItem=function(){var b={modules:[],lectures:[],quizzes:[],customlinks:[]};a.selected_module.selected?b.modules.push(a.selected_module.id):a.selected_module.items.forEach(function(a){a.selected&&("lecture"==a.class_name?b.lectures.push(a.id):"quiz"==a.class_name?b.quizzes.push(a.id):"customlink"==a.class_name&&b.customlinks.push(a.id))}),b.modules.length||b.lectures.length||b.quizzes.length||b.customlinks.length?a.selected_teacher.email?i.create({},{shared_item:{data:b},shared_with:a.selected_teacher.email},function(){j.close()},function(b){a.errors=b.data.errors,e.debug(a.errors)}):a.errors=k.instant("sharing.please_enter_email"):a.errors=k.instant("sharing.nothing_selected")},a.selectAll=function(a,b){a.selected=!a.selected,a.items.forEach(function(b){b.selected=a.selected}),b&&b.stopPropagation()},a.deSelectAll=function(a){a.selected=!1,a.items.forEach(function(b){b.selected=a.selected})},a.selectItem=function(a,b,c){c?c.stopPropagation():b.selected=!b.selected;var d=0;a.items.forEach(function(a){a.selected&&(d+=1)}),a.selected=d==a.items.length},n()}]),angular.module("scalearAngularApp").controller("progressCtrl",["$scope","$stateParams","ContentNavigator","Page","Course","Module","$timeout","$log","CourseModel","ErrorHandler","$translate",function(a,b,c,d,e,f,g,h,i,j,k){d.setTitle("navigation.progress"),c.close(),a.course=i.getSelectedCourse();var l=function(c,d){a.module_limit=d,a.module_offset=c,a.loading_modules=!0,e.getModuleProgress({course_id:b.course_id,offset:a.module_offset,limit:a.module_limit},function(b){h.debug("getModuleProgress response",b);var c={};c.module_names=b.module_names,c.total=b.total,c.module_students=a.module_students||[],c.module_status=a.module_status||{},c.late_modules=a.late_modules||{},c.module_students=c.module_students.concat(JSON.parse(b.students)),angular.extend(c.module_status,b.module_status),angular.extend(c.late_modules,b.late_modules),h.debug(c),angular.extend(a,c),g(function(){a.getRemainingModuleProgress()})})};a.getRemainingModuleProgress=function(){a.module_offset+a.module_limit<=parseInt(a.total)?l(a.module_offset+a.module_limit,a.module_limit):a.loading_modules=!1},a.updateStatus=function(a,c,d){d=d?"Finished on Time"==d?1:2:0,f.changeModuleStatus({course_id:b.course_id,module_id:c},{user_id:a,status:d})},a.export=function(){e.exportModuleProgress({course_id:b.course_id}).$promise.then(function(a){a.notice&&j.showMessage(k.instant("error_message.export_course"),"errorMessage",4e3,"success")})},l(0,20)}]),angular.module("scalearAngularApp").controller("progressOverviewCtrl",["$scope","$state","ContentNavigator","$translate","$log","Page","ErrorHandler","CourseModel",function(a,b,c,d,e,f,g,h){a.course=h.getSelectedCourse(),f.setTitle(d.instant("navigation.progress")+": "+a.course.name),c.open(),a.goTo=function(a){b.params.module_id?b.go(a):g.showMessage(d.instant("error_message.select_module_first"),"errorMessage",4e3,"error")}}]),angular.module("scalearAngularApp").controller("progressMainCtrl",["$scope","$timeout","$stateParams","Course","Module","$translate","$log","Page","ContentNavigator",function(a,b,c,d,e,f,g,h,i){h.setTitle("navigation.progress"),i.close(),a.moduleProgressTab=function(){k(),null==a.module_offset&&j(0,20)};var j=function(e,f){a.module_limit=f,a.module_offset=e,a.loading_modules=!0,l(),d.getModuleProgress({course_id:c.course_id,offset:a.module_offset,limit:a.module_limit},function(c){g.debug(c);var d={};d.module_names=c.module_names,d.total=c.total,d.module_students=a.module_students||[],d.module_status=a.module_status||{},d.late_modules=a.late_modules||{},d.module_students=d.module_students.concat(JSON.parse(c.students)),angular.extend(d.module_status,c.module_status),angular.extend(d.late_modules,c.late_modules),g.debug(d),angular.extend(a,d),b(function(){k(),a.loading_modules=!1,$(".student").tooltip({placement:"left",container:"body"})})})};a.getRemainingModuleProgress=function(){a.module_offset+a.module_limit<=parseInt(a.total)?j(a.module_offset+a.module_limit,a.module_limit):l()};var k=function(){a.module_scroll_disable=!1},l=function(){a.module_scroll_disable=!0};a.updateStatus=function(a,b,d){d=d?"Finished on Time"==d?1:2:0,e.changeModuleStatus({course_id:c.course_id,module_id:b},{user_id:a,status:d})},a.totalChartTab=function(){l(),a.total_chart||(a.loading_total_charts=!0,m())};var m=function(){d.getTotalChart({course_id:c.course_id},function(b){a.student_progress=b.student_progress,a.total_chart=n(a.student_progress),a.loading_total_charts=!1},function(){})};a.getTotalChartHeight=function(a){return 30*a.length+50},a.formatTotalChartData=function(a){var b={};b.cols=[{label:f.instant("global.students"),type:"string"},{label:f.instant("progress.quiz"),type:"number"},{label:f.instant("progress.lecture"),type:"number"}],b.rows=[];for(var c in a){var d={c:[{v:a[c][0]},{v:a[c][1],f:a[c][1].toFixed(0)+"%"},{v:a[c][2],f:a[c][2].toFixed(0)+"%"}]};b.rows.push(d)}return b};var n=function(b){var c={};return c.type="BarChart",c.options={colors:["#195a92","#759c45"],title:"Student Progress",isStacked:"false",fill:20,height:a.getTotalChartHeight(b),displayExactValues:!0,fontSize:12,hAxis:{maxValue:100,minValue:0},chartArea:{top:10}},c.data=a.formatTotalChartData(b),c};a.moduleProgressTab()}]),angular.module("scalearAngularApp").controller("progressGraphCtrl",["$scope","$stateParams","ContentNavigator","Page","Course","$translate",function(a,b,c,d,e,f){d.setTitle("navigation.progress"),c.close();var g=function(){a.loading_total_charts=!0,e.getTotalChart({course_id:b.course_id},function(b){a.student_progress=b.student_progress,a.total_chart=h(a.student_progress),a.loading_total_charts=!1})};a.getTotalChartHeight=function(a){return 30*a.length+50},a.formatTotalChartData=function(a){var b={};b.cols=[{label:f.instant("global.students"),type:"string"},{label:f.instant("progress.quiz"),type:"number"},{label:f.instant("progress.lecture"),type:"number"}],b.rows=[];for(var c in a){var d={c:[{v:a[c][0]},{v:a[c][1],f:a[c][1].toFixed(0)+"%"},{v:a[c][2],f:a[c][2].toFixed(0)+"%"}]};b.rows.push(d)}return b};var h=function(b){var c={};return c.type="BarChart",c.options={colors:["#195a92","#759c45"],title:"Student Progress",isStacked:"false",fill:20,height:a.getTotalChartHeight(b),displayExactValues:!0,fontSize:12,hAxis:{maxValue:100,minValue:0},chartArea:{top:10}},c.data=a.formatTotalChartData(b),c};g()}]),angular.module("scalearAngularApp").controller("progressLectureCtrl",["$scope","$stateParams","Timeline","Module","Quiz","OnlineQuiz","$log","$window","$translate","$timeout","Forum","Page","ContentNavigator","Lecture","ScalearUtils","ModuleModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){l.setTitle("navigation.progress"),m.close(),a.Math=window.Math,a.highlight_index=-1,a.inner_highlight_index=0,a.progress_player={},a.timeline={},a.highlight_level=0,a.time_parameters={quiz:3,question:2},a.selected_module=p.getSelectedModule(),a.module_id=b.module_id,a.course_id=b.course_id,a.module_summary={},a.module_summary[a.module_id]={},a.module_summary[a.module_id].type="teacher",a.module_summary[a.module_id].review_page_trigger=!0,a.module_summary[a.module_id].loading={summary:!0,online_quiz:!0,discussion:!0},a.$on("$destroy",function(){B()}),a.$on("progress_item_filter_update",function(b,c){a.check_sub_items=c}),a.$on("progress_filter_update",function(b,c){a.check_items=c}),a.$on("print",function(){a.print()}),a.$on("scroll_to_item",function(b,c){if("customlink"!=c.class_name){var d="quiz"==c.class_name?c.quiz_type:c.class_name;v("#"+d+"_"+c.id,130),y();var e=angular.element("#"+d+"_"+c.id).find(".ul_item")[0];a.highlight_index=angular.element(".ul_item").index(e)-1}}),a.$on("scroll_to_item_summary",function(a,b){null!=b&&w(b)}),a.check_sub_items={lecture_quizzes:!0,confused:!0,charts:!0,discussion:!0,free_question:!0},a.check_items={quiz:!0,survey:!0},a.grade_options=[{value:0,text:i.instant("quizzes.grade.under_review")},{value:1,text:i.instant("quizzes.grade.incorrect")},{value:2,text:i.instant("quizzes.grade.partial")},{value:3,text:i.instant("quizzes.grade.correct")}];var q=function(){a.timeline=new c,s(),r(),t(),u(),A()},r=function(){d.getModuleProgress({course_id:b.course_id,module_id:b.module_id},function(d){angular.extend(a,d),a.module=p.getSelectedModule(),a.progress_player.controls.isYoutube(a.first_lecture.url)?(a.video_start=a.first_lecture.start_time,a.video_end=a.first_lecture.end_time,a.url=a.first_lecture.url+"&controls=1&fs=1&theme=light",a.url_lecture_id=a.first_lecture.id):(a.url=a.first_lecture.url,a.url_lecture_id=a.first_lecture.id),a.timeline.lecture={},a.inclass_quizzes_time=0;for(var e in a.lectures){a.timeline.lecture[e]=new c;for(var f in a.lectures[e])if("meta"!=f)for(var g in a.lectures[e][f]){if("discussion"==f){a.lectures[e][f][g][0]=a.lectures[e][f][g][1][0].time;for(var h in a.lectures[e][f][g][1]){a.lectures[e][f][g][1][h].hide=!a.lectures[e][f][g][1][h].hide;for(var i in a.lectures[e][f][g][1][h].comments)a.lectures[e][f][g][1][h].comments[i].hide=!a.lectures[e][f][g][1][h].comments[i].hide}}else"charts"==f&&(a.lectures[e][f][g][1].hide=!a.lectures[e][f][g][1].hide,a.lectures[e][f][g][1].inclass&&a.lectures[e][f][g][1].hide&&(a.inclass_quizzes_time+=(a.lectures[e][f][g][1].timers.intro+a.lectures[e][f][g][1].timers.self+a.lectures[e][f][g][1].timers.in_group+a.lectures[e][f][g][1].timers.discussion)/60));a.timeline.lecture[e].add(a.lectures[e][f][g][0],f,a.lectures[e][f][g][1])}}null!=b.item_id&&w(b.item_id)},function(){})},s=function(){d.getModuleSummary({module_id:a.module_id,course_id:a.course_id},function(b){a.timeline.module=new c,a.module_summary[a.module_id].loading.summary=!1,angular.extend(a.module_summary[a.module_id],b.module)}),d.getOnlineQuizSummary({module_id:a.module_id,course_id:a.course_id},function(b){a.module_summary[a.module_id].loading.online_quiz=!1,angular.extend(a.module_summary[a.module_id],b.module)})},t=function(){d.getQuizCharts({course_id:b.course_id,module_id:b.module_id},function(b){var d=b.quizzes;a.review_quiz_count=b.review_quiz_count,a.review_quiz_reply_count={},a.timeline.quiz={};for(var e in d){a.timeline.quiz[e]=new c,a.review_quiz_reply_count[e]={};for(var f in d[e].questions){var g=d[e].questions[f].id;a.review_quiz_reply_count[e][g]=0;var h=d[e].charts[g]||d[e].free_question[g];h.type=d[e].questions[f].type,h.id=g,h.quiz_type="quiz",h.show=d[e].questions[f].show,h.title=d[e].questions[f].question;var i="Free Text Question"==d[e].questions[f].type?"free_question":"charts";"free_question"==i&&h.answers.forEach(function(b){b.hide||a.review_quiz_reply_count[e][g]++,b.hide=!b.hide}),h.show&&(a.review_quiz_count+=a.review_quiz_reply_count[e][g]),a.timeline.quiz[e].add(0,i,h,"quiz")}}a.quizzes=angular.extend({},d,a.quizzes)},function(){})},u=function(){d.getSurveyCharts({course_id:b.course_id,module_id:b.module_id},function(b){var d=b.surveys;a.review_survey_count=b.review_survey_count,a.review_survey_reply_count={},a.timeline.survey={};for(var e in d){a.timeline.survey[e]=new c,a.review_survey_reply_count[e]={};for(var f in d[e].questions){var g=d[e].questions[f].id;a.review_survey_reply_count[e][g]=0;var h=d[e].charts[g]||d[e].free_question[g];h.type=d[e].questions[f].type,h.id=g,h.quiz_type="survey";var i="Free Text Question"==d[e].questions[f].type?"free_question":"charts";"free_question"==i&&h.answers.forEach(function(b){b.hide||a.review_survey_reply_count[e][g]++,b.hide=!b.hide}),h.show&&(a.review_survey_count+=a.review_survey_reply_count[e][g]),a.timeline.survey[e].add(0,i,h)}}a.quizzes=angular.extend({},d,a.quizzes)},function(){})},v=function(a,b){var c=b||$("html").innerHeight()/2-10;$(".main_content").parent().scrollToThis(angular.element(a),{offsetTop:c})},w=function(b){if(-1!=b.indexOf("disc")){var c=b.split("a"),d=c[0],e=parseInt(d.split("_")[1]),f=parseInt(c[1]);j(function(){a.timeline.lecture[f].items.forEach(function(a){"discussion"==a.type&&a.data.forEach(function(a){a.post.id==e&&(a.post.show_feedback=!0)})}),v("#"+d,140)})}else j(function(){v("#"+b,130)})};a.manageHighlight=function(b){var c=angular.element(".ul_item");angular.element(c[a.highlight_index]).removeClass("highlight"),angular.element("li.highlight").removeClass("highlight"),a.highlight_index=a.highlight_index+b,a.highlight_index<0?a.highlight_index=0:a.highlight_index>c.length-1&&(a.highlight_index=c.length-1);var d=angular.element(c[a.highlight_index]);d.addClass("highlight").addClass("full-opacity"),a.highlight_level=1,angular.element(".ul_item").not(".highlight").removeClass("full-opacity");var e=d.closest("div");if(e.attr("id")){var f=e.attr("id").split("_");a.selected_item=a.timeline[f[0]][f[1]].items[d.attr("index")],a.selected_item.lec_id=f[1]}else a.selected_item=null;v(c[a.highlight_index]),a.inner_highlight_index=0,x(),z()},a.manageInnerHighlight=function(b){var c=angular.element("ul.highlight").find("ul");if(c.length){var d=c.find("li").not(".no_highlight");if(angular.element("li.highlight").length&&angular.element("li.highlight").removeClass("highlight"),a.inner_highlight_index=a.inner_highlight_index+b,a.inner_highlight_index<0)a.inner_highlight_index=0;else if(a.inner_highlight_index>d.length-1)return a.manageHighlight(1),void 0;angular.element(d[a.inner_highlight_index]).addClass("highlight"),a.highlight_level=2}v(d[a.inner_highlight_index]),z()},a.highlight=function(b,c){var d=angular.element(b.target).closest("ul.ul_item"),e=angular.element(".ul_item");$(".highlight").removeClass("highlight"),a.highlight_index=e.index(d),angular.element(d).addClass("highlight").addClass("full-opacity"),angular.element(".ul_item").not(".highlight").removeClass("full-opacity"),a.highlight_level=1,x(),a.selected_item=c;var f=d.closest("div");if(f.attr("id")){var g=f.attr("id").split("_");a.selected_item.lec_id=g[1]}a.inner_highlight_index=0;var h=angular.element(b.target).closest("li.li_item");h.length&&(angular.element("li.highlight").length&&angular.element("li.highlight").removeClass("highlight"),a.inner_highlight_index=d.find("li.li_item").index(h[0]),angular.element(h[0]).addClass("highlight"),a.highlight_level=2),z()};var x=function(){$(document).click(function(a){angular.element(a.target).find(".inner_content").length&&(y(),$(document).off("click"))})},y=function(){D(),$(".highlight").removeClass("highlight"),angular.element(".ul_item").addClass("full-opacity"),a.highlight_level=0};a.resetHighlightVariables=function(){y(),a.highlight_index=-1,a.inner_highlight_index=0},a.updateHideQuiz=function(c,e){var f=e?-1:1;c.data.inclass?(a.inclass_quizzes_time+=f*(c.data.timers.intro+c.data.timers.self+c.data.timers.in_group+c.data.timers.discussion)/60,a.inclass_quizzes_count+=f):a.review_video_quiz_count+=f,d.hideQuiz({course_id:b.course_id,module_id:b.module_id},{quiz:c.data.id,hide:e})},a.updateHideDiscussion=function(b,c){c?a.review_question_count--:a.review_question_count++,k.hideDiscussion({},{post_id:b,hide:c},function(){},function(){})},a.updateHideComment=function(b,c){k.hideComment({},{post_id:c.id,comment_id:b.id,hide:b.hide},function(){b.hide&&!c.hide&&(c.hide=!0,a.updateHideDiscussion(c.id,!c.hide))},function(){})},a.updateHideResponse=function(c,d,f,g){"survey"==g?f.hide?(a.review_survey_reply_count[c][d.data.id]--,d.data.show&&a.review_survey_count--):(a.review_survey_reply_count[c][d.data.id]++,d.data.show&&a.review_survey_count++):f.hide?(a.review_quiz_reply_count[c][d.data.id]--,d.data.show&&a.review_quiz_count--):(a.review_quiz_reply_count[c][d.data.id]++,d.data.show&&a.review_quiz_count++),e.hideResponses({course_id:b.course_id,quiz_id:c},{hide:{id:f.id,hide:f.hide}},function(){f.hide&&!d.data.show&&(d.data.show=!0,a.updateHideQuizQuestion(c,d.data.id,d.data.show,d.type,g))})},a.updateHideResponseOnlineQuiz=function(a,c,d){f.hideResponses({course_id:b.course_id,online_quizzes_id:a},{hide:{id:c,hide:d}})},a.updateHideQuizQuestion=function(c,d,f,g,h){var i="charts"==g?1:a["review_"+h+"_reply_count"][c][d]+1;f?a["review_"+h+"_count"]+=i:a["review_"+h+"_count"]-=i,e.showInclass({course_id:b.course_id,quiz_id:c},{question:d,show:f})},a.updateHideConfused=function(a,c,d,e){n.confusedShowInclass({course_id:b.course_id,lecture_id:a},{time:c,hide:d,very:e})},a.makeSurveyVisible=function(a,b){a.meta.visible=b,e.makeVisible({course_id:a.meta.course_id,quiz_id:a.meta.id},{visible:b})},a.sendComment=function(a){if(a.temp_response&&a.temp_response.length&&""!=a.temp_response.trim()){var b=a.temp_response;a.temp_response=null,k.createComment({comment:{content:b,post_id:a.id,lecture_id:a.lecture_id}},function(b){b.comment.hide=!1,a.comments.push(b.comment),angular.element("ul.highlight .feedback textarea").blur()},function(){})}},a.sendFeedback=function(a){if(a.temp_response&&a.temp_response.length&&""!=a.temp_response.trim()){var c=a.temp_response;a.temp_response=null,e.sendFeedback({quiz_id:a.quiz_id,course_id:b.course_id},{groups:[a.id],response:c},function(){a.response=angular.copy(c),angular.element("ul.highlight .feedback textarea").blur()},function(){})}},a.deleteFeedback=function(a){e.deleteFeedback({quiz_id:a.quiz_id,course_id:b.course_id},{answer:a.id},function(){a.response=null})},a.deletePost=function(a,b){var c=a[b];k.deletePost({post_id:c.post.id},function(){a.splice(b,1)},function(){})},a.deleteComment=function(a,b){k.deleteComment({comment_id:a.id,post_id:b.id},function(){b.comments.splice(b.comments.indexOf(a),1)},function(){})},a.removeFlag=function(a){k.removeAllFlags({post_id:a.id},function(){a.flags_count=0},function(){})},a.removeCommentFlag=function(a,b){k.removeAllCommentFlags({comment_id:a.id,post_id:b.id},function(){b.comments[b.comments.indexOf(a)].flags_count=0},function(){})},a.updateGrade=function(a){e.updateGrade({course_id:b.course_id,quiz_id:a.quiz_id},{answer_id:a.id,grade:a.grade})},a.updateOnlineQuizGrade=function(a){f.updateGrade({course_id:b.course_id,online_quizzes_id:a.online_quiz_id},{answer_id:a.id,grade:a.grade})},a.seek=function(b,c){-1==a.url.indexOf(c.url)?(a.progress_player.controls.isYoutube(c.url)&&(a.video_start=c.start_time,a.video_end=c.end_time,a.progress_player.controls.setStartTime(c.start_time),a.url=c.url+"&controls=1&fs=1&theme=light",a.url_lecture_id=c.id,j(function(){a.progress_player.controls.seek_and_pause(b)},250)),a.progress_player.controls.isMP4(c.url)&&(a.url=c.url,a.url_lecture_id=c.id,j(function(){a.progress_player.controls.seek_and_pause(b)}))):a.selected_item.lec_id!=a.url_lecture_id?(a.video_start=c.start_time,a.video_end=c.end_time,a.progress_player.controls.setStartTime(c.start_time),j(function(){a.progress_player.controls.seek_and_pause(b)},250),a.url_lecture_id=c.id):j(function(){a.progress_player.controls.seek_and_pause(b)})},a.formatModuleChartData=function(a){var b={};b.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("global.students"),type:"number"}],b.rows=[];var c=[i.instant("progress.chart.not_started_watching"),i.instant("progress.chart.watched")+" <= 50%",i.instant("progress.chart.watched")+" > 50%",i.instant("progress.chart.completed_on_time"),i.instant("progress.chart.completed_late")];
for(var d in a){var e={c:[{v:c[d]},{v:a[d]}]};b.rows.push(e)}return b},a.formatLectureChartData=function(a,b){var c={};c.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("editor.correct")+" ("+i.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:i.instant("editor.correct")+" ("+i.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:i.instant("editor.incorrect")+" ("+i.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:i.instant("editor.incorrect")+" ("+i.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:"",type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:i.instant("dashboard.solved"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],c.rows=[];for(var d in a){var e,f=0,g=0,h=0,j=0,k=0,l=0,e=o.getHtmlText(a[d][2]),m=o.getShortAnswerText(e,Object.keys(a).length),n=a[d][2],p="",q="",r="",s="",t="",u="";"orange"==a[d][1]?("Survey"!=b&&(m+=" ("+i.instant("editor.incorrect")+")"),h=a[d][0],j=a[d][3],r="<div style='color:black;padding:8px'>"+n+"<br>"+i.instant("editor.incorrect")+" ("+i.instant("dashboard.first_try")+")  : "+a[d][0]+"</div>",s="<div style='color:black;padding:8px'>"+n+"<br>"+i.instant("editor.incorrect")+" ("+i.instant("dashboard.final_try")+")  : "+a[d][3]+"</div>"):"gray"==a[d][1]?(k=a[d][0],t="<div style='color:black;padding:8px'>"+i.instant("dashboard.never_tried")+"  : "+a[d][0]+"</div>"):"blue"==a[d][1]?(l=a[d][0],u="<div style='color:black;padding:8px'>"+n+"<br>"+i.instant("dashboard.solved")+" : "+a[d][0]+"</div>"):("Survey"!=b&&(m+=" ("+i.instant("editor.correct")+")"),f=a[d][0],g=a[d][3],p="<div style='color:black;padding:8px'>"+n+"<br>"+i.instant("editor.correct")+" ("+i.instant("dashboard.first_try")+")  : "+a[d][0]+"</div>",q="<div style='color:black;padding:8px'>"+n+"<br>"+i.instant("editor.correct")+" ("+i.instant("dashboard.final_try")+")  : "+a[d][3]+"</div>");var v={c:[{v:m},{v:f},{v:p},{v:g},{v:q},{v:h},{v:r},{v:j},{v:s},{v:k},{v:t},{v:l},{v:u}]};c.rows.push(v)}return c},a.formatQuizChartData=function(a){var b={};b.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("editor.correct"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:i.instant("editor.incorrect"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],b.rows=[];for(var c in a){var d,e,f,g,h,j;d=o.getHtmlText(a[c][2]);var k=o.getShortAnswerText(d,Object.keys(a).length),g=a[c][2];a[c][1]?(k+=" ("+i.instant("editor.correct")+")",e=a[c][0],f=0,h="<div style='color:black;padding:8px'>"+g+"<br>"+i.instant("editor.correct")+" : "+a[c][0]+"</div>"):(k+=" ("+i.instant("editor.incorrect")+")",e=0,f=a[c][0],j="<div style='color:black;padding:8px'>"+g+"<br>"+i.instant("editor.incorrect")+" : "+a[c][0]+"</div>");var l={c:[{v:k},{v:e},{v:h},{v:f},{v:j}]};b.rows.push(l)}return b},a.formatSurveyChartData=function(a){var b={};b.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("progress.chart.answered"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],b.rows=[];var c,d,e;for(var f in a){c=o.getHtmlText(a[f][1]),d=o.getShortAnswerText(c,Object.keys(a).length),e=a[f][1],e="<div style='color:black;padding:8px'>"+e+" : "+a[f][0]+"</div>";var g={c:[{v:d},{v:a[f][0]},{v:e}]};b.rows.push(g)}return b};var z=function(){if(a.selected_item&&a.selected_item.time>=0&&a.lectures[a.selected_item.lec_id]){var b=a.selected_item.time;if("discussion"==a.selected_item.type){var c=a.inner_highlight_index;b=a.selected_item.data[c].time,g.debug(b)}a.seek(b,a.lectures[a.selected_item.lec_id].meta)}};a.createChart=function(b,c,d,e,f,g){var h={};return g?h=a.createChartSelfGroup(b,c,{},"formatSelfGroupChartData",f):(h.type="ColumnChart",h.options={colors:["#16A53F","#1bca4d","#ED9467","#E66726","#a4a9ad","#355BB7"],isStacked:"true",fill:20,height:135,displayExactValues:!0,fontSize:10,legend:{position:"none"},chartArea:{left:30,width:"95%"},vAxis:{gridlines:{count:7},viewWindow:{max:c},textPosition:"none"},tooltip:{isHtml:!0}},("formatQuizChartData"==e||"formatSurveyChartData"==e)&&(h.options.colors=["#16A53F","#E66726"]),angular.extend(h.options,d),h.data=a[e](b,f)),h},a.createChartSelfGroup=function(b,c,d,e,f){var g={type:"ColumnChart",options:{colors:["#16A53F","#1bca4d","#ED9467","#E66726","#a4a9ad","#355BB7","#16A53F","#1bca4d","#ED9467","#E66726","#a4a9ad","#355BB7"],isStacked:"true",fill:20,height:135,displayExactValues:!0,legend:{position:"none"},fontSize:10,chartArea:{left:30,width:"95%"},tooltip:{isHtml:!0},vAxis:{gridlines:{count:7},viewWindow:{max:c}}},data:a[e](b,f)};return angular.extend(g.options,d),g},a.formatSelfGroupChartData=function(a,b){var c={};c.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("editor.correct")+" ("+i.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:i.instant("editor.correct")+" ("+i.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:i.instant("editor.incorrect")+" ("+i.instant("dashboard.first_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:i.instant("editor.incorrect")+" ("+i.instant("dashboard.final_try")+")",type:"number"},{type:"string",p:{role:"style"}},{label:"",type:"number"},{type:"string",p:{role:"style"}},{label:i.instant("dashboard.solved"),type:"number"},{type:"string",p:{role:"style"}}],c.rows=[];for(var d in a){var e,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,p=0,q=0,r=0,s=0,e=a[d][2],t="green"==a[d][1]?"stroke-color: black;stroke-width: 3;":"",u=e+" ("+i.instant("inclass.self_stage")+")",v=e+" ("+i.instant("inclass.group_stage")+")";"green"==a[d][1]?(f=a[d][0]||0,g=a[d][3]||0,m=a[d][4]||0,n=a[d][5]||0):"orange"==a[d][1]?("Survey"!=b&&(e+=" ("+i.instant("editor.incorrect")+")"),h=a[d][0]||0,j=a[d][3]||0,p=a[d][4]||0,q=a[d][5]||0):"gray"==a[d][1]?(k=a[d][0],r=a[d][3]):"blue"==a[d][1]&&(l=a[d][0],s=a[d][3]);var w={c:[{v:o.getHtmlText(u)},{v:f},{v:t},{v:g},{v:t},{v:h},{v:t},{v:j},{v:t},{v:k},{v:t},{v:l},{v:t}]};c.rows.push(w);var w={c:[{v:o.getHtmlText(v)},{v:m},{v:t},{v:n},{v:t},{v:p},{v:t},{v:q},{v:t},{v:r},{v:t},{v:s},{v:t}]};c.rows.push(w)}return c};var A=function(){shortcut.add("r",function(){!a.selected_item||"free_question"!=a.selected_item.type&&"discussion"!=a.selected_item.type||a.inner_highlight_index>=0&&(a.selected_item.data.answers?a.selected_item.data.answers[a.inner_highlight_index].show_feedback=!a.selected_item.data.answers[a.inner_highlight_index].show_feedback:a.selected_item.data[a.inner_highlight_index].post.show_feedback=!a.selected_item.data[a.inner_highlight_index].post.show_feedback,a.$apply(),angular.element("textarea").focus())},{disable_in_input:!0,propagate:!1}),shortcut.add("Down",function(){a.highlight_level<=1?a.manageHighlight(1):a.manageInnerHighlight(1),a.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Up",function(){a.highlight_level<=1?a.manageHighlight(-1):a.manageInnerHighlight(-1),a.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Right",function(){0==a.highlight_level?a.manageHighlight(0):a.manageInnerHighlight(0),a.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Left",function(){a.highlight_level<=1?y():a.manageHighlight(0),a.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("Space",function(){a.selected_item&&a.selected_item.time>=0&&!a.large_player?C():D(),a.$apply()},{disable_in_input:!0,propagate:!1}),shortcut.add("m",function(){if(a.selected_item)if("discussion"==a.selected_item.type){var b=a.inner_highlight_index;a.selected_item.data[b].post.hide=!a.selected_item.data[b].post.hide,a.updateHideDiscussion(a.selected_item.data[b].post.id,!a.selected_item.data[b].post.hide)}else if("charts"==a.selected_item.type)null!=a.selected_item.data.hide?(a.selected_item.data.hide=!a.selected_item.data.hide,a.updateHideQuiz(a.selected_item,!a.selected_item.data.hide)):null!=a.selected_item.data.show&&(a.selected_item.data.show=!a.selected_item.data.show,a.updateHideQuizQuestion(a.selected_item.lec_id,a.selected_item.data.id,a.selected_item.data.show,a.selected_item.type,a.selected_item.data.quiz_type));else if("free_question"==a.selected_item.type)if("survey"==a.selected_item.data.quiz_type)if(1==a.highlight_level)a.selected_item.data.show=!a.selected_item.data.show,a.updateHideQuizQuestion(a.selected_item.data.answers[0].quiz_id,a.selected_item.data.id,a.selected_item.data.show,a.selected_item.type,a.selected_item.data.quiz_type);else{var b=a.inner_highlight_index;a.updateHideResponse(a.selected_item.data.answers[b].quiz_id,a.selected_item,a.selected_item.data.answers[b]),a.selected_item.data.answers[b].hide=!a.selected_item.data.answers[b].hide}else if("Quiz"==a.selected_item.data.quiz_type)if(1==a.highlight_level)a.selected_item.data.show=!a.selected_item.data.show,a.updateHideQuiz(a.selected_item,!a.selected_item.data.show);else{var b=a.inner_highlight_index;a.selected_item.data.answers[b].hide=!a.selected_item.data.answers[b].hide,a.updateHideResponseOnlineQuiz(a.selected_item.data.answers[b].online_quiz_id,a.selected_item.data.answers[b].id,!a.selected_item.data.answers[b].hide)}},{disable_in_input:!0,propagate:!1}),shortcut.add("ESC",function(){D(),"discussion"==a.selected_item.type?a.selected_item.data.forEach(function(a){a.post.show_feedback=!1,a.post.temp_response=null}):"free_question"==a.selected_item.type&&a.selected_item.data.answers.forEach(function(a){a.show_feedback=!1,a.temp_response=null}),angular.element("ul.highlight .feedback textarea").blur(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("enter",function(){if("discussion"==a.selected_item.type){var b=a.inner_highlight_index;a.sendComment(a.selected_item.data[b].post),a.selected_item.data[b].post.show_feedback=!1}else if("free_question"==a.selected_item.type){var b=a.inner_highlight_index;a.sendFeedback(a.selected_item.data.answers[b]),a.selected_item.data.answers[b].show_feedback=!1}a.$apply()},{disable_in_input:!1,propagate:!1})},B=function(){shortcut.remove("r"),shortcut.remove("Down"),shortcut.remove("Up"),shortcut.remove("Right"),shortcut.remove("Left"),shortcut.remove("Space"),shortcut.remove("m"),shortcut.remove("ESC"),shortcut.remove("enter")};a.print=function(){var b=document.getElementById("printarea"),c=window.open("","_blank");c.document.open(),c.document.write('<html><title>::Progress Report::</title><link rel="stylesheet" type="text/css" href="styles/externals/print/progress_print.css" /></head><body onload="window.print()"><center><b>'+a.module.name+"</b></center>"),c.document.write(b.innerHTML),c.document.write("</html>"),c.document.close()},a.filterSubItems=function(b){var c=!1;for(var d in a.check_sub_items)a.check_sub_items[d]&&(c=c||-1!=b.type.indexOf(d)&&null!=b.data);var e=""!=b.type&&c;return e},a.filterItems=function(b){var c=!1;if("lecture"==b.class_name)return!0;for(var d in a.check_items)a.check_items[d]&&(c=c||b.quiz_type==d);return c},a.calculateReviewPercent=function(a,b){return Math.ceil(100*(a/b))||0},a.getReviewColor=function(a){return 10>a?"gray":a>20?"#f5c343":"black"};var C=function(){a.large_player=!0},D=function(){a.large_player=!1};a.getKeys=function(a){return Object.keys?Object.keys(a):function(a){var b=[];for(var c in a)hasOwn.call(a,c)&&b.push(c);return b}(a)},q()}]),angular.module("scalearAngularApp").controller("studentStatisticsCtrl",["$scope","$stateParams","$timeout","Module","$translate","$log","$window","ModuleModel",function(a,b,c,d,e,f,g,h){a.statistics_player={},a.statistics_player.events={},a.module=h.getSelectedModule(),a.types=["confused","back","pauses","questions"];var i=function(){a.loading_statistics_chart=!0,d.getStudentStatistics({course_id:b.course_id,module_id:b.module_id},function(b){a.statistics=b,a.lecture_url="none"==a.statistics.lecture_url?"":a.statistics.lecture_url,j(a.lecture_url)&&(a.lecture_url+="&controls=1&autohide=1&fs=1&theme=light"),a.loading_statistics_chart=!1;var c=angular.element(g);a.win_width=90.5*c.width()/100;var d=a.win_width/a.statistics.width;a.statistics.lecture_names.forEach(function(a){a[0]*=d})})},j=function(a){var b=a||scope.url||"";return b.match(/(?:https?:\/{2})?(?:w{3}\.)?(?:youtu|y2u)(?:be)?\.(?:com|be)(?:\/watch\?v=|\/).*(?:v=)?([^\s&]{11})/)};a.getStatisticsType=function(b){return a.types[b]};var k=function(){return a.win_width};a.formatStatisticsChartData=function(a){var b={};b.cols=[{label:e.instant("global.students"),type:"timeofday"},{label:"#"+e.instant("global.students"),type:"number"}],b.rows=[];for(var c in a){var d=new Date(1e3*a[c][0]),f={c:[{v:[d.getUTCHours(),d.getMinutes(),d.getSeconds(),0]},{v:a[c][1]}]};b.rows.push(f)}return b},a.createStatisticsChart=function(b){var c=a.statistics[b],d={},e=new Date(1e3*a.statistics.min),f=new Date(1e3*a.statistics.max);return d.type="ColumnChart",d.options={colors:["#0c81c8","darkred"],isStacked:"true",fill:20,height:100,width:k()+100,displayExactValues:!0,fontSize:12,hAxis:{viewWindow:{min:[e.getUTCHours(),e.getMinutes(),e.getSeconds(),0],max:[f.getUTCHours(),f.getMinutes(),f.getSeconds(),0]}},legend:"none",chartArea:{left:35,width:k()},bar:{groupWidth:5}},d.data=a.formatStatisticsChartData(c),"confused"==b&&(d.data=l(d.data)),"questions"==b&&(d.options.tooltip={isHtml:!0},d.data=m(d.data)),d};var l=function(b){b.cols.push({label:e.instant("progress.really_confused"),type:"number"});for(var c in b.rows)if(a.statistics.really_confused[c]){var d=new Date(1e3*a.statistics.really_confused[c][0]);b.rows.push({c:[{v:[d.getUTCHours(),d.getMinutes(),d.getSeconds(),0]},{v:0},{v:a.statistics.really_confused[c][1]}]})}return b},m=function(b){b.cols.push({type:"string",p:{role:"tooltip",html:!0}});for(var c in b.rows){var d=n(b.rows[c].c[0].v,b.rows[c].c[1].v,a.statistics.question_text[c][1]);b.rows[c].c.push({v:d})}return b},n=function(a,b,c){var d=[];d[0]=a[0],d[1]=a[1]<10?"0"+a[1]:a[1],d[2]=a[2]<10?"0"+a[2]:a[2];var f=d[0]+":"+d[1]+":"+d[2],g="<div style='padding:8px 0 0 5px'><b>"+f+"</b><br>#"+e.instant("global.students")+":  <b>"+b+"</b></div><hr style='padding:0;margin:4px 0'>";for(var h in c)g+="<div style='width:400px;margin-left:5px;overflow-wrap:break-word'>- "+c[h]+"</div><br>";return g};a.statistics_player.events.onReady=function(){a.statistics_player.controls.pause()},a.skipToTime=function(b,c){if("confused"==c&&2==b.column)var d=new Date(1e3*a.statistics.really_confused[b.row-a.statistics.confused.length][0]);else var d=new Date(1e3*a.statistics[c][b.row][0]);var e=60*60*d.getUTCHours()+60*d.getMinutes()+d.getSeconds(),f=0,g=0,h="";for(var i in a.statistics.time_list){if(e<parseInt(i)){f=e-g,h=a.statistics.time_list[i];break}g=parseInt(i)}-1==a.lecture_url.indexOf(h)?(a.statistics_player.controls.setStartTime(f),a.lecture_url=j(a.lecture_url)?h+"&controls=1&autohide=1&fs=1&theme=light":h):a.statistics_player.controls.seek_and_pause(f)},i()}]),angular.module("scalearAngularApp").controller("lectureProgressCtrl",["$scope","$stateParams","$timeout","Module","$log","Lecture","Quiz","ModuleModel",function(a,b,c,d,e,f,g,h){a.module=h.getSelectedModule(),a.getAllItemsProgress=function(f,g){a.lecture_limit=g,a.lecture_offset=f,a.loading_lectures=!0,d.getAllItemsProgress({course_id:b.course_id,module_id:b.module_id,offset:a.lecture_offset,limit:a.lecture_limit},function(b){e.debug("getAllItemsProgress response",b);var d={};d.lecture_names=b.lecture_names,d.total_lec_quiz=b.total_lec_quiz,d.total=b.total,d.lecture_students=a.lecture_students||[],d.solved_count=a.solved_count||{},d.lecture_status=a.lecture_status||{},d.late_lectures=a.late_lectures||{},d.lecture_students=d.lecture_students.concat(JSON.parse(b.students)),angular.extend(d.solved_count,b.solved_count),angular.extend(d.lecture_status,b.lecture_status),angular.extend(d.late_lectures,b.late_lectures),e.debug(d),angular.extend(a,d),c(function(){a.getRemainingLectureProgress()})})},a.updateStatus=function(a,c,d,e){d=d?"Finished on Time"==d?1:2:0,1==e?f.changeLectureStatus({course_id:b.course_id,lecture_id:c},{user_id:a,status:d}):g.changeQuizStatus({course_id:b.course_id,quiz_id:c},{user_id:a,status:d})},a.getRemainingLectureProgress=function(){a.lecture_offset+a.lecture_limit<=parseInt(a.total)?a.getAllItemsProgress(a.lecture_offset+a.lecture_limit,a.lecture_limit):a.loading_lectures=!1},a.getAllItemsProgress(0,20)}]),angular.module("scalearAngularApp").controller("surveysCtrl",["$scope","$stateParams","$timeout","Module","Quiz","$translate","$log","ScalearUtils",function(a,b,c,d,e,f,g,h){a.surveysTab=function(){a.tabState(5),a.disableInfinitScrolling(),a.selected_survey||a.getSurveyCharts()},a.getSurveyCharts=function(c,e,f){var h;a.selected_survey&&(h=a.selected_survey?a.selected_survey[1]:"");var i=f||h;a.loading_surveys_chart=!0,d.getSurveyChart({course_id:b.course_id,module_id:b.module_id||e,survey_id:i,display_only:c},function(b){g.debug(b),a.current_survey=b.survey,a.ordered_survey=b.ordered_survey,a.survey_chart_data=b.chart_data,a.survey_chart_questions=b.chart_questions,a.survey_free=b.survey_free,a.related_answers=b.related,a.student_count=b.students_count,a.selected_survey||(a.all_surveys=b.all_surveys,a.selected_survey=a.all_surveys?a.all_surveys[0]:""),a.button_msg=a.selected_survey[2]?"progress.button.hide":"progress.button.make_visible",a.loading_surveys_chart=!1},function(){})},a.getSurveyQuestionTitle=function(b){return a.survey_chart_questions[b].question},a.getSurveyQuestionType=function(b){return a.survey_chart_questions[b].type+" | "},a.formatSurveyChartData=function(a){var b={};b.cols=[{label:f.instant("global.students"),type:"string"},{label:f.instant("progress.chart.answered"),type:"number"}],b.rows=[];for(var c in a){var d={c:[{v:h.getHtmlText(a[c][1])},{v:a[c][0]}]};b.rows.push(d)}return b},a.createSurveyChart=function(b,c,d){var e={};return e.type="ColumnChart",e.options={colors:["green","gray"],title:a.getSurveyQuestionType(c)+h.getHtmlText(a.getSurveyQuestionTitle(c)),isStacked:"true",fill:20,height:200,displayExactValues:!0,fontSize:12,vAxis:{title:f.instant("progress.number_of_students")+" ("+f.instant("progress.out_of")+" "+d+")",gridlines:{count:9},maxValue:d}},e.data=a.formatSurveyChartData(b),e},a.changeSurvey=function(){g.debug("survey change"),a.survey_chart_data={},a.survey_chart_questions={},a.getSurveyCharts()},a.makeVisibleBtn=function(){var b=a.selected_survey[1];a.selected_survey[2]=!a.selected_survey[2],e.makeVisible({quiz_id:b},{visible:a.selected_survey[2]},function(){a.button_msg=a.selected_survey[2]?"progress.button.hide":"progress.button.make_visible"})},a.updateHideSurveyQuestion=function(a,c,d){e.showStudent({course_id:b.course_id,quiz_id:a},{question:c,show:d})}}]),angular.module("scalearAngularApp").controller("freeTextTableCtrl",["$scope","$timeout","Quiz","$log","Lecture","$stateParams","$translate",function(a,b,c,d,e,f,g){a.grade_options=[{value:0,text:g.instant("quizzes.grade.under_review")},{value:1,text:g.instant("quizzes.grade.incorrect")},{value:2,text:g.instant("quizzes.grade.partial")},{value:3,text:g.instant("quizzes.grade.correct")}],a.showFeedback=function(a,b,c){if(!c){a.showGroups=!0;for(var d in a)a[d].show_feedback=!1,a[d].group_selected=!1;a[b].show_feedback=!0,a[b].group_selected=!0}};var h=function(a,b){a.showGroups=!1,a[b].show_feedback=!1,a[b].group_selected=!1};a.saveCheckedHideSurvey=function(b,d){c.hideResponseStudent({quiz_id:a.survey_id},{hide:{id:b,hide:d}})},a.saveCheckedHideQuiz=function(b,c){e.hideResponses({lecture_id:a.lecture_id},{hide:{id:b,hide:c}})},a.sendFeedback=function(b,d){var e=a.survey_id,f=[],g=0,i=b[d].response;b.forEach(function(a){a.group_selected&&(f[g]=a.id,a.response=i,g++)}),c.sendFeedback({quiz_id:e},{groups:f,response:i},function(){h(b,d)},function(){})},a.deleteFeedback=function(b,e){var f=a.survey_id,g=b[e].id;d.debug(b[e]),c.deleteFeedback({quiz_id:f},{answer:g},function(){b[e].response="",h(b,e)},function(){})},a.updateGrade=function(a){c.updateGrade({course_id:f.course_id,quiz_id:a.quiz_id},{answer_id:a.id,grade:a.grade})}}]),angular.module("scalearAngularApp").controller("enrolledStudentsCtrl",["$scope","$state","Course","batchEmailService","$stateParams","$translate","$log","$window","Page","$filter","$modal","$cookieStore","ContentNavigator","$rootScope","ErrorHandler","$interval",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){m.close(),g.debug("in enrolled students"),i.setTitle("navigation.enrolled_students"),a.emails=[],d.setEmails(a.emails),a.loading_students=!0,a.delete_mode=!1,a.list_view=l.get("list_view"),c.getEnrolledStudents({course_id:e.course_id},function(b){a.students=b,a.loading_students=!1}),a.removeStudent=function(b){g.debug(b),b.removing=!0,c.removeStudent({course_id:e.course_id,student:b.id},{},function(){a.students.splice(a.students.indexOf(b),1)},function(){b.removing=!1,g.debug(value)})},a.exportStudentsList=function(){g.debug("List "),c.exportStudentCsv({course_id:e.course_id},function(a){a.notice&&o.showMessage(f.instant("error_message.export_student"),"errorMessage",2e3,"success")})},a.emailSingle=function(b){a.deSelectAll(),a.toggleSelect(b),a.emailForm()},a.emailForm=function(){var b=j("filter")(a.students,{checked:!0},!0);a.emails=[],b.forEach(function(b){a.emails.push(b.email)}),d.setEmails(a.emails),k.open({templateUrl:"/views/teacher/course/send_emails.html",controller:"sendEmailsCtrl"})},a.selected=[],a.toggleSelect=function(a){a.checked=!a.checked},a.selectAll=function(){var b=j("filter")(a.students,a.searchText);b.forEach(function(b){j("filter")(a.students,{id:b.id},!0)[0].checked=!0})},a.deSelectAll=function(){var b=j("filter")(a.students,a.searchText);b.forEach(function(b){j("filter")(a.students,{id:b.id},!0)[0].checked=!1})},a.toggleHelpEnrolling=function(){a.isCollapsed=!a.isCollapsed,h.scrollTo(0,0)},a.toggleDeleteMode=function(){a.delete_mode=!a.delete_mode},a.listView=function(b){a.list_view=b,l.put("list_view",b)}}]),angular.module("scalearAngularApp").controller("teacherCourseInformationCtrl",["$scope","$state","$translate","$log","$window","Page","ScalearUtils","ContentNavigator","ErrorHandler","$location","CourseModel","TeacherModel","$modal",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){a.timezones.forEach(function(b){return b.name==a.course.time_zone?(a.course.time_zone=b,void 0):void 0})}function o(){a.formData.disable_registration_checked?a.course.disable_registration||(a.course.disable_registration=a.course.end_date):a.course.disable_registration=null}function p(){l.getTeachers().then(function(c){a.teachers=c.data,a.new_teacher={},b.params.new_course&&m.open({templateUrl:"/views/teacher/course_list/email_student_answers_modal.html",scope:a,controller:["$modalInstance",function(b){var c=a.teachers.findIndex(function(b){return a.current_user.id==b.id});a.updateEmailDiscussion=function(d){a.teachers[c].email_discussion=d,a.updateTeacher(a.teachers[c]),b.dismiss("cancel")}}]})})}function q(){l.getSelectedSubdomains().then(function(b){a.course_domain.selected_subdomain=b.selected_domain,a.subdomains=b.subdomains})}e.scrollTo(0,0),a.in_delete=!1,a.toggle_message="courses.information.button.remove_teacher",a.formData={},a.course=k.getSelectedCourse(),a.formData.disable_registration_checked=!!a.course.disable_registration,a.roles=[{value:3,text:"courses.information.professor"},{value:4,text:"courses.information.ta"}],f.setTitle(c.instant("navigation.information")+": "+a.course.name),a.timezones=g.listTimezones(),a.enrollment_url=j.absUrl().split("courses")[0]+"courses/enroll?id="+a.course.unique_identifier,a.course_info_url=b.href("course.course_information",{course_id:a.course.id},{absolute:!0}),a.course_domain={},a.subdomains={},f.startTour(),h.close(),n(),p(),q(),a.updateCourse=function(b,c){b&&b instanceof Date&&(b.setMinutes(b.getMinutes()-b.getTimezoneOffset()),a.course[c]=b),o(),a.course.update()},a.toggleRegistrationCheck=function(){o(),a.updateCourse()},a.validateCourse=function(b,c){var d={id:a.course.id};d[b]=c;var e=k.createInstance(d);return e.validate()},a.exportCourse=function(){a.course.exportCourse().then(function(a){a.notice&&i.showMessage(c.instant("error_message.export_course"),"errorMessage",4e3,"success")})},a.toggleDelete=function(){a.in_delete=!a.in_delete,a.toggle_message=a.in_delete?"courses.information.done":"courses.information.button.remove_teacher"},a.addNewTeacher=function(){a.teacher_forum=!0},a.updateTeacher=function(a){l.updateTeacher(a)},a.removeNewTeacher=function(){a.new_teacher=null,a.teacher_forum=!1},a.removeTeacher=function(d){l.deleteTeacher(d).then(function(e){e.remove_your_self&&(b.go("course_list"),i.showMessage(c.instant("error_message.remove_your_self"),"errorMessage",4e3,"success"));var f=a.teachers.indexOf(d);-1!=f&&a.teachers.splice(f,1)})},a.saveTeacher=function(){l.saveNewTeacher(a.new_teacher).then(function(){p(),a.teacher_forum=!1}).catch(function(b){a.new_teacher.errors=b.data.errors})},a.animateCopy=function(){$("#enrollment_key").animate({color:"#428bca"},"fast").delay(400).animate({color:"black"},"fast")},a.copySuccess=function(a){$(a.trigger).animate({color:"#428bca"},"fast").delay(300).animate({color:"black"},"fast",function(){a.clearSelection()})},a.copyError=function(){},a.toggleDomain=function(b){b.stopPropagation(),m.open({templateUrl:"/views/teacher/course_list/school_registration_modal.html",plain:!0,scope:a,controller:["$scope","$modalInstance",function(a,b){a.subdomain={},a.subdomain.boolean="all",a.course_domain.selected_subdomain.All||(a.subdomain.boolean="custom"),a.close=function(){b.dismiss()},a.updateDomainList=function(){},a.setBooleanDomain=function(){"all"==a.subdomain.boolean?a.course_domain.selected_subdomain={All:!0}:delete a.course_domain.selected_subdomain.All}}]}).result.finally(function(){-1==Object.keys(a.course_domain.selected_subdomain).map(function(b){return a.course_domain.selected_subdomain[b]}).indexOf(!0)&&(a.course_domain.selected_subdomain={All:!0}),l.setSelectedSubdomains(a.course_domain.selected_subdomain).then(function(){})})}}]),angular.module("scalearAngularApp").controller("sendEmailsCtrl",["$scope","$state","Course","batchEmailService","$stateParams","$log","$window","Page","$modalInstance",function(a,b,c,d,e,f,g,h,i){for(g.scrollTo(0,0),h.setTitle("email"),f.debug("in sending emails"),a.batch_emails=d.getEmails(),f.debug(a.batch_emails.length),0==a.batch_emails.length&&b.go("course.enrolled_students");-1!=a.batch_emails.indexOf(",");)for(var j=0;j<a.batch_emails.length;j++)","==a.batch_emails[j]&&a.batch_emails.splice(j,1);a.final_emails="";for(var j=0;j<a.batch_emails.length;j++)a.final_emails+=a.batch_emails[j]+"; ";f.debug(a.final_emails),a.sendBatchEmail=function(b,d){f.debug(a.batch_emails),c.send_batch_email_through({course_id:e.course_id},{emails:a.batch_emails,subject:b,message:d},function(){i.close()},function(){})}}]),angular.module("scalearAngularApp").controller("systemEmailCtrl",["$scope","$state","Course","$stateParams","$log","$window","Page","$modalInstance","ngDialog",function(a,b,c,d,e,f,g,h,i){f.scrollTo(0,0),a.announcement={emails:""},a.confirmDialog=function(){i.open({template:'<div class="ngdialog-message">                    <h2><b><span>You are going to send a system wide email!</span></b></h2>                    <span translate>Are you sure you want to continue?</span>                    </div>                    <div class="ngdialog-buttons">                        <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)" translate>Cancel</button>                        <button type="button" class="ngdialog-button ngdialog-button-primary" ng-disabled="disable_send" ng-click="sendEmail()">Send</button>                    </div>',plain:!0,className:"ngdialog-theme-default ngdialog-dark_overlay ngdialog-theme-custom",showClose:!1,scope:a,controller:["$scope","Course",function(a,b){a.sendEmail=function(){a.disable_send=!0,b.systemWideEmail({},{subject:a.announcement.subject,message:a.announcement.message,list_type:a.announcement.list_type,reply_to:a.announcement.reply_to,emails:a.announcement.emails.split(",").map(function(a){return a.trim()})},function(){a.closeThisDialog()})}}]})}}]),angular.module("scalearAngularApp").controller("inclassCtrl",["$scope","$translate","ContentNavigator","Page","CourseModel",function(a,b,c,d,e){a.course=e.getSelectedCourse(),d.setTitle(b.instant("navigation.in_class")+": "+a.course.name),c.open()}]),angular.module("scalearAngularApp").controller("inclassModuleCtrl",["$scope","$modal","$timeout","$window","$log","Module","$stateParams","ScalearUtils","$translate","Timeline","Page","$interval","OnlineQuiz","Forum","Quiz","OnlineMarker","Lecture","ModuleModel","CourseModel",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){var b=0;switch(a){case"small":b=1;break;case"medium":b=1.5;break;case"large":b=2}return Math.round(b*window.screen.availWidth)/100}function u(){var b=angular.element(".normal_question_block").not(".ng-hide"),c=b.text().trim().length,d=b.height()*b.width(),e=Math.sqrt(d/c)+5,f=t("large");a.fontsize=Math.min(e,f)+"px"}function v(){if(a.chart){var b=angular.element(".normal_question_block").not(".ng-hide");a.chart.options.height=a.zooom_graph&&95==a.question_block_large?Object.keys(a.selected_timeline_item.data.answers).length*((b.height()-50)/4):b.height()-50}}d.scrollTo(0,0),a.course=s.getSelectedCourse(),k.setTitle(i.instant("navigation.in_class")+": "+a.course.name),a.inclass_player={},a.inclass_player.events={},a.time_parameters={quiz:3,question:2};var w="[REPLACE-STYLING]";a.display=function(){x(),D(),L(),a.hide_video_text=a.button_names[3],a.zooom_graph_text=a.button_names[8],a.zooom_graph=!1,a.setOriginalClass(),a.setInclassShortcuts(),screenfull.request(),a.fullscreen=!0,a.blurButtons(),a.timer=Math.ceil(a.review_question_count*a.time_parameters.question+a.review_video_quiz_count*a.time_parameters.quiz+a.review_survey_count*a.time_parameters.question+a.inclass_quizzes_time+a.review_quiz_count*a.time_parameters.quiz),a.counter=a.timer>0?1:0,a.up_timer=0,a.up_counter=0,a.timerCountUp(),angular.element(d).bind("resize",function(){L(),c(function(){u(),v();var b=16/9,c=angular.element("#inclass_video").height()*b;a.quiz_layer.width=c,a.quiz_layer.marginLeft=(angular.element("#inclass_video").width()-c)/2})}),document.addEventListener(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen||(a.fullscreen=!1,a.exitBtn(),a.$apply())});for(var b in a.lectures){var e=a.timeline.lecture[b].filtered.filterByType("inclass");if(e.length>0){R(e[0].data.id,1);break}}};var x=function(){a.play_pause_class="fi-play",a.mute_class="fi-volume",a.loading_video=!0,a.lecture_url="",a.current_quiz=0,a.item_itr=0,a.timeline_itr=0,a.show_black_screen=!1,a.hide_questions=!1,a.zooom_graph=!1,a.dark_buttons="dark_button",a.fullscreen=!1,a.selected_item={start_time:0},a.selected_timeline_item=null,a.quality_set="color-blue",a.inclass_answer=!1,a.quiz_layer={},a.player_button_hover=!1,a.question_class_normal="normal_question_block",a.video_class_normal="original_video",a.question_block_small=30,a.question_block_large=30},y=function(){a.timeline={lecture:{},survey:{},quiz:{}},a.markers_count=0,a.module=angular.copy(r.getSelectedModule()),a.module.items=[],a.player_button_hover=!1,z(),A()},z=function(){f.getModuleInclass({course_id:g.course_id,module_id:g.module_id},function(b){a.inclass_quizzes_time=0,angular.extend(a,b),a.confused_count=0;for(var c in a.lectures){a.timeline.lecture[c]={all:new j,filtered:new j};for(var d in a.lectures[c])for(var e in a.lectures[c][d])"markers"==d&&a.lectures[c][d][e][1].title?(a.timeline.lecture[c].all.add(a.lectures[c][d][e][0],"primary_marker",a.lectures[c][d][e][1]||{}),a.markers_count+=1):a.timeline.lecture[c].all.add(a.lectures[c][d][e][0],d,a.lectures[c][d][e][1]||{}),"inclass"==d&&a.lectures[c][d][e][1].show&&(a.inclass_quizzes_time+=(a.lectures[c][d][e][1].timers.intro+a.lectures[c][d][e][1].timers.self+a.lectures[c][d][e][1].timers.in_group+a.lectures[c][d][e][1].timers.discussion)/60),"confused"==d&&(a.confused_count+=a.lectures[c][d].length);
a.timeline.lecture[c].filtered.items=a.timeline.lecture[c].all.filterByNotType("markers")}C(a.lectures,r.getSelectedModule().items,a.module.items),B()})},A=function(){f.getQuizChartsInclass({course_id:g.course_id,module_id:g.module_id},function(b){a.quizzes=angular.extend({},b.quizzes,a.quizzes),a.review_quiz_count=b.review_quiz_count,a.review_survey_count=b.review_survey_count;for(var c in a.quizzes){var d=a.quizzes[c].type;a.timeline[d][c]={filtered:new j};for(var e in a.quizzes[c].questions){var f=a.quizzes[c].questions[e].id;a.quizzes[c].answers[f].id=f;var g="Free Text Question"==a.quizzes[c].questions[e].type?a.quizzes[c].questions[e].type:"charts";a.timeline[d][c].filtered.add(0,g,a.quizzes[c].answers[f])}}C(a.quizzes,r.getSelectedModule().items,a.module.items),B()})},B=function(){a.inclass_ready=a.review_question_count||a.review_video_quiz_count||a.review_survey_count||a.inclass_quizzes_count||a.review_quiz_count||a.confused_count||a.markers_count},C=function(a,b,c){var d=h.getKeys(a);for(var e in b)-1!=d.indexOf(b[e].id.toString())&&c.push(b[e]);c.sort(function(a,b){return a.position-b.position})};a.updateHideQuiz=function(b){f.hideQuiz({course_id:g.course_id,module_id:g.module_id},{quiz:b.data.id,hide:b.data.show},function(){var c=b.data.show?1:-1;"inclass"==b.type?(a.inclass_quizzes_time+=c*(b.data.timers.intro+b.data.timers.self+b.data.timers.in_group+b.data.timers.discussion)/60,a.inclass_quizzes_count+=c):a.review_video_quiz_count+=c,B()})},a.updateHideMarker=function(a){p.updateHide({online_markers_id:a.data.id},{hide:a.data.show})},a.updateHideResponseOnlineQuiz=function(a){m.hideResponses({course_id:a.course_id,online_quizzes_id:a.online_quiz_id},{hide:{id:a.id,hide:a.hide}})},a.updateHideDiscussion=function(b,c){n.hideDiscussion({},{post_id:b,hide:c},function(){c?a.review_question_count--:a.review_question_count++})},a.updateHideComment=function(b,c){n.hideComment({},{post_id:c.id,comment_id:b.id,hide:b.hide},function(){b.hide&&!c.hide&&(c.hide=!0,a.updateHideDiscussion(c.id,!c.hide))})},a.updateHideQuizQuestion=function(b,c){o.showInclass({course_id:g.course_id,quiz_id:b.id},{question:c.data.id,show:!c.data.show},function(){var d=c.data.show?1:-1;a["review_"+b.quiz_type+"_count"]+=d*("charts"==c.type?1:c.data.answers.length+1)})},a.updateHideConfused=function(b,c,d,e){q.confusedShowInclass({course_id:g.course_id,lecture_id:b},{time:c,hide:d,very:e},function(){d?a.confused_count-=1:a.confused_count+=1,B()})};var D=function(){angular.element("body").css("overflow","hidden"),angular.element("#main").css("overflow","hidden"),angular.element("html").css("overflow","hidden");var c=angular.element(d);c.scrollTop("0px"),a.modalInstance=b.open({templateUrl:"/views/teacher/in_class/inclass_display.html",windowClass:"whiteboard display",controller:"inclassDisplayCtrl",scope:a}),a.modalInstance.result.then(function(){},function(){E()}),a.unregister_back_event=a.$on("$locationChangeStart",function(b){b.preventDefault(),E(),a.$apply()}),a.unregister_state_event=a.$on("$stateChangeStart",function(){E(),a.$apply()})};a.exitBtn=function(){S(),screenfull.exit(),a.modalInstance.dismiss("cancel"),E(),a.timer_interval_up=null};var E=function(){angular.element("body").css("overflow",""),angular.element("#main").css("overflow",""),angular.element("html").css("overflow",""),a.unregister_back_event(),a.unregister_state_event(),a.removeShortcuts(),x(),l.cancel(a.timer_interval_up),V(),P()};a.playBtn=function(){"fi-play"==a.play_pause_class?(a.inclass_player.controls.play(),a.play_pause_class="fi-pause"):a.inclass_player.controls.pause(),a.blurButtons()},a.muteBtn=function(){"fi-volume-strike"==a.mute_class?(a.mute_class="fi-volume",a.inclass_player.controls.unmute(),a.inclass_player.controls.volume(1)):(a.mute_class="fi-volume-strike",a.inclass_player.controls.mute()),a.blurButtons()},a.qualityBtn=function(){a.quality_set?(a.inclass_player.controls.changeQuality("large"),a.quality_set=null):(a.inclass_player.controls.changeQuality("hd720"),a.quality_set="color-blue"),a.blurButtons()},a.seek=function(b){a.selected_item.url&&(-1==a.lecture_url.indexOf(a.selected_item.url)?(a.inclass_player.controls.isYoutube(a.selected_item.url)&&a.inclass_player.controls.setStartTime(b),a.lecture_url=a.selected_item.url,a.inclass_player.controls.isMP4(a.selected_item.url)&&c(function(){a.inclass_player.controls.seek(b)})):a.inclass_player.controls.seek(b))},a.skip=function(b){if(b){var c=a.inclass_player.controls.getTime()+b,d=a.inclass_player.controls.getDuration();0>c?c=0:c>d&&(c=d),a.seek(c)}a.blurButtons()},a.inclass_player.events.onPlay=function(){a.play_pause_class="fi-pause"},a.inclass_player.events.onPause=function(){a.play_pause_class="fi-play"},a.inclass_player.events.onReady=function(){a.loading_video=!1,a.should_mute&&a.muteBtn(),a.timer_interval_up||(a.timer_interval_up=l(a.timerCountUp,1e3))},a.inclass_player.events.onMeta=function(){a.play_pause_class="fi-play",a.loading_video=!1},a.inclass_player.events.seeked=function(){a.inclass_player.controls.pause()};var F=function(a){for(var b,c=0;c<a.length;c++){var d=a[c];if(d.data.background="lightgrey",d.data.color="black","inclass"!=d.type);else{b=d.data.timers,d.data.inclass_title=i.instant("inclass.self_stage"),d.data.status=2,d.data.background="#008CBA",d.data.color="white",d.data.timer=b.self;var e={time:d.data.start_time,type:"marker",data:{time:d.data.start_time,status:1}};a.splice(0,0,e),c++;var f=angular.copy(d);f.data.inclass_title=i.instant("inclass.group_stage"),f.data.status=3,f.data.background="#43AC6A",f.data.timer=b.in_group,a.splice(++c,0,f);var g=angular.copy(d);g.data.inclass_title=i.instant("inclass.discussion_stage"),g.data.status=4,g.data.background="darkorange",g.data.color="white",g.data.timer=b.discussion,a.splice(++c,0,g);var h={time:d.time,type:"marker",data:{time:d.data.time,status:"answer"}};if(a.splice(++c,0,h),d.time<d.data.end_time){var j={time:d.data.end_time,type:"marker",data:{time:d.data.end_time,status:5}};a.splice(a.length,0,j)}}}return a[0].data.inclass_title=i.instant("inclass.intro_stage"),a[0].data.background="lightgrey",a[0].data.color="black",a[0].data.timer=b.intro,a},G=function(b,c){var d,e;if("charts"==c.type||"inclass"==c.type?(d=c.data.start_time,e=c.data.end_time):(d=c.time-15<a.selected_item.start_time?a.selected_item.start_time:c.time-15,e=c.time+15>a.selected_item.end_time?a.selected_item.end_time:c.time+15),"primary_marker"==c.type){for(var f=[c],g=b.items.indexOf(c),h=g+1;h<b.items.length&&"markers"==b.items[h].type;h++)f.push(b.items[h]);return f}return"inclass"==c.type?b.getItemsBetweenTime(d,e):b.getItemsBetweenTimeByType(d,e,"markers").concat(c)},H=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.data.background="lightgrey",c.data.color="black","markers"!=c.type&&("discussion"==c.type?a[b].data.inclass_title=i.instant("inclass.discussion"):-1!=c.type.indexOf("confused")?a[b].data.inclass_title=i.instant("inclass.confused"):"primary_marker"!=c.type&&(a[b].data.inclass_title=c.data.type))}return a},I=function(b){if(a.selected_timeline_sub_item=b,V(),"primary_marker"==b.type&&"inclass"!=a.selected_timeline_item.type?a.hideQuestionBox():"markers"!=b.type&&a.showQuestionBox(),a.seek(b.time),"inclass"==a.selected_timeline_item.type){if(2==b.data.status||3==b.data.status?(K(a.selected_timeline_item.data.quiz_type),T(a.selected_timeline_item.data.id,a.selected_item.id,3==b.data.status),U()):((b.data.status>4||"answer"==b.data.status)&&(a.loading_chart=!0,m.getChartData({online_quizzes_id:a.selected_timeline_item.data.id},function(b){a.selected_timeline_item.data.answers=b.chart,a.chart=a.createChart(a.selected_timeline_item.data.answers,{colors:["rgb(0, 140, 186)","rgb(67, 172, 106)"]},"formatInclassQuizChartData")})),K()),b.data.timer){P(),Q(b.data.timer);var c=a.$watch("loading_video",function(a){a||(O(),c())})}b.data.status&&"number"==typeof b.data.status?(R(a.selected_timeline_item.data.id,b.data.status),a.inclass_answer=!1):"answer"==b.data.status&&(a.inclass_answer=!0)}};a.nextSubItem=function(){if(a.isBlackScreenOn()&&a.hideBlackScreen(),"lecture"==a.selected_item.class_name){var b=a.selected_timeline_item.sub_items.indexOf(a.selected_timeline_sub_item)+1;if(b<a.selected_timeline_item.sub_items.length)return I(a.selected_timeline_item.sub_items[b]),void 0}a.nextItem()},a.prevSubItem=function(){if(a.isBlackScreenOn()&&a.hideBlackScreen(),"lecture"==a.selected_item.class_name){var b=a.selected_timeline_item.sub_items.indexOf(a.selected_timeline_sub_item)-1;if(b>=0)return I(a.selected_timeline_item.sub_items[b]),void 0}a.prevItem()},a.skipToItem=function(b,c,d){a.item_itr=a.module.items.indexOf(b),a.selected_item=b,c?(a.timeline_itr=a.timeline[d][b.id].filtered.items.indexOf(c),J(angular.noop)):(a.timeline_itr=0,a.nextItem())};var J=function(b){var c="quiz"==a.selected_item.class_name?a.selected_item.quiz_type:a.selected_item.class_name,d=a.timeline[c][a.selected_item.id].filtered.items[a.timeline_itr],e=Array(1);if(Array.isArray(d.data)&&(e=d.data.filter(function(a){return a.hide})),d.data&&(d.data.show===!1||!e.length))return b(),void 0;if(d!=a.selected_timeline_item){if(a.selected_timeline_item&&"inclass"==a.selected_timeline_item.type&&R(a.selected_timeline_item.data.id,1),a.selected_timeline_item=angular.copy(d),"lecture"==c){a.selected_timeline_item.sub_items=G(a.timeline[c][a.selected_item.id].all,d);var f;"inclass"==a.selected_timeline_item.type?(f=0,a.selected_timeline_item.sub_items=F(a.selected_timeline_item.sub_items)):(f=a.selected_timeline_item.sub_items.indexOf(d),a.selected_timeline_item.sub_items=H(a.selected_timeline_item.sub_items)),I(a.selected_timeline_item.sub_items[f])}if("charts"==a.selected_timeline_item.type){var g="lecture"!=c?{backgroundColor:"white"}:{};a.loading_chart=!0;var h="formatLectureChartData";"survey"==c&&(h="formatSurveyChartData"),a.chart=a.createChart(a.selected_timeline_item.data.answers,g,h)}}};a.nextItem=function(){if(a.item_itr<0&&(a.item_itr=0,a.timeline_itr+=1),a.item_itr>=0&&a.item_itr<a.module.items.length){a.selected_item=a.module.items[a.item_itr];var b="quiz"==a.selected_item.class_name?a.selected_item.quiz_type:a.selected_item.class_name;a.timeline[b]&&a.timeline[b][a.selected_item.id]&&(a.timeline_itr+=1,a.timeline_itr>0&&a.timeline_itr<a.timeline[b][a.selected_item.id].filtered.items.length?J(a.nextItem):(a.item_itr+=1,a.timeline_itr=a.item_itr<a.module.items.length?0:a.timeline_itr,a.nextItem()))}else a.item_itr=a.module.items.length,a.showBlackScreen("inclass.blackscreen_done"),a.selected_timeline_item&&"inclass"==a.selected_timeline_item.type&&R(a.selected_timeline_item.data.id,1);c(function(){u(),v()}),a.blurButtons()},a.prevItem=function(){if(a.item_itr>=a.module.items.length&&(a.item_itr=a.module.items.length-1),a.item_itr>=0){a.selected_item=a.module.items[a.item_itr];var b="quiz"==a.selected_item.class_name?a.selected_item.quiz_type:a.selected_item.class_name;if(a.timeline[b]&&a.timeline[b][a.selected_item.id])if(a.timeline_itr-=1,a.timeline_itr>0)J(a.prevItem);else{a.item_itr-=1,a.module.items[a.item_itr]&&(a.selected_item=a.module.items[a.item_itr]);var b="quiz"==a.selected_item.class_name?a.selected_item.quiz_type:a.selected_item.class_name;a.timeline_itr=a.item_itr<0?0:a.timeline[b][a.selected_item.id].filtered.items.length,a.prevItem()}}c(function(){u(),v()}),a.blurButtons()};var K=function(b){"html"==b?(a.quiz_layer.backgroundColor="white",a.quiz_layer.overflowX="hidden",a.quiz_layer.overflowY="auto"):(a.quiz_layer.backgroundColor="",a.quiz_layer.overflowX="",a.quiz_layer.overflowY="")};a.createChart=function(b,c,d){var e={type:"BarChart",options:{width:angular.element(".reveal-modal").width()-50,colors:["green","gray"],isStacked:"false",fill:25,backgroundColor:"white",displayExactValues:!0,legend:{position:"none"},chartArea:{left:"70%",width:"90%",top:"10%"},tooltip:{isHtml:!0},hAxis:{textPosition:"none"}},data:a[d](b)};return a.chooseVideoQuestionBlockGlass(Object.keys(b).length),angular.extend(e.options,c),e},a.chooseVideoQuestionBlockGlass=function(b){var c=95,d=30;a.question_block_small=Math.min(Math.max(d,9*b),c),a.question_block_large=Math.min(c,20*b),a.changeVideoQuestionBoxPercentage(a.question_block_small,!1)},a.formatLectureChartData=function(b){var c={};c.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("lectures.correct"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{role:"style",type:"string"}],c.rows=[];for(var d in b){var e,f=b[d][2],g=h.getHtmlText(f),j="<div style='color:black;padding:8px'>",k=b[d][1];if("gray"==k)e=Math.floor(100*(b[d][0]/a.students_count));else{e=Math.floor(100*((b[d][0]+b[d][3])/a.students_count));var l="Correct: ";"orange"==k?(k="gray",l="Incorrect: "):g=w+g,M()||(j+=l)}j+=f+"</div>";var m={c:[{v:g},{v:e},{v:j},{v:k}]};c.rows.push(m)}return c},a.formatInclassQuizChartData=function(a){var b={};b.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("inclass.self_stage"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}},{label:i.instant("inclass.group_stage"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],b.rows=[];var c=0,d=0;for(var e in a)"Never tried"!=a[e][2]&&(c+=a[e][0],d+=a[e][4]);for(var f in a){var g=a[f][2],j=h.getHtmlText(g),k=a[f][0]||0,l=a[f][4]||0,m=100*(k/c),n=100*(l/d),o="<div style='padding:8px'><b>"+g+"</b><br>"+i.instant("inclass.self_stage")+": "+k+" ("+m+"%)<br>"+i.instant("inclass.group_stage")+": "+l+" ("+n+"%)</div>",j="green"==a[f][1]?w+j:j,p={c:[{v:j},{v:m},{v:o},{v:n},{v:o}]};"Never tried"!=j&&b.rows.push(p)}return b},a.formatSurveyChartData=function(b){var c={};c.cols=[{label:i.instant("global.students"),type:"string"},{label:i.instant("progress.chart.answered"),type:"number"},{type:"string",p:{role:"tooltip",html:!0}}],c.rows=[];for(var d in b){var e={c:[{v:h.getHtmlText(b[d][2])},{v:Math.floor(100*(b[d][0]/a.students_count))},{v:h.getHtmlText(b[d][2])}]};c.rows.push(e)}return c},a.setInclassShortcuts=function(){a.removeShortcuts(),shortcut.add("Right",function(){a.nextSubItem(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Page_down",function(){a.nextSubItem(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Left",function(){a.prevSubItem(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Page_up",function(){a.prevSubItem(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Up",function(){a.prevItem(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Down",function(){a.nextItem(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("b",function(){a.toggleBlackScreen("inclass.blackscreen_close"),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("h",function(){a.toggleHideQuestions(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("Space",function(){a.playBtn(),a.$apply()},{disable_in_input:!1,propagate:!1}),shortcut.add("m",function(){a.muteBtn(),a.$apply()},{disable_in_input:!1,propagate:!1})},a.removeShortcuts=function(){shortcut.remove("Page_up"),shortcut.remove("Page_down"),shortcut.remove("Right"),shortcut.remove("Left"),shortcut.remove("b"),shortcut.remove("h"),shortcut.remove("Space"),shortcut.remove("m")},a.toggleBlackScreen=function(b){a.show_black_screen=!a.show_black_screen,a.blackscreen_msg=b},a.showBlackScreen=function(b){a.show_black_screen=!0,a.blackscreen_msg=b},a.hideBlackScreen=function(){a.show_black_screen=!1,a.blackscreen_msg=""},a.isBlackScreenOn=function(){return a.show_black_screen},a.setOriginalClass=function(){a.question_class="original_question",a.chart_class="original_chart",a.student_question_class="original_student_question",a.question_block="normal_question_block",a.showQuestionBox()},a.toggleHideQuestions=function(){a.hide_questions?a.showQuestionBox():a.hideQuestionBox()},a.toggleZoomGraphVideo=function(){a.zooom_graph?a.showQuestionBox():a.zoomGraph()},a.changeVideoQuestionBoxPercentage=function(a,b){var d=angular.element(".normal_question_block"),e=angular.element(".original_video");c(function(){0!==d.length&&0!==e.length&&(d[0].style.maxHeight=a+"%",d[0].style.minHeight=a+"%",d[0].style.border=(a>0?1:0)+"px solid darkgrey",d[0].style.overflowY=b?"auto":"hidden",e[0].style.maxHeight=95-a+"%",e[0].style.minHeight=95-a+"%")})},a.zoomGraph=function(){a.zooom_graph_text=a.button_names[9],a.hide_video_text=a.button_names[3],a.zooom_graph=!0,a.hide_questions=!1,a.changeVideoQuestionBoxPercentage(a.question_block_large,!0),a.chart&&(a.chart.options.fontSize=t("medium")),a.blurButtons()},a.showQuestionBox=function(){a.zooom_graph=!1,a.hide_questions=!1,a.hide_video_text=a.button_names[3],a.zooom_graph_text=a.button_names[8],a.selected_timeline_item&&"inclass"==a.selected_timeline_item.type?a.changeVideoQuestionBoxPercentage(30,!1):a.changeVideoQuestionBoxPercentage(a.question_block_small,!1),a.chart&&(a.chart.options.fontSize=t("small")),a.blurButtons()},a.hideQuestionBox=function(){a.hide_questions=!0,a.zooom_graph=!1,a.hide_video_text=a.button_names[4],a.zooom_graph_text=a.button_names[8],a.changeVideoQuestionBoxPercentage(0,!1),a.blurButtons()};var L=function(){var b=angular.element(d),c=b.width();660>c?(a.button_names=["Ex","Ov","Sh","H","U","","P","R","Z G","Z V"],a.button_class=510>c?"smallest_font_button":"small_font_button"):(a.button_class="big_font_button",a.button_names=[i.instant("inclass.exit"),"","",i.instant("inclass.video_only"),i.instant("inclass.show_graph"),"5sec",i.instant("inclass.pause"),i.instant("inclass.resume"),i.instant("inclass.zoom_graph"),i.instant("inclass.zoom_video")]),a.hide_video_text=a.hide_questions?a.button_names[4]:a.button_names[3],a.zooom_graph_text=a.zooom_graph?a.button_names[9]:a.button_names[8]};a.playerButtonTooltip=function(){a.player_button_hover=!0},a.playerButtonTooltipLeave=function(){a.player_button_hover=!1},a.lightUpButtons=function(){a.last_movement_time=new Date,a.dark_buttons=null,l(function(){new Date-a.last_movement_time>=5e3&&(a.dark_buttons="dark_button")},5e3,1)},a.blurButtons=function(){angular.element(".button").blur()};var M=function(){return a.selected_timeline_item.data.type&&"survey"==a.selected_timeline_item.data.type.toLowerCase()||a.selected_timeline_item.data.type&&"html_survey"==a.selected_timeline_item.data.type.toLowerCase()};a.timerCountUp=function(){59==a.up_counter?(a.up_timer++,a.up_counter=0):a.up_counter++,a.sec_counter_up=a.up_counter<10?"0"+a.up_counter:a.up_counter,a.min_counter_up=a.up_timer<10?"0"+a.up_timer:a.up_timer};var N=function(){0===a.stage_counter?P():a.stage_counter--};a.toggleStageTimer=function(){a.stage_timer?P():O()};var O=function(){a.stage_timer=l(N,1e3)},P=function(){a.stage_timer&&(l.cancel(a.stage_timer),a.stage_timer=null)},Q=function(b){a.stage_counter=b},R=function(b,c){a.inclass_session=c,c>=0&&5>=c&&m.updateInclassSession({online_quizzes_id:b},{status:c})},S=function(){f.updateAllInclassSessions({course_id:g.course_id,module_id:g.module_id},{})},T=function(b,c,d){m.getInclassSessionVotes({online_quizzes_id:b,lecture_id:c,in_group:d},function(b){a.session_votes=b.votes,a.session_max_votes=b.max_votes})},U=function(){a.session_votes_timer=l(function(){T(a.selected_timeline_item.data.id,a.selected_item.id,3==a.selected_timeline_sub_item.data.status)},5e3)},V=function(){a.session_votes_timer&&l.cancel(a.session_votes_timer),a.session_votes=null,a.session_max_votes=null};a.chartReady=function(){a.chart.options.fontSize||(a.chart.options.fontSize=t("small")),$("text:contains('"+w+"')").each(function(a,b){var c=$(b),d=c.text().replace(w,"");c.html("<tspan>"+d+"</tspan>")}),$("div[style*='background: infobackground;']:contains('"+w+"')").each(function(a,b){var c=$(b),d=c.text().replace(w,"");c.text(d)}),$(window).resize(),a.loading_chart=!1},y()}]),angular.module("scalearAngularApp").controller("inclassDisplayCtrl",["$scope","$window",function(a,b){b.scrollTo(0,0),a.$on("player ready",function(){a.nextItem()})}]),angular.module("scalearAngularApp").controller("TeacherGettingStartedCtrl",["$scope","$location","$anchorScroll","$rootScope","Page","scalear_api","$translate",function(a,b,c,d,e,f,g){e.setTitle("help.getting_started"),d.subheader_message=g.instant("help.getting_started"),a.scalear_api=f,a.scroll=function(a){$("body").scrollToThis(0,{offsetTop:0,duration:0}),$("body").scrollToThis("#"+a,{offsetTop:95,duration:0})}}]),angular.module("scalearAngularApp").controller("LtiKeyGenerateCtrl",["$scope","$location","$anchorScroll","$rootScope","Page","scalear_api","$translate","Lti","$modal",function(a,b,c,d,e,f,g,h,i){e.setTitle("lti.lti"),d.subheader_message=g.instant("lti.lti"),a.scalear_api=f,a.loading_lti=!0,h.getLtiCustomSharedKey({type:"user"}).$promise.then(function(b){a.shared_sceret=b.shared_sceret,a.consumer_key=b.consumer_key,a.lti_url_xml=b.lti_url_xml,a.lti_url_embed=b.lti_url_embed,a.loading_lti=!1}),a.generateNewLtiKeys=function(){h.generateNewLtiKeys({type:"user"}).$promise.then(function(b){a.consumer_key=b.consumer_key,a.shared_sceret=b.shared_sceret})},a.generateLaunchUrl=function(){i.open({templateUrl:"/views/teacher/course_list/lti_course_list.html",scope:a,controller:"ltiCourseListCtrl"})},a.scroll=function(a){$("body").scrollToThis(0,{offsetTop:0,duration:0}),$("body").scrollToThis("#"+a,{offsetTop:95,duration:0})}}]),angular.module("scalearAngularApp").controller("StudentEnrollModalCtrl",["$rootScope","$scope","$modalInstance","Course","$log","$window","$state","$timeout",function(a,b,c,d,e,f,g,h){f.scrollTo(0,0),b.enrollment={},b.form={},h(function(){$("#enrollkey_field").select()},1e3),b.enrollInputClick=function(a){h(function(){$("#enrollkey_field").focus(),a.stopPropagation()})},b.enrollStudent=function(){e.debug(b),b.form.key.$valid?(b.form.processing=!0,d.enroll({},{unique_identifier:b.enrollment.key},function(d){e.debug(d),b.form.processing=!1,g.go("course.course_information",{course_id:d.course.id,new_enroll:!0}),a.$broadcast("Course:get_current_courses"),c.close(b.enrollment.key)},function(a){b.form.processing=!1,b.form.server_error=a.data.errors.join()})):b.form.submitted=!0},b.cancelEnroll=function(){c.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("CoursesEnrollCtrl",["$scope","Course","$state","$stateParams","$rootScope","$log","ErrorHandler",function(a,b,c,d,e){b.enroll({},{unique_identifier:d.id},function(b){a.go_to_course(b)},function(b){a.go_to_course(b,!0)}),a.go_to_course=function(a,b){b?c.go("course.course_information",{course_id:a.data.course.id}):c.go("course.course_information",{course_id:a.course.id,new_enroll:!0}),e.$broadcast("Course:get_current_courses")}}]),angular.module("scalearAngularApp").controller("studentCourseInformationCtrl",["$scope","$stateParams","Course","Page","$state","$translate","ContentNavigator","$log","CourseModel","ScalearUtils","$modal",function(a,b,c,d,e,f,g,h,i,j,k){function l(){a.course.discussion_link&&(a.short_url=j.shorten(a.course.discussion_link,20)),c.show({course_id:b.course_id},function(b){a.teachers=b.teachers}),a.course.getStudentDueDateEmail().then(function(b){a.email_due_date=b.email_due_date}),a.course.getAnnouncements().then(function(b){a.announcements=b})}a.course=i.getSelectedCourse(),d.setTitle(f.instant("navigation.information")+": "+a.course.name),g.open(),a.urlWithProtocol=j.urlWithProtocol,e.params.new_enroll&&k.open({templateUrl:"/views/student/course_list/email_due_dates_modal.html",scope:a,controller:["$modalInstance",function(b){a.updateDueDateEmail=function(c){a.email_due_date=c,a.course.updateStudentDueDateEmail(c),b.dismiss("cancel")}}]}),l(),a.goToContent=function(){if(-1!=a.course.next_item.module){var b={module_id:a.course.next_item.module};b[a.course.next_item.item.class_name+"_id"]=a.course.next_item.item.id,e.go("course.module.courseware."+a.course.next_item.item.class_name,b)}},a.updateStudentDueDateEmail=function(b){a.course.updateStudentDueDateEmail(b)}}]),angular.module("scalearAngularApp").controller("contentSelectorCtrl",["$scope","$stateParams","Page","$state","$timeout","$rootScope","ContentNavigator","$log",function(a,b,c,d,e,f,g){c.setTitle("navigation.information"),g.open()}]),angular.module("scalearAngularApp").controller("studentModuleOverviewCtrl",["$scope","$state","Module","Page",function(a,b,c,d){function e(b,d){a.module_summary={},a.module_summary.loading={summary:!0,online_quiz:!0,discussion:!0},c.getModuleSummary({module_id:b,course_id:d},function(b){a.module_summary.loading.summary=!1,angular.extend(a.module_summary,b.module)}),c.getOnlineQuizSummary({module_id:b,course_id:d},function(b){a.module_summary.loading.online_quiz=!1,angular.extend(a.module_summary,b.module)}),c.getDiscussionSummary({module_id:b,course_id:d},function(b){a.module_summary.loading.discussion=!1,angular.extend(a.module_summary,b.module)})}d.setTitle("global.overview"),e(b.params.module_id,b.params.course_id)}]),angular.module("scalearAngularApp").controller("coursewareCtrl",["$scope","$stateParams","$log","Module","Timeline","Page","$state","ModuleModel","ItemsModel","ErrorHandler",function(a,b,c,d,e,f,g,h,i,j){f.setTitle("navigation.lectures"),f.startTour();var k=function(){var f=h.getSelectedModule();f&&(a.module_items=f.items,d.getStudentModule({course_id:b.course_id,module_id:f.id},function(b){a.module_lectures=b.module_lectures,a.timeline={},a.timeline.lecture={},c.debug("timeline");for(var d in a.module_lectures){var f=a.module_lectures[d];a.timeline.lecture[f.id]=new e;var g=i.getLecture(f.id);for(var h in g)(null===g[h]||void 0===g[h])&&delete g[h];a.timeline.lecture[f.id].meta=angular.extend(f,i.getLecture(f.id));for(var j=f.video_quizzes.length-1;j>=0;j--)0==f.video_quizzes[j].online_answers.length&&"Free Text Question"!=f.video_quizzes[j].question_type?f.video_quizzes.splice(j,1):a.timeline.lecture[f.id].add(f.video_quizzes[j].time,"quiz",f.video_quizzes[j]);for(var k in f.user_confused)a.timeline.lecture[f.id].add(f.user_confused[k].time,"confused",f.user_confused[k]);for(var k in f.posts)a.timeline.lecture[f.id].add(f.posts[k].time,"discussion",f.posts[k]);for(var l in f.lecture_notes)a.timeline.lecture[f.id].add(f.lecture_notes[l].time,"note",f.lecture_notes[l]);for(var l in f.title_markers)a.timeline.lecture[f.id].add(f.title_markers[l].time,"marker",f.title_markers[l])}c.debug("timeline",a.timeline)},function(a){j.showMessage(a.data.errors[0],"errorMessage",4e3,"error"),g.go("course_list")}))};k()}]),angular.module("scalearAngularApp").controller("studentLectureMiddleCtrl",["$scope","$stateParams","Lecture","$interval","$translate","$state","$log","$timeout","Page","$filter","OnlineQuiz","ScalearUtils","ContentNavigator","TimelineNavigator","$rootScope","TimelineFilter","$window","VideoInformation","CourseModel","ModuleModel","ItemsModel","VideoEventLogger","$modal","Course","$q","ErrorHandler","$location","MobileDetector",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){a.course=s.getSelectedCourse(),a.video_layer={},a.quiz_layer={},a.lecture_player={},a.lecture_player.controls={},a.lecture_player.events={},a.resize={},a.distance_peer_session_id=null,a.TimelineNavigator=n,a.ContentNavigator=m,B.isPhone()||a.ContentNavigator.open(),a.preview_as_student&&a.TimelineNavigator.open(),a.delayed_timeline_open=a.TimelineNavigator.getStatus(),a.$on("export_notes",function(){a.exportNotes()}),a.$on("timeline_navigator_change",function(b,c){c?a.delayed_timeline_open=c:h(function(){a.delayed_timeline_open=!1},400)}),a.$on("exit_preview",function(){a.lecture_player.element&&(a.skip_pause_update=!0,a.lecture_player.controls.pause())}),a.$watch("distance_peer_session_id",function(){a.distance_peer_session_id&&null!=a.lecture&&(a.distance_peer_status||c.checkIfInDistancePeerSession({course_id:a.lecture.course_id,lecture_id:a.lecture.id}).$promise.then(function(b){"no_peer_session"!=b.distance_peer&&(a.name=b.name,a.distance_peer_status=b.distance_peer.status,O(),a.distance_peer_message_in_box=e.instant("distance_peer.message_video",{name:a.name}),a.lecture_player.events.onReady(!0))}))});var C=function(){a.studentAnswers={},a.explanation={},a.fullscreen=!1,a.total_duration=0,a.elapsed_width=0,a.slow=!1,a.course.warning_message=null,a.video_class="flex-video",a.container_class="",a.passed_requirments=!0,a.lecture=null,a.video_ready=!1,a.show_progressbar=!1,J(),a.next_stop_time=null,a.distance_peer_session_id=null,a.distance_peer_status=null,a.distance_peer_message_in_box=null,a.quiz_cue_distance_peer_list={}},D=function(){a.next_stop_time=null,a.distance_peer_status=null,a.distance_peer_message_in_box=null,a.distance_peer_session_id=null,a.quiz_cue_distance_peer_list={},a.lecture_player.events.onReady(!0)},E=function(){if(o.is_mobile){var a=B.isTablet()?"tiny":"really-tiny";h(function(){$(".button").removeClass("small").addClass(a)})}},F=function(){if(C(),o.is_mobile?G():document.addEventListener(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen||(db(),a.$apply())}),a.$watch("timeline",function(){a.timeline&&K(f.params.lecture_id)}),a.$on("remove_from_timeline",function(b,c){if(a.timeline){var d=c.data?c.data.lecture_id:f.params.lecture_id,e=a.timeline.lecture[d].items.indexOf(c);a.timeline.lecture[d].items.splice(e,1)}}),!a.preview_as_student)var b=o.$on("$stateChangeStart",function(c,d,e,g,h,i){var j=a.lecture_player.controls.getTime();if(j){c.preventDefault();var k=Math.round(100*(j/a.total_duration));V(k,"seek").then(function(){f.go(d,e,i)}),b()}})},G=function(){$("#lecture_container").addClass("ipad"),$(".container").addClass("ipad"),B.isPhone()&&(H(),$(window).bind("orientationchange",H)),E()},H=function(){90==window.orientation||-90==window.orientation?a.TimelineNavigator.close():eb()},I=function(){shortcut.add("c",function(){a.addConfused(),a.$apply()},{disable_in_input:!0}),shortcut.add("q",function(){a.addQuestionBlock(),a.$apply()},{disable_in_input:!0}),shortcut.add("n",function(){a.addNote(),a.$apply()},{disable_in_input:!0}),shortcut.add("f",function(){a.toggleFullscreen(),a.$apply()},{disable_in_input:!0})},J=function(){shortcut.remove("c"),shortcut.remove("q"),shortcut.remove("n"),shortcut.remove("f")},K=function(b){a.timeline&&(h(function(){a.lecture=a.timeline.lecture[b].meta;var c=t.getSelectedModule();i.setTitle(c.name+": "+a.lecture.name+" - "+a.course.name)}),C(),Y(),a.closeReviewNotify(),c.getLectureStudent({course_id:f.params.course_id,lecture_id:b},function(b){var c=b.lecture;a.next_item=b.next_item,a.alert_messages=b.alert_messages;for(var d in a.alert_messages)"due"==d?a.course.warning_message=e.instant("events.due_date_passed")+" - "+a.alert_messages[d][0]+" ("+a.alert_messages[d][1]+" "+e.instant("time."+a.alert_messages[d][2])+") "+e.instant("time.ago"):"today"==d&&(a.course.warning_message=e.instant("events.due")+" "+e.instant("time.today")+" "+e.instant("at")+" "+j("date")(a.alert_messages[d],"shortTime"));if(!a.preview_as_student)for(var f in c.requirements)for(var g in c.requirements[f]){var i=u.getById(c.requirements[f][g],f);i.done||(a.passed_requirments=!1)}a.passed_requirments&&I(),h(function(){a.scrollIntoView()},500)}))},L=function(b,c,d){v.log(f.params.course_id,f.params.lecture_id,b,c,d,a.quiz_mode,r.speed,r.volume,a.fullscreen)},M=function(b){var c=a.lecture.video_quizzes.map(function(a){return a.time}).indexOf(b.time);a.next_quiz=null,a.lecture.video_quizzes[c+1]&&a.lecture.video_quizzes[c+1].time-b.time<=1&&(a.next_quiz=a.lecture.video_quizzes[c+1]),a.seek(b.time),a.lecture_player.controls.pause(),a.closeReviewNotify(),a.studentAnswers[b.id]={},a.selected_quiz=b,a.quiz_mode=!0,a.check_answer_title="lectures.button.check_answer",a.selected_quiz.actual_display_text=a.selected_quiz.display_text,a.distance_peer_session_id&&(a.check_answer_title="lectures.button.submit_my_vote"),"html"==b.quiz_type||"html_survey"==b.quiz_type?(g.debug("HTML quiz"),a.quiz_layer.backgroundColor="white",a.quiz_layer.overflowX="hidden",a.quiz_layer.overflowY="auto","DRAG"==b.question_type.toUpperCase()&&(a.studentAnswers[b.id]=b.online_answers_drag)):(a.quiz_layer.backgroundColor="",a.quiz_layer.overflowX="",a.quiz_layer.overflowY=""),"FREE TEXT QUESTION"==b.question_type.toUpperCase()&&(a.studentAnswers[b.id]=""),("survey"==b.quiz_type||"FREE TEXT QUESTION"==b.question_type.toUpperCase()||"html_survey"==b.quiz_type)&&(a.check_answer_title="lectures.button.submit"),a.last_quiz=b,a.backup_quiz=angular.copy(b)
},N=function(){a.selected_quiz.online_answers.forEach(function(a){a.selected&&(a.selected=null)})},O=function(){1==a.distance_peer_status?a.distance_peer_message_in_box=e.instant("distance_peer.the_another_student_finished_message_video",{name:a.name}):2==a.distance_peer_status?a.distance_peer_message_in_box=e.instant("distance_peer.the_another_student_finished_message_quiz_intro",{name:a.name}):3==a.distance_peer_status?a.distance_peer_message_in_box=e.instant("distance_peer.the_another_student_finished_message_quiz_self",{name:a.name}):4==a.distance_peer_status?a.distance_peer_message_in_box=e.instant("distance_peer.the_another_student_finished_message_quiz_group",{name:a.name}):5==a.distance_peer_status&&(a.distance_peer_message_in_box=e.instant("distance_peer.the_another_student_finished_message_quiz_end",{name:a.name}))},P=function(a){2==a?sb(e.instant("distance_peer.waiting_message_quiz_intro_after_video")):3==a?sb(e.instant("distance_peer.waiting_message_quiz_self_after_intro")):4==a?sb(e.instant("distance_peer.waiting_message_quiz_group_after_self")):5==a?sb(e.instant("distance_peer.waiting_message_quiz_end_after_group")):1==a&&sb(e.instant("distance_peer.waiting_message_video_after_quiz_end"))},Q=function(b,f,g,h){c.checkIfDistancePeerStatusIsSync({course_id:a.lecture.course_id,lecture_id:a.lecture.id,distance_peer_id:b}).$promise.then(function(b){if("start"==b.status&&(S(),a.distance_peer_status=f,O(),1==a.distance_peer_status?sb(e.instant("distance_peer.the_another_student_finished_message_video")):2==a.distance_peer_status?sb(e.instant("distance_peer.the_another_student_finished_message_quiz_intro")):3==a.distance_peer_status?sb(e.instant("distance_peer.the_another_student_finished_message_quiz_self")):4==a.distance_peer_status?sb(e.instant("distance_peer.the_another_student_finished_message_quiz_group")):5==a.distance_peer_status&&sb(e.instant("distance_peer.the_another_student_finished_message_quiz_end")),a.next_stop_time=g,yb(),3==f||4==f)){a.hide_quiz_button=!0,M(h),d(function(){a.hide_quiz_button=!1},5e3);var c=3==f?h.self:h.in_group;N(),zb(c),xb()}})},R=function(b,c,e,f){a.check_if_distance_peer_is_sync=d(function(){Q(b,c,e,f)},5e3)},S=function(){a.check_if_distance_peer_is_sync&&d.cancel(a.check_if_distance_peer_is_sync),a.session_votes=null},T=function(b,d,e){var f="do_not_updated";6!=b&&(f=e.id),a.lecture_player.controls.pause(),c.changeStatusDistancePeer({course_id:a.lecture.course_id,lecture_id:a.lecture.id,status:b,online_quiz_id:f,distance_peer_id:a.distance_peer_session_id}).$promise.then(function(){6!=b?(R(a.distance_peer_session_id,b,d,e),P(b)):(D(),S(),rb())})},U=function(b){var c=a.lecture.video_quizzes.map(function(a){return a.time}).indexOf(b.time);b.start_time!=b.time&&a.lecture_player.controls.cue(a.lecture.start_time+b.start_time,function(){a.lecture.start_time+b.start_time>=a.next_stop_time&&T(2,b.time,b)}),a.lecture_player.controls.cue(a.lecture.start_time+b.time,function(){a.lecture.start_time+b.time>=a.next_stop_time&&2==a.distance_peer_status&&T(3,b.time,b),3==a.distance_peer_status?M(b):4==a.distance_peer_status&&M(b)}),a.lecture_player.controls.cue(a.lecture.start_time+(b.end_time+.6),function(){a.lecture.start_time+b.end_time>=a.next_stop_time&&(null!=a.lecture.video_quizzes[c+1]?T(1,a.lecture.video_quizzes[c+1].start_time,b):T(1,a.total_duration,b))})};a.lecture_player.events.onReady=function(b){a.slow=!1,a.total_duration=a.lecture_player.controls.getDuration(),a.lecture_player.controls.removeAllTrackEvents();for(var c=[0],d=0,e=30;e<a.total_duration;e+=30)c.push(100*(e/a.total_duration));Ab().then(function(){b||!a.lecture.distance_peer||a.distance_peer_session_id||a.openStudentList(a.lecture.id,a.lecture.course_id);var c=0;a.lecture.video_quizzes&&a.lecture.video_quizzes.forEach(function(b){b.time>=a.total_duration-2&&(b.time=a.total_duration-2+c,c+=.2),a.lecture.distance_peer&&a.distance_peer_session_id?b.id in a.quiz_cue_distance_peer_list?b.id in a.quiz_cue_distance_peer_list||(d=a.lecture_player.controls.cue(a.lecture.start_time+b.start_time,function(){U(b)}),a.quiz_cue_distance_peer_list[b.id]=d.id):d=a.lecture_player.controls.cue(a.lecture.start_time+b.start_time,function(){U(b)}):a.lecture_player.controls.cue(a.lecture.start_time+(b.time-.1),function(){M(b)})})}),a.lecture.annotations&&a.lecture.annotations.forEach(function(b){b.annotation&&(a.lecture_player.controls.cue(a.lecture.start_time+(b.time-.1),function(){b.as_slide?(a.lecture_player.controls.pause(),ub(b)):tb(b)}),b.as_slide||a.lecture_player.controls.cue(a.lecture.start_time+(b.time-.1+b.duration),function(){a.dismissDynmaicAnnotation()}))}),c.forEach(function(b){a.lecture_player.controls.cue(a.total_duration*b/100,function(){V(b,"mile_cue")})}),a.video_ready=!0,a.lecture_player.controls.youtube&&o.is_mobile||(a.show_progressbar=!0);var g=f.params.time;g?(h(function(){a.seek(g)}),h(function(){a.scrollIntoView()},500),A.search("time",0)):o.is_mobile||(a.lecture_player.controls.seek(0),a.lecture_player.controls.pause())};var V=function(b,c){if(b>a.lecture.watched_percentage){var d=a.lecture;return a.not_done_msg=!1,d.updateViewPercentage(b).then(function(e){a.last_navigator_state=a.ContentNavigator.getStatus(),e.lecture_done&&!d.done?d.markDone():100==b&&(a.not_done_msg=!0),g.debug("Watched:"+e.watched+"% solved:"+e.quizzes_done[0]+" total:"+e.quizzes_done[1],c),a.lecture.watched_percentage=e.watched,a.lecture.quiz_percentage=e.quizzes_done[0]+" / "+e.quizzes_done[1]})}return y.when({})};a.scrollIntoView=function(){a.lecture&&$(".student_timeline").scrollToThis("#outline_"+a.lecture.id,{offsetTop:$(".student_timeline").offset().top,duration:400})},a.nextItem=function(){if(a.next_item.id)if(a.last_navigator_state||m.close(),"lecture"==a.next_item.class_name)a.seek(null,a.next_item.id);else{var b="course.module.courseware."+a.next_item.class_name,c=a.next_item.class_name+"_id",d={};d[c]=a.next_item.id,d.module_id=a.next_item.group_id,f.go(b,d)}},a.replay=function(){a.seek(0),h(function(){a.lecture_player.controls.play()},1e3)},a.refreshVideo=function(){a.slow=!1;var b=a.lecture.url;a.lecture.url="",h(function(){a.lecture.url=b})},a.seek=function(b,c){a.closeReviewNotify(),a.dismissAnnotation(),a.dismissDynmaicAnnotation();var d=a.lecture_player.controls.getTime(),g=Math.round(100*(d/a.total_duration));a.seek_to_time=b;var i=Math.round(100*(a.seek_to_time/a.total_duration));a.lecture.watched_percentage<g&&g>i&&V(g,"seek"),c&&c!=a.lecture.id?(f.go("course.module.courseware.lecture",{lecture_id:c},{reload:!1,notify:!1}),K(c),a.go_to_time=b):a.next_stop_time<b&&a.distance_peer_session_id?(a.lecture_player.controls.pause(),sb(e.instant("distance_peer.prevent_seek_forward"))):(a.lecture.skip_ahead||i<Math.max(a.lecture.watched_percentage,g))&&b>=0&&a.show_progressbar&&(a.lecture_player.controls.seek(b),a.log_event_timeout||(a.log_event_timeout=h(function(){L("seek",d,a.seek_to_time),V(i,"seek"),a.log_event_timeout=null},1e3))),a.video_end=!1},a.seek_and_pause=function(b,c){a.lecture_player.controls.getTime()!=b&&Y(),a.skip_pause_update=!0,a.seek(b,c),a.lecture_player.controls.pause()},a.progressSeek=function(b){a.seek(b),W(),X()};var W=function(){if(a.distance_peer_session_id){if(a.quiz_mode)if(a.selected_quiz.graded&&a.lecture_player.controls.getTime()>=a.selected_quiz.time)if("html"==a.selected_quiz.quiz_type||"html_survey"==a.selected_quiz.quiz_type)a.answer_form.$error.atleastone?Z(a.selected_quiz.time):Y();else{var b=[];a.selected_quiz.online_answers.forEach(function(a){a.selected&&b.push(a.id)}),0==b.length?Z(a.selected_quiz.time):Y()}else a.display_review_message&&(lb(),a.display_review_message=!1),Y(),a.next_quiz&&M(a.next_quiz)}else a.quiz_mode&&(!a.selected_quiz.solved_quiz&&a.selected_quiz.graded&&a.lecture_player.controls.getTime()>=a.selected_quiz.time?Z(a.selected_quiz.time):(a.display_review_message&&(lb(),a.display_review_message=!1),Y(),a.next_quiz&&M(a.next_quiz)))},X=function(){a.slide_note&&_(a.slide_note.time)},Y=function(){a.selected_quiz="",a.quiz_mode=!1,a.quiz_layer.backgroundColor="",a.quiz_layer.overflowX="",a.quiz_layer.overflowY=""},Z=function(b){a.seek(b),a.lecture_player.controls.pause(),ab("lectures.choose_correct_answer")},_=function(b){a.seek(b),a.lecture_player.controls.pause()};a.lecture_player.events.onPlay=function(){g.debug("playing "),W(),X(),a.dismissAnnotation(),!a.quiz_mode&&a.distance_peer_session_id&&vb(),a.video_end=!1,L("play",a.lecture_player.controls.getTime()),B.isPhone()&&a.temp_timeline_item&&((a.temp_timeline_item.type="discussion")&&a.$emit("remove_from_timeline",a.temp_timeline_item),ob())},a.lecture_player.events.onPause=function(){if(!a.skip_pause_update){g.debug("pausing");var b=a.lecture_player.controls.getTime(),c=Math.round(100*(b/a.total_duration));L("pause",b),V(c,"pause")}a.skip_pause_update=!1},a.lecture_player.events.onEnd=function(){a.video_end=!0,V(100,"end")},a.lecture_player.events.onSlow=function(b){g.debug("youtube is"),g.debug(b),a.is_youtube=b,a.slow=!0},a.lecture_player.events.canPlay=function(){if(a.go_to_time){if(a.go_to_time>=0)var b=a.go_to_time;h(function(){a.seek_and_pause(b)}),a.go_to_time=null}},a.lecture_player.events.waiting=function(){o.is_mobile&&!a.show_progressbar&&(a.video_ready=!0,a.show_progressbar=!0,B.isPhone()&&cb())};var ab=function(b,c,f){a.notification_message=e.instant(b),a.notification_middle_message=e.instant(f),a.notification_submessage=e.instant(c),d(function(){bb()},3e3,1)},bb=function(){a.notification_message&&(a.notification_message=null,window.onmousemove=null)};a.toggleFullscreen=function(){a.fullscreen?db():cb(),L("fullscreen",a.lecture_player.controls.getTime())},a.toggleVideoPlayback=function(){a.lecture_player.controls.paused()?a.lecture_player.controls.play():a.lecture_player.controls.pause()};var cb=function(){function b(){a.video_layer.height=angular.element(q).height()-70,a.resize.big(),a.$apply()}a.fullscreen=!0,o.is_mobile?(a.resize.big(),a.container_class="mobile_video_full",a.video_layer={width:"100%",height:angular.element(q).height()-70,position:"relative"},E(),B.isPhone()&&(a.video_layer.paddingBottom="0"),$(window).bind("orientationchange",function(){B.isAndroid()?h(b,200):b()})):"4:3"==l.calculateScreenRatio()?a.video_layer={marginTop:"5.5%",marginBottom:"5.5%"}:"16:9"==l.calculateScreenRatio()&&(a.video_layer=a.distance_peer_session_id?{paddingBottom:"44.7%"}:{paddingBottom:"51.7%"})},db=function(){a.fullscreen=!1,a.video_layer={},o.is_mobile&&(a.resize.small(),a.container_class="",$(window).off("orientationchange"),B.isPhone()&&($(window).bind("orientationchange",H),ob()),E())};a.playOnPhone=function(){a.toggleVideoPlayback()};var eb=function(){a.TimelineNavigator.open(),h(function(){a.scrollIntoView()})};a.addQuestionBlock=function(){var b=a.lecture_player.controls.getTime();if(a.last_fullscreen_state=a.fullscreen,a.last_video_state=!a.lecture_player.controls.paused(),a.lecture_player.controls.pause(),p.set("discussion",!0),a.last_timeline_state=!a.TimelineNavigator.getStatus(),a.last_discussion){var c=a.timeline.lecture[f.params.lecture_id].items[a.last_discussion];a.last_discussion=null,a.$broadcast("post_question",c)}a.last_discussion=a.timeline.lecture[f.params.lecture_id].add(b,"discussion",null),B.isPhone()&&a.fullscreen?a.temp_timeline_item=a.timeline.lecture[f.params.lecture_id].items[a.last_discussion]:(db(),eb())},a.addConfused=function(){var b=a.lecture_player.controls.getTime();c.confused({course_id:f.params.course_id,lecture_id:f.params.lecture_id},{time:b},function(c){if("ask"==c.msg&&ab("lectures.messages.really_confused_use_question"),c.flag||a.timeline.lecture[f.params.lecture_id].add(b,"confused",c.item),c.flag&&"ask"!=c.msg){var d=a.timeline.lecture[f.params.lecture_id].getIndexById(c.id,"confused");a.timeline.lecture[f.params.lecture_id].items[d].data.very=!0}})},a.addNote=function(){var b=a.lecture_player.controls.getTime();a.last_fullscreen_state=a.fullscreen,a.last_video_state=!a.lecture_player.controls.paused(),p.set("note",!0),a.lecture_player.controls.pause(),B.isPhone()&&a.fullscreen?(a.temp_timeline_item={time:b,type:"note",data:null},h(function(){$(".note-textarea").focus(),$(".note-textarea").on("blur",function(){a.temp_timeline_item.data?fb(a.temp_timeline_item):nb()})})):(a.timeline.lecture[f.params.lecture_id].add(b,"note",null),a.last_timeline_state=!a.TimelineNavigator.getStatus(),db(),eb())};var fb=function(b){c.saveNote({course_id:f.params.course_id,lecture_id:f.params.lecture_id,note_id:null},{data:b.data,time:b.time},function(c){a.timeline.lecture[f.params.lecture_id].add(b.time,"note",c.note),nb()})};a.checkAnswer=function(){"html"==a.selected_quiz.quiz_type||"html_survey"==a.selected_quiz.quiz_type?gb():hb()};var gb=function(){a.answer_form.$error.atleastone||"Free Text Question"==a.selected_quiz.question_type&&a.answer_form.$error.required?(g.debug("invalid form"),a.submitted=!0):(g.debug("valid form"),a.submitted=!1,c.saveHtml({course_id:f.params.course_id,lecture_id:f.params.lecture_id},{quiz:a.selected_quiz.id,answer:a.studentAnswers[a.selected_quiz.id],in_group:4==a.distance_peer_status,distance_peer:null!=a.distance_peer_session_id},function(b){jb(b),"Free Text Question"==a.selected_quiz.question_type&&ib(a.studentAnswers[a.selected_quiz.id])}))},hb=function(){var b;if("OCQ"==a.selected_quiz.question_type||"MCQ"==a.selected_quiz.question_type){if(b=[],a.selected_quiz.online_answers.forEach(function(a){a.selected&&b.push(a.id)}),0==b.length)return ab("lectures.choose_correct_answer"),void 0;"OCQ"==a.selected_quiz.question_type&&1==b.length&&(b=b[0])}else if("Free Text Question"==a.selected_quiz.question_type){if(b=a.studentAnswers[a.selected_quiz.id],!b)return ab("global.required"),void 0}else{b={},b=a.studentAnswers[a.selected_quiz.id];var d=0;for(var e in b)b[e]&&d++;if(d<a.selected_quiz.online_answers.length)return ab("lectures.must_place_items"),void 0}c.saveOnline({course_id:f.params.course_id,lecture_id:f.params.lecture_id},{quiz:a.selected_quiz.id,answer:b,in_group:4==a.distance_peer_status,distance_peer:null!=a.distance_peer_session_id},function(c){jb(c),"Free Text Question"==a.selected_quiz.question_type&&ib(b)})},ib=function(b){b="Quiz: "+a.selected_quiz.question+"\nAnswer: "+b,c.saveNote({course_id:f.params.course_id,lecture_id:f.params.lecture_id,note_id:null},{data:b,time:a.selected_quiz.time},function(b){a.timeline.lecture[f.params.lecture_id].add(a.selected_quiz.time,"note",b.note)})},jb=function(b){a.distance_peer_session_id&&3==a.distance_peer_status?(yb(),T(4,a.selected_quiz.time,a.selected_quiz)):a.distance_peer_session_id&&4==a.distance_peer_status?(yb(),T(5,a.selected_quiz.end_time,a.selected_quiz)):kb(b)},kb=function(b){if("Empty"!=b.msg){var c="";if("survey"==a.selected_quiz.quiz_type||"html_survey"==a.selected_quiz.quiz_type||"FREE TEXT QUESTION"==a.selected_quiz.question_type.toUpperCase()&&b.review){if(a.selected_quiz.solved_quiz=!0,"survey"!=a.selected_quiz.quiz_type&&"html_survey"!=a.selected_quiz.quiz_type&&"html"!=a.selected_quiz.quiz_type&&"FREE TEXT QUESTION"!==a.selected_quiz.question_type.toUpperCase())var e=o.is_mobile?"lectures.tap_for_explanation":"lectures.hover_for_explanation";if("FREE TEXT QUESTION"==a.selected_quiz.question_type.toUpperCase()){c="lectures.messages.press_to_continue";for(var f in b.explanation)a.explanation[f]=b.explanation[f]}ab("lectures.messages.thank_you_answer",e||"",c||"")}else{for(var f in b.detailed_exp)a.explanation[f]=b.detailed_exp[f];var h=b.correct?"lectures.correct":"lectures.incorrect",e="";if("html"!=a.selected_quiz.quiz_type||"DRAG"!=a.selected_quiz.question_type.toUpperCase()&&"FREE TEXT QUESTION"!=a.selected_quiz.question_type.toUpperCase())"MCQ"!=a.selected_quiz.question_type.toUpperCase()||b.correct||(c="lectures.multiple_correct");else for(var f in b.explanation)a.explanation[f]=b.explanation[f];e=o.is_mobile?"lectures.tap_for_explanation":"lectures.hover_for_explanation","FREE TEXT QUESTION"==a.selected_quiz.question_type.toUpperCase()&&(c="lectures.messages.press_to_continue",e=""),b.correct||"DRAG"!=a.selected_quiz.question_type.toUpperCase()||"HTML"!=a.selected_quiz.quiz_type.toUpperCase()||(e=""),ab(h,e,c),a.selected_quiz.solved_quiz=!0}a.display_review_message=!0;var i=Math.round(100*(a.lecture_player.controls.getTime()/a.total_duration));g.debug("current watched: "+i),V(i,"solved_quiz")}d(function(){window.onmousemove=function(){bb(),a.$apply()}},1500,1)},lb=function(){var b=10,c=7.5;if("survey"!=a.selected_quiz.quiz_type&&!a.review_inclass&&!a.review_inclass_inprogress){g.debug("review inclass"),a.review_inclass_inprogress=!0;var e=b,f=mb(a.selected_quiz.time,b);f?e=(f-a.selected_quiz.time)/2:a.total_duration-a.selected_quiz.time<=b&&(e=(a.total_duration-a.selected_quiz.time)/2),d(function(){a.review_inclass_inprogress=!1,$("#review_inclass").fadeIn("fast"),d(function(){a.closeReviewNotify()},1e3*c,1)},1e3*e,1)}},mb=function(b,c){for(var d in a.lecture.video_quizzes)if(a.lecture.video_quizzes[d].time>b&&a.lecture.video_quizzes[d].time<=b+c)return a.lecture.video_quizzes[d].time};a.voteForReview=function(){g.debug("vote review"),k.voteForReview({online_quizzes_id:a.last_quiz.id},{},function(b){b.done&&(a.last_quiz.reviewed||(a.last_quiz.reviewed=!0,a.last_quiz.votes_count+=1),a.closeReviewNotify())})},a.unvoteForReview=function(){k.unvoteForReview({online_quizzes_id:a.last_quiz.id},{},function(b){b.done&&(a.last_quiz.reviewed&&(a.last_quiz.reviewed=!1,a.last_quiz.votes_count--),a.closeReviewNotify())})},a.closeReviewNotify=function(){$("#review_inclass").fadeOut("fast")},a.retryQuiz=function(){a.explanation={},a.selected_quiz=a.backup_quiz,a.seek_and_pause(a.backup_quiz.time),a.closeReviewNotify()},a.exportNotes=function(){c.exportNotes({course_id:f.params.course_id,lecture_id:f.params.lecture_id},function(b){for(var c,d=angular.fromJson(b),e=[],f=0;f<d.notes.length;f++)d.notes[f].length>2&&(c=angular.fromJson(d.notes[f]),e.push(c));a.Notes=e;var g=document.URL,h=g.split("lectures")[0],i=window.open("","_blank");if(i){i.focus();for(var k='<html><head><title>ScalableLearning - Export Notes</title><style>body{font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;}.table {width: 100%;margin-bottom: 20px; margin: 0 auto;background: white;border: 1px solid lightgrey;}.table td {padding: 8px;line-height: 20px;text-align: left;vertical-align: top;border-top: 1px solid #dddddd; border-right: 1px solid #dddddd;}.table th {font-weight: bold;}.table thead th {vertical-align: bottom;} a{color: green; text-decoration: none;} a:hover{color: darkgreen;}</style></head><body>',f=0;f<e.length;f++){k+='<table class="table" style="width:90%">',k+="<h3>"+e[f][0].lecture.name+"</h3>";for(var l=0;l<e[f].length;l++)k+="<tr>",k+="<td>"+j("formattime")(e[f][l].time,"hh:mm:ss")+"</td>",k+="<td>"+e[f][l].data+"</td>",k+='<td><a target="_blank" href="'+h+"lectures/"+e[f][l].lecture.id+"?time="+e[f][l].time+'">go to video</a></td>',k+="</tr>";k+="</table>"}k+="<br /><a href='data:Application/octet-stream,"+encodeURIComponent(k)+'\'Download = "Notes.html">Download Notes</a>',k+="</body></html>",i.document.write(k),i.document.close()}},function(){})},a.$on("note_updated",function(){nb()}),a.$on("discussion_updated",function(){nb()});var nb=function(){a.last_fullscreen_state&&!a.fullscreen&&cb(),a.last_video_state&&a.lecture_player.controls.paused()&&!a.quiz_mode&&a.lecture_player.controls.play(),a.last_timeline_state&&a.TimelineNavigator.getStatus()&&h(function(){a.TimelineNavigator.close()},400),ob()},ob=function(){a.temp_timeline_item=null,a.last_fullscreen_state=null,a.last_video_state=null,a.last_timeline_state=null};a.dismissAnnotation=function(){a.annotation=null},a.dismissDynmaicAnnotation=function(){a.dynmaic_annotation=null},a.dismissSlideNote=function(){a.slide_note=null},a.dismissQuestionText=function(){a.selected_quiz.actual_display_text=null},a.endDistancePeerSession=function(){a.dismissAnnotation(),a.dismissDynmaicAnnotation(),a.dismissSlideNote(),Y(),T(6,null)},a.lectureLayerClick=function(){a.quiz_mode||a.dynmaic_annotation&&(!a.dynmaic_annotation||a.dynmaic_annotation.as_slide)||a.toggleVideoPlayback()};var pb=function(){c.checkIfDistancePeerIsAlive({course_id:a.lecture.course_id,lecture_id:a.lecture.id,distance_peer_id:a.distance_peer_session_id}).$promise.then(function(b){"dead"==b.status&&(rb(),sb(e.instant("distance_peer.other_student_ended_session",{name:a.name})),D(),S(),yb(),Y())})},qb=function(){a.check_if_distance_peer_is_alive_timer=d(function(){pb()},2e4)},rb=function(){a.check_if_distance_peer_is_alive_timer&&d.cancel(a.check_if_distance_peer_is_alive_timer)},sb=function(b){a.dismissDynmaicAnnotation(),a.dismissSlideNote(),a.annotation=b},tb=function(b){a.dismissAnnotation(),a.dismissSlideNote(),a.dynmaic_annotation=b},ub=function(b){a.dismissAnnotation(),a.dismissDynmaicAnnotation(),a.slide_note=b},vb=function(){parseInt(a.lecture_player.controls.getTime().toFixed(2))>=parseInt(a.next_stop_time.toFixed(2))&&(a.seek(a.next_stop_time),a.lecture_player.controls.pause(),5==a.distance_peer_status?P(1):P(a.distance_peer_status+1))},wb=function(){0==a.status_counter?yb():a.status_counter--},xb=function(){a.status_timer=d(wb,1e3)},yb=function(){a.status_timer&&(d.cancel(a.status_timer),a.status_timer=null)},zb=function(b){a.status_counter=b},Ab=function(){a.check_peer_fuction_is_called=!0;var b=y.defer();return a.lecture?c.checkIfInDistancePeerSession({course_id:a.lecture.course_id,lecture_id:a.lecture.id}).$promise.then(function(c){if("no_peer_session"!=c.distance_peer){a.distance_peer_session_id=c.distance_peer.distance_peer_id,qb(),a.name=c.name,a.distance_peer_status=c.distance_peer.status,O();var d=a.lecture.video_quizzes.map(function(a){return a.id}).indexOf(c.distance_peer.online_quiz_id);if(1==a.distance_peer_status&&(a.next_stop_time=a.lecture.video_quizzes[d+1]?a.lecture.video_quizzes[d+1].start_time:a.total_duration),-1==d&&(d=0),a.lecture.video_quizzes[d]){if(5==a.distance_peer_status)a.next_stop_time=a.lecture.video_quizzes[d].end_time;else if(-1!=[2,3,4].indexOf(a.distance_peer_status)&&(a.next_stop_time=a.lecture.video_quizzes[d].time,-1!=[3,4].indexOf(a.distance_peer_status))){if(M(a.lecture.video_quizzes[d]),3==a.distance_peer_status)var e=a.lecture.video_quizzes[d].self;else var e=a.lecture.video_quizzes[d].in_group;zb(e),xb()}if(!(a.lecture.video_quizzes[d].id in a.quiz_cue_distance_peer_list)){var f=a.lecture_player.controls.cue(a.next_stop_time,function(){U(a.lecture.video_quizzes[d])});a.quiz_cue_distance_peer_list[a.lecture.video_quizzes[d].id]=f.id}}else a.next_stop_time=a.total_duration}b.resolve()}):b.resolve(),b.promise};a.openStudentList=function(b,f){w.open({templateUrl:"/views/student/inclass/distance_peer_modal.html",scope:a,controller:["$modalInstance",function(g){a.waiting_response_of_back_end=!0,a.check_if_invited=!1,a.wait_for_acceptance=!1,a.invite_student=!1,a.invited_student={},a.loading_students=!0,a.inviteStudent=function(d){a.waiting_response_of_back_end=!0,a.invite_student=!1,c.invitedStudent({course_id:f,lecture_id:b,email:d.email}).$promise.then(function(b){a.waiting_response_of_back_end=!1,a.check_if_invited=!1,a.wait_for_acceptance=!0,a.invite_student=!1,a.invited_student=d.email,a.distance_peer_id=b.distance_peer_id,i()})},a.changeToInviteStatus=function(){a.waiting_response_of_back_end=!1,a.check_if_invited=!1,a.wait_for_acceptance=!1,a.invite_student=!0,a.invited_student={}},a.checkIfInvitedByOrInvited=function(){c.checkIfInvited({course_id:f,lecture_id:b}).$promise.then(function(b){"no_invitation"==b.invite_status?(a.waiting_response_of_back_end=!1,a.check_if_invited=!1,a.wait_for_acceptance=!1,a.invite_student=!0,a.students=b.students):"invited"==b.invite_status?(a.waiting_response_of_back_end=!1,a.check_if_invited=!1,a.wait_for_acceptance=!0,a.invite_student=!1,a.invited_student=b.invite,a.distance_peer_id=b.distance_peer_id,i()):"invited_by"==b.invite_status&&(a.waiting_response_of_back_end=!1,a.check_if_invited=!0,a.cancelled_invited_by_student=null,a.wait_for_acceptance=!1,a.invite_student=!1,a.invited_by_student=b.invite)})},a.acceptInvation=function(d){c.acceptInvation({course_id:f,lecture_id:b,email:d[0],distance_peer_id:d[1]}).$promise.then(function(b){if("cancelled"!=b.status)a.distance_peer_session_id=d[1],a.closeModal();else{var c=a.invited_by_student.findIndex(function(a){return a[1]==d[1]});a.invited_by_student.splice(c,1),a.cancelled_invited_by_student=e.instant("distance_peer.student_cancelled",{name:d[0]})}})},a.caneclAllDistancePeerSession=function(){a.invited_by_student.forEach(function(b){a.caneclDistancePeerSession(b[1])})},a.caneclDistancePeerSession=function(a){c.caneclDistancePeerSession({course_id:f,lecture_id:b,distance_peer_id:a}),j()};var h=function(d,e){c.checkInvitedStudentAccepted({course_id:f,lecture_id:b,email:d,distance_peer_id:e}).$promise.then(function(b){0!=b.status&&(j(),"denied"==b.status?a.invited_student+=" denied your invation":(1==b.status||2==b.status)&&(a.distance_peer_session_id=a.distance_peer_id,a.closeModal()))})},i=function(){a.check_invited_student_accepted_timer=d(function(){h(a.invited_student,a.distance_peer_id)},5e3)},j=function(){a.check_invited_student_accepted_timer&&d.cancel(a.check_invited_student_accepted_timer),a.session_votes=null};a.closeModal=function(){g.dismiss("cancel"),j()},a.checkIfInvitedByOrInvited()}]})},F()}]),angular.module("scalearAngularApp").controller("studentInclassCtrl",["$scope","ContentNavigator","MobileDetector","Module","$state","$log","$interval","Lecture","Page","WizardHandler","$cookieStore","CourseModel","ModuleModel","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){c.isPhone()&&n(function(){b.close()});var o=k.get("self_answers")||[],p=k.get("group_answers")||[],q=["noclass","intro","self","group","discussion"];a.course=l.getSelectedCourse(),a.module=m.getSelectedModule(),i.setTitle(a.module.name+": In-class - "+a.course.name);var r=function(b){d.getInclassStudentStatus({module_id:e.params.module_id,course_id:e.params.course_id,status:a.inclass_status||0,quiz_id:a.quiz?a.quiz.id:-1},b)};a.getInclassStudentStatus=function(){a.loading=!0,r(function(b){a.loading=!1,b.updated&&(a.quiz=b.quiz,a.quiz.in_group=!1,a.group_quiz=angular.copy(a.quiz),a.group_quiz.in_group=!0,a.lecture=b.lecture,$(".answer_choices input").attr("type","MCQ"==a.quiz.question_type?"checkbox":"radio"),o.length>0&&o.forEach(function(b){var c=a.quiz.answers.filter(function(a){return a.id==b.id});c.length&&(c[0].selected=!0)}),p.length>0&&p.forEach(function(b){var c=a.group_quiz.answers.filter(function(a){return a.id==b.id});c.length&&(c[0].selected=!0)}),a.note={self:"",group:""},a.last_note={self:"",group:""}),a.inclass_status!=b.status?(a.inclass_status=b.status,j.wizard().goTo(q[a.inclass_status]),a.inclass_status<2&&(y(),a.note={self:"",group:""},a.last_note={self:"",group:""})):(2==a.inclass_status||3==a.inclass_status)&&(a.showWaitNotification("Please wait for the teacher to continue."),g(function(){a.removeWaitNotification()},5e3,1))})},a.getInclassStudentStatus();var s=function(b){b.answers.forEach(function(a){a.selected=!1}),2==a.inclass_status?o=[]:3==a.inclass_status&&(p=[])},t=function(b,c){("OCQ"==b.question_type||"MCQ"==b.question_type)&&h.saveOnline({course_id:e.params.course_id,lecture_id:a.lecture.id},{quiz:b.id,answer:c,in_group:b.in_group,inclass:!0})},u=function(b){var c;if("OCQ"==b.question_type||"MCQ"==b.question_type){if(c=[],b.answers.forEach(function(a){a.selected&&c.push(a.id)}),0==c.length)return a.showNotification("lectures.messages.please_choose_an_answer"),!1;"OCQ"==b.question_type&&1==c.length&&(c=c[0])}return b.done=!0,t(b,c),!0},v=function(b,c){h.saveHtml({course_id:e.params.course_id,lecture_id:a.lecture.id},{quiz:b.id,answer:c,in_group:b.in_group,inclass:!0})},w=function(){var b={},c=0,d=null;if("OCQ"==quiz.question_type||"MCQ"==quiz.question_type){if(quiz.answers.forEach(function(a){b[a.id]=a.selected,a.selected&&(c++,d=a.id)}),0==c)return a.showNotification("lectures.messages.please_choose_an_answer"),!1;"OCQ"==quiz.question_type&&d&&(b=d)}return quiz.done=!0,v(quiz,b),!0},x=function(b,c,d){h.saveNote({course_id:e.params.course_id,lecture_id:a.lecture.id,note_id:null},{data:(d?"In Class Group Note: ":"In Class Self Note: ")+b,time:c},function(){a.last_note[d?"group: ":"self"]=b})};a.checkAnswer=function(b,c){a.removeNotification();var d="html"==b.quiz_type?w(b):u(b);d&&(c&&a.last_note[b.in_group?"group: ":"self"]!==c&&x(c,Math.ceil(b.time),b.in_group),j.wizard().next())},a.showNotification=function(b){a.alert_message=b},a.removeNotification=function(){a.alert_message=""},a.showWaitNotification=function(b){a.wait_alert_message=b},a.removeWaitNotification=function(){a.wait_alert_message=""},a.retry=function(a){a.done=!1,s(a)},a.intToChar=function(a){return String.fromCharCode(97+a).toUpperCase()};var y=function(){k.remove("self_answers"),k.remove("group_answers")},z=function(a,b){k.put("self_answers",a),k.put("group_answers",b)};a.selectAnswer=function(b,c){b.selected?(2==a.inclass_status?o=o.filter(function(a){return a.id!=b.id}):3==a.inclass_status&&(p=p.filter(function(a){return a.id!=b.id})),b.selected=!1):("OCQ"==a.quiz.question_type&&s(c),b.selected=!0,2==a.inclass_status?o.push(b):3==a.inclass_status&&p.push(b)),y(),z(o,p)},a.retry=function(b){r(function(c){"self"==b&&3==c.status||"group"==b&&4==c.status?(a.showWaitNotification("Please click on 'Next' to continue."),g(function(){a.removeWaitNotification()},5e3)):j.wizard().previous()})}}]),angular.module("scalearAngularApp").controller("studentQuizMiddleCtrl",["$scope","Course","$stateParams","$controller","Quiz","$log","CourseEditor","$state","Page","ScalearUtils","$translate","ContentNavigator","CourseModel","ItemsModel","QuestionModel","ErrorHandler","MobileDetector",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){d("surveysCtrl",{$scope:a}),a.course=m.getSelectedCourse(),a.quiz=n.getQuiz(c.quiz_id);var r=function(){q.isPhone()||l.open(),o.getSolvableQuestions().then(function(b){var c=b.quiz;if(!a.preview_as_student)for(var d in c.requirements)for(var e in c.requirements[d]){var f=n.getById(c.requirements[d][e],d);f.done||(a.passed_requirments=!1)}a.quiz.questions=b.questions,a.studentAnswers=b.quiz_grades,a.status=b.status,a.correct=b.correct,a.explanation=b.explanation,a.next_item=b.next_item,a.alert_messages=b.alert_messages,a.course.warning_message=s(a.alert_messages),a.quiz.questions.forEach(function(c,d){c.answers=b.answers[d],"DRAG"==c.question_type.toUpperCase()&&null==a.studentAnswers[c.id]&&(a.studentAnswers[c.id]=c.answers[0].content)})}),"survey"==a.quiz.quiz_type&&a.getSurveyCharts("display_only",a.quiz.group_id,a.quiz.id)};a.nextItem=function(){var b="course.module.courseware."+a.next_item.class_name,c=a.next_item.class_name+"_id",d={};d[c]=a.next_item.id,d.module_id=a.next_item.group_id,f.debug(b),h.go(b,d)},a.saveQuiz=function(b){a.save_inprogress=!0,a.form.$valid||"save"==b?(a.submitted=!1,a.quiz.studentSolve(a.studentAnswers,b).then(function(b){a.save_inprogress=!1,a.status=b.status,a.alert_messages=b.alert_messages,a.course.warning_message=s(a.alert_messages),a.next_item=b.next_item,b.correct&&(a.correct=b.correct),b.explanation&&(a.explanation=b.explanation),b.done[2]&&a.quiz.markDone()})):(a.save_inprogress=!1,a.submitted=!0)};var s=function(b){for(var c in b){if("submit"==c)return k.instant("quizzes.already_submitted")+" "+a.quiz.quiz_type+" "+k.instant("quizzes.no_more_attempts");if("due"==c)return k.instant("events.due_date_passed")+" - "+a.alert_messages[c][0]+" ("+a.alert_messages[c][1]+" "+a.alert_messages[c][2]+") "+k.instant("time.ago");if("today"==c)return k.instant("events.due")+" "+k.instant("time.today")+" "+k.instant("at")+" "+a.alert_messages[c]}};a.quiz&&(n.setSelectedItem(a.quiz),a.course.warning_message=null,a.studentAnswers={},a.passed_requirments=!0,i.setTitle(a.quiz.name),r())}]),angular.module("scalearAngularApp").controller("StudentGettingStartedCtrl",["$scope","$location","$anchorScroll","$rootScope","Page","scalear_api","$translate",function(a,b,c,d,e,f,g){e.setTitle("help.getting_started"),d.subheader_message=g.instant("help.getting_started"),a.intro_url=f.student_welcom_video,a.scroll=function(a){$("body").scrollToThis(0,{offsetTop:0,duration:0}),$("body").scrollToThis("#"+a,{offsetTop:95,duration:0})
}}]),angular.module("scalearAngularApp").controller("UsersTeacherCtrl",["$scope","User","$state","Page","$log",function(a,b,c){c.go("login")}]),angular.module("scalearAngularApp").controller("UsersStudentCtrl",["$scope","User","$state","Page","$filter",function(a,b,c){c.go("login")}]),angular.module("scalearAngularApp").controller("UsersSignUpCtrl",["$scope","User","$state","Page","$filter","$location","ngDialog","$modal",function(a,b,c,d,e,f,g,h){d.setTitle("account.sign_up");var i=function(){a.user.screen_name=e("anonymous")(10*Math.random()+a.user.email,"user")},j=function(){a.user={},a.saml_user={},angular.forEach(f.$$search,function(a,b){this[b]=a.replace(/\+/g," ")},a.saml_user),a.is_saml=a.saml_user.saml,a.user.email=a.saml_user.mail||c.params.input1||"",a.user.name=a.saml_user.givenName||"",a.user.last_name=a.saml_user.sn||"",a.user.university=a.saml_user.o||"",a.user.password=c.params.input2||"",i()};j(),a.signUp=function(){a.is_saml?(a.user.saml=a.is_saml,b.samlSignup({},{user:a.user}).$promise.then(function(){c.go("confirmed")}).catch(function(b){a.user.errors=b.data.errors})):(a.user.password_confirmation||(a.user.password_confirmation=" "),delete a.user.errors,b.signUp({},a.user,function(){c.go("thanks_for_registering",{email:a.user.email})},function(b){b.data.errors.school_provider?h.open({templateUrl:"/views/school_provider_modal.html",controller:["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss()}}],scope:a}):a.user.errors=b.data.errors}))},a.$watch("user.email",function(){i()})}]),angular.module("scalearAngularApp").controller("UsersPasswordNewCtrl",["$scope","User","$state","Page","ngDialog",function(a,b,c,d,e){d.setTitle("account.password.new_password"),a.user={},a.reset_password=function(){a.sending=!0,delete a.user.errors,b.reset_password({},{email:a.user.email,redirect_url:location.protocol+"//"+location.host+"/#/users/password/edit"},function(){a.sending=!1,c.go("forgot_password_confirmation",{email:a.user.email})},function(b){a.sending=!1,b.data.saml?e.open({template:"passwordDialog",className:"ngdialog-theme-default ngdialog-theme-custom",showClose:!1,preCloseCallback:function(){c.go("login")}}):a.user.errors=b.data.errors})},a.$watch("current_lang",function(b,c){b!=c&&delete a.user.errors})}]),angular.module("scalearAngularApp").controller("UsersPasswordEditCtrl",["$scope","User","$state","$stateParams","$rootScope","Page","Token","UserSession",function(a,b,c,d,e,f,g,h){f.setTitle("account.password.resetting"),a.user={},a.user["access-token"]=d.token,a.user.uid=d.uid,a.user.client=d.client_id,a.change_password=function(){g.setToken(a.user),delete a.user.errors,b.change_password({},a.user,function(a){h.signIn(a.data).then(function(){c.go("dashboard")})},function(b){a.user.errors=b.data.errors})},a.$watch("current_lang",function(b,c){b!=c&&delete a.user.errors})}]),angular.module("scalearAngularApp").controller("UsersConfirmationNewCtrl",["$scope","User","$state","Page",function(a,b,c,d){d.setTitle("account.resend_confirmation"),a.user={},a.resend=function(){delete a.user.errors,a.sending=!0,b.resend_confirmation({},{email:a.user.email},function(){a.sending=!1,c.go("login")},function(b){a.sending=!1,a.user.errors=b.data.errors})},a.$watch("current_lang",function(b,c){b!=c&&delete a.user.errors})}]),angular.module("scalearAngularApp").controller("UsersConfirmationShowCtrl",["$scope","User","$state","$stateParams","$timeout","$rootScope","UserSession","Page","$log","$modal","ErrorHandler","$translate",function(a,b,c,d,e,f,g,h,i,j,k,l){h.setTitle("account.confirm_account"),a.user={},a.sending=!0,i.debug("showing confirmation "),i.debug(d),b.show_confirmation({confirmation_token:d.confirmation_token},function(b){a.sending=!1,"confirmed"==b.data?(a.user_email=b.user_email,j.open({template:"<style>.reveal-modal{height:auto;overflow: hidden;}</style><center><span translate='account.account_confirmed' translate-values='{ email: user_email}'></span><span translate>global.please</span> <a class='tiny' ng-click='goTo()' translate>account.login</a> <span translate>account.start_using</span>ScalableLearning.<br><Small translate>account.go_to_support</small></center>",scope:a,controller:["$modalInstance",function(b){a.goTo=function(){c.go("login",{email:a.user_email}),b.dismiss("cancel")}}]})):"invalid"==b.data?j.open({template:"<style>.reveal-modal{height:auto;overflow: hidden;}</style><center><span translate>account.invalid_confirmation</span><br><span translate>account.already_confirmation</span> <a class='tiny' ng-click='goTo()' translate>account.click_here</a> <span translate>global.to</span> <span translate>navigation.login</span>.<br><span translate>account.new_confirmation</span> <a ui-sref='new_confirmation' ng-click='closeModal()' translate>account.click_here</a>.<br><Small translate>account.go_to_support</small></center>",scope:a,controller:["$modalInstance",function(b){a.goTo=function(){c.go("login",{email:a.user_email}),b.dismiss("cancel")},a.closeModal=function(){b.dismiss("cancel")}}]}):"confirm_change_email"==b.data?(k.showMessage(l.instant("error_message.confirm_change_email"),"errorMessage",4e3,"success"),g.allowRefetchOfUser(),e(function(){c.go("course_list")},1e3)):(g.allowRefetchOfUser(),e(function(){c.go("confirmed")},2500))},function(b){a.sending=!1,a.user.errors=b.data}),a.$watch("current_lang",function(b,c){b!=c&&delete a.user.errors})}]),angular.module("scalearAngularApp").controller("UsersEditCtrl",["$rootScope","$scope","User","$state","$modal","Page","$translate","UserSession",function(a,b,c,d,e,f,g,h){f.setTitle("navigation.account_information"),b.dayNamesOption=[{id:0,name:full_calendar_en.dayNames[0]},{id:1,name:full_calendar_en.dayNames[1]},{id:2,name:full_calendar_en.dayNames[2]},{id:3,name:full_calendar_en.dayNames[3]},{id:4,name:full_calendar_en.dayNames[4]},{id:5,name:full_calendar_en.dayNames[5]},{id:6,name:full_calendar_en.dayNames[6]}],a.subheader_message=g.instant("navigation.account_information"),h.getCurrentUser().then(function(a){b.user={screen_name:a.screen_name,name:a.name,last_name:a.last_name,university:a.university,email:a.email,link:a.link,bio:a.bio,saml:a.saml,first_day:b.dayNamesOption[a.first_day]}}),a.$watch("current_lang",function(a,c){a!=c&&delete b.user.errors}),b.confirmDelete=function(){e.open({templateUrl:"/views/users/confirm_delete.html",controller:"ConfirmDeleteCtrl",resolve:{user_new:function(){return b.user}}})},b.openRequirePassword=function(){delete b.user.errors,b.user.saml?(b.user.first_day=b.user.first_day.id,c.update_account({},b.user,function(){h.allowRefetchOfUser(),d.go("home")},function(a){b.user.errors=a.data.errors,b.user.first_day=b.dayNamesOption[b.user.first_day]})):e.open({templateUrl:"/views/users/update_account_info.html",controller:"SaveAccountCtrl",resolve:{user_new:function(){return b.user},day_options:function(){return b.dayNamesOption}}})}}]),angular.module("scalearAngularApp").controller("ConfirmDeleteCtrl",["$scope","$modalInstance","User","$log","$window","$rootScope","$state","user_new","UserSession",function(a,b,c,d,e,f,g,h,i){e.scrollTo(0,0),a.form={},a.user=h,a.deleteAccount=function(){a.user.saml||a.form.key.$valid?(a.form.processing=!0,i.deleteUser(a.user.pass).then(function(){a.form.processing=!1,b.close(),g.go("login")}).catch(function(b){a.form.processing=!1,a.form.server_error=b.data.errors.join()})):a.form.submitted=!0},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("SaveAccountCtrl",["$scope","$modalInstance","User","$log","$window","$state","user_new","ErrorHandler","$translate","UserSession","day_options",function(a,b,c,d,e,f,g,h,i,j,k){e.scrollTo(0,0),a.user=g,a.dayNamesOption=k,a.update_account=function(){console.log(a.user),a.sending=!0,delete a.user.errors,a.user.first_day=a.user.first_day.id,c.update_account({},a.user,function(){b.close(),0==a.user.intro_watched?f.go("confirmed"):(j.allowRefetchOfUser(),a.user.first_day=a.dayNamesOption[a.user.first_day])},function(c){a.sending=!1,a.user.errors=c.data.errors,a.user.first_day=a.dayNamesOption[a.user.first_day],a.user.current_password=null,c.data.errors.current_password||b.close()})},a.cancel=function(){a.user.current_password=null,b.dismiss("cancel")}}]),angular.module("scalearAngularApp").controller("ThanksForRegisteringCtrl",["$scope","Page","$state",function(a,b,c){b.setTitle("Thanks for Registering"),a.user_email=c.params.email}]),angular.module("scalearAngularApp").controller("ForgotPasswordConfirmationCtrl",["$scope","Page","$state",function(a,b,c){b.setTitle("Reset Password"),a.user_email=c.params.email}]),angular.module("scalearAngularApp").controller("UsersConfirmedCtrl",["$scope","$rootScope","User","UserSession","$state","$interval","Page","scalear_api","$translate","$log","ngDialog","URLInformation","$window",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.user_email=e.params.type,a.remaining=5,a.show_ending=!1,a.privacy_approved=!1,a.player={},a.player.controls={},a.player.events={},g.setTitle("Welcome to ScalableLearning"),b.subheader_message=i.instant("intro.title"),a.student_or_teacher=null,d.getCurrentUser().then(function(b){a.current_user=b,a.privacyPopover()}),a.player.events.onEnd=function(){a.show_ending=!0,f(function(){a.remaining--,0==a.remaining&&a.watchedIntro()},1e3,5)},a.set_student_or_teacher=function(b){a.student_or_teacher=!0,"S"==b?(a.student=!0,a.intro_url=h.student_welcom_video):(a.student=!1,a.intro_url=h.teacher_welcome_video)},a.watchedIntro=function(){var b={};b.intro_watched=!0,c.updateCompletionWizard({id:a.current_user.id},{completion_wizard:b},function(){d.allowRefetchOfUser(),l.hasEnroll()&&(m.location.href=l.getEnrollLink(),l.clearEnrollLink()),e.go("course_list")})},a.privacyPopover=function(){k.openConfirm({template:"/views/privacy_popover.html",className:"ngdialog-theme-default dialogwidth800",showClose:!1,scope:a}).then(function(){a.privacy_approved=!0},function(){b.busy_loading=!0,d.logout().then(function(){e.go("login"),b.busy_loading=!1})})}}]),angular.module("scalearAngularApp").controller("statisticsCtrl",["$scope","Kpi","Page","$rootScope","$translate","$modal",function(a,b,c,d,e,f){c.setTitle("statistics.statistics"),d.subheader_message=e.instant("statistics.statistics_dashboard"),a.close_selector=!1;var g=function(){a.loading_totals=!0,b.readTotals({},function(b){angular.extend(a,b),a.loading_totals=!1},function(){}),b.readSeries({},function(b){a.collection=b.series,a.selected_series=a.collection[0],a.getSeriesData(a.selected_series)},function(){}),h()},h=function(){a.chartConfig={options:{chart:{zoomType:"x",spacingRight:20},tooltip:{shared:!0},legend:{enabled:!1},subtitle:{text:void 0===document.ontouchstart?e.instant("statistics.drag_to_zoom"):e.instant("statistics.pinch_to_zoom")},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},lineWidth:1,marker:{enabled:!1},shadow:!1,states:{hover:{lineWidth:1}},threshold:null},line:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},lineWidth:1,states:{hover:{lineWidth:1}},marker:{enabled:!1},threshold:null}}},series:[{type:"line",name:"#",pointInterval:864e5,data:[],pointStart:Date.UTC(2013,0,1)}],title:{text:null},xAxis:{type:"datetime",title:{text:null}},yAxis:{min:0,max:null,title:{text:null}},loading:!1}};a.getSeriesData=function(c){a.selected_series=c;var d=[];a.chartConfig.loading=!0;var f=new Date("2013-01-01").toISOString().split("T")[0],g=(new Date).toISOString().split("T")[0];b.readData({key:c,start:f,end:g},function(b){b.data.forEach(function(a,b){d[b]=a.value}),a.chartConfig.series[0].data=d,a.chartConfig.title.text=e.instant("statistics."+c.toLowerCase())+" "+e.instant("statistics.rate_from")+" "+f+" "+e.instant("statistics.to")+" "+g,a.chartConfig.loading=!1,a.stats_title="statistics."+a.selected_series.toLowerCase()},function(){})},a.toggleSelector=function(){a.close_selector=!a.close_selector},a.emailForm=function(){f.open({templateUrl:"/views/teacher/course/system_email.html",controller:"systemEmailCtrl"})},g()}]),angular.module("scalearAngularApp").controller("schoolStatisticsCtrl",["$scope","Kpi","Page","$rootScope","$translate","$modal","$q","ScalearUtils","UserSession","User","ErrorHandler",function(a,b,c,d,e,f,g,h,i,j,k){function l(){a.total_hours=0,a.total_online_quiz_solved=0,a.total_questions=0,a.total_questions_answered_students=0,a.total_questions_answered_teachers=0,a.total_student_watched=0,a.total_course_been_watched=0,a.total_online_quiz_course=0,a.total_online_quiz_lecture=0,a.total_online_quiz_student=0,a.total_questions_students=0,a.total_questions_courses=0,a.total_questions_lectures=0,a.total_hours_string=h.toHourMin(a.total_hours),a.total_student_watched_string=h.toHourMin(a.total_student_watched),a.total_course_been_watched_string=h.toHourMin(a.total_course_been_watched),o=0,p=0,q=0,r=0,s=0}function m(){var b=g.defer(),c={};return a.report.start_date=new Date(a.report.start_date),a.report.end_date=new Date(a.report.end_date),"Invalid Date"==a.report.start_date?(c.start_date="not a Date",b.reject(c)):"Invalid Date"==a.report.end_date?(c.end_date="not a Date",b.reject(c)):a.report.start_date<a.report.end_date?(c.start_date=null,c.end_date=null,b.resolve(c)):(c.start_date="must be before end date",b.reject(c)),a.report.start_date=moment(a.report.start_date).format("DD-MMMM-YYYY"),a.report.end_date=moment(a.report.end_date).format("DD-MMMM-YYYY"),b.promise}function n(c){b.getReportDataCourseDuration({start_date:a.report.start_date,end_date:a.report.end_date,course_ids:c},function(b){t-=c.length,o+=b.total_hours,p+=b.total_online_quiz_solved,q+=b.total_questions,r+=b.total_questions_answered_students,s+=b.total_questions_answered_teachers,angular.forEach(b.course_data,function(b,c){b.id=c,b.total_view_string=h.toHourMin(b.total_view),b.active_view_string=h.toHourMin(b.active_view),b.total_view=b.total_view,b.active_view=b.active_view,a.course_data_array.push(b)}),0==t&&(a.loading=!1,a.total_hours=o,a.total_online_quiz_solved=p,a.total_questions=q,a.total_questions_answered_students=r,a.total_questions_answered_teachers=s,total_students=0==a.total_students?1:a.total_students,total_courses=0==a.total_courses?1:a.total_courses,total_lectures=0==a.total_lectures?1:a.total_lectures,a.total_student_watched=a.total_hours/total_students,a.total_course_been_watched=a.total_hours/total_courses,a.total_online_quiz_course=(a.total_online_quiz_solved/total_courses).toFixed(1),a.total_online_quiz_lecture=(a.total_online_quiz_solved/total_lectures).toFixed(1),a.total_online_quiz_student=(a.total_online_quiz_solved/total_students).toFixed(1),a.total_questions_students=(a.total_questions/total_students).toFixed(1),a.total_questions_courses=(a.total_questions/total_courses).toFixed(1),a.total_questions_lectures=(a.total_questions/total_lectures).toFixed(1),a.total_hours_string=h.toHourMin(a.total_hours),a.total_student_watched_string=h.toHourMin(a.total_student_watched),a.total_course_been_watched_string=h.toHourMin(a.total_course_been_watched))})}c.setTitle("statistics.statistics"),d.subheader_message=e.instant("statistics.statistics_dashboard"),i.getCurrentUser().then(function(b){j.getSubdomains({id:b.id},function(b){a.subdomains=b.subdomains,1==a.subdomains.length?a.report.selected_domain=a.subdomains[0]:(a.report.selected_domain="All",a.subdomains.unshift("All"))})}),a.show_statistics=!1,a.report={},a.errors={},a.total_hours=0,a.total_online_quiz_solved=0,a.total_questions=0,a.total_questions_answered_students=0,a.total_questions_answered_teachers=0;var o=0,p=0,q=0,r=0,s=0,t=0;a.report.start_date=moment().subtract(30,"days").format("DD-MMMM-YYYY"),a.report.end_date=moment().format("DD-MMMM-YYYY"),a.showStatistics=function(){m().then(function(c){a.loading=!0,a.show_statistics=!1,l(),b.readTotalsForDuration({start_date:a.report.start_date,end_date:a.report.end_date,domain:a.report.selected_domain},function(b){a.show_statistics=!0;var c=100;for(a.total_courses=b.total_courses,a.total_students=b.total_students,a.total_teachers=b.total_teachers,a.total_lectures=b.total_lectures,t=b.course_ids.length,a.course_data_array=[];b.course_ids.length>0;)n(b.course_ids.splice(0,c))}),angular.extend(a.errors,c)}).catch(function(b){return a.show_statistics=!1,angular.extend(a.errors,b),!0})},a.exportCSV=function(){b.exportSchoolStatistics({start_date:a.report.start_date,end_date:a.report.end_date,domain:a.report.selected_domain},function(a){a.notice&&k.showMessage(e.instant("error_message.export_school_administration"),"errorMessage",4e3,"success")})},a.sortting={total_view_string:function(a){return a.total_view},active_view_string:function(a){return a.active_view}}}]),angular.module("scalearAngularApp").controller("welcomeMessageCtrl",["$scope","Kpi","Page","$rootScope","$translate","$modal","$q","ScalearUtils","UserSession","User","ErrorHandler",function(a,b,c,d,e,f,g,h,i,j,k){function l(){i.getCurrentUser().then(function(b){a.user=b,j.getWelcomeMessage({id:a.user.id},function(b){a.loading=!1,a.welcome_message=b.welcome_message,a.domain=b.domain})})}c.setTitle("navigation.welcome_message"),d.subheader_message=e.instant("navigation.welcome_message"),a.loading=!0,l(),a.submitWelcomeMessage=function(){j.submitWelcomeMessage({id:a.user.id},{welcome_message:a.welcome_message},function(){k.showMessage(e.instant("error_message.welcome_message_updated"),"errorMessage",4e3,"success")})}}]),angular.module("scalearAngularApp").controller("dashboardCtrl",["$scope","$state","$stateParams","Dashboard","NewsFeed","Page","$timeout","$rootScope","$compile","$translate","$filter","$location","Module","ErrorHandler","$interval","Lecture","Quiz","UserSession","ScalearUtils",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){angular.element("#studentCalendar").fullCalendar("render")}function t(b,c){$(".tooltip.tip-top").remove(),c.attr({"tooltip-html-unsafe":b.tooltip_string,"tooltip-append-to-body":!0,"tooltip-placement":"bottom"}),i(c)(a)}function u(){a.uiConfig={calendar:{header:{right:"today prev,next",left:"title"},eventRender:t,eventDrop:v,firstDay:C.first_day}},a.uiConfig.calendar.editable=!0,angular.extend(a.uiConfig.calendar,"en"==a.current_lang?full_calendar_en:full_calendar_sv)}function v(a,b,c){var d={due_date:a.start};a.lecture_id?p.update({course_id:a.course_id,lecture_id:a.lecture_id},{lecture:d},function(a){w(a)},function(b){x(b,c,a,"Lecture")}):a.quiz_id?q.update({course_id:a.course_id,quiz_id:a.quiz_id},{quiz:d},function(a){w(a)},function(b){x(b,c,a,"Quiz")}):m.update({course_id:a.course_id,module_id:a.group_id},{group:d},function(a){w(a)},function(b){x(b,c,a,"Module")})}function w(a){a.notice&&n.showMessage(j.instant("error_message.due_date_changed"),"errorMessage",4e3,"success")}function x(a,b,c,d){if(b(),"must be before due time"==a.data.errors[Object.keys(a.data.errors)[0]][0])var e=j.instant("events.drag_due_date_error_part_1")+d+j.instant("events.drag_due_date_error_part_2")+d+j.instant("events.drag_due_date_error_part_3");else var e=Object.keys(a.data.errors)[0].replace("_"," ")+" "+a.data.errors[Object.keys(a.data.errors)[0]][0];n.showMessage(e,"errorMessage",4e3,"error")}function y(b){var c=Intl.DateTimeFormat().resolvedOptions().timeZone;a.calendar_url=l.absUrl().replace("/#","")+"/dynamic_url?tz="+c+"&key="+b,a.calendar_pop={content:"<div ng-click='preventDropDownHide($event)'><div><b>Subscribe to Calendar:</b></div><div style='padding: 5px;word-wrap: break-word;'>{{calendar_url}}</div></div>",html:!0,placement:"right"}}function z(){d.getDashboard({},function(c){u(),B(c.module_summary_id_list),y(c.key),a.calendar=c;for(var d in a.calendar.events){var e=a.calendar.events[d];e.start=new Date(e.start),e.item_title=e.title.replace(" due",""),e.title=e.course_short_name+": "+e.item_title,e.tooltip_string=e.title+"<br />"+j.instant("events.due")+" "+j.instant("global.at")+" "+k("date")(e.start,"HH:mm"),1==e.status?e.tooltip_string+="<br />"+j.instant("events.completed_on_time"):2==e.status&&(e.tooltip_string+="<br />"+j.instant("events.completed")+" "+e.days+" "+j.instant("time.days")+" "+j.instant("events.late"));var f={course_id:e.course_id,module_id:e.group_id},h="course.module";2==e.role?(h+=".courseware",e.quiz_id?(h+=".quiz",f.quiz_id=e.quiz_id):e.lecture_id&&(h+=".lecture",f.lecture_id=e.lecture_id),e.editable=!1):h=".progress",e.url=b.href(h,f,{absolute:!0})}a.calendar.className=["truncate"],a.eventSources.push({events:a.calendar.events}),g(function(){s()},300)})}function A(){e.index({},function(b){a.events=[],a.latest_announcements=b.latest_announcements,a.latest_announcements.forEach(function(b){b.timestamp=b.updated_at,a.events.push(b),g(function(){s()},300)})})}function B(b){a.module_summary_id_list=b,a.module_summary={},b.forEach(function(b){var c=b[0],d=b[1],e=b[2];a.module_summary[c]={type:e},a.module_summary[c].loading={summary:!0,online_quiz:!0,discussion:!0},m.getModuleSummary({module_id:c,course_id:d},function(b){"teacher"==b.module.type&&(a.course_id=d),a.module_summary[c].loading.summary=!1,angular.extend(a.module_summary[c],b.module)}),m.getOnlineQuizSummary({module_id:c,course_id:d},function(b){a.module_summary[c].loading.online_quiz=!1,angular.extend(a.module_summary[c],b.module)}),m.getDiscussionSummary({module_id:c,course_id:d},function(b){a.module_summary[c].loading.discussion=!1,angular.extend(a.module_summary[c],b.module)})})}f.setTitle("navigation.dashboard"),f.startTour(),h.subheader_message=j.instant("dashboard.whats_new"),a.eventSources=[],a.module_summary_data=[];var C=null;r.getCurrentUser().then(function(a){C=a,z(),A()}),a.toggleLargeCalendar=function(){a.large_calendar=!a.large_calendar,g(function(){s()})},a.preventDropDownHide=function(a){a.preventDefault(),a.stopPropagation()},a.exportCalendar=function(){var b=ics();a.calendar.events.__id&&delete a.calendar.events.__id;for(var c in a.calendar.events){var d=a.calendar.events[c].tooltip_string.replace("<br />"," ")+" "+a.calendar.events[c].url;b.addEvent(a.calendar.events[c].title,d,"Scalable-Learning",a.calendar.events[c].start,a.calendar.events[c].start)}b.download("calendar")},a.createAnnouncement=function(){b.go("course.announcements",{course_id:a.course_id,show:!0})}}]),angular.module("scalearAngularApp").controller("CalendarModalCtrl",["$state","$stateParams","$scope","$modalInstance","Course","$window","$rootScope","$timeout","$filter","$compile",function(a,b,c,d,e,f,g,h,i,j){c.eventRender=function(a,b){var d=a.course_short_name+": "+a.item_title+"<br />Due at  "+i("date")(a.start,"HH:mm");1==a.status?d+="<br />Completed on time":2==a.status&&(d+="<br />Completed "+a.days+" days late"),b.attr({"tooltip-html-unsafe":d,"tooltip-append-to-body":!0}),j(b)(c)};var k=function(){c.eventSources=[],e.getCalendarEvents({course_id:b.course_id},function(b){c.uiConfig={calendar:{editable:!1,header:{right:"today prev,next",left:"title"},eventRender:c.eventRender}},c.calendar=b;for(var d in c.calendar.events)c.calendar.events[d].start=new Date(c.calendar.events[d].start),c.calendar.events[d].item_title=c.calendar.events[d].title.replace(" due",""),c.calendar.events[d].title=c.calendar.events[d].course_short_name+": "+c.calendar.events[d].item_title,c.calendar.events[d].url=2==g.current_user.roles[0].id?c.calendar.events[d].quiz_id?a.href("course.module.courseware.quiz",{course_id:c.calendar.events[d].course_id,module_id:c.calendar.events[d].group_id,quiz_id:c.calendar.events[d].quiz_id}):c.calendar.events[d].lecture_id?a.href("course.module.courseware.lecture",{course_id:c.calendar.events[d].course_id,module_id:c.calendar.events[d].group_id,lecture_id:c.calendar.events[d].lecture_id}):a.href("course.module.courseware",{course_id:c.calendar.events[d].course_id,module_id:c.calendar.events[d].group_id}):a.href("course.module.progress",{course_id:c.calendar.events[d].course_id,module_id:c.calendar.events[d].group_id});c.calendar.className=["truncate"],c.eventSources.push(c.calendar),h(function(){$(window).resize()})},function(){})};k()}]);